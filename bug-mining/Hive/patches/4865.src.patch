diff --git a/ql/src/test/results/clientpositive/alter_merge_orc.q.out b/ql/src/test/results/clientpositive/alter_merge_orc.q.out
index aa83fce02b..b5a6d04d9c 100644
--- a/ql/src/test/results/clientpositive/alter_merge_orc.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_orc.q.out
@@ -179,10 +179,12 @@ minFileSize:2515
 PREHOOK: query: select count(1) from src_orc_merge_test_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src_orc_merge_test_part
+PREHOOK: Input: default@src_orc_merge_test_part@ds=2011
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from src_orc_merge_test_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_orc_merge_test_part
+POSTHOOK: Input: default@src_orc_merge_test_part@ds=2011
 #### A masked pattern was here ####
 1500
 PREHOOK: query: select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part
diff --git a/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out b/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out
index b30d9da825..156d02f31e 100644
--- a/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out
+++ b/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out
@@ -53,10 +53,12 @@ POSTHOOK: Input: default@cbo_t1@dt=2014
 PREHOOK: query: select f,a,e,b from (select count(*) as a, count(c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
+PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: select f,a,e,b from (select count(*) as a, count(c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
+POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 1	20	1	18
 PREHOOK: query: select f,a,e,b from (select count(*) as a, count(distinct c_int) as b, sum(distinct c_int) as c, avg(distinct c_int) as d, max(distinct c_int) as e, min(distinct c_int) as f from cbo_t1) cbo_t1
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out b/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
index cbfc7be7b1..fc4f4830c8 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
@@ -1158,37 +1158,53 @@ Storage Desc Params:
 PREHOOK: query: select count(*) from over1k_part_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_orc
+PREHOOK: Input: default@over1k_part_orc@ds=foo/t=27
+PREHOOK: Input: default@over1k_part_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_orc
+POSTHOOK: Input: default@over1k_part_orc@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 38
 PREHOOK: query: select count(*) from over1k_part_limit_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_limit_orc
+PREHOOK: Input: default@over1k_part_limit_orc@ds=foo/t=27
+PREHOOK: Input: default@over1k_part_limit_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_limit_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_limit_orc
+POSTHOOK: Input: default@over1k_part_limit_orc@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part_limit_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 20
 PREHOOK: query: select count(*) from over1k_part_buck_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_orc
+PREHOOK: Input: default@over1k_part_buck_orc@t=27
+PREHOOK: Input: default@over1k_part_buck_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_orc
+POSTHOOK: Input: default@over1k_part_buck_orc@t=27
+POSTHOOK: Input: default@over1k_part_buck_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 38
 PREHOOK: query: select count(*) from over1k_part_buck_sort_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_sort_orc
+PREHOOK: Input: default@over1k_part_buck_sort_orc@t=27
+PREHOOK: Input: default@over1k_part_buck_sort_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_sort_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_sort_orc
+POSTHOOK: Input: default@over1k_part_buck_sort_orc@t=27
+POSTHOOK: Input: default@over1k_part_buck_sort_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 38
 PREHOOK: query: -- tests for HIVE-6883
@@ -1689,10 +1705,14 @@ POSTHOOK: Input: default@over1k_part2_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select count(*) from over1k_part2_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part2_orc
+PREHOOK: Input: default@over1k_part2_orc@ds=foo/t=27
+PREHOOK: Input: default@over1k_part2_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part2_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part2_orc
+POSTHOOK: Input: default@over1k_part2_orc@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part2_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: insert overwrite table over1k_part2_orc partition(ds="foo",t) select si,i,b,f,t from over1k_orc where t is null or t=27 order by i
@@ -1832,10 +1852,14 @@ POSTHOOK: Input: default@over1k_part2_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select count(*) from over1k_part2_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part2_orc
+PREHOOK: Input: default@over1k_part2_orc@ds=foo/t=27
+PREHOOK: Input: default@over1k_part2_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part2_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part2_orc
+POSTHOOK: Input: default@over1k_part2_orc@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part2_orc@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: -- hadoop-1 does not honor number of reducers in local mode. There is always only 1 reducer irrespective of the number of buckets.
@@ -2140,22 +2164,58 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain select count(*) from over1k_part_buck_sort2_orc
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: over1k_part_buck_sort2_orc
+            Statistics: Num rows: 19 Data size: 493 Basic stats: COMPLETE Column stats: NONE
+            Select Operator
+              Statistics: Num rows: 19 Data size: 493 Basic stats: COMPLETE Column stats: NONE
+              Group By Operator
+                aggregations: count()
+                mode: hash
+                outputColumnNames: _col0
+                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+                Reduce Output Operator
+                  sort order: 
+                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+                  value expressions: _col0 (type: bigint)
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations: count(VALUE._col0)
+          mode: mergepartial
+          outputColumnNames: _col0
+          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
-      limit: 1
+      limit: -1
       Processor Tree:
         ListSink
 
 PREHOOK: query: select count(*) from over1k_part_buck_sort2_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_sort2_orc
+PREHOOK: Input: default@over1k_part_buck_sort2_orc@t=27
+PREHOOK: Input: default@over1k_part_buck_sort2_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_sort2_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_sort2_orc
+POSTHOOK: Input: default@over1k_part_buck_sort2_orc@t=27
+POSTHOOK: Input: default@over1k_part_buck_sort2_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: insert overwrite table over1k_part_buck_sort2_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
@@ -2314,21 +2374,57 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain select count(*) from over1k_part_buck_sort2_orc
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: over1k_part_buck_sort2_orc
+            Statistics: Num rows: 19 Data size: 493 Basic stats: COMPLETE Column stats: NONE
+            Select Operator
+              Statistics: Num rows: 19 Data size: 493 Basic stats: COMPLETE Column stats: NONE
+              Group By Operator
+                aggregations: count()
+                mode: hash
+                outputColumnNames: _col0
+                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+                Reduce Output Operator
+                  sort order: 
+                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+                  value expressions: _col0 (type: bigint)
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations: count(VALUE._col0)
+          mode: mergepartial
+          outputColumnNames: _col0
+          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
-      limit: 1
+      limit: -1
       Processor Tree:
         ListSink
 
 PREHOOK: query: select count(*) from over1k_part_buck_sort2_orc
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_sort2_orc
+PREHOOK: Input: default@over1k_part_buck_sort2_orc@t=27
+PREHOOK: Input: default@over1k_part_buck_sort2_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_sort2_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_sort2_orc
+POSTHOOK: Input: default@over1k_part_buck_sort2_orc@t=27
+POSTHOOK: Input: default@over1k_part_buck_sort2_orc@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out b/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
index ce3fad24dc..d24ee1648e 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
@@ -1107,37 +1107,53 @@ Storage Desc Params:
 PREHOOK: query: select count(*) from over1k_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part
+PREHOOK: Input: default@over1k_part@ds=foo/t=27
+PREHOOK: Input: default@over1k_part@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part
+POSTHOOK: Input: default@over1k_part@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 38
 PREHOOK: query: select count(*) from over1k_part_limit
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_limit
+PREHOOK: Input: default@over1k_part_limit@ds=foo/t=27
+PREHOOK: Input: default@over1k_part_limit@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_limit
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_limit
+POSTHOOK: Input: default@over1k_part_limit@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part_limit@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 20
 PREHOOK: query: select count(*) from over1k_part_buck
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck
+PREHOOK: Input: default@over1k_part_buck@t=27
+PREHOOK: Input: default@over1k_part_buck@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck
+POSTHOOK: Input: default@over1k_part_buck@t=27
+POSTHOOK: Input: default@over1k_part_buck@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 38
 PREHOOK: query: select count(*) from over1k_part_buck_sort
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_sort
+PREHOOK: Input: default@over1k_part_buck_sort@t=27
+PREHOOK: Input: default@over1k_part_buck_sort@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_sort
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_sort
+POSTHOOK: Input: default@over1k_part_buck_sort@t=27
+POSTHOOK: Input: default@over1k_part_buck_sort@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 38
 PREHOOK: query: -- tests for HIVE-6883
@@ -1633,10 +1649,14 @@ POSTHOOK: Input: default@over1k_part2@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select count(*) from over1k_part2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part2
+PREHOOK: Input: default@over1k_part2@ds=foo/t=27
+PREHOOK: Input: default@over1k_part2@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part2
+POSTHOOK: Input: default@over1k_part2@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part2@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: insert overwrite table over1k_part2 partition(ds="foo",t) select si,i,b,f,t from over1k where t is null or t=27 order by i
@@ -1776,10 +1796,14 @@ POSTHOOK: Input: default@over1k_part2@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select count(*) from over1k_part2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part2
+PREHOOK: Input: default@over1k_part2@ds=foo/t=27
+PREHOOK: Input: default@over1k_part2@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part2
+POSTHOOK: Input: default@over1k_part2@ds=foo/t=27
+POSTHOOK: Input: default@over1k_part2@ds=foo/t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: -- hadoop-1 does not honor number of reducers in local mode. There is always only 1 reducer irrespective of the number of buckets.
@@ -2059,10 +2083,14 @@ POSTHOOK: Input: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select count(*) from over1k_part_buck_sort2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_sort2
+PREHOOK: Input: default@over1k_part_buck_sort2@t=27
+PREHOOK: Input: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_sort2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_sort2
+POSTHOOK: Input: default@over1k_part_buck_sort2@t=27
+POSTHOOK: Input: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: insert overwrite table over1k_part_buck_sort2 partition(t) select si,i,b,f,t from over1k where t is null or t=27
@@ -2198,10 +2226,14 @@ POSTHOOK: Input: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: select count(*) from over1k_part_buck_sort2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part_buck_sort2
+PREHOOK: Input: default@over1k_part_buck_sort2@t=27
+PREHOOK: Input: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from over1k_part_buck_sort2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_part_buck_sort2
+POSTHOOK: Input: default@over1k_part_buck_sort2@t=27
+POSTHOOK: Input: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 #### A masked pattern was here ####
 19
 PREHOOK: query: create table over1k_part3(
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
index 1d43bc001d..3dbf6181d0 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
@@ -318,27 +318,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds='2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds='2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(1) from list_bucketing_dynamic_part where ds='2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_dynamic_part
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=11
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from list_bucketing_dynamic_part where ds='2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_dynamic_part
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select key, value from srcpart where ds='2008-04-08' and hr='11' and key = "484"
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out
index b94e52bc80..2dbcf39ebb 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out
@@ -303,25 +303,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(*) from list_bucketing_static_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_static_part
-PREHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from list_bucketing_static_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_static_part
-POSTHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 1000
 PREHOOK: query: explain extended
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
index 385e1136fa..049c57a5aa 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
@@ -264,25 +264,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds='2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds='2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(1) from list_bucketing_static_part where ds='2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_static_part
-PREHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from list_bucketing_static_part where ds='2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_static_part
-POSTHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select key, value from srcpart where ds='2008-04-08' and hr='11' and key = "484"
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out
index 27849a0321..cbe35793b6 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out
@@ -679,25 +679,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(*) from list_bucketing_static_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_static_part
-PREHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from list_bucketing_static_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_static_part
-POSTHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 1000
 PREHOOK: query: explain extended
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out
index 95da7c9456..b46977da6f 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out
@@ -320,27 +320,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds='2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds='2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(1) from list_bucketing_dynamic_part where ds='2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_dynamic_part
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=11
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from list_bucketing_dynamic_part where ds='2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_dynamic_part
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select key, value from srcpart where ds='2008-04-08' and key = "103" and value ="val_103"
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out
index 655ac3515e..3591239714 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out
@@ -825,27 +825,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(*) from list_bucketing_dynamic_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_dynamic_part
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=a1
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=b1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from list_bucketing_dynamic_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_dynamic_part
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=a1
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=b1
 #### A masked pattern was here ####
 1000
 PREHOOK: query: explain extended
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
index 224ecc26c5..ab8d0a89fa 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
@@ -773,27 +773,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(*) from list_bucketing_dynamic_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_dynamic_part
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=a1
-PREHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=b1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from list_bucketing_dynamic_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_dynamic_part
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=a1
-POSTHOOK: Input: default@list_bucketing_dynamic_part@ds=2008-04-08/hr=b1
 #### A masked pattern was here ####
 1000
 PREHOOK: query: explain extended
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out
index 6c542ed77d..2640f8d1ab 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out
@@ -460,14 +460,10 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(*) from list_bucketing_dynamic_part
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out
index cb19154079..400f23bf27 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out
@@ -679,25 +679,19 @@ Storage Desc Params:
 PREHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
-POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 #### A masked pattern was here ####
 1000
 PREHOOK: query: select count(*) from list_bucketing_static_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@list_bucketing_static_part
-PREHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from list_bucketing_static_part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@list_bucketing_static_part
-POSTHOOK: Input: default@list_bucketing_static_part@ds=2008-04-08/hr=11
 #### A masked pattern was here ####
 1000
 PREHOOK: query: explain extended
diff --git a/ql/src/test/results/clientpositive/orc_merge1.q.out b/ql/src/test/results/clientpositive/orc_merge1.q.out
index 63dd19cf08..3f047dae20 100644
--- a/ql/src/test/results/clientpositive/orc_merge1.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge1.q.out
@@ -400,28 +400,40 @@ POSTHOOK: Input: default@orcfile_merge1c@ds=1/part=1
 PREHOOK: query: select count(*) from orcfile_merge1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orcfile_merge1
+PREHOOK: Input: default@orcfile_merge1@ds=1/part=0
+PREHOOK: Input: default@orcfile_merge1@ds=1/part=1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from orcfile_merge1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orcfile_merge1
+POSTHOOK: Input: default@orcfile_merge1@ds=1/part=0
+POSTHOOK: Input: default@orcfile_merge1@ds=1/part=1
 #### A masked pattern was here ####
 500
 PREHOOK: query: select count(*) from orcfile_merge1b
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orcfile_merge1b
+PREHOOK: Input: default@orcfile_merge1b@ds=1/part=0
+PREHOOK: Input: default@orcfile_merge1b@ds=1/part=1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from orcfile_merge1b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orcfile_merge1b
+POSTHOOK: Input: default@orcfile_merge1b@ds=1/part=0
+POSTHOOK: Input: default@orcfile_merge1b@ds=1/part=1
 #### A masked pattern was here ####
 500
 PREHOOK: query: select count(*) from orcfile_merge1c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orcfile_merge1c
+PREHOOK: Input: default@orcfile_merge1c@ds=1/part=0
+PREHOOK: Input: default@orcfile_merge1c@ds=1/part=1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from orcfile_merge1c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orcfile_merge1c
+POSTHOOK: Input: default@orcfile_merge1c@ds=1/part=0
+POSTHOOK: Input: default@orcfile_merge1c@ds=1/part=1
 #### A masked pattern was here ####
 500
 PREHOOK: query: DROP TABLE orcfile_merge1
diff --git a/ql/src/test/results/clientpositive/orc_merge10.q.out b/ql/src/test/results/clientpositive/orc_merge10.q.out
index efb5669a3f..1d64ae5f7a 100644
--- a/ql/src/test/results/clientpositive/orc_merge10.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge10.q.out
@@ -381,19 +381,27 @@ POSTHOOK: Input: default@orcfile_merge1b@ds=1/part=1
 PREHOOK: query: select count(*) from orcfile_merge1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orcfile_merge1
+PREHOOK: Input: default@orcfile_merge1@ds=1/part=0
+PREHOOK: Input: default@orcfile_merge1@ds=1/part=1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from orcfile_merge1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orcfile_merge1
+POSTHOOK: Input: default@orcfile_merge1@ds=1/part=0
+POSTHOOK: Input: default@orcfile_merge1@ds=1/part=1
 #### A masked pattern was here ####
 500
 PREHOOK: query: select count(*) from orcfile_merge1b
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orcfile_merge1b
+PREHOOK: Input: default@orcfile_merge1b@ds=1/part=0
+PREHOOK: Input: default@orcfile_merge1b@ds=1/part=1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from orcfile_merge1b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orcfile_merge1b
+POSTHOOK: Input: default@orcfile_merge1b@ds=1/part=0
+POSTHOOK: Input: default@orcfile_merge1b@ds=1/part=1
 #### A masked pattern was here ####
 500
 PREHOOK: query: -- concatenate
@@ -492,10 +500,14 @@ POSTHOOK: Input: default@orcfile_merge1@ds=1/part=1
 PREHOOK: query: select count(*) from orcfile_merge1c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orcfile_merge1c
+PREHOOK: Input: default@orcfile_merge1c@ds=1/part=0
+PREHOOK: Input: default@orcfile_merge1c@ds=1/part=1
 #### A masked pattern was here ####
 POSTHOOK: query: select count(*) from orcfile_merge1c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orcfile_merge1c
+POSTHOOK: Input: default@orcfile_merge1c@ds=1/part=0
+POSTHOOK: Input: default@orcfile_merge1c@ds=1/part=1
 #### A masked pattern was here ####
 500
 PREHOOK: query: select * from orcfile_merge1 where ds='1' and part='0' limit 1
diff --git a/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out b/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
index 7e30942696..caa41b25cf 100644
--- a/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
+++ b/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
@@ -64,12 +64,10 @@ POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03
 PREHOOK: query: select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src_orc_merge_test_part
-PREHOOK: Input: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 #### A masked pattern was here ####
 POSTHOOK: query: select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_orc_merge_test_part
-POSTHOOK: Input: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 #### A masked pattern was here ####
 610
 PREHOOK: query: select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
diff --git a/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out b/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out
index c5616cfd4d..618b7b136b 100644
--- a/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out
+++ b/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out
@@ -56,25 +56,25 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: srcpart
-                  Statistics: Num rows: 2000 Data size: 724000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 2000 Data size: 389248 Basic stats: COMPLETE Column stats: PARTIAL
                   Select Operator
                     expressions: key (type: string), value (type: string), hr (type: string)
                     outputColumnNames: _col0, _col1, _col2
-                    Statistics: Num rows: 2000 Data size: 724000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 2000 Data size: 368000 Basic stats: COMPLETE Column stats: PARTIAL
                     Reduce Output Operator
                       sort order: 
                       Map-reduce partition columns: _col0 (type: string)
-                      Statistics: Num rows: 2000 Data size: 724000 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 2000 Data size: 368000 Basic stats: COMPLETE Column stats: PARTIAL
                       value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
                 expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string)
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 2000 Data size: 724000 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 2000 Data size: 368000 Basic stats: COMPLETE Column stats: PARTIAL
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 2000 Data size: 724000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 2000 Data size: 368000 Basic stats: COMPLETE Column stats: PARTIAL
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
