diff --git a/storage-api/src/java/org/apache/hive/common/util/Murmur3.java b/storage-api/src/java/org/apache/hive/common/util/Murmur3.java
index 1c56765a8a..eb050820d6 100644
--- a/storage-api/src/java/org/apache/hive/common/util/Murmur3.java
+++ b/storage-api/src/java/org/apache/hive/common/util/Murmur3.java
@@ -52,7 +52,7 @@ public class Murmur3 {
   private static final int N1 = 0x52dce729;
   private static final int N2 = 0x38495ab5;
 
-  private static final int DEFAULT_SEED = 104729;
+  public static final int DEFAULT_SEED = 104729;
 
   /**
    * Murmur3 32-bit variant.
@@ -358,13 +358,13 @@ public final void add(byte[] data, int offset, int length) {
         int k = -1;
         switch (tailLen) {
         case 1:
-          k = orBytes(tail[0], data[0], data[1], data[2]);
+          k = orBytes(tail[0], data[offset], data[offset + 1], data[offset + 2]);
           break;
         case 2:
-          k = orBytes(tail[0], tail[1], data[0], data[1]);
+          k = orBytes(tail[0], tail[1], data[offset], data[offset + 1]);
           break;
         case 3:
-          k = orBytes(tail[0], tail[1], tail[2], data[0]);
+          k = orBytes(tail[0], tail[1], tail[2], data[offset]);
           break;
         default: throw new AssertionError(tailLen);
         }
diff --git a/storage-api/src/test/org/apache/hive/common/util/TestMurmur3.java b/storage-api/src/test/org/apache/hive/common/util/TestMurmur3.java
index 5facc7c4de..391ee425cc 100644
--- a/storage-api/src/test/org/apache/hive/common/util/TestMurmur3.java
+++ b/storage-api/src/test/org/apache/hive/common/util/TestMurmur3.java
@@ -19,6 +19,7 @@
 package org.apache.hive.common.util;
 
 import static org.junit.Assert.assertEquals;
+import org.apache.hive.common.util.Murmur3.IncrementalHash32;
 
 import com.google.common.hash.HashFunction;
 import com.google.common.hash.Hashing;
@@ -221,4 +222,27 @@ public void testHashCodesM3_128_double() {
       assertEquals(gl2, m2);
     }
   }
+  
+
+  @Test
+  public void testIncremental() {
+    final int seed = 123, arraySize = 1023;
+    byte[] bytes = new byte[arraySize];
+    new Random(seed).nextBytes(bytes);
+    int expected = Murmur3.hash32(bytes);
+    Murmur3.IncrementalHash32 same = new IncrementalHash32(), diff = new IncrementalHash32();
+    for (int blockSize = 1; blockSize <= arraySize; ++blockSize) {
+      byte[] block = new byte[blockSize];
+      same.start(Murmur3.DEFAULT_SEED);
+      diff.start(Murmur3.DEFAULT_SEED);
+      for (int offset = 0; offset < arraySize; offset += blockSize) {
+        int length = Math.min(arraySize - offset, blockSize);
+        same.add(bytes, offset, length);
+        System.arraycopy(bytes, offset, block, 0, length);
+        diff.add(block, 0, length);
+      }
+      assertEquals("Block size " + blockSize, expected, same.end());
+      assertEquals("Block size " + blockSize, expected, diff.end());
+    }
+  }
 }
