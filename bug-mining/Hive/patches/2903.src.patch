diff --git a/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseStorageHandler.java b/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseStorageHandler.java
index 814c86c64a..d1530dc3dd 100644
--- a/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseStorageHandler.java
+++ b/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseStorageHandler.java
@@ -59,6 +59,7 @@
 import org.apache.hadoop.hive.ql.plan.TableDesc;
 import org.apache.hadoop.hive.serde2.Deserializer;
 import org.apache.hadoop.hive.serde2.SerDe;
+import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.mapred.InputFormat;
 import org.apache.hadoop.mapred.JobConf;
 import org.apache.hadoop.mapred.OutputFormat;
@@ -479,7 +480,7 @@ public void configureJobConf(TableDesc tableDesc, JobConf jobConf) {
       // Get credentials using the configuration instance which has HBase properties
       JobConf hbaseJobConf = new JobConf(getConf());
       org.apache.hadoop.hbase.mapred.TableMapReduceUtil.initCredentials(hbaseJobConf);
-      jobConf.getCredentials().mergeAll(hbaseJobConf.getCredentials());
+      ShimLoader.getHadoopShims().mergeCredentials(jobConf, hbaseJobConf);
     } catch (Exception e) {
       throw new RuntimeException(e);
     }
diff --git a/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java b/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
index 9d2ff55a5c..76df71c3eb 100644
--- a/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
+++ b/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
@@ -904,6 +904,11 @@ public void getMergedCredentials(JobConf jobConf) throws IOException {
     throw new IOException("Merging of credentials not supported in this version of hadoop");
   }
 
+  @Override
+  public void mergeCredentials(JobConf dest, JobConf src) throws IOException {
+    throw new IOException("Merging of credentials not supported in this version of hadoop");
+  }
+
   protected void run(FsShell shell, String[] command) throws Exception {
     LOG.debug(ArrayUtils.toString(command));
     shell.run(command);
diff --git a/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java b/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
index 2626af707d..127f6e6ed2 100644
--- a/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
+++ b/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
@@ -527,6 +527,11 @@ public void getMergedCredentials(JobConf jobConf) throws IOException {
     throw new IOException("Merging of credentials not supported in this version of hadoop");
   }
 
+  @Override
+  public void mergeCredentials(JobConf dest, JobConf src) throws IOException {
+    throw new IOException("Merging of credentials not supported in this version of hadoop");
+  }
+
   @Override
   public String getPassword(Configuration conf, String name) {
     // No password API, just retrieve value from conf
diff --git a/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java b/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
index 2dd40780be..c80d3a816a 100644
--- a/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
+++ b/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
@@ -771,6 +771,11 @@ public void getMergedCredentials(JobConf jobConf) throws IOException {
     jobConf.getCredentials().mergeAll(UserGroupInformation.getCurrentUser().getCredentials());
   }
 
+  @Override
+  public void mergeCredentials(JobConf dest, JobConf src) throws IOException {
+    dest.getCredentials().mergeAll(src.getCredentials());
+  }
+
   protected static final Method accessMethod;
   protected static final Method getPasswordMethod;
 
diff --git a/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java b/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java
index f079cf8ad8..d72e0da014 100644
--- a/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java
+++ b/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java
@@ -712,6 +712,8 @@ public interface DirectDecompressorShim {
 
   public void getMergedCredentials(JobConf jobConf) throws IOException;
 
+  public void mergeCredentials(JobConf dest, JobConf src) throws IOException;
+
   /**
    * Check if the configured UGI has access to the path for the given file system action.
    * Method will return successfully if action is permitted. AccessControlExceptoin will
