diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
index 7ee6186553..4857ddc46c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
@@ -18,8 +18,6 @@
 
 package org.apache.hadoop.hive.ql.exec.tez;
 
-import java.io.Serializable;
-import org.apache.hadoop.hive.ql.exec.ConditionalTask;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
 
 import java.io.IOException;
@@ -88,6 +86,8 @@
 import org.json.JSONObject;
 import org.apache.hadoop.hive.ql.exec.tez.monitoring.TezJobMonitor;
 
+import com.google.common.annotations.VisibleForTesting;
+
 /**
  *
  * TezTask handles the execution of TezWork. Currently it executes a graph of map and reduce work
@@ -105,6 +105,8 @@ public class TezTask extends Task<TezWork> {
 
   private final DagUtils utils;
 
+  private final Object dagClientLock = new Object();
+  private volatile boolean isShutdown = false;
   private DAGClient dagClient = null;
 
   Map<BaseWork, Vertex> workToVertex = new HashMap<BaseWork, Vertex>();
@@ -189,9 +191,24 @@ public int execute(DriverContext driverContext) {
         // Add the extra resources to the dag
         addExtraResourcesToDag(session, dag, inputOutputJars, inputOutputLocalResources);
 
-        // submit will send the job to the cluster and start executing
-        dagClient = submit(jobConf, dag, scratchDir, appJarLr, session,
+        // Check isShutdown opportunistically; it's never unset.
+        if (this.isShutdown) {
+          throw new HiveException("Operation cancelled");
+        }
+        DAGClient dagClient = submit(jobConf, dag, scratchDir, appJarLr, session,
             additionalLr, inputOutputJars, inputOutputLocalResources);
+        boolean wasShutdown = false;
+        synchronized (dagClientLock) {
+          assert this.dagClient == null;
+          wasShutdown = this.isShutdown;
+          if (!wasShutdown) {
+            this.dagClient = dagClient;
+          }
+        }
+        if (wasShutdown) {
+          closeDagClientOnCancellation(dagClient);
+          throw new HiveException("Operation cancelled");
+        }
 
         // finally monitor will print progress until the job is done
         TezJobMonitor monitor = new TezJobMonitor(work.getAllWork(),dagClient, conf, dag, ctx);
@@ -254,14 +271,33 @@ public int execute(DriverContext driverContext) {
         }
       }
       // need to either move tmp files or remove them
+      DAGClient dagClient = null;
+      synchronized (dagClientLock) {
+        dagClient = this.dagClient;
+        this.dagClient = null;
+      }
+      // TODO: not clear why we don't do the rest of the cleanup if dagClient is not created.
+      //       E.g. jobClose will be called if we fail after dagClient creation but no before...
+      //       DagClient as such should have no bearing on jobClose.
       if (dagClient != null) {
         // rc will only be overwritten if close errors out
-        rc = close(work, rc);
+        rc = close(work, rc, dagClient);
       }
     }
     return rc;
   }
 
+  private void closeDagClientOnCancellation(DAGClient dagClient) {
+    try {
+      dagClient.tryKillDAG();
+      LOG.info("Waiting for Tez task to shut down: " + this);
+      dagClient.waitForCompletion();
+    } catch (Exception ex) {
+      LOG.warn("Failed to shut down TezTask" + this, ex);
+    }
+    closeDagClientWithoutEx(dagClient);
+  }
+
   private void logResources(List<LocalResource> additionalLr) {
     // log which resources we're adding (apart from the hive exec)
     if (!LOG.isDebugEnabled()) return;
@@ -544,7 +580,8 @@ DAGClient submit(JobConf conf, DAG dag, Path scratchDir,
    * close will move the temp files into the right place for the fetch
    * task. If the job has failed it will clean up the files.
    */
-  int close(TezWork work, int rc) {
+  @VisibleForTesting
+  int close(TezWork work, int rc, DAGClient dagClient) {
     try {
       List<BaseWork> ws = work.getAllWork();
       for (BaseWork w: ws) {
@@ -564,7 +601,9 @@ int close(TezWork work, int rc) {
         console.printError(mesg, "\n" + StringUtils.stringifyException(e));
       }
     }
-    closeDagClientWithoutEx();
+    if (dagClient != null) { // null in tests
+      closeDagClientWithoutEx(dagClient);
+    }
     return rc;
   }
 
@@ -572,10 +611,9 @@ int close(TezWork work, int rc) {
    * Close DagClient, log warning if it throws any exception.
    * We don't want to fail query if that function fails.
    */
-  private void closeDagClientWithoutEx(){
+  private static void closeDagClientWithoutEx(DAGClient dagClient) {
     try {
       dagClient.close();
-      dagClient = null;
     } catch (Exception e) {
       LOG.warn("Failed to close DagClient", e);
     }
@@ -642,17 +680,16 @@ public Operator<? extends OperatorDesc> getReducer(MapWork mapWork) {
   @Override
   public void shutdown() {
     super.shutdown();
-    if (dagClient != null) {
-      LOG.info("Shutting down Tez task " + this);
-      try {
-        dagClient.tryKillDAG();
-        LOG.info("Waiting for Tez task to shut down: " + this);
-        dagClient.waitForCompletion();
-      } catch (Exception ex) {
-        LOG.warn("Failed to shut down TezTask" + this, ex);
-      }
-      closeDagClientWithoutEx();
+    DAGClient dagClient = null;
+    synchronized (dagClientLock) {
+      isShutdown = true;
+      dagClient = this.dagClient;
+      // Don't set dagClient to null here - execute will only clean up operators if it's set.
     }
+    LOG.info("Shutting down Tez task " + this + " "
+        + ((dagClient == null) ? " before submit" : ""));
+    if (dagClient == null) return;
+    closeDagClientOnCancellation(dagClient);
   }
 
   /** DAG client that does dumb global sync on all the method calls;
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/tez/TestTezTask.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/tez/TestTezTask.java
index 70fedb7857..5c8065429c 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/tez/TestTezTask.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/tez/TestTezTask.java
@@ -233,7 +233,7 @@ public void testSubmit() throws Exception {
 
   @Test
   public void testClose() throws HiveException {
-    task.close(work, 0);
+    task.close(work, 0, null);
     verify(op, times(4)).jobClose(any(Configuration.class), eq(true));
   }
 
