diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
index c6d2fd91a3..2798eaa8ea 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
@@ -186,6 +186,7 @@ public enum ErrorMsg {
   NO_COMPARE_BIGINT_DOUBLE("In strict mode, comparing bigints and doubles is not allowed, "
       + "it may result in a loss of precision. "
       + "If you really want to perform the operation, set hive.mapred.mode=nonstrict"),
+      FUNCTIONS_ARE_NOT_SUPPORTED_IN_ORDER_BY("functions are not supported in order by"),
       ;
 
   private String mesg;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 7b818dfcde..e091e86b67 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -4524,6 +4524,9 @@ private Operator genReduceSinkPlan(String dest, QB qb, Operator input,
           // ClusterBy
           order.append("+");
         }
+        if (cl.getType() == HiveParser.TOK_FUNCTION) {
+          throw new SemanticException(ErrorMsg.FUNCTIONS_ARE_NOT_SUPPORTED_IN_ORDER_BY.getMsg());
+        }
         ExprNodeDesc exprNode = genExprNodeDesc(cl, inputRR);
         sortCols.add(exprNode);
       }
diff --git a/ql/src/test/queries/clientnegative/orderby_function.q b/ql/src/test/queries/clientnegative/orderby_function.q
new file mode 100644
index 0000000000..e63b6a85cc
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/orderby_function.q
@@ -0,0 +1 @@
+select src.key FROM src ORDER BY count(1) limit 1;
diff --git a/ql/src/test/results/clientnegative/orderby_function.q.out b/ql/src/test/results/clientnegative/orderby_function.q.out
new file mode 100644
index 0000000000..c4f4dbbf23
--- /dev/null
+++ b/ql/src/test/results/clientnegative/orderby_function.q.out
@@ -0,0 +1 @@
+FAILED: Error in semantic analysis: functions are not supported in order by
