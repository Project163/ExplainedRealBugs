diff --git a/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out b/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
index 3a181f383a..e264abb3f4 100644
--- a/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
@@ -184,16 +184,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -246,16 +246,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -284,7 +284,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -298,7 +298,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -312,7 +312,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -650,16 +650,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -712,16 +712,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -750,7 +750,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -764,7 +764,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -778,7 +778,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -1201,16 +1201,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -1307,16 +1307,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -1345,7 +1345,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1359,7 +1359,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1373,7 +1373,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -1789,16 +1789,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -1895,16 +1895,16 @@ STAGE PLANS:
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -1933,7 +1933,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1947,7 +1947,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -1961,7 +1961,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -2432,16 +2432,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -2551,16 +2551,16 @@ STAGE PLANS:
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -2589,7 +2589,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -2603,7 +2603,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -2617,7 +2617,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -3178,16 +3178,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
-  Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
-  Stage-5
-  Stage-9 depends on stages: Stage-5, Stage-4, Stage-7, Stage-12, Stage-11, Stage-14
-  Stage-0 depends on stages: Stage-9
+  Stage-9 depends on stages: Stage-2 , consists of Stage-6, Stage-5, Stage-7
+  Stage-6
+  Stage-4 depends on stages: Stage-6, Stage-5, Stage-8, Stage-12, Stage-11, Stage-14
+  Stage-0 depends on stages: Stage-4
   Stage-3 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-9
+  Stage-1 depends on stages: Stage-4
   Stage-10 depends on stages: Stage-1
-  Stage-4
-  Stage-6
-  Stage-7 depends on stages: Stage-6
+  Stage-5
+  Stage-7
+  Stage-8 depends on stages: Stage-7
   Stage-15 depends on stages: Stage-2 , consists of Stage-12, Stage-11, Stage-13
   Stage-12
   Stage-11
@@ -3297,16 +3297,16 @@ STAGE PLANS:
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           name: default.src_multi2
 
-  Stage: Stage-8
+  Stage: Stage-9
     Conditional Operator
 
-  Stage: Stage-5
+  Stage: Stage-6
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-9
+  Stage: Stage-4
     Dependency Collection
 
   Stage: Stage-0
@@ -3335,7 +3335,7 @@ STAGE PLANS:
   Stage: Stage-10
     Stats-Aggr Operator
 
-  Stage: Stage-4
+  Stage: Stage-5
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -3349,7 +3349,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -3363,7 +3363,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
@@ -6276,16 +6276,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
-  Stage-10 depends on stages: Stage-4 , consists of Stage-7, Stage-6, Stage-8
-  Stage-7
-  Stage-11 depends on stages: Stage-7, Stage-6, Stage-9, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
-  Stage-0 depends on stages: Stage-11
+  Stage-11 depends on stages: Stage-4 , consists of Stage-8, Stage-7, Stage-9
+  Stage-8
+  Stage-6 depends on stages: Stage-8, Stage-7, Stage-10, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
+  Stage-0 depends on stages: Stage-6
   Stage-5 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-11
+  Stage-1 depends on stages: Stage-6
   Stage-12 depends on stages: Stage-1
-  Stage-6
-  Stage-8
-  Stage-9 depends on stages: Stage-8
+  Stage-7
+  Stage-9
+  Stage-10 depends on stages: Stage-9
   Stage-17 depends on stages: Stage-4 , consists of Stage-14, Stage-13, Stage-15
   Stage-14
   Stage-13
@@ -6422,16 +6422,16 @@ STAGE PLANS:
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
 
-  Stage: Stage-10
+  Stage: Stage-11
     Conditional Operator
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-11
+  Stage: Stage-6
     Dependency Collection
 
   Stage: Stage-0
@@ -6460,7 +6460,7 @@ STAGE PLANS:
   Stage: Stage-12
     Stats-Aggr Operator
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -6474,7 +6474,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-8
+  Stage: Stage-9
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -6488,7 +6488,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-9
+  Stage: Stage-10
     Move Operator
       files:
           hdfs directory: true
@@ -6855,16 +6855,16 @@ ABSTRACT SYNTAX TREE:
 
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
-  Stage-10 depends on stages: Stage-4 , consists of Stage-7, Stage-6, Stage-8
-  Stage-7
-  Stage-11 depends on stages: Stage-7, Stage-6, Stage-9, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
-  Stage-0 depends on stages: Stage-11
+  Stage-11 depends on stages: Stage-4 , consists of Stage-8, Stage-7, Stage-9
+  Stage-8
+  Stage-6 depends on stages: Stage-8, Stage-7, Stage-10, Stage-14, Stage-13, Stage-16, Stage-18, Stage-19
+  Stage-0 depends on stages: Stage-6
   Stage-5 depends on stages: Stage-0
-  Stage-1 depends on stages: Stage-11
+  Stage-1 depends on stages: Stage-6
   Stage-12 depends on stages: Stage-1
-  Stage-6
-  Stage-8
-  Stage-9 depends on stages: Stage-8
+  Stage-7
+  Stage-9
+  Stage-10 depends on stages: Stage-9
   Stage-17 depends on stages: Stage-4 , consists of Stage-14, Stage-13, Stage-15
   Stage-14
   Stage-13
@@ -7001,16 +7001,16 @@ STAGE PLANS:
                       output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
 
-  Stage: Stage-10
+  Stage: Stage-11
     Conditional Operator
 
-  Stage: Stage-7
+  Stage: Stage-8
     Move Operator
       files:
           hdfs directory: true
 #### A masked pattern was here ####
 
-  Stage: Stage-11
+  Stage: Stage-6
     Dependency Collection
 
   Stage: Stage-0
@@ -7039,7 +7039,7 @@ STAGE PLANS:
   Stage: Stage-12
     Stats-Aggr Operator
 
-  Stage: Stage-6
+  Stage: Stage-7
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -7053,7 +7053,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-8
+  Stage: Stage-9
     Map Reduce
       Alias -> Map Operator Tree:
 #### A masked pattern was here ####
@@ -7067,7 +7067,7 @@ STAGE PLANS:
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: default.src_multi1
 
-  Stage: Stage-9
+  Stage: Stage-10
     Move Operator
       files:
           hdfs directory: true
diff --git a/ql/src/test/results/clientpositive/vector_left_outer_join.q.out b/ql/src/test/results/clientpositive/vector_left_outer_join.q.out
index 1ecfae8e2a..0113bb5e67 100644
--- a/ql/src/test/results/clientpositive/vector_left_outer_join.q.out
+++ b/ql/src/test/results/clientpositive/vector_left_outer_join.q.out
@@ -152,4 +152,4 @@ left outer join alltypesorc hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-192735557
+225951785
diff --git a/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out b/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
index e4e824e0a8..13d54897a8 100644
--- a/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
@@ -131,4 +131,4 @@ POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-3149925	1073680599	-1073051226	9.381482540406644E8
+3152013	1073680599	-1073279343	9.375396162525452E8
