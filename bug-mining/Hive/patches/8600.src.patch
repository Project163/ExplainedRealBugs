diff --git a/standalone-metastore/metastore-server/src/main/sql/derby/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.derby.sql b/standalone-metastore/metastore-server/src/main/sql/derby/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.derby.sql
index d24722518a..b177325410 100644
--- a/standalone-metastore/metastore-server/src/main/sql/derby/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.derby.sql
+++ b/standalone-metastore/metastore-server/src/main/sql/derby/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.derby.sql
@@ -31,18 +31,22 @@ ALTER TABLE "APP"."METASTORE_DB_PROPERTIES" ADD PROPERTYCONTENT BLOB;
 
 -- HIVE-27457
 UPDATE "SDS"
-    SET "SDS"."INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat',
-        "SDS"."OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
-    WHERE "SDS"."SD_ID" IN (
-        SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%'
+    SET "INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat', "OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
+    WHERE "SD_ID" IN (
+        SELECT "TBLS"."SD_ID"
+            FROM "TBLS"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
+
 UPDATE "SERDES"
     SET "SERDES"."SLIB" = 'org.apache.hadoop.hive.kudu.KuduSerDe'
     WHERE "SERDE_ID" IN (
         SELECT "SDS"."SERDE_ID"
             FROM "TBLS"
-            LEFT JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
-            WHERE "TBL_ID" IN (SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%')
+            INNER JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
 
 -- This needs to be the last thing done.  Insert any changes above this line.
diff --git a/standalone-metastore/metastore-server/src/main/sql/mssql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mssql.sql b/standalone-metastore/metastore-server/src/main/sql/mssql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mssql.sql
index 5712d24847..e4253ac1ff 100644
--- a/standalone-metastore/metastore-server/src/main/sql/mssql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mssql.sql
+++ b/standalone-metastore/metastore-server/src/main/sql/mssql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mssql.sql
@@ -31,18 +31,22 @@ ALTER TABLE METASTORE_DB_PROPERTIES ADD PROPERTYCONTENT varbinary(max);
 
 -- HIVE-27457
 UPDATE "SDS"
-    SET "SDS"."INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat',
-        "SDS"."OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
-    WHERE "SDS"."SD_ID" IN (
-        SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%'
+    SET "INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat', "OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
+    WHERE "SD_ID" IN (
+        SELECT "TBLS"."SD_ID"
+            FROM "TBLS"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
+
 UPDATE "SERDES"
     SET "SERDES"."SLIB" = 'org.apache.hadoop.hive.kudu.KuduSerDe'
     WHERE "SERDE_ID" IN (
         SELECT "SDS"."SERDE_ID"
             FROM "TBLS"
-            LEFT JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
-            WHERE "TBL_ID" IN (SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%')
+            INNER JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
 
 -- These lines need to be last.  Insert any changes above.
diff --git a/standalone-metastore/metastore-server/src/main/sql/mysql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mysql.sql b/standalone-metastore/metastore-server/src/main/sql/mysql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mysql.sql
index fee7042115..0d4b227476 100644
--- a/standalone-metastore/metastore-server/src/main/sql/mysql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mysql.sql
+++ b/standalone-metastore/metastore-server/src/main/sql/mysql/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.mysql.sql
@@ -32,18 +32,22 @@ ALTER TABLE METASTORE_DB_PROPERTIES ADD PROPERTYCONTENT blob;
 
 -- HIVE-27457
 UPDATE SDS
-    SET SDS.INPUT_FORMAT = "org.apache.hadoop.hive.kudu.KuduInputFormat",
-        SDS.OUTPUT_FORMAT = "org.apache.hadoop.hive.kudu.KuduOutputFormat"
-    WHERE SDS.SD_ID IN (
-        SELECT TBL_ID FROM TABLE_PARAMS WHERE PARAM_VALUE LIKE '%KuduStorageHandler%'
+    SET INPUT_FORMAT = 'org.apache.hadoop.hive.kudu.KuduInputFormat', OUTPUT_FORMAT = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
+    WHERE SD_ID IN (
+        SELECT TBLS.SD_ID
+            FROM TBLS
+            INNER JOIN TABLE_PARAMS ON TBLS.TBL_ID = TABLE_PARAMS.TBL_ID
+            WHERE PARAM_VALUE LIKE '%KuduStorageHandler%'
     );
+
 UPDATE SERDES
     SET SERDES.SLIB = "org.apache.hadoop.hive.kudu.KuduSerDe"
     WHERE SERDE_ID IN (
         SELECT SDS.SERDE_ID
             FROM TBLS
-            LEFT JOIN SDS ON TBLS.SD_ID = SDS.SD_ID
-            WHERE TBL_ID IN (SELECT TBL_ID FROM TABLE_PARAMS WHERE PARAM_VALUE LIKE '%KuduStorageHandler%')
+            INNER JOIN SDS ON TBLS.SD_ID = SDS.SD_ID
+            INNER JOIN TABLE_PARAMS ON TBLS.TBL_ID = TABLE_PARAMS.TBL_ID
+            WHERE TABLE_PARAMS.PARAM_VALUE LIKE '%KuduStorageHandler%'
     );
 
 -- These lines need to be last.  Insert any changes above.
diff --git a/standalone-metastore/metastore-server/src/main/sql/oracle/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.oracle.sql b/standalone-metastore/metastore-server/src/main/sql/oracle/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.oracle.sql
index 1e25c1271c..781609ee1d 100644
--- a/standalone-metastore/metastore-server/src/main/sql/oracle/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.oracle.sql
+++ b/standalone-metastore/metastore-server/src/main/sql/oracle/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.oracle.sql
@@ -31,18 +31,22 @@ ALTER TABLE METASTORE_DB_PROPERTIES ADD PROPERTYCONTENT BLOB;
 
 -- HIVE-27457
 UPDATE "SDS"
-    SET "SDS"."INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat',
-        "SDS"."OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
-    WHERE "SDS"."SD_ID" IN (
-        SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%'
+    SET "INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat', "OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
+    WHERE "SD_ID" IN (
+        SELECT "TBLS"."SD_ID"
+            FROM "TBLS"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
+
 UPDATE "SERDES"
     SET "SERDES"."SLIB" = 'org.apache.hadoop.hive.kudu.KuduSerDe'
     WHERE "SERDE_ID" IN (
         SELECT "SDS"."SERDE_ID"
             FROM "TBLS"
-            LEFT JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
-            WHERE "TBL_ID" IN (SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%')
+            INNER JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
 
 -- These lines need to be last.  Insert any changes above.
diff --git a/standalone-metastore/metastore-server/src/main/sql/postgres/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.postgres.sql b/standalone-metastore/metastore-server/src/main/sql/postgres/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.postgres.sql
index fd6459e234..d6a3162d84 100644
--- a/standalone-metastore/metastore-server/src/main/sql/postgres/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.postgres.sql
+++ b/standalone-metastore/metastore-server/src/main/sql/postgres/upgrade-4.0.0-alpha-2-to-4.0.0-beta-1.postgres.sql
@@ -31,18 +31,22 @@ ALTER TABLE "METASTORE_DB_PROPERTIES" ADD "PROPERTYCONTENT" bytea;
 
 -- HIVE-27457
 UPDATE "SDS"
-    SET "INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat',
-        "OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
-    WHERE "SDS"."SD_ID" IN (
-        SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%'
+    SET "INPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduInputFormat', "OUTPUT_FORMAT" = 'org.apache.hadoop.hive.kudu.KuduOutputFormat'
+    WHERE "SD_ID" IN (
+        SELECT "TBLS"."SD_ID"
+            FROM "TBLS"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
+
 UPDATE "SERDES"
     SET "SLIB" = 'org.apache.hadoop.hive.kudu.KuduSerDe'
     WHERE "SERDE_ID" IN (
         SELECT "SDS"."SERDE_ID"
             FROM "TBLS"
-            LEFT JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
-            WHERE "TBL_ID" IN (SELECT "TBL_ID" FROM "TABLE_PARAMS" WHERE "PARAM_VALUE" LIKE '%KuduStorageHandler%')
+            INNER JOIN "SDS" ON "TBLS"."SD_ID" = "SDS"."SD_ID"
+            INNER JOIN "TABLE_PARAMS" ON "TBLS"."TBL_ID" = "TABLE_PARAMS"."TBL_ID"
+            WHERE "TABLE_PARAMS"."PARAM_VALUE" LIKE '%KuduStorageHandler%'
     );
 
 -- These lines need to be last. Insert any changes above.
