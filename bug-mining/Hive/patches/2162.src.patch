diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java
index 7f4a807744..1f70c552f3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java
@@ -447,8 +447,7 @@ public static String getOrdinal(int i) {
 
   /**
    * Finds any occurence of <code>subtext</code> from <code>text</code> in the
-   * backing buffer, for avoiding string encoding and decoding. Shamelessly copy
-   * from {@link org.apache.hadoop.io.Text#find(String, int)}.
+   * backing buffer.
    */
   public static int findText(Text text, Text subtext, int start) {
     // src.position(start) can't accept negative numbers.
@@ -463,38 +462,14 @@ public static int findText(Text text, Text subtext, int start) {
       return -1;
     }
 
-    ByteBuffer src = ByteBuffer.wrap(text.getBytes(), 0, text.getLength());
-    ByteBuffer tgt = ByteBuffer
-        .wrap(subtext.getBytes(), 0, subtext.getLength());
-    byte b = tgt.get();
-    src.position(start);
-
-    while (src.hasRemaining()) {
-      if (b == src.get()) { // matching first byte
-        src.mark(); // save position in loop
-        tgt.mark(); // save position in target
-        boolean found = true;
-        int pos = src.position() - 1;
-        while (tgt.hasRemaining()) {
-          if (!src.hasRemaining()) { // src expired first
-            tgt.reset();
-            src.reset();
-            found = false;
-            break;
-          }
-          if (!(tgt.get() == src.get())) {
-            tgt.reset();
-            src.reset();
-            found = false;
-            break; // no match
-          }
-        }
-        if (found) {
-          return pos;
-        }
-      }
+    String textString = text.toString();
+    String subtextString = subtext.toString();
+    int index = textString.indexOf(subtextString, start);
+    if (index == -1) {
+      return index;
+    } else {
+      return textString.codePointCount(0, index);
     }
-    return -1; // not found
   }
 
   private GenericUDFUtils() {
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFUtils.java b/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFUtils.java
index d9338a50fa..7399a7cd96 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFUtils.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFUtils.java
@@ -20,6 +20,7 @@
 
 import junit.framework.Assert;
 import junit.framework.TestCase;
+
 import org.apache.hadoop.hive.ql.udf.generic.GenericUDFUtils;
 import org.apache.hadoop.io.Text;
 import org.junit.Test;
@@ -30,6 +31,7 @@ public class TestGenericUDFUtils extends TestCase {
   public void testFindText() throws Exception {
 
     // http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_locate
+    Assert.assertEquals(0, GenericUDFUtils.findText(new Text("foobarbar"), new Text("foo"), 0));
     Assert.assertEquals(3, GenericUDFUtils.findText(new Text("foobarbar"), new Text("bar"), 0));
     Assert.assertEquals(-1, GenericUDFUtils.findText(new Text("foobarbar"), new Text("xbar"), 0));
     Assert.assertEquals(6, GenericUDFUtils.findText(new Text("foobarbar"), new Text("bar"), 5));
@@ -44,5 +46,13 @@ public void testFindText() throws Exception {
     Assert.assertEquals(0, GenericUDFUtils.findText(new Text("foobar"), new Text(""), 0));
     Assert.assertEquals(0, GenericUDFUtils.findText(new Text("foobar"), new Text(""), 6));
     Assert.assertEquals(-1, GenericUDFUtils.findText(new Text("foobar"), new Text(""), 7));
+
+    //Unicode case.
+    Assert.assertEquals(4, GenericUDFUtils.findText(new Text("НАСТРОЕние"), new Text("Р"), 0));
+    Assert.assertEquals(15, GenericUDFUtils.findText(new Text("НАСТРОЕние НАСТРОЕние"), new Text("Р"), 11));
+
+    //surrogate pair case
+    Assert.assertEquals(3, GenericUDFUtils.findText(new Text("123\uD801\uDC00456"), new Text("\uD801\uDC00"), 0));
+    Assert.assertEquals(4, GenericUDFUtils.findText(new Text("123\uD801\uDC00456"), new Text("4"), 0));
   }
 }
