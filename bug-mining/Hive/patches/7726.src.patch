diff --git a/common/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java b/common/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
index d454a99b90..4ce2c52035 100644
--- a/common/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
+++ b/common/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
@@ -471,6 +471,7 @@ public enum ErrorMsg {
           "Not an ordered-set aggregate function: {0}. WITHIN GROUP clause is not allowed.", true),
   WITHIN_GROUP_PARAMETER_MISMATCH(10422,
           "The number of hypothetical direct arguments ({0}) must match the number of ordering columns ({1})", true),
+  AMBIGUOUS_STRUCT_ATTRIBUTE(10423, "Attribute \"{0}\" specified more than once in structured type.", true),
 
   //========================== 20000 range starts here ========================//
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
index 5d46758443..36eb7975c0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
@@ -955,9 +955,18 @@ private static String getStructTypeStringFromAST(ASTNode typeNode)
       throw new SemanticException("empty struct not allowed.");
     }
     StringBuilder buffer = new StringBuilder(typeStr);
+    Set<String> attributeIdentifiers = new HashSet<>(children);
     for (int i = 0; i < children; i++) {
       ASTNode child = (ASTNode) typeNode.getChild(i);
-      buffer.append(unescapeIdentifier(child.getChild(0).getText())).append(":");
+
+      String attributeIdentifier = unescapeIdentifier(child.getChild(0).getText());
+      if (attributeIdentifiers.contains(attributeIdentifier)) {
+        throw new SemanticException(ErrorMsg.AMBIGUOUS_STRUCT_ATTRIBUTE, attributeIdentifier);
+      } else {
+        attributeIdentifiers.add(attributeIdentifier);
+      }
+
+      buffer.append(attributeIdentifier).append(":");
       buffer.append(getTypeStringFromAST((ASTNode) child.getChild(1)));
       if (i < children - 1) {
         buffer.append(",");
diff --git a/ql/src/test/queries/clientnegative/struct_attribute_uniqueness.q b/ql/src/test/queries/clientnegative/struct_attribute_uniqueness.q
new file mode 100644
index 0000000000..d78ac9eaf8
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/struct_attribute_uniqueness.q
@@ -0,0 +1 @@
+create table test_struct( duplicateColumn struct<id:int, id:int>);
diff --git a/ql/src/test/queries/clientnegative/struct_attribute_uniqueness_2.q b/ql/src/test/queries/clientnegative/struct_attribute_uniqueness_2.q
new file mode 100644
index 0000000000..aa3e74d501
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/struct_attribute_uniqueness_2.q
@@ -0,0 +1 @@
+create table test_nested_struct( duplicateColumn struct<id:int, address:struct<number:int,street:string,number:int>>);
diff --git a/ql/src/test/results/clientnegative/struct_attribute_uniqueness.q.out b/ql/src/test/results/clientnegative/struct_attribute_uniqueness.q.out
new file mode 100644
index 0000000000..d6d1436472
--- /dev/null
+++ b/ql/src/test/results/clientnegative/struct_attribute_uniqueness.q.out
@@ -0,0 +1 @@
+FAILED: SemanticException [Error 10423]: Attribute "id" specified more than once in structured type.
diff --git a/ql/src/test/results/clientnegative/struct_attribute_uniqueness_2.q.out b/ql/src/test/results/clientnegative/struct_attribute_uniqueness_2.q.out
new file mode 100644
index 0000000000..c69bf5449a
--- /dev/null
+++ b/ql/src/test/results/clientnegative/struct_attribute_uniqueness_2.q.out
@@ -0,0 +1 @@
+FAILED: SemanticException [Error 10423]: Attribute "number" specified more than once in structured type.
