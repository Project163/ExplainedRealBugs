diff --git a/itests/src/test/resources/testconfiguration.properties b/itests/src/test/resources/testconfiguration.properties
index e99ce7babb..19a90b90a2 100644
--- a/itests/src/test/resources/testconfiguration.properties
+++ b/itests/src/test/resources/testconfiguration.properties
@@ -44,7 +44,9 @@ minitez.query.files=acid_vectorization_original_tez.q,\
   tez_complextype_with_null.q
 
 
-minillap.shared.query.files=insert_into1.q,\
+minillap.shared.query.files=acid_direct_insert_insert_overwrite.q,\
+  acid_multiinsert_dyn_part.q,\
+  insert_into1.q,\
   insert_into2.q,\
   llapdecider.q,\
   mapreduce1.q,\
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractFileMergeOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractFileMergeOperator.java
index d68d8f9409..d8f8e72efa 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractFileMergeOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/AbstractFileMergeOperator.java
@@ -257,8 +257,8 @@ public void closeOp(boolean abort) throws HiveException {
           assert finalPath.equals(outPath);
           // There's always just one file that we have merged.
           // The union/DP/etc. should already be account for in the path.
-          Utilities.writeCommitManifest(Lists.newArrayList(outPath),
-              tmpPath.getParent(), fs, taskId, conf.getWriteId(), conf.getStmtId(), null, false);
+          Utilities.writeCommitManifest(Lists.newArrayList(outPath), tmpPath.getParent(), fs, taskId, conf.getWriteId(),
+              conf.getStmtId(), null, false, hasDynamicPartitions, new HashSet<>());
           LOG.info("Merged into " + finalPath + "(" + fss.getLen() + " bytes).");
         }
       }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
index 04166a23ee..d121a21f62 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
@@ -138,6 +138,7 @@ public class FileSinkOperator extends TerminalOperator<FileSinkDesc> implements
   private transient String counterGroup;
   private transient BiFunction<Object[], ObjectInspector[], Integer> hashFunc;
   public static final String TOTAL_TABLE_ROWS_WRITTEN = "TOTAL_TABLE_ROWS_WRITTEN";
+  private transient Set<String> dynamicPartitionSpecs = new HashSet<>();
 
   /**
    * Counters.
@@ -1011,6 +1012,7 @@ public void process(Object row, int tag) throws HiveException {
               HiveConf.ConfVars.METASTORE_PARTITION_NAME_WHITELIST_PATTERN.varname + ")");
         }
         fpaths = getDynOutPaths(dpVals, lbDirName);
+        dynamicPartitionSpecs.add(fpaths.dpDirForCounters);
 
         // use SubStructObjectInspector to serialize the non-partitioning columns in the input row
         recordValue = serializer.serialize(row, subSetOI);
@@ -1409,7 +1411,7 @@ public void closeOp(boolean abort) throws HiveException {
       }
       if (conf.isMmTable() || conf.isDirectInsert()) {
         Utilities.writeCommitManifest(commitPaths, specPath, fs, originalTaskId, conf.getTableWriteId(), conf
-            .getStatementId(), unionPath, conf.getInsertOverwrite());
+            .getStatementId(), unionPath, conf.getInsertOverwrite(), bDynParts, dynamicPartitionSpecs);
       }
       // Only publish stats if this operator's flag was set to gather stats
       if (conf.isGatherStats()) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index 0304a5c74a..fcf206044e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -4360,8 +4360,20 @@ private static void tryDeleteAllDirectInsertFiles(FileSystem fs, Path specPath,
 
 
   public static void writeCommitManifest(List<Path> commitPaths, Path specPath, FileSystem fs,
-      String taskId, Long writeId, int stmtId, String unionSuffix, boolean isInsertOverwrite) throws HiveException {
-    if (commitPaths.isEmpty()) {
+      String taskId, Long writeId, int stmtId, String unionSuffix, boolean isInsertOverwrite,
+      boolean hasDynamicPartitions, Set<String> dynamicPartitionSpecs) throws HiveException {
+
+    // When doing a multi-statement insert overwrite with dynamic partitioning,
+    // the partition information will be written to the manifest file.
+    // This is needed because in this use case each FileSinkOperator should clean-up
+    // only the partition directories written by the same FileSinkOperator and do not
+    // clean-up the partition directories written by the other FileSinkOperators.
+    // If a statement from the insert overwrite query, doesn't produce any data,
+    // a manifest file will still be written, otherwise the missing manifest file
+    // would result a clean-up on table level which could delete the data written by
+    // the other FileSinkOperators. (For further details please see HIVE-23114.)
+    boolean writeDynamicPartitionsToManifest = isInsertOverwrite && hasDynamicPartitions;
+    if (commitPaths.isEmpty() && !writeDynamicPartitionsToManifest) {
       return;
     }
     // We assume one FSOP per task (per specPath), so we create it in specPath.
@@ -4374,6 +4386,14 @@ public static void writeCommitManifest(List<Path> commitPaths, Path specPath, Fi
         if (out == null) {
           throw new HiveException("Failed to create manifest at " + manifestPath);
         }
+
+        if (writeDynamicPartitionsToManifest) {
+          out.writeInt(dynamicPartitionSpecs.size());
+          for (String dynamicPartitionSpec : dynamicPartitionSpecs) {
+            out.writeUTF(dynamicPartitionSpec.toString());
+          }
+        }
+
         out.writeInt(commitPaths.size());
         for (Path path : commitPaths) {
           out.writeUTF(path.toString());
@@ -4384,11 +4404,16 @@ public static void writeCommitManifest(List<Path> commitPaths, Path specPath, Fi
     }
   }
 
-  // TODO: we should get rid of isInsertOverwrite here too.
   private static Path getManifestDir(
       Path specPath, long writeId, int stmtId, String unionSuffix, boolean isInsertOverwrite) {
     Path manifestPath = new Path(specPath, "_tmp." +
       AcidUtils.baseOrDeltaSubdir(isInsertOverwrite, writeId, writeId, stmtId));
+    if (isInsertOverwrite) {
+      // When doing a multi-statement insert overwrite query with dynamic partitioning, the
+      // generated manifest directory is the same for each FileSinkOperator.
+      // To resolve this name collision, extending the manifest path with the statement id.
+      manifestPath = new Path(manifestPath + "_" + stmtId);
+    }
 
     return (unionSuffix == null) ? manifestPath : new Path(manifestPath, unionSuffix);
   }
@@ -4431,33 +4456,28 @@ public static void handleDirectInsertTableFinalPath(Path specPath, String unionS
         }
       }
     } else {
-      Utilities.FILE_OP_LOGGER.info("No manifests found - query produced no output");
+      Utilities.FILE_OP_LOGGER.info("No manifests found in directory {} - query produced no output", manifestDir);
       manifestDir = null;
     }
 
-    Utilities.FILE_OP_LOGGER.debug("Looking for files in: {}", specPath);
-    AcidUtils.IdPathFilter filter = new AcidUtils.IdPathFilter(writeId, stmtId);
-    if (!fs.exists(specPath)) {
-      Utilities.FILE_OP_LOGGER.info("Creating directory with no output at {}", specPath);
-      FileUtils.mkdir(fs, specPath, hconf);
-    }
-    Path[] files = getDirectInsertDirectoryCandidates(
-        fs, specPath, dpLevels, filter, writeId, stmtId, hconf, isInsertOverwrite);
-    ArrayList<Path> directInsertDirectories = new ArrayList<>();
-    if (files != null) {
-      for (Path path : files) {
-        Utilities.FILE_OP_LOGGER.trace("Looking at path: {}", path);
-        directInsertDirectories.add(path);
-      }
-    }
-
+    Set<String> dynamicPartitionSpecs = new HashSet<>();
     Set<Path> committed = Collections.newSetFromMap(new ConcurrentHashMap<>());
     for (Path mfp : manifests) {
+      Utilities.FILE_OP_LOGGER.info("Looking at manifest file: {}", mfp);
       try (FSDataInputStream mdis = fs.open(mfp)) {
+        if (isInsertOverwrite && dpLevels > 0) {
+          int partitionCount = mdis.readInt();
+          for (int i = 0; i < partitionCount; ++i) {
+            String nextPart = mdis.readUTF();
+            Utilities.FILE_OP_LOGGER.debug("Looking at dynamic partition {}", nextPart);
+            dynamicPartitionSpecs.add(nextPart);
+          }
+        }
+
         int fileCount = mdis.readInt();
         for (int i = 0; i < fileCount; ++i) {
           String nextFile = mdis.readUTF();
-          Utilities.FILE_OP_LOGGER.trace("Looking at committed file: {}", nextFile);
+          Utilities.FILE_OP_LOGGER.debug("Looking at committed file {}", nextFile);
           Path path = fs.makeQualified(new Path(nextFile));
           if (!committed.add(path)) {
             throw new HiveException(nextFile + " was specified in multiple manifests");
@@ -4466,6 +4486,27 @@ public static void handleDirectInsertTableFinalPath(Path specPath, String unionS
       }
     }
 
+    Utilities.FILE_OP_LOGGER.debug("Looking for files in: {}", specPath);
+    AcidUtils.IdPathFilter filter = new AcidUtils.IdPathFilter(writeId, stmtId, dynamicPartitionSpecs, dpLevels);
+    if (!fs.exists(specPath)) {
+      Utilities.FILE_OP_LOGGER.info("Creating directory with no output at {}", specPath);
+      FileUtils.mkdir(fs, specPath, hconf);
+    }
+
+    Path[] files = null;
+    if (!isInsertOverwrite || dpLevels == 0 || !dynamicPartitionSpecs.isEmpty()) {
+      files = getDirectInsertDirectoryCandidates(
+          fs, specPath, dpLevels, filter, writeId, stmtId, hconf, isInsertOverwrite);
+    }
+
+    ArrayList<Path> directInsertDirectories = new ArrayList<>();
+    if (files != null) {
+      for (Path path : files) {
+        Utilities.FILE_OP_LOGGER.info("Looking at path: {}", path);
+        directInsertDirectories.add(path);
+      }
+    }
+
     if (manifestDir != null) {
       Utilities.FILE_OP_LOGGER.info("Deleting manifest directory {}", manifestDir);
       tryDelete(fs, manifestDir);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java
index 17e6cdf162..98d5a79161 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java
@@ -2805,8 +2805,14 @@ public boolean accept(Path path) {
   public static class IdPathFilter implements PathFilter {
     private String baseDirName, deltaDirName;
     private final boolean isDeltaPrefix;
+    private final Set<String> dpSpecs;
+    private final int dpLevel;
 
     public IdPathFilter(long writeId, int stmtId) {
+      this(writeId, stmtId, null, 0);
+    }
+
+    public IdPathFilter(long writeId, int stmtId, Set<String> dpSpecs, int dpLevel) {
       String deltaDirName = null;
       deltaDirName = DELTA_PREFIX + String.format(DELTA_DIGITS, writeId) + "_" +
               String.format(DELTA_DIGITS, writeId);
@@ -2817,13 +2823,32 @@ public IdPathFilter(long writeId, int stmtId) {
 
       this.baseDirName = BASE_PREFIX + String.format(DELTA_DIGITS, writeId);
       this.deltaDirName = deltaDirName;
+      this.dpSpecs = dpSpecs;
+      this.dpLevel = dpLevel;
     }
 
     @Override
     public boolean accept(Path path) {
       String name = path.getName();
-      return name.equals(baseDirName) || (isDeltaPrefix && name.startsWith(deltaDirName))
-          || (!isDeltaPrefix && name.equals(deltaDirName));
+      // Extending the path filter with optional dynamic partition specifications.
+      // This is needed for the use case when doing multi-statement insert overwrite with
+      // dynamic partitioning with direct insert or with insert-only tables.
+      // In this use-case, each FileSinkOperator should only clean-up the directories written
+      // by the same FileSinkOperator and do not clean-up the partition directories
+      // written by the other FileSinkOperators. (For further details please see HIVE-23114.)
+      if (dpLevel > 0 && dpSpecs != null && !dpSpecs.isEmpty()) {
+        Path parent = path.getParent();
+        String partitionSpec = parent.getName();
+        for (int i = 1; i < dpLevel; i++) {
+          parent = parent.getParent();
+          partitionSpec = parent.getName() + "/" + partitionSpec;
+        }
+        return (name.equals(baseDirName) && dpSpecs.contains(partitionSpec));
+      }
+      else {
+        return name.equals(baseDirName) || (isDeltaPrefix && name.startsWith(deltaDirName))
+            || (!isDeltaPrefix && name.equals(deltaDirName));
+      }
     }
   }
 
diff --git a/ql/src/test/queries/clientpositive/acid_direct_insert_insert_overwrite.q b/ql/src/test/queries/clientpositive/acid_direct_insert_insert_overwrite.q
new file mode 100644
index 0000000000..e537b27585
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/acid_direct_insert_insert_overwrite.q
@@ -0,0 +1,251 @@
+set hive.acid.direct.insert.enabled=true;
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.stats.autogather=false;
+
+drop table if exists io_test_acid_part;
+drop table if exists io_test_text_1;
+drop table if exists io_test_text_2;
+drop table if exists io_test_text_3;
+drop table if exists io_test_acid_1;
+drop table if exists io_test_acid_2;
+drop table if exists io_test_acid_3;
+
+create external table io_test_text_1 (a int, b int, c int) stored as textfile;
+
+insert into io_test_text_1 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL);
+
+create external table io_test_text_2 (a int, b int, c int) stored as textfile;
+
+insert into io_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444);
+
+-- non-partitioned table
+
+create table io_test_acid (a int, b int, c int) stored as orc tblproperties('transactional'='true');
+
+insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is not null;
+
+select * from io_test_acid order by a;
+
+insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is null;
+
+select * from io_test_acid order by a;
+
+insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is null;
+
+select * from io_test_acid order by a;
+
+insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is not null;
+
+select * from io_test_acid order by a;
+
+drop table io_test_acid;
+
+create table io_test_acid_1 (a int, b int, c int) stored as orc tblproperties('transactional'='true');
+create table io_test_acid_2 (a int, b int, c int) stored as orc tblproperties('transactional'='true');
+create table io_test_acid_3 (a int, b int, c int) stored as orc tblproperties('transactional'='true');
+
+from io_test_text_2
+insert overwrite table io_test_acid_1 select a, b, c where c=1111
+insert overwrite table io_test_acid_2 select a, b, c where c=2222
+insert overwrite table io_test_acid_3 select a, b, c where c=4444
+;
+
+select * from io_test_acid_1 order by a;
+select * from io_test_acid_2 order by a;
+select * from io_test_acid_3 order by a;
+
+from io_test_text_1
+insert overwrite table io_test_acid_1 select a, b, c where c is null
+insert overwrite table io_test_acid_2 select a, b, c where c=7777
+insert overwrite table io_test_acid_3 select a, b, c where c is not null
+;
+
+select * from io_test_acid_1 order by a;
+select * from io_test_acid_2 order by a;
+select * from io_test_acid_3 order by a;
+
+drop table io_test_acid_1;
+drop table io_test_acid_2;
+drop table io_test_acid_3;
+
+
+-- static partitioning
+
+create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is not null;
+
+select * from io_test_acid_part order by a;
+
+insert overwrite table io_test_acid_part partition (c=2) select a, b from io_test_text_1 where c is null;
+
+select * from io_test_acid_part order by a;
+
+insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is null;
+
+select * from io_test_acid_part order by a, c;
+
+insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is null;
+
+select * from io_test_acid_part order by a;
+
+insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is not null;
+
+select * from io_test_acid_part order by a, c;
+
+drop table io_test_acid_part;
+
+create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+from io_test_text_2
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=1111
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=2222
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=4444
+;
+
+select * from io_test_acid_part order by a;
+
+from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c is null
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c is not null
+;
+
+select * from io_test_acid_part order by a;
+
+from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=8888
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=9999
+;
+
+select * from io_test_acid_part order by a;
+
+drop table io_test_acid_part;
+
+
+-- dynamic partitioning
+
+create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is not null;
+
+select * from io_test_acid_part order by a;
+
+insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is null;
+
+select * from io_test_acid_part order by a;
+
+insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=11 or b=44 or b=99;
+
+select * from io_test_acid_part order by a, c;
+
+insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=99;
+
+select * from io_test_acid_part order by a, c;
+
+drop table io_test_acid_part;
+
+create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+;
+
+select * from io_test_acid_part order by a;
+
+from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+;
+
+select * from io_test_acid_part order by a;
+
+from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=7
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
+;
+
+select * from io_test_acid_part order by a, c;
+
+drop table io_test_acid_part;
+
+create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+;
+
+select * from io_test_acid_part order by a;
+
+drop table io_test_acid_part;
+
+create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=33
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=88
+;
+
+select * from io_test_acid_part order by a;
+
+drop table io_test_acid_part;
+
+set hive.acid.direct.insert.enabled=true;
+
+
+create external table io_test_text_3 (a int, b int, pc1 int, pc2 int, pc3 int) stored as textfile;
+
+insert into io_test_text_3 values (11,11,11,11,11),
+(12,12,11,11,11),
+(13,13,11,11,22),
+(14,15,11,11,NULL),
+(16,16,11,22,11),
+(17,17,11,22,22),
+(18,18,11,22,NULL),
+(19,19,11,22,NULL),
+(20,20,22,11,11),
+(21,21,22,11,11),
+(22,22,22,22,11),
+(23,23,22,NUll,11),
+(24,24,22,NUll,22),
+(25,25,22,NULL,NULL),
+(26,26,NULL,11,11),
+(27,27,NULL,22,11),
+(28,28,NULL,NULL,11),
+(29,29,NULL,NULL,22),
+(30,30,NULL,NULL,NULL);
+
+create table io_test_acid_part (a int, b int) partitioned by (pc1 int, pc2 int, pc3 int) stored as orc  tblproperties('transactional'='true');
+
+from io_test_text_3
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is not null and pc2 is not null and pc3 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc2 is null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc3 is null and pc2 is not null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where a=111
+;
+
+select * from io_test_acid_part order by a;
+
+drop table io_test_acid_part;
+drop table io_test_text_1;
+drop table io_test_text_2;
+drop table io_test_text_3;
diff --git a/ql/src/test/queries/clientpositive/acid_multiinsert_dyn_part.q b/ql/src/test/queries/clientpositive/acid_multiinsert_dyn_part.q
new file mode 100644
index 0000000000..651d197685
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/acid_multiinsert_dyn_part.q
@@ -0,0 +1,152 @@
+set hive.acid.direct.insert.enabled=true;
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.stats.autogather=true;
+
+drop table if exists multiinsert_test_text;
+drop table if exists multiinsert_test_text_2;
+drop table if exists multiinsert_test_acid;
+drop table if exists multiinsert_test_mm;
+drop table if exists multiinsert_test_acid_nondi;
+
+create external table multiinsert_test_text (a int, b int, c int) stored as textfile;
+
+insert into multiinsert_test_text values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL);
+
+create external table multiinsert_test_text_2 (a int, b int, c int) stored as textfile;
+
+insert into multiinsert_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444);
+
+create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only');
+
+create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+;
+
+select * from multiinsert_test_acid order by a;
+
+from multiinsert_test_text a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+;
+
+select * from multiinsert_test_mm order by a;
+
+set hive.acid.direct.insert.enabled=false;
+
+from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+;
+
+select * from multiinsert_test_acid_nondi order by a;
+
+drop table if exists multiinsert_test_acid;
+drop table if exists multiinsert_test_mm;
+drop table if exists multiinsert_test_acid_nondi;
+
+create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only');
+
+create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true');
+
+from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+;
+
+select * from multiinsert_test_acid order by a;
+
+from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+;
+
+select * from multiinsert_test_mm order by a;
+
+set hive.acid.direct.insert.enabled=false;
+
+from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+;
+
+select * from multiinsert_test_acid_nondi order by a;
+
+drop table if exists multiinsert_test_text;
+drop table if exists multiinsert_test_text_2;
+drop table if exists multiinsert_test_acid;
+drop table if exists multiinsert_test_mm;
+drop table if exists multiinsert_test_acid_nondi;
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/acid_direct_insert_insert_overwrite.q.out b/ql/src/test/results/clientpositive/acid_direct_insert_insert_overwrite.q.out
new file mode 100644
index 0000000000..2ea60a84cb
--- /dev/null
+++ b/ql/src/test/results/clientpositive/acid_direct_insert_insert_overwrite.q.out
@@ -0,0 +1,1258 @@
+PREHOOK: query: drop table if exists io_test_acid_part
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_part
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_text_1
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_text_1
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_text_2
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_text_2
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_text_3
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_text_3
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_acid_1
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_1
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_acid_2
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_2
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_acid_3
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_3
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create external table io_test_text_1 (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_text_1
+POSTHOOK: query: create external table io_test_text_1 (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_text_1
+PREHOOK: query: insert into io_test_text_1 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@io_test_text_1
+POSTHOOK: query: insert into io_test_text_1 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@io_test_text_1
+POSTHOOK: Lineage: io_test_text_1.a SCRIPT []
+POSTHOOK: Lineage: io_test_text_1.b SCRIPT []
+POSTHOOK: Lineage: io_test_text_1.c SCRIPT []
+PREHOOK: query: create external table io_test_text_2 (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_text_2
+POSTHOOK: query: create external table io_test_text_2 (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_text_2
+PREHOOK: query: insert into io_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@io_test_text_2
+POSTHOOK: query: insert into io_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@io_test_text_2
+POSTHOOK: Lineage: io_test_text_2.a SCRIPT []
+POSTHOOK: Lineage: io_test_text_2.b SCRIPT []
+POSTHOOK: Lineage: io_test_text_2.c SCRIPT []
+PREHOOK: query: create table io_test_acid (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: create table io_test_acid (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE []
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE []
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: drop table io_test_acid
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: drop table io_test_acid
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid
+POSTHOOK: Output: default@io_test_acid
+PREHOOK: query: create table io_test_acid_1 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_1
+POSTHOOK: query: create table io_test_acid_1 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_1
+PREHOOK: query: create table io_test_acid_2 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_2
+POSTHOOK: query: create table io_test_acid_2 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_2
+PREHOOK: query: create table io_test_acid_3 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: create table io_test_acid_3 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_3
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_1 select a, b, c where c=1111
+insert overwrite table io_test_acid_2 select a, b, c where c=2222
+insert overwrite table io_test_acid_3 select a, b, c where c=4444
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_1
+PREHOOK: Output: default@io_test_acid_2
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_1 select a, b, c where c=1111
+insert overwrite table io_test_acid_2 select a, b, c where c=2222
+insert overwrite table io_test_acid_3 select a, b, c where c=4444
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_1
+POSTHOOK: Output: default@io_test_acid_2
+POSTHOOK: Output: default@io_test_acid_3
+POSTHOOK: Lineage: io_test_acid_1.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_1 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_1
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_1 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_1
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+PREHOOK: query: select * from io_test_acid_2 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_2
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_2 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_2
+#### A masked pattern was here ####
+3333	33	2222
+PREHOOK: query: select * from io_test_acid_3 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_3
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_3 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_3
+#### A masked pattern was here ####
+4444	44	4444
+5555	55	4444
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_1 select a, b, c where c is null
+insert overwrite table io_test_acid_2 select a, b, c where c=7777
+insert overwrite table io_test_acid_3 select a, b, c where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_1
+PREHOOK: Output: default@io_test_acid_2
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_1 select a, b, c where c is null
+insert overwrite table io_test_acid_2 select a, b, c where c=7777
+insert overwrite table io_test_acid_3 select a, b, c where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_1
+POSTHOOK: Output: default@io_test_acid_2
+POSTHOOK: Output: default@io_test_acid_3
+POSTHOOK: Lineage: io_test_acid_1.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_1 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_1
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_1 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_1
+#### A masked pattern was here ####
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: select * from io_test_acid_2 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_2
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_2 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_2
+#### A masked pattern was here ####
+PREHOOK: query: select * from io_test_acid_3 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_3
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_3 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_3
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+PREHOOK: query: drop table io_test_acid_1
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_1
+PREHOOK: Output: default@io_test_acid_1
+POSTHOOK: query: drop table io_test_acid_1
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_1
+POSTHOOK: Output: default@io_test_acid_1
+PREHOOK: query: drop table io_test_acid_2
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_2
+PREHOOK: Output: default@io_test_acid_2
+POSTHOOK: query: drop table io_test_acid_2
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_2
+POSTHOOK: Output: default@io_test_acid_2
+PREHOOK: query: drop table io_test_acid_3
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_3
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: drop table io_test_acid_3
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_3
+POSTHOOK: Output: default@io_test_acid_3
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+#### A masked pattern was here ####
+1111	11	1
+2222	22	1
+3333	33	1
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=2) select a, b from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=2) select a, b from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+1111	11	1
+2222	22	1
+3333	33	1
+4444	44	2
+5555	55	2
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+4444	44	1
+4444	44	2
+5555	55	1
+5555	55	2
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+4444	44	2
+5555	55	2
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+#### A masked pattern was here ####
+1111	11	1
+2222	22	1
+3333	33	1
+4444	44	1
+4444	44	2
+5555	55	1
+5555	55	2
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=1111
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=2222
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=4444
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part@c=1
+PREHOOK: Output: default@io_test_acid_part@c=2
+PREHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=1111
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=2222
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=4444
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Input: default@io_test_acid_part@c=3
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Input: default@io_test_acid_part@c=3
+#### A masked pattern was here ####
+1111	11	1
+2222	22	1
+3333	33	2
+4444	44	3
+5555	55	3
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c is null
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+PREHOOK: Output: default@io_test_acid_part@c=2
+PREHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c is null
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Input: default@io_test_acid_part@c=3
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Input: default@io_test_acid_part@c=3
+#### A masked pattern was here ####
+1111	11	3
+2222	22	3
+3333	33	3
+4444	44	1
+5555	55	1
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=8888
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=9999
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+PREHOOK: Output: default@io_test_acid_part@c=2
+PREHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=8888
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=9999
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Input: default@io_test_acid_part@c=3
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Input: default@io_test_acid_part@c=3
+#### A masked pattern was here ####
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=11 or b=44 or b=99
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=11 or b=44 or b=99
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+3333	33	2222
+4444	44	4444
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=99
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=99
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE []
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE []
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE []
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+3333	33	2222
+4444	44	4444
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+3333	33	2222
+4444	44	NULL
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=7
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=7
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+3333	33	2222
+4444	44	4444
+4444	44	NULL
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=33
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=88
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=33
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=88
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+#### A masked pattern was here ####
+1111	11	1111
+3333	33	2222
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create external table io_test_text_3 (a int, b int, pc1 int, pc2 int, pc3 int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_text_3
+POSTHOOK: query: create external table io_test_text_3 (a int, b int, pc1 int, pc2 int, pc3 int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_text_3
+PREHOOK: query: insert into io_test_text_3 values (11,11,11,11,11),
+(12,12,11,11,11),
+(13,13,11,11,22),
+(14,15,11,11,NULL),
+(16,16,11,22,11),
+(17,17,11,22,22),
+(18,18,11,22,NULL),
+(19,19,11,22,NULL),
+(20,20,22,11,11),
+(21,21,22,11,11),
+(22,22,22,22,11),
+(23,23,22,NUll,11),
+(24,24,22,NUll,22),
+(25,25,22,NULL,NULL),
+(26,26,NULL,11,11),
+(27,27,NULL,22,11),
+(28,28,NULL,NULL,11),
+(29,29,NULL,NULL,22),
+(30,30,NULL,NULL,NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@io_test_text_3
+POSTHOOK: query: insert into io_test_text_3 values (11,11,11,11,11),
+(12,12,11,11,11),
+(13,13,11,11,22),
+(14,15,11,11,NULL),
+(16,16,11,22,11),
+(17,17,11,22,22),
+(18,18,11,22,NULL),
+(19,19,11,22,NULL),
+(20,20,22,11,11),
+(21,21,22,11,11),
+(22,22,22,22,11),
+(23,23,22,NUll,11),
+(24,24,22,NUll,22),
+(25,25,22,NULL,NULL),
+(26,26,NULL,11,11),
+(27,27,NULL,22,11),
+(28,28,NULL,NULL,11),
+(29,29,NULL,NULL,22),
+(30,30,NULL,NULL,NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@io_test_text_3
+POSTHOOK: Lineage: io_test_text_3.a SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.b SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.pc1 SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.pc2 SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.pc3 SCRIPT []
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (pc1 int, pc2 int, pc3 int) stored as orc  tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (pc1 int, pc2 int, pc3 int) stored as orc  tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_3
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is not null and pc2 is not null and pc3 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc2 is null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc3 is null and pc2 is not null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where a=111
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_3
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_3
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is not null and pc2 is not null and pc3 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc2 is null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc3 is null and pc2 is not null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where a=111
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_3
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=22/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=22/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=22/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=11/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=22/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=11/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=22/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=11,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=11,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=22,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=22,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=11,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=11,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=22,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=22,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=11/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=22/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=11/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=22/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=11/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=22/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=11/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=22/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+11	11	11	11	11
+12	12	11	11	11
+13	13	11	11	22
+14	15	11	11	NULL
+16	16	11	22	11
+17	17	11	22	22
+18	18	11	22	NULL
+19	19	11	22	NULL
+20	20	22	11	11
+21	21	22	11	11
+22	22	22	22	11
+23	23	22	NULL	11
+24	24	22	NULL	22
+25	25	22	NULL	NULL
+26	26	NULL	11	11
+27	27	NULL	22	11
+28	28	NULL	NULL	11
+29	29	NULL	NULL	22
+30	30	NULL	NULL	NULL
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: drop table io_test_text_1
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_text_1
+POSTHOOK: query: drop table io_test_text_1
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_text_1
+PREHOOK: query: drop table io_test_text_2
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_text_2
+POSTHOOK: query: drop table io_test_text_2
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_text_2
+PREHOOK: query: drop table io_test_text_3
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_text_3
+PREHOOK: Output: default@io_test_text_3
+POSTHOOK: query: drop table io_test_text_3
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_text_3
+POSTHOOK: Output: default@io_test_text_3
diff --git a/ql/src/test/results/clientpositive/acid_multiinsert_dyn_part.q.out b/ql/src/test/results/clientpositive/acid_multiinsert_dyn_part.q.out
new file mode 100644
index 0000000000..4605368aa6
--- /dev/null
+++ b/ql/src/test/results/clientpositive/acid_multiinsert_dyn_part.q.out
@@ -0,0 +1,536 @@
+PREHOOK: query: drop table if exists multiinsert_test_text
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_text
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_text_2
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_text_2
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_acid
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_acid
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_mm
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_mm
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_acid_nondi
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_acid_nondi
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create external table multiinsert_test_text (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_text
+POSTHOOK: query: create external table multiinsert_test_text (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_text
+PREHOOK: query: insert into multiinsert_test_text values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@multiinsert_test_text
+POSTHOOK: query: insert into multiinsert_test_text values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@multiinsert_test_text
+POSTHOOK: Lineage: multiinsert_test_text.a SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text.b SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text.c SCRIPT []
+PREHOOK: query: create external table multiinsert_test_text_2 (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: query: create external table multiinsert_test_text_2 (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_text_2
+PREHOOK: query: insert into multiinsert_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: query: insert into multiinsert_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: Lineage: multiinsert_test_text_2.a SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text_2.b SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text_2.c SCRIPT []
+PREHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
+PREHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_acid@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Input: default@multiinsert_test_acid@c=1111
+PREHOOK: Input: default@multiinsert_test_acid@c=2222
+PREHOOK: Input: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from multiinsert_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Input: default@multiinsert_test_acid@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_mm@c=1111
+POSTHOOK: Output: default@multiinsert_test_mm@c=2222
+POSTHOOK: Output: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_mm order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Input: default@multiinsert_test_mm@c=1111
+PREHOOK: Input: default@multiinsert_test_mm@c=2222
+PREHOOK: Input: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from multiinsert_test_mm order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Input: default@multiinsert_test_mm@c=1111
+POSTHOOK: Input: default@multiinsert_test_mm@c=2222
+POSTHOOK: Input: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid_nondi order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+POSTHOOK: query: select * from multiinsert_test_acid_nondi order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: drop table if exists multiinsert_test_acid
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: drop table if exists multiinsert_test_acid
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: drop table if exists multiinsert_test_mm
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: drop table if exists multiinsert_test_mm
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: drop table if exists multiinsert_test_acid_nondi
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: drop table if exists multiinsert_test_acid_nondi
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
+PREHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
+PREHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_acid@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid@c=4444
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=4444).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=4444).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Input: default@multiinsert_test_acid@c=1111
+PREHOOK: Input: default@multiinsert_test_acid@c=2222
+PREHOOK: Input: default@multiinsert_test_acid@c=4444
+#### A masked pattern was here ####
+POSTHOOK: query: select * from multiinsert_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Input: default@multiinsert_test_acid@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid@c=4444
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_mm@c=1111
+POSTHOOK: Output: default@multiinsert_test_mm@c=2222
+POSTHOOK: Output: default@multiinsert_test_mm@c=4444
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=4444).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=4444).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_mm order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Input: default@multiinsert_test_mm@c=1111
+PREHOOK: Input: default@multiinsert_test_mm@c=2222
+PREHOOK: Input: default@multiinsert_test_mm@c=4444
+#### A masked pattern was here ####
+POSTHOOK: query: select * from multiinsert_test_mm order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Input: default@multiinsert_test_mm@c=1111
+POSTHOOK: Input: default@multiinsert_test_mm@c=2222
+POSTHOOK: Input: default@multiinsert_test_mm@c=4444
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=4444
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=4444).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=4444).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid_nondi order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=4444
+#### A masked pattern was here ####
+POSTHOOK: query: select * from multiinsert_test_acid_nondi order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=4444
+#### A masked pattern was here ####
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: drop table if exists multiinsert_test_text
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_text
+POSTHOOK: query: drop table if exists multiinsert_test_text
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_text
+PREHOOK: query: drop table if exists multiinsert_test_text_2
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: query: drop table if exists multiinsert_test_text_2
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_text_2
+PREHOOK: query: drop table if exists multiinsert_test_acid
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: drop table if exists multiinsert_test_acid
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: drop table if exists multiinsert_test_mm
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: drop table if exists multiinsert_test_mm
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: drop table if exists multiinsert_test_acid_nondi
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: drop table if exists multiinsert_test_acid_nondi
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
diff --git a/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out b/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
new file mode 100644
index 0000000000..d3a33cb36f
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
@@ -0,0 +1,1258 @@
+PREHOOK: query: drop table if exists io_test_acid_part
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_part
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_text_1
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_text_1
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_text_2
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_text_2
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_text_3
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_text_3
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_acid_1
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_1
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_acid_2
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_2
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists io_test_acid_3
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists io_test_acid_3
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create external table io_test_text_1 (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_text_1
+POSTHOOK: query: create external table io_test_text_1 (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_text_1
+PREHOOK: query: insert into io_test_text_1 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@io_test_text_1
+POSTHOOK: query: insert into io_test_text_1 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@io_test_text_1
+POSTHOOK: Lineage: io_test_text_1.a SCRIPT []
+POSTHOOK: Lineage: io_test_text_1.b SCRIPT []
+POSTHOOK: Lineage: io_test_text_1.c SCRIPT []
+PREHOOK: query: create external table io_test_text_2 (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_text_2
+POSTHOOK: query: create external table io_test_text_2 (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_text_2
+PREHOOK: query: insert into io_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@io_test_text_2
+POSTHOOK: query: insert into io_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@io_test_text_2
+POSTHOOK: Lineage: io_test_text_2.a SCRIPT []
+POSTHOOK: Lineage: io_test_text_2.b SCRIPT []
+POSTHOOK: Lineage: io_test_text_2.c SCRIPT []
+PREHOOK: query: create table io_test_acid (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: create table io_test_acid (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE []
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE []
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+PREHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: insert overwrite table io_test_acid select a, b, c from io_test_text_2 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid
+POSTHOOK: Lineage: io_test_acid.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: drop table io_test_acid
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid
+PREHOOK: Output: default@io_test_acid
+POSTHOOK: query: drop table io_test_acid
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid
+POSTHOOK: Output: default@io_test_acid
+PREHOOK: query: create table io_test_acid_1 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_1
+POSTHOOK: query: create table io_test_acid_1 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_1
+PREHOOK: query: create table io_test_acid_2 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_2
+POSTHOOK: query: create table io_test_acid_2 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_2
+PREHOOK: query: create table io_test_acid_3 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: create table io_test_acid_3 (a int, b int, c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_3
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_1 select a, b, c where c=1111
+insert overwrite table io_test_acid_2 select a, b, c where c=2222
+insert overwrite table io_test_acid_3 select a, b, c where c=4444
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_1
+PREHOOK: Output: default@io_test_acid_2
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_1 select a, b, c where c=1111
+insert overwrite table io_test_acid_2 select a, b, c where c=2222
+insert overwrite table io_test_acid_3 select a, b, c where c=4444
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_1
+POSTHOOK: Output: default@io_test_acid_2
+POSTHOOK: Output: default@io_test_acid_3
+POSTHOOK: Lineage: io_test_acid_1.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.c SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_1 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_1
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_1 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_1
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+PREHOOK: query: select * from io_test_acid_2 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_2
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_2 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_2
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+3333	33	2222
+PREHOOK: query: select * from io_test_acid_3 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_3
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_3 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_3
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+4444	44	4444
+5555	55	4444
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_1 select a, b, c where c is null
+insert overwrite table io_test_acid_2 select a, b, c where c=7777
+insert overwrite table io_test_acid_3 select a, b, c where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_1
+PREHOOK: Output: default@io_test_acid_2
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_1 select a, b, c where c is null
+insert overwrite table io_test_acid_2 select a, b, c where c=7777
+insert overwrite table io_test_acid_3 select a, b, c where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_1
+POSTHOOK: Output: default@io_test_acid_2
+POSTHOOK: Output: default@io_test_acid_3
+POSTHOOK: Lineage: io_test_acid_1.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_1.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_2.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_3.c SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:c, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_1 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_1
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_1 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_1
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: select * from io_test_acid_2 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_2
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_2 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_2
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+PREHOOK: query: select * from io_test_acid_3 order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_3
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_3 order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_3
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+PREHOOK: query: drop table io_test_acid_1
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_1
+PREHOOK: Output: default@io_test_acid_1
+POSTHOOK: query: drop table io_test_acid_1
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_1
+POSTHOOK: Output: default@io_test_acid_1
+PREHOOK: query: drop table io_test_acid_2
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_2
+PREHOOK: Output: default@io_test_acid_2
+POSTHOOK: query: drop table io_test_acid_2
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_2
+POSTHOOK: Output: default@io_test_acid_2
+PREHOOK: query: drop table io_test_acid_3
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_3
+PREHOOK: Output: default@io_test_acid_3
+POSTHOOK: query: drop table io_test_acid_3
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_3
+POSTHOOK: Output: default@io_test_acid_3
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1
+2222	22	1
+3333	33	1
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=2) select a, b from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=2) select a, b from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1
+2222	22	1
+3333	33	1
+4444	44	2
+5555	55	2
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+4444	44	1
+4444	44	2
+5555	55	1
+5555	55	2
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+4444	44	2
+5555	55	2
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c=1) select a, b from io_test_text_2 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1
+2222	22	1
+3333	33	1
+4444	44	1
+4444	44	2
+5555	55	1
+5555	55	2
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=1111
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=2222
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=4444
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part@c=1
+PREHOOK: Output: default@io_test_acid_part@c=2
+PREHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=1111
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=2222
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=4444
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Input: default@io_test_acid_part@c=3
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Input: default@io_test_acid_part@c=3
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1
+2222	22	1
+3333	33	2
+4444	44	3
+5555	55	3
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c is null
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+PREHOOK: Output: default@io_test_acid_part@c=2
+PREHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c is null
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Input: default@io_test_acid_part@c=3
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Input: default@io_test_acid_part@c=3
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	3
+2222	22	3
+3333	33	3
+4444	44	1
+5555	55	1
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=8888
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=9999
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part@c=1
+PREHOOK: Output: default@io_test_acid_part@c=2
+PREHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c=1) select a, b where c=8888
+insert overwrite table io_test_acid_part partition (c=2) select a, b where c=7777
+insert overwrite table io_test_acid_part partition (c=3) select a, b where c=9999
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1
+POSTHOOK: Output: default@io_test_acid_part@c=2
+POSTHOOK: Output: default@io_test_acid_part@c=3
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=3).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1
+PREHOOK: Input: default@io_test_acid_part@c=2
+PREHOOK: Input: default@io_test_acid_part@c=3
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1
+POSTHOOK: Input: default@io_test_acid_part@c=2
+POSTHOOK: Input: default@io_test_acid_part@c=3
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is not null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is not null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=11 or b=44 or b=99
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=11 or b=44 or b=99
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+3333	33	2222
+4444	44	4444
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=99
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=99
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE []
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE []
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE []
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+3333	33	2222
+4444	44	4444
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_1
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+3333	33	2222
+4444	44	NULL
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=7
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=7
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a, c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a, c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Input: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+3333	33	2222
+4444	44	4444
+4444	44	NULL
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is not null
+insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Output: default@io_test_acid_part@c=4444
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Input: default@io_test_acid_part@c=4444
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Input: default@io_test_acid_part@c=4444
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=33
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=88
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_2
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=11
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=33
+insert overwrite table io_test_acid_part partition (c) select a, b, c where b=88
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part@c=1111
+POSTHOOK: Output: default@io_test_acid_part@c=2222
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@c=1111
+PREHOOK: Input: default@io_test_acid_part@c=2222
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@c=1111
+POSTHOOK: Input: default@io_test_acid_part@c=2222
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+3333	33	2222
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: create external table io_test_text_3 (a int, b int, pc1 int, pc2 int, pc3 int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_text_3
+POSTHOOK: query: create external table io_test_text_3 (a int, b int, pc1 int, pc2 int, pc3 int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_text_3
+PREHOOK: query: insert into io_test_text_3 values (11,11,11,11,11),
+(12,12,11,11,11),
+(13,13,11,11,22),
+(14,15,11,11,NULL),
+(16,16,11,22,11),
+(17,17,11,22,22),
+(18,18,11,22,NULL),
+(19,19,11,22,NULL),
+(20,20,22,11,11),
+(21,21,22,11,11),
+(22,22,22,22,11),
+(23,23,22,NUll,11),
+(24,24,22,NUll,22),
+(25,25,22,NULL,NULL),
+(26,26,NULL,11,11),
+(27,27,NULL,22,11),
+(28,28,NULL,NULL,11),
+(29,29,NULL,NULL,22),
+(30,30,NULL,NULL,NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@io_test_text_3
+POSTHOOK: query: insert into io_test_text_3 values (11,11,11,11,11),
+(12,12,11,11,11),
+(13,13,11,11,22),
+(14,15,11,11,NULL),
+(16,16,11,22,11),
+(17,17,11,22,22),
+(18,18,11,22,NULL),
+(19,19,11,22,NULL),
+(20,20,22,11,11),
+(21,21,22,11,11),
+(22,22,22,22,11),
+(23,23,22,NUll,11),
+(24,24,22,NUll,22),
+(25,25,22,NULL,NULL),
+(26,26,NULL,11,11),
+(27,27,NULL,22,11),
+(28,28,NULL,NULL,11),
+(29,29,NULL,NULL,22),
+(30,30,NULL,NULL,NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@io_test_text_3
+POSTHOOK: Lineage: io_test_text_3.a SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.b SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.pc1 SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.pc2 SCRIPT []
+POSTHOOK: Lineage: io_test_text_3.pc3 SCRIPT []
+PREHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (pc1 int, pc2 int, pc3 int) stored as orc  tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: create table io_test_acid_part (a int, b int) partitioned by (pc1 int, pc2 int, pc3 int) stored as orc  tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: from io_test_text_3
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is not null and pc2 is not null and pc3 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc2 is null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc3 is null and pc2 is not null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where a=111
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_text_3
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: from io_test_text_3
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is not null and pc2 is not null and pc3 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc2 is null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc3 is null and pc2 is not null and pc1 is not null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where pc1 is null
+insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
+  select a, b, pc1, pc2, pc3
+  where a=111
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_text_3
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=22/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=22/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=22/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=11/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=22/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=11/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=22/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Output: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=11,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=11,pc2=22,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=11,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=11,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=22,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=22,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=22,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=11,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=11,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=22,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=22,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=11).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=22).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: io_test_acid_part PARTITION(pc1=__HIVE_DEFAULT_PARTITION__,pc2=__HIVE_DEFAULT_PARTITION__,pc3=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_3)io_test_text_3.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from io_test_acid_part order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=11/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=22/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=11/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=22/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+PREHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from io_test_acid_part order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=11/pc2=22/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=11/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=22/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=22/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=11/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=22/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=11
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=22
+POSTHOOK: Input: default@io_test_acid_part@pc1=__HIVE_DEFAULT_PARTITION__/pc2=__HIVE_DEFAULT_PARTITION__/pc3=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+11	11	11	11	11
+12	12	11	11	11
+13	13	11	11	22
+14	15	11	11	NULL
+16	16	11	22	11
+17	17	11	22	22
+18	18	11	22	NULL
+19	19	11	22	NULL
+20	20	22	11	11
+21	21	22	11	11
+22	22	22	22	11
+23	23	22	NULL	11
+24	24	22	NULL	22
+25	25	22	NULL	NULL
+26	26	NULL	11	11
+27	27	NULL	22	11
+28	28	NULL	NULL	11
+29	29	NULL	NULL	22
+30	30	NULL	NULL	NULL
+PREHOOK: query: drop table io_test_acid_part
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_acid_part
+PREHOOK: Output: default@io_test_acid_part
+POSTHOOK: query: drop table io_test_acid_part
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_acid_part
+POSTHOOK: Output: default@io_test_acid_part
+PREHOOK: query: drop table io_test_text_1
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_text_1
+PREHOOK: Output: default@io_test_text_1
+POSTHOOK: query: drop table io_test_text_1
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_text_1
+PREHOOK: query: drop table io_test_text_2
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_text_2
+PREHOOK: Output: default@io_test_text_2
+POSTHOOK: query: drop table io_test_text_2
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_text_2
+PREHOOK: query: drop table io_test_text_3
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@io_test_text_3
+PREHOOK: Output: default@io_test_text_3
+POSTHOOK: query: drop table io_test_text_3
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@io_test_text_3
+POSTHOOK: Output: default@io_test_text_3
diff --git a/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out b/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out
new file mode 100644
index 0000000000..645c858364
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out
@@ -0,0 +1,536 @@
+PREHOOK: query: drop table if exists multiinsert_test_text
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_text
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_text_2
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_text_2
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_acid
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_acid
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_mm
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_mm
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: drop table if exists multiinsert_test_acid_nondi
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table if exists multiinsert_test_acid_nondi
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create external table multiinsert_test_text (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_text
+POSTHOOK: query: create external table multiinsert_test_text (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_text
+PREHOOK: query: insert into multiinsert_test_text values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@multiinsert_test_text
+POSTHOOK: query: insert into multiinsert_test_text values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, NULL), (5555, 55, NULL)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@multiinsert_test_text
+POSTHOOK: Lineage: multiinsert_test_text.a SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text.b SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text.c SCRIPT []
+PREHOOK: query: create external table multiinsert_test_text_2 (a int, b int, c int) stored as textfile
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: query: create external table multiinsert_test_text_2 (a int, b int, c int) stored as textfile
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_text_2
+PREHOOK: query: insert into multiinsert_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: query: insert into multiinsert_test_text_2 values (1111, 11, 1111), (2222, 22, 1111), (3333, 33, 2222), (4444, 44, 4444), (5555, 55, 4444)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: Lineage: multiinsert_test_text_2.a SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text_2.b SCRIPT []
+POSTHOOK: Lineage: multiinsert_test_text_2.c SCRIPT []
+PREHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
+PREHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_acid@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Input: default@multiinsert_test_acid@c=1111
+PREHOOK: Input: default@multiinsert_test_acid@c=2222
+PREHOOK: Input: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from multiinsert_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Input: default@multiinsert_test_acid@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_mm@c=1111
+POSTHOOK: Output: default@multiinsert_test_mm@c=2222
+POSTHOOK: Output: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_mm order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Input: default@multiinsert_test_mm@c=1111
+PREHOOK: Input: default@multiinsert_test_mm@c=2222
+PREHOOK: Input: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from multiinsert_test_mm order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Input: default@multiinsert_test_mm@c=1111
+POSTHOOK: Input: default@multiinsert_test_mm@c=2222
+POSTHOOK: Input: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: from multiinsert_test_text a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(multiinsert_test_text)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(multiinsert_test_text)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid_nondi order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from multiinsert_test_acid_nondi order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	NULL
+5555	55	NULL
+PREHOOK: query: drop table if exists multiinsert_test_acid
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: drop table if exists multiinsert_test_acid
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: drop table if exists multiinsert_test_mm
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: drop table if exists multiinsert_test_mm
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: drop table if exists multiinsert_test_acid_nondi
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: drop table if exists multiinsert_test_acid_nondi
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
+PREHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: create table multiinsert_test_acid (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: create table multiinsert_test_mm (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: create table multiinsert_test_acid_nondi (a int, b int) partitioned by (c int) stored as orc tblproperties('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
+PREHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_acid@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid@c=4444
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=1111).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=2222).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=4444).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid PARTITION(c=4444).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Input: default@multiinsert_test_acid@c=1111
+PREHOOK: Input: default@multiinsert_test_acid@c=2222
+PREHOOK: Input: default@multiinsert_test_acid@c=4444
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from multiinsert_test_acid order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Input: default@multiinsert_test_acid@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid@c=4444
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_mm partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_mm@c=1111
+POSTHOOK: Output: default@multiinsert_test_mm@c=2222
+POSTHOOK: Output: default@multiinsert_test_mm@c=4444
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=1111).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=2222).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=4444).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_mm PARTITION(c=4444).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_mm order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Input: default@multiinsert_test_mm@c=1111
+PREHOOK: Input: default@multiinsert_test_mm@c=2222
+PREHOOK: Input: default@multiinsert_test_mm@c=4444
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from multiinsert_test_mm order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Input: default@multiinsert_test_mm@c=1111
+POSTHOOK: Input: default@multiinsert_test_mm@c=2222
+POSTHOOK: Input: default@multiinsert_test_mm@c=4444
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: from multiinsert_test_text_2 a
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+ where a.c is not null
+insert overwrite table multiinsert_test_acid_nondi partition (c)
+select
+ a.a,
+ a.b,
+ a.c
+where a.c is null
+sort by a.c
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=4444
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=1111).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=2222).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=4444).a SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: multiinsert_test_acid_nondi PARTITION(c=4444).b SIMPLE [(multiinsert_test_text_2)a.FieldSchema(name:b, type:int, comment:null), ]
+PREHOOK: query: select * from multiinsert_test_acid_nondi order by a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+PREHOOK: Input: default@multiinsert_test_acid_nondi@c=4444
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select * from multiinsert_test_acid_nondi order by a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=1111
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=2222
+POSTHOOK: Input: default@multiinsert_test_acid_nondi@c=4444
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1111	11	1111
+2222	22	1111
+3333	33	2222
+4444	44	4444
+5555	55	4444
+PREHOOK: query: drop table if exists multiinsert_test_text
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_text
+PREHOOK: Output: default@multiinsert_test_text
+POSTHOOK: query: drop table if exists multiinsert_test_text
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_text
+PREHOOK: query: drop table if exists multiinsert_test_text_2
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_text_2
+PREHOOK: Output: default@multiinsert_test_text_2
+POSTHOOK: query: drop table if exists multiinsert_test_text_2
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_text_2
+PREHOOK: query: drop table if exists multiinsert_test_acid
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid
+PREHOOK: Output: default@multiinsert_test_acid
+POSTHOOK: query: drop table if exists multiinsert_test_acid
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid
+POSTHOOK: Output: default@multiinsert_test_acid
+PREHOOK: query: drop table if exists multiinsert_test_mm
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_mm
+PREHOOK: Output: default@multiinsert_test_mm
+POSTHOOK: query: drop table if exists multiinsert_test_mm
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_mm
+POSTHOOK: Output: default@multiinsert_test_mm
+PREHOOK: query: drop table if exists multiinsert_test_acid_nondi
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@multiinsert_test_acid_nondi
+PREHOOK: Output: default@multiinsert_test_acid_nondi
+POSTHOOK: query: drop table if exists multiinsert_test_acid_nondi
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@multiinsert_test_acid_nondi
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
