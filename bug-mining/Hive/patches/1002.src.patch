diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/BucketMapJoinContext.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/BucketMapJoinContext.java
index 3e0cee3ec1..e3cab05240 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/BucketMapJoinContext.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/BucketMapJoinContext.java
@@ -18,6 +18,7 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.io.Serializable;
+import java.net.URI;
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.LinkedHashMap;
@@ -199,7 +200,7 @@ public String createFileName(String inputPath, String fileName) {
   private String prependPartSpec(String inputPath, String fileName) {
     Map<String, String> mapping = inputToPartSpecMapping == null ?
         inputToPartSpecMapping = revert(bigTablePartSpecToFileMapping) : inputToPartSpecMapping;
-    String partSpec = mapping.get(inputPath);
+    String partSpec = mapping.get(URI.create(inputPath).getPath());
     return partSpec == null || partSpec.isEmpty() ? fileName :
       "(" + FileUtils.escapePathName(partSpec) + ")" + fileName;
   }
@@ -210,7 +211,7 @@ private Map<String, String> revert(Map<String, List<String>> mapping) {
     for (Map.Entry<String, List<String>> entry : mapping.entrySet()) {
       String partSpec = entry.getKey();
       for (String file : entry.getValue()) {
-        converted.put(file, partSpec);
+        converted.put(URI.create(file).getPath(), partSpec);
       }
     }
     return converted;
