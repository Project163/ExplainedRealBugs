diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index 0ab1364e83..a373c8bf76 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -975,7 +975,8 @@ private boolean validateConfVariables() {
     boolean valid = true;
     if ((!conf.getBoolVar(HiveConf.ConfVars.HIVE_HADOOP_SUPPORTS_SUBDIRECTORIES))
         && ((conf.getBoolVar(HiveConf.ConfVars.HADOOPMAPREDINPUTDIRRECURSIVE)) || (conf
-              .getBoolVar(HiveConf.ConfVars.HIVEOPTLISTBUCKETING)))) {
+              .getBoolVar(HiveConf.ConfVars.HIVEOPTLISTBUCKETING)) || ((conf
+                  .getBoolVar(HiveConf.ConfVars.HIVE_OPTIMIZE_UNION_REMOVE))))) {
       errorMessage = "FAILED: Hive Internal Error: "
           + ErrorMsg.SUPPORT_DIR_MUST_TRUE_FOR_LIST_BUCKETING.getMsg();
       SQLState = ErrorMsg.findSQLState(errorMessage);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
index 82d452e59a..5d2e0298ca 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
@@ -256,7 +256,8 @@ public enum ErrorMsg {
       10199,
       "hive.mapred.supports.subdirectories must be true"
           + " if any one of following is true: "
-          + " hive.optimize.listbucketing and mapred.input.dir.recursive"),
+          + " hive.optimize.listbucketing , mapred.input.dir.recursive"
+          + " and hive.optimize.union.remove."),
   SKEWED_TABLE_NO_COLUMN_NAME(10200, "No skewed column name."),
   SKEWED_TABLE_NO_COLUMN_VALUE(10201, "No skewed values."),
   SKEWED_TABLE_DUPLICATE_COLUMN_NAMES(10202,
diff --git a/ql/src/test/queries/clientnegative/invalid_config2.q b/ql/src/test/queries/clientnegative/invalid_config2.q
new file mode 100644
index 0000000000..fa023c8c4b
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/invalid_config2.q
@@ -0,0 +1,4 @@
+set hive.mapred.supports.subdirectories=false;
+set hive.optimize.union.remove=true;
+
+select count(1) from src;
diff --git a/ql/src/test/results/clientnegative/invalid_config1.q.out b/ql/src/test/results/clientnegative/invalid_config1.q.out
index 5c8a322124..87e3476389 100644
--- a/ql/src/test/results/clientnegative/invalid_config1.q.out
+++ b/ql/src/test/results/clientnegative/invalid_config1.q.out
@@ -1,2 +1,2 @@
-FAILED: Hive Internal Error: hive.mapred.supports.subdirectories must be true if any one of following is true:  hive.optimize.listbucketing and mapred.input.dir.recursive
+FAILED: Hive Internal Error: hive.mapred.supports.subdirectories must be true if any one of following is true:  hive.optimize.listbucketing , mapred.input.dir.recursive and hive.optimize.union.remove.
 
diff --git a/ql/src/test/results/clientnegative/invalid_config2.q.out b/ql/src/test/results/clientnegative/invalid_config2.q.out
new file mode 100644
index 0000000000..87e3476389
--- /dev/null
+++ b/ql/src/test/results/clientnegative/invalid_config2.q.out
@@ -0,0 +1,2 @@
+FAILED: Hive Internal Error: hive.mapred.supports.subdirectories must be true if any one of following is true:  hive.optimize.listbucketing , mapred.input.dir.recursive and hive.optimize.union.remove.
+
