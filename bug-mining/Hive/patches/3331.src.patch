diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
index a029f10c11..c48e0b7bf0 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
@@ -101,6 +101,7 @@
 import org.apache.hadoop.hive.ql.ErrorMsg;
 import org.apache.hadoop.hive.ql.exec.FunctionRegistry;
 import org.apache.hadoop.hive.ql.exec.FunctionTask;
+import org.apache.hadoop.hive.ql.exec.FunctionUtils;
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.index.HiveIndexHandler;
 import org.apache.hadoop.hive.ql.io.AcidUtils;
@@ -174,8 +175,9 @@ public static void reloadFunctions() throws HiveException {
       for (String functionName : db.getFunctions(dbName, "*")) {
         Function function = db.getFunction(dbName, functionName);
         try {
-          FunctionRegistry.registerPermanentFunction(functionName, function.getClassName(), false,
-              FunctionTask.toFunctionResource(function.getResourceUris()));
+	  FunctionRegistry.registerPermanentFunction(
+	      FunctionUtils.qualifyFunctionName(functionName, dbName), function.getClassName(),
+	      false, FunctionTask.toFunctionResource(function.getResourceUris()));
         } catch (Exception e) {
           LOG.warn("Failed to register persistent function " +
               functionName + ":" + function.getClassName() + ". Ignore and continue.");
