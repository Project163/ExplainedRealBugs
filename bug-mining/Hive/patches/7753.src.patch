diff --git a/itests/src/test/resources/testconfiguration.properties b/itests/src/test/resources/testconfiguration.properties
index 5d69d29cee..a29a4a34f9 100644
--- a/itests/src/test/resources/testconfiguration.properties
+++ b/itests/src/test/resources/testconfiguration.properties
@@ -102,6 +102,7 @@ minillap.query.files=\
   mm_all.q,\
   mm_cttas.q,\
   mm_dp.q,\
+  mm_dyn_part.q,\
   multi_count_distinct_null.q,\
   newline.q,\
   nonreserved_keywords_insert_into1.q,\
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java
index c21c0f41bd..529050123f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MoveTask.java
@@ -531,7 +531,8 @@ private DataContainer handleDynParts(Hive db, Table table, LoadTableDesc tbd,
       TaskInformation ti, DynamicPartitionCtx dpCtx) throws HiveException,
       IOException, InvalidOperationException {
     DataContainer dc;
-    List<LinkedHashMap<String, String>> dps = Utilities.getFullDPSpecs(conf, dpCtx);
+    List<LinkedHashMap<String, String>> dps = Utilities.getFullDPSpecs(conf, dpCtx,
+        work.getLoadTableWork().getWriteId(), tbd.isMmTable(), tbd.isDirectInsert(), tbd.isInsertOverwrite());
 
     console.printInfo(System.getProperty("line.separator"));
     long startTime = System.currentTimeMillis();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index ea73cba7e6..b2dde645f4 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -2845,16 +2845,31 @@ private static <T> List<T> getTasks(List<Task<?>> tasks,
    * Construct a list of full partition spec from Dynamic Partition Context and the directory names
    * corresponding to these dynamic partitions.
    */
-  public static List<LinkedHashMap<String, String>> getFullDPSpecs(Configuration conf,
-      DynamicPartitionCtx dpCtx) throws HiveException {
+  public static List<LinkedHashMap<String, String>> getFullDPSpecs(Configuration conf, DynamicPartitionCtx dpCtx,
+      long writeId, boolean isMmTable, boolean isDirectInsert, boolean isInsertOverwrite) throws HiveException {
 
     try {
       Path loadPath = dpCtx.getRootPath();
       FileSystem fs = loadPath.getFileSystem(conf);
       int numDPCols = dpCtx.getNumDPCols();
-      List<FileStatus> status = HiveStatsUtils.getFileStatusRecurse(loadPath, numDPCols, fs);
+      List<Path> path = new ArrayList<>();
+      if (isMmTable || isDirectInsert) {
+        Path[] leafStatus = Utilities.getDirectInsertDirectoryCandidates(fs, loadPath, numDPCols, null, writeId, -1,
+            conf, isInsertOverwrite);
+        for (Path p : leafStatus) {
+          Path dpPath = p.getParent();
+          if (!path.contains(dpPath)) {
+            path.add(dpPath);
+          }
+        }
+      } else {
+        List<FileStatus> status = HiveStatsUtils.getFileStatusRecurse(loadPath, numDPCols, fs);
+        for (FileStatus fileStatus : status) {
+          path.add(fileStatus.getPath());
+        }
+      }
 
-      if (status.isEmpty()) {
+      if (path.isEmpty()) {
         LOG.warn("No partition is generated by dynamic partitioning");
         return null;
       }
@@ -2867,9 +2882,7 @@ public static List<LinkedHashMap<String, String>> getFullDPSpecs(Configuration c
 
       // for each dynamically created DP directory, construct a full partition spec
       // and load the partition based on that
-      for (int i = 0; i < status.size(); ++i) {
-        // get the dynamically created directory
-        Path partPath = status.get(i).getPath();
+      for (Path partPath : path) {
         assert fs.getFileStatus(partPath).isDir() : "partitions " + partPath
             + " is not a directory !";
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
index de8f0440f9..5ab7cf849c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
@@ -2695,7 +2695,7 @@ private Set<Path> getValidPartitionsInPath(
     Set<Path> validPartitions = new HashSet<Path>();
     try {
       FileSystem fs = loadPath.getFileSystem(conf);
-      if (!isMmTable || !isDirectInsert) {
+      if (!isMmTable && !isDirectInsert) {
         List<FileStatus> leafStatus = HiveStatsUtils.getFileStatusRecurse(loadPath, numDP, fs);
         // Check for empty partitions
         for (FileStatus s : leafStatus) {
diff --git a/ql/src/test/queries/clientpositive/create_transactional_full_acid.q b/ql/src/test/queries/clientpositive/create_transactional_full_acid.q
index 5be7789e37..d2e690804a 100644
--- a/ql/src/test/queries/clientpositive/create_transactional_full_acid.q
+++ b/ql/src/test/queries/clientpositive/create_transactional_full_acid.q
@@ -2,6 +2,7 @@
 set hive.mapred.mode=nonstrict;
 set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.acid.direct.insert.enabled=false;
 
 drop table if exists target;
 drop table if exists source;
diff --git a/ql/src/test/queries/clientpositive/mm_dyn_part.q b/ql/src/test/queries/clientpositive/mm_dyn_part.q
new file mode 100644
index 0000000000..d2d91d28a1
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/mm_dyn_part.q
@@ -0,0 +1,24 @@
+-- SORT_QUERY_RESULTS
+
+set hive.fetch.task.conversion=none;
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.stats.autogather=true;
+set hive.exec.dynamic.partition.mode=nonstrict;
+set hive.exec.dynamic.partition=true;
+
+DROP TABLE txt_table;
+DROP TABLE part_table;
+
+CREATE TABLE txt_table (id int, value string, year string, month string, day string);
+INSERT INTO TABLE txt_table VALUES (1, 'one', '2020', '02', '11');
+INSERT INTO TABLE txt_table VALUES (2, 'two', '2019', '03', '12');
+INSERT INTO TABLE txt_table VALUES (3, 'three', '2020', '03', '13');
+
+CREATE TABLE part_table (id int, value string) PARTITIONED BY(year string, month string, day string) STORED AS ORC TBLPROPERTIES('transactional'='true','transactional_properties'='insert_only');
+
+INSERT INTO TABLE part_table PARTITION (year, month, day) SELECT id, value, year, month, day FROM txt_table ;
+SELECT * FROM part_table;
+
+DROP TABLE txt_table;
+DROP TABLE part_table;
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out
index 0af7f5e35f..79063e102e 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out
@@ -75,12 +75,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@encryptedtable_n0
 POSTHOOK: Output: default@encryptedtable_n0@key=238
-POSTHOOK: Output: default@encryptedtable_n0@key=501
-POSTHOOK: Output: default@encryptedtable_n0@key=502
 POSTHOOK: Output: default@encryptedtable_n0@key=86
 POSTHOOK: Lineage: encryptedtable_n0 PARTITION(key=238).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-POSTHOOK: Lineage: encryptedtable_n0 PARTITION(key=501).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-POSTHOOK: Lineage: encryptedtable_n0 PARTITION(key=502).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: encryptedtable_n0 PARTITION(key=86).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: select * from encryptedTable_n0 order by key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out b/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
index edb8fbdf67..bde0415d35 100644
--- a/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
@@ -656,13 +656,7 @@ POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_1
 POSTHOOK: Output: default@io_test_acid_part
-POSTHOOK: Output: default@io_test_acid_part@c=1111
-POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
 PREHOOK: query: select * from io_test_acid_part order by a
@@ -693,17 +687,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
 POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
-POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=4444
-POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
 PREHOOK: query: select * from io_test_acid_part order by a, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@io_test_acid_part
@@ -733,18 +721,6 @@ POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
 POSTHOOK: Output: default@io_test_acid_part
-POSTHOOK: Output: default@io_test_acid_part@c=1111
-POSTHOOK: Output: default@io_test_acid_part@c=2222
-POSTHOOK: Output: default@io_test_acid_part@c=4444
-POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE []
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE []
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE []
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
 PREHOOK: query: select * from io_test_acid_part order by a, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@io_test_acid_part
@@ -837,12 +813,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_1
 POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
-POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:b, type:int, comment:null), ]
 PREHOOK: query: select * from io_test_acid_part order by a
@@ -876,18 +849,9 @@ insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
 POSTHOOK: Output: default@io_test_acid_part
-POSTHOOK: Output: default@io_test_acid_part@c=1111
-POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=4444
-POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=2222).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=4444).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
-POSTHOOK: Lineage: io_test_acid_part PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:b, type:int, comment:null), ]
 PREHOOK: query: select * from io_test_acid_part order by a, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@io_test_acid_part
diff --git a/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out b/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
index e368f92d9d..c749496ec1 100644
--- a/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
@@ -609,25 +609,13 @@ POSTHOOK: Output: default@merge_tmp_table
 POSTHOOK: Output: default@srcpart_acid
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=12
 POSTHOOK: Lineage: merge_tmp_table.val EXPRESSION [(srcpart_acid)t.FieldSchema(name:ROW__ID, type:struct<writeId:bigint,bucketId:int,rowId:bigint>, comment:), (srcpart_acid)t.FieldSchema(name:ds, type:string, comment:null), (srcpart_acid)t.FieldSchema(name:hr, type:string, comment:null), ]
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-08,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-08,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-08,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-08,hr=12).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-09,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-09,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-09,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acid PARTITION(ds=2008-04-09,hr=12).value SIMPLE []
 PREHOOK: query: select count(*) from srcpart_acid where ds='2008-04-08' and hr=='12'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acid
@@ -636,7 +624,7 @@ POSTHOOK: query: select count(*) from srcpart_acid where ds='2008-04-08' and hr=
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_acid
 #### A masked pattern was here ####
-497
+0
 PREHOOK: query: select ds, hr, key, value from srcpart_acid where value like '%updated by merge'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acid
@@ -1162,25 +1150,13 @@ POSTHOOK: Output: default@merge_tmp_table
 POSTHOOK: Output: default@srcpart_acidb
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=12
 POSTHOOK: Lineage: merge_tmp_table.val EXPRESSION [(srcpart_acidb)t.FieldSchema(name:ROW__ID, type:struct<writeId:bigint,bucketId:int,rowId:bigint>, comment:), (srcpart_acidb)t.FieldSchema(name:ds, type:string, comment:null), (srcpart_acidb)t.FieldSchema(name:hr, type:string, comment:null), ]
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-08,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-08,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-08,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-08,hr=12).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-09,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-09,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-09,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidb PARTITION(ds=2008-04-09,hr=12).value SIMPLE []
 PREHOOK: query: select count(*) from srcpart_acidb where ds='2008-04-08' and hr=='12'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acidb
@@ -1189,7 +1165,7 @@ POSTHOOK: query: select count(*) from srcpart_acidb where ds='2008-04-08' and hr
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_acidb
 #### A masked pattern was here ####
-497
+0
 PREHOOK: query: select ds, hr, key, value from srcpart_acidb where value like '%updated by merge'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acidb
@@ -2036,25 +2012,13 @@ POSTHOOK: Output: default@merge_tmp_table
 POSTHOOK: Output: default@srcpart_acidv
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=12
 POSTHOOK: Lineage: merge_tmp_table.val EXPRESSION [(srcpart_acidv)t.FieldSchema(name:ROW__ID, type:struct<writeId:bigint,bucketId:int,rowId:bigint>, comment:), (srcpart_acidv)t.FieldSchema(name:ds, type:string, comment:null), (srcpart_acidv)t.FieldSchema(name:hr, type:string, comment:null), ]
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-08,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-08,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-08,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-08,hr=12).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-09,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-09,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-09,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidv PARTITION(ds=2008-04-09,hr=12).value SIMPLE []
 PREHOOK: query: select count(*) from srcpart_acidv where ds='2008-04-08' and hr=='12'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acidv
@@ -2063,7 +2027,7 @@ POSTHOOK: query: select count(*) from srcpart_acidv where ds='2008-04-08' and hr
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_acidv
 #### A masked pattern was here ####
-497
+0
 PREHOOK: query: select ds, hr, key, value from srcpart_acidv where value like '%updated by merge'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acidv
@@ -2919,25 +2883,13 @@ POSTHOOK: Output: default@merge_tmp_table
 POSTHOOK: Output: default@srcpart_acidvb
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
-POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
-POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=12
 POSTHOOK: Lineage: merge_tmp_table.val EXPRESSION [(srcpart_acidvb)t.FieldSchema(name:ROW__ID, type:struct<writeId:bigint,bucketId:int,rowId:bigint>, comment:), (srcpart_acidvb)t.FieldSchema(name:ds, type:string, comment:null), (srcpart_acidvb)t.FieldSchema(name:hr, type:string, comment:null), ]
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-08,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-08,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-08,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-08,hr=12).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-09,hr=11).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-09,hr=11).value SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-09,hr=12).key SIMPLE []
-POSTHOOK: Lineage: srcpart_acidvb PARTITION(ds=2008-04-09,hr=12).value SIMPLE []
 PREHOOK: query: select count(*) from srcpart_acidvb where ds='2008-04-08' and hr=='12'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acidvb
@@ -2946,7 +2898,7 @@ POSTHOOK: query: select count(*) from srcpart_acidvb where ds='2008-04-08' and h
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_acidvb
 #### A masked pattern was here ####
-497
+0
 PREHOOK: query: select ds, hr, key, value from srcpart_acidvb where value like '%updated by merge'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart_acidvb
diff --git a/ql/src/test/results/clientpositive/llap/acid_subquery.q.out b/ql/src/test/results/clientpositive/llap/acid_subquery.q.out
index eef983c743..f6d48ffbee 100644
--- a/ql/src/test/results/clientpositive/llap/acid_subquery.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_subquery.q.out
@@ -97,17 +97,8 @@ POSTHOOK: Output: default@merge_tmp_table
 POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
-POSTHOOK: Output: default@target@p=1/q=2
-POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=2/q=2
 POSTHOOK: Output: default@target@p=2/q=2
-POSTHOOK: Output: default@target@p=2/q=2
 POSTHOOK: Lineage: merge_tmp_table.val EXPRESSION [(target)t.FieldSchema(name:ROW__ID, type:struct<writeId:bigint,bucketId:int,rowId:bigint>, comment:), (target)t.FieldSchema(name:p, type:int, comment:null), (target)t.FieldSchema(name:q, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=2).a SIMPLE [(source)s.FieldSchema(name:a1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=2).b SIMPLE [(source)s.FieldSchema(name:b1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=3).a SIMPLE [(source)s.FieldSchema(name:a1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=3).b SIMPLE [(source)s.FieldSchema(name:b1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=2,q=2).a SIMPLE [(source)s.FieldSchema(name:a1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=2,q=2).b SIMPLE [(source)s.FieldSchema(name:b1, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out b/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out
index a307a5ab02..d8647e0542 100644
--- a/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out
+++ b/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out
@@ -191,17 +191,8 @@ POSTHOOK: Output: default@merge_tmp_table
 POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
-POSTHOOK: Output: default@target@p=1/q=2
-POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=2/q=2
 POSTHOOK: Output: default@target@p=2/q=2
-POSTHOOK: Output: default@target@p=2/q=2
 POSTHOOK: Lineage: merge_tmp_table.val EXPRESSION [(target)t.FieldSchema(name:ROW__ID, type:struct<writeId:bigint,bucketId:int,rowId:bigint>, comment:), (target)t.FieldSchema(name:p, type:int, comment:null), (target)t.FieldSchema(name:q, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=2).a SIMPLE [(source)s.FieldSchema(name:a1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=2).b SIMPLE [(source)s.FieldSchema(name:b1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=3).a SIMPLE [(source)s.FieldSchema(name:a1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=1,q=3).b SIMPLE [(source)s.FieldSchema(name:b1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=2,q=2).a SIMPLE [(source)s.FieldSchema(name:a1, type:int, comment:null), ]
-POSTHOOK: Lineage: target PARTITION(p=2,q=2).b SIMPLE [(source)s.FieldSchema(name:b1, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out b/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out
index e21a5177c0..626a8e2c9f 100644
--- a/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out
@@ -375,12 +375,6 @@ POSTHOOK: query: INSERT OVERWRITE TABLE int_part PARTITION (par) SELECT * FROM b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@b
 POSTHOOK: Output: default@int_part
-POSTHOOK: Output: default@int_part@par=1
-POSTHOOK: Output: default@int_part@par=2
-POSTHOOK: Output: default@int_part@par=3
-POSTHOOK: Lineage: int_part PARTITION(par=1).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
-POSTHOOK: Lineage: int_part PARTITION(par=2).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
-POSTHOOK: Lineage: int_part PARTITION(par=3).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
 PREHOOK: query: SELECT count(*) FROM int_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@int_part
@@ -439,11 +433,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@b
 POSTHOOK: Output: default@int_part
 POSTHOOK: Output: default@int_part@par=1
-POSTHOOK: Output: default@int_part@par=2
-POSTHOOK: Output: default@int_part@par=3
 POSTHOOK: Lineage: int_part PARTITION(par=1).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
-POSTHOOK: Lineage: int_part PARTITION(par=2).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
-POSTHOOK: Lineage: int_part PARTITION(par=3).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
 PREHOOK: query: SELECT count(*) FROM int_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@int_part
diff --git a/ql/src/test/results/clientpositive/llap/mm_all.q.out b/ql/src/test/results/clientpositive/llap/mm_all.q.out
index a289cf37a6..cc36cea95c 100644
--- a/ql/src/test/results/clientpositive/llap/mm_all.q.out
+++ b/ql/src/test/results/clientpositive/llap/mm_all.q.out
@@ -1638,7 +1638,6 @@ POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
 POSTHOOK: Output: default@multi1_mm
 POSTHOOK: Output: default@multi1_mm@p=1
-POSTHOOK: Output: default@multi1_mm@p=2
 POSTHOOK: Output: default@multi1_mm@p=455
 POSTHOOK: Output: default@multi1_mm@p=456
 POSTHOOK: Output: default@multi1_mm@p=457
@@ -1652,8 +1651,6 @@ POSTHOOK: Lineage: ###Masked###
 POSTHOOK: Lineage: ###Masked###
 POSTHOOK: Lineage: ###Masked###
 POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
 PREHOOK: query: select key, key2, p from multi1_mm order by key, key2, p
 PREHOOK: type: QUERY
 PREHOOK: Input: default@multi1_mm
@@ -1722,18 +1719,6 @@ POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
 POSTHOOK: Output: default@multi1_mm
 POSTHOOK: Output: default@multi1_mm@p=1
-POSTHOOK: Output: default@multi1_mm@p=2
-POSTHOOK: Output: default@multi1_mm@p=455
-POSTHOOK: Output: default@multi1_mm@p=456
-POSTHOOK: Output: default@multi1_mm@p=457
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
-POSTHOOK: Lineage: ###Masked###
 POSTHOOK: Lineage: ###Masked###
 POSTHOOK: Lineage: ###Masked###
 POSTHOOK: Lineage: ###Masked###
diff --git a/ql/src/test/results/clientpositive/llap/mm_dyn_part.q.out b/ql/src/test/results/clientpositive/llap/mm_dyn_part.q.out
new file mode 100644
index 0000000000..e91b3c9d96
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/mm_dyn_part.q.out
@@ -0,0 +1,113 @@
+PREHOOK: query: DROP TABLE txt_table
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: DROP TABLE txt_table
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: DROP TABLE part_table
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: DROP TABLE part_table
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: CREATE TABLE txt_table (id int, value string, year string, month string, day string)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@txt_table
+POSTHOOK: query: CREATE TABLE txt_table (id int, value string, year string, month string, day string)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@txt_table
+PREHOOK: query: INSERT INTO TABLE txt_table VALUES (1, 'one', '2020', '02', '11')
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@txt_table
+POSTHOOK: query: INSERT INTO TABLE txt_table VALUES (1, 'one', '2020', '02', '11')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@txt_table
+POSTHOOK: Lineage: txt_table.day SCRIPT []
+POSTHOOK: Lineage: txt_table.id SCRIPT []
+POSTHOOK: Lineage: txt_table.month SCRIPT []
+POSTHOOK: Lineage: txt_table.value SCRIPT []
+POSTHOOK: Lineage: txt_table.year SCRIPT []
+PREHOOK: query: INSERT INTO TABLE txt_table VALUES (2, 'two', '2019', '03', '12')
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@txt_table
+POSTHOOK: query: INSERT INTO TABLE txt_table VALUES (2, 'two', '2019', '03', '12')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@txt_table
+POSTHOOK: Lineage: txt_table.day SCRIPT []
+POSTHOOK: Lineage: txt_table.id SCRIPT []
+POSTHOOK: Lineage: txt_table.month SCRIPT []
+POSTHOOK: Lineage: txt_table.value SCRIPT []
+POSTHOOK: Lineage: txt_table.year SCRIPT []
+PREHOOK: query: INSERT INTO TABLE txt_table VALUES (3, 'three', '2020', '03', '13')
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@txt_table
+POSTHOOK: query: INSERT INTO TABLE txt_table VALUES (3, 'three', '2020', '03', '13')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@txt_table
+POSTHOOK: Lineage: txt_table.day SCRIPT []
+POSTHOOK: Lineage: txt_table.id SCRIPT []
+POSTHOOK: Lineage: txt_table.month SCRIPT []
+POSTHOOK: Lineage: txt_table.value SCRIPT []
+POSTHOOK: Lineage: txt_table.year SCRIPT []
+PREHOOK: query: CREATE TABLE part_table (id int, value string) PARTITIONED BY(year string, month string, day string) STORED AS ORC TBLPROPERTIES('transactional'='true','transactional_properties'='insert_only')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@part_table
+POSTHOOK: query: CREATE TABLE part_table (id int, value string) PARTITIONED BY(year string, month string, day string) STORED AS ORC TBLPROPERTIES('transactional'='true','transactional_properties'='insert_only')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@part_table
+PREHOOK: query: INSERT INTO TABLE part_table PARTITION (year, month, day) SELECT id, value, year, month, day FROM txt_table
+PREHOOK: type: QUERY
+PREHOOK: Input: default@txt_table
+PREHOOK: Output: default@part_table
+POSTHOOK: query: INSERT INTO TABLE part_table PARTITION (year, month, day) SELECT id, value, year, month, day FROM txt_table
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@txt_table
+POSTHOOK: Output: default@part_table
+POSTHOOK: Output: default@part_table@year=2019/month=03/day=12
+POSTHOOK: Output: default@part_table@year=2020/month=02/day=11
+POSTHOOK: Output: default@part_table@year=2020/month=03/day=13
+POSTHOOK: Lineage: part_table PARTITION(year=2019,month=03,day=12).id SIMPLE [(txt_table)txt_table.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: part_table PARTITION(year=2019,month=03,day=12).value SIMPLE [(txt_table)txt_table.FieldSchema(name:value, type:string, comment:null), ]
+POSTHOOK: Lineage: part_table PARTITION(year=2020,month=02,day=11).id SIMPLE [(txt_table)txt_table.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: part_table PARTITION(year=2020,month=02,day=11).value SIMPLE [(txt_table)txt_table.FieldSchema(name:value, type:string, comment:null), ]
+POSTHOOK: Lineage: part_table PARTITION(year=2020,month=03,day=13).id SIMPLE [(txt_table)txt_table.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: part_table PARTITION(year=2020,month=03,day=13).value SIMPLE [(txt_table)txt_table.FieldSchema(name:value, type:string, comment:null), ]
+PREHOOK: query: SELECT * FROM part_table
+PREHOOK: type: QUERY
+PREHOOK: Input: default@part_table
+PREHOOK: Input: default@part_table@year=2019/month=03/day=12
+PREHOOK: Input: default@part_table@year=2020/month=02/day=11
+PREHOOK: Input: default@part_table@year=2020/month=03/day=13
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: SELECT * FROM part_table
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@part_table
+POSTHOOK: Input: default@part_table@year=2019/month=03/day=12
+POSTHOOK: Input: default@part_table@year=2020/month=02/day=11
+POSTHOOK: Input: default@part_table@year=2020/month=03/day=13
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1	one	2020	02	11
+2	two	2019	03	12
+3	three	2020	03	13
+PREHOOK: query: DROP TABLE txt_table
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@txt_table
+PREHOOK: Output: default@txt_table
+POSTHOOK: query: DROP TABLE txt_table
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@txt_table
+POSTHOOK: Output: default@txt_table
+PREHOOK: query: DROP TABLE part_table
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@part_table
+PREHOOK: Output: default@part_table
+POSTHOOK: query: DROP TABLE part_table
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@part_table
+POSTHOOK: Output: default@part_table
