diff --git a/hcatalog/core/src/test/java/org/apache/hive/hcatalog/mapreduce/HCatBaseTest.java b/hcatalog/core/src/test/java/org/apache/hive/hcatalog/mapreduce/HCatBaseTest.java
index e982653019..463d4a3760 100644
--- a/hcatalog/core/src/test/java/org/apache/hive/hcatalog/mapreduce/HCatBaseTest.java
+++ b/hcatalog/core/src/test/java/org/apache/hive/hcatalog/mapreduce/HCatBaseTest.java
@@ -118,6 +118,17 @@ protected void logAndRegister(PigServer server, String query, int lineNumber) th
   public static PigServer createPigServer(boolean stopOnFailure) throws ExecException {
     if(stopOnFailure) {
       Properties p = new Properties();
+      Path workDir = new Path(System.getProperty("test.tmp.dir",
+          "target" + File.separator + "test" + File.separator + "tmp"));
+      String testId = "HCatBaseTest_" + System.currentTimeMillis();
+      p.put("mapred.local.dir", workDir + File.separator + testId
+          + File.separator + "mapred" + File.separator + "local");
+      p.put("mapred.system.dir", workDir + File.separator + testId
+          + File.separator + "mapred" + File.separator + "system");
+      p.put("mapreduce.jobtracker.staging.root.dir", workDir + File.separator + testId
+          + File.separator + "mapred" + File.separator + "staging");
+      p.put("mapred.temp.dir", workDir + File.separator + testId
+          + File.separator + "mapred" + File.separator + "temp");
       p.put("stop.on.failure", Boolean.TRUE.toString());
       return new PigServer(ExecType.LOCAL, p);
     }
