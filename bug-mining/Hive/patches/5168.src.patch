diff --git a/hbase-handler/src/test/results/positive/hbase_ppd_join.q.out b/hbase-handler/src/test/results/positive/hbase_ppd_join.q.out
index ee459e2c8b..0744cafc21 100644
--- a/hbase-handler/src/test/results/positive/hbase_ppd_join.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_ppd_join.q.out
@@ -50,6 +50,12 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@hive1_tbl_data_hbase1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@hive1_view_data_hbase1
+POSTHOOK: Lineage: hive1_view_data_hbase1.col_updated_date SIMPLE [(hive1_tbl_data_hbase1)hive1_tbl_data_hbase1.FieldSchema(name:col_updated_date, type:timestamp, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase1.columid SIMPLE [(hive1_tbl_data_hbase1)hive1_tbl_data_hbase1.FieldSchema(name:columid, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase1.column_fn SIMPLE [(hive1_tbl_data_hbase1)hive1_tbl_data_hbase1.FieldSchema(name:column_fn, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase1.column_ln SIMPLE [(hive1_tbl_data_hbase1)hive1_tbl_data_hbase1.FieldSchema(name:column_ln, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase1.email SIMPLE [(hive1_tbl_data_hbase1)hive1_tbl_data_hbase1.FieldSchema(name:email, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase1.pk_colum SIMPLE [(hive1_tbl_data_hbase1)hive1_tbl_data_hbase1.FieldSchema(name:pk_colum, type:string, comment:), ]
 PREHOOK: query: insert into table hive1_tbl_data_hbase1 select '00001','john','doe','john@hotmail.com','2014-01-01 12:01:02','4000-10000' from src where key = 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -90,6 +96,12 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@hive1_tbl_data_hbase2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@hive1_view_data_hbase2
+POSTHOOK: Lineage: hive1_view_data_hbase2.col_updated_date SIMPLE [(hive1_tbl_data_hbase2)hive1_tbl_data_hbase2.FieldSchema(name:col_updated_date, type:timestamp, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase2.columid SIMPLE [(hive1_tbl_data_hbase2)hive1_tbl_data_hbase2.FieldSchema(name:columid, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase2.column_fn SIMPLE [(hive1_tbl_data_hbase2)hive1_tbl_data_hbase2.FieldSchema(name:column_fn, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase2.column_ln SIMPLE [(hive1_tbl_data_hbase2)hive1_tbl_data_hbase2.FieldSchema(name:column_ln, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase2.email SIMPLE [(hive1_tbl_data_hbase2)hive1_tbl_data_hbase2.FieldSchema(name:email, type:string, comment:), ]
+POSTHOOK: Lineage: hive1_view_data_hbase2.pk_colum SIMPLE [(hive1_tbl_data_hbase2)hive1_tbl_data_hbase2.FieldSchema(name:pk_colum, type:string, comment:), ]
 PREHOOK: query: insert into table hive1_tbl_data_hbase2 select '00001','john','doe','john@hotmail.com','2014-01-01 12:01:02','00001' from src where key = 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/hbase-handler/src/test/results/positive/hbase_viewjoins.q.out b/hbase-handler/src/test/results/positive/hbase_viewjoins.q.out
index 908024c109..95fcaa02e0 100644
--- a/hbase-handler/src/test/results/positive/hbase_viewjoins.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_viewjoins.q.out
@@ -62,6 +62,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@hbase_table_test_1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@VIEW_HBASE_TABLE_TEST_1
+POSTHOOK: Lineage: VIEW_HBASE_TABLE_TEST_1.ccount SIMPLE [(hbase_table_test_1)hbase_table_test_1.FieldSchema(name:ccount, type:int, comment:), ]
+POSTHOOK: Lineage: VIEW_HBASE_TABLE_TEST_1.cvalue SIMPLE [(hbase_table_test_1)hbase_table_test_1.FieldSchema(name:cvalue, type:string, comment:), ]
+POSTHOOK: Lineage: VIEW_HBASE_TABLE_TEST_1.pk SIMPLE [(hbase_table_test_1)hbase_table_test_1.FieldSchema(name:pk, type:string, comment:), ]
 PREHOOK: query: CREATE TABLE HBASE_TABLE_TEST_2(
   cvalue string ,
     pk string ,
@@ -114,6 +117,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@hbase_table_test_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@VIEW_HBASE_TABLE_TEST_2
+POSTHOOK: Lineage: VIEW_HBASE_TABLE_TEST_2.ccount SIMPLE [(hbase_table_test_2)hbase_table_test_2.FieldSchema(name:ccount, type:int, comment:), ]
+POSTHOOK: Lineage: VIEW_HBASE_TABLE_TEST_2.cvalue SIMPLE [(hbase_table_test_2)hbase_table_test_2.FieldSchema(name:cvalue, type:string, comment:), ]
+POSTHOOK: Lineage: VIEW_HBASE_TABLE_TEST_2.pk SIMPLE [(hbase_table_test_2)hbase_table_test_2.FieldSchema(name:pk, type:string, comment:), ]
 PREHOOK: query: SELECT  p.cvalue cvalue
 FROM `VIEW_HBASE_TABLE_TEST_1` `p`
 LEFT OUTER JOIN `VIEW_HBASE_TABLE_TEST_2` `A1`
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
index a930408569..9511b46638 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
@@ -4434,6 +4434,10 @@ private int createView(Hive db, CreateViewDesc crtView) throws HiveException {
         HiveMaterializedViewsRegistry.get().addMaterializedView(tbl);
       }
       addIfAbsentByName(new WriteEntity(tbl, WriteEntity.WriteType.DDL_NO_LOCK));
+      
+      //set lineage info
+      DataContainer dc = new DataContainer(tbl.getTTable());
+      SessionState.get().getLineageState().setLineage(new Path(crtView.getViewName()), dc, tbl.getCols());
     }
     return 0;
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 266bc7d147..e5d0101049 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -237,6 +237,8 @@
 import org.apache.hadoop.mapred.OutputFormat;
 import org.apache.hadoop.security.UserGroupInformation;
 
+import com.google.common.base.Splitter;
+import com.google.common.base.Strings;
 import com.google.common.collect.Sets;
 import com.google.common.math.IntMath;
 
@@ -7143,7 +7145,7 @@ protected Operator genFileSinkPlan(String dest, QB qb, Operator input)
 
     if (ltd != null && SessionState.get() != null) {
       SessionState.get().getLineageState()
-          .mapDirToFop(ltd.getSourcePath(), (FileSinkOperator) output);
+          .mapDirToOp(ltd.getSourcePath(), (FileSinkOperator) output);
     } else if ( queryState.getCommandType().equals(HiveOperation.CREATETABLE_AS_SELECT.getOperationName())) {
 
       Path tlocation = null;
@@ -7156,7 +7158,7 @@ protected Operator genFileSinkPlan(String dest, QB qb, Operator input)
       }
 
       SessionState.get().getLineageState()
-              .mapDirToFop(tlocation, (FileSinkOperator) output);
+              .mapDirToOp(tlocation, (FileSinkOperator) output);
     }
 
     if (LOG.isDebugEnabled()) {
@@ -11054,14 +11056,22 @@ void analyzeInternal(ASTNode ast, PlannerContext plannerCtx) throws SemanticExce
 
         // Generate lineage info for create view statements
         // if LineageLogger hook is configured.
-        if (HiveConf.getVar(conf, HiveConf.ConfVars.POSTEXECHOOKS).contains(
-            "org.apache.hadoop.hive.ql.hooks.LineageLogger")) {
+        // Add the transformation that computes the lineage information.
+        Set<String> postExecHooks = Sets.newHashSet(Splitter.on(",").trimResults()
+            .omitEmptyStrings()
+            .split(Strings.nullToEmpty(HiveConf.getVar(conf, HiveConf.ConfVars.POSTEXECHOOKS))));
+        if (postExecHooks.contains("org.apache.hadoop.hive.ql.hooks.PostExecutePrinter")
+            || postExecHooks.contains("org.apache.hadoop.hive.ql.hooks.LineageLogger")
+            || postExecHooks.contains("org.apache.atlas.hive.hook.HiveHook")) {
           ArrayList<Transform> transformations = new ArrayList<Transform>();
           transformations.add(new HiveOpConverterPostProc());
           transformations.add(new Generator());
           for (Transform t : transformations) {
             pCtx = t.transform(pCtx);
           }
+          // we just use view name as location.
+          SessionState.get().getLineageState()
+              .mapDirToOp(new Path(createVwDesc.getViewName()), sinkOp);
         }
         return;
       }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/session/LineageState.java b/ql/src/java/org/apache/hadoop/hive/ql/session/LineageState.java
index 223f0ea929..0f9506376c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/session/LineageState.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/session/LineageState.java
@@ -26,6 +26,7 @@
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.ql.exec.ColumnInfo;
 import org.apache.hadoop.hive.ql.exec.FileSinkOperator;
+import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.hooks.LineageInfo;
 import org.apache.hadoop.hive.ql.hooks.LineageInfo.DataContainer;
 import org.apache.hadoop.hive.ql.optimizer.lineage.LineageCtx.Index;
@@ -38,12 +39,12 @@
 public class LineageState {
 
   /**
-   * Mapping from the directory name to FileSinkOperator. This
+   * Mapping from the directory name to FileSinkOperator (may not be FileSinkOperator for views). This
    * mapping is generated at the filesink operator creation
    * time and is then later used to created the mapping from
    * movetask to the set of filesink operators.
    */
-  private final Map<Path, FileSinkOperator> dirToFop;
+  private final Map<Path, Operator> dirToFop;
 
   /**
    * The lineage context index for this query.
@@ -60,7 +61,7 @@ public class LineageState {
    * Constructor.
    */
   public LineageState() {
-    dirToFop = new HashMap<Path, FileSinkOperator>();
+    dirToFop = new HashMap<Path, Operator>();
     linfo = new LineageInfo();
     index = new Index();
   }
@@ -69,9 +70,9 @@ public LineageState() {
    * Adds a mapping from the load work to the file sink operator.
    *
    * @param dir The directory name.
-   * @param fop The file sink operator.
+   * @param fop The sink operator.
    */
-  public void mapDirToFop(Path dir, FileSinkOperator fop) {
+  public void mapDirToOp(Path dir, Operator fop) {
     dirToFop.put(dir, fop);
   }
 
@@ -85,18 +86,18 @@ public void mapDirToFop(Path dir, FileSinkOperator fop) {
   public void setLineage(Path dir, DataContainer dc,
       List<FieldSchema> cols) {
     // First lookup the file sink operator from the load work.
-    FileSinkOperator fop = dirToFop.get(dir);
+    Operator<?> op = dirToFop.get(dir);
 
     // Go over the associated fields and look up the dependencies
     // by position in the row schema of the filesink operator.
-    if (fop == null) {
+    if (op == null) {
       return;
     }
 
-    List<ColumnInfo> signature = fop.getSchema().getSignature();
+    List<ColumnInfo> signature = op.getSchema().getSignature();
     int i = 0;
     for (FieldSchema fs : cols) {
-      linfo.putDependency(dc, fs, index.getDependency(fop, signature.get(i++)));
+      linfo.putDependency(dc, fs, index.getDependency(op, signature.get(i++)));
     }
   }
 
diff --git a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
index adbc7a83c2..9e074168f5 100644
--- a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
@@ -16,6 +16,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@testViewPart
+POSTHOOK: Lineage: testViewPart.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: ALTER VIEW testViewPart 
 ADD PARTITION (value='val_86') PARTITION (value='val_xyz')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientnegative/alter_view_failure.q.out b/ql/src/test/results/clientnegative/alter_view_failure.q.out
index b1a56b43af..4b318a0902 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx3
+POSTHOOK: Lineage: xxx3.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: xxx3.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/alter_view_failure2.q.out b/ql/src/test/results/clientnegative/alter_view_failure2.q.out
index 755299db36..dfee098fdb 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure2.q.out
@@ -18,4 +18,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx4
+POSTHOOK: Lineage: xxx4.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/alter_view_failure4.q.out b/ql/src/test/results/clientnegative/alter_view_failure4.q.out
index 2efa54c966..7a7def1ffa 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure4.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure4.q.out
@@ -18,4 +18,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx5
+POSTHOOK: Lineage: xxx5.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 FAILED: SemanticException LOCATION clause illegal for view partition
diff --git a/ql/src/test/results/clientnegative/alter_view_failure5.q.out b/ql/src/test/results/clientnegative/alter_view_failure5.q.out
index 2891fb0c97..6629df4c2d 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure5.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure5.q.out
@@ -18,4 +18,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx6
+POSTHOOK: Lineage: xxx6.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 FAILED: ValidationFailureSemanticException Partition spec {v=val_86} contains non-partition columns
diff --git a/ql/src/test/results/clientnegative/alter_view_failure6.q.out b/ql/src/test/results/clientnegative/alter_view_failure6.q.out
index 78416ad545..1ada5472ad 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure6.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure6.q.out
@@ -18,5 +18,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx7
+POSTHOOK: Lineage: xxx7.hr SIMPLE [(srcpart)srcpart.FieldSchema(name:hr, type:string, comment:null), ]
 FAILED: SemanticException Queries against partitioned tables without a partition filter are disabled for safety reasons. If you know what you are doing, please sethive.strict.checks.large.query to false and that hive.mapred.mode is not set to 'strict' to proceed. Note that if you may get errors or incorrect results if you make a mistake while using some of the unsafe features. No partition predicate for Alias "default.xxx7:srcpart" Table "srcpart"
 FAILED: SemanticException [Error 10056]: The query does not reference any valid partition. To run this query, set hive.mapred.mode=nonstrict
diff --git a/ql/src/test/results/clientnegative/alter_view_failure7.q.out b/ql/src/test/results/clientnegative/alter_view_failure7.q.out
index 97d2b83ead..f96f3ccc34 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure7.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure7.q.out
@@ -18,4 +18,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx8
+POSTHOOK: Lineage: xxx8.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 FAILED: ValidationFailureSemanticException partition spec {ds=2011-01-01} doesn't contain all (2) partition columns
diff --git a/ql/src/test/results/clientnegative/alter_view_failure9.q.out b/ql/src/test/results/clientnegative/alter_view_failure9.q.out
index 0afae119f0..85ed74e4b7 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure9.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure9.q.out
@@ -16,4 +16,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx4
+POSTHOOK: Lineage: xxx4.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: xxx4.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/analyze_view.q.out b/ql/src/test/results/clientnegative/analyze_view.q.out
index 95bdde8bb1..f185dcf175 100644
--- a/ql/src/test/results/clientnegative/analyze_view.q.out
+++ b/ql/src/test/results/clientnegative/analyze_view.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@av
+POSTHOOK: Lineage: av.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: av.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException [Error 10091]: ANALYZE is not supported for views
diff --git a/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out b/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
index b1dc96950e..4920517689 100644
--- a/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
+++ b/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
@@ -16,4 +16,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt1
+POSTHOOK: Lineage: vt1.i SIMPLE [(t1)t1.FieldSchema(name:i, type:int, comment:null), ]
 FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation DROPVIEW [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.vt1], [OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.vt1]]
diff --git a/ql/src/test/results/clientnegative/authorization_select_view.q.out b/ql/src/test/results/clientnegative/authorization_select_view.q.out
index 707757e5d8..7e8fa1661e 100644
--- a/ql/src/test/results/clientnegative/authorization_select_view.q.out
+++ b/ql/src/test/results/clientnegative/authorization_select_view.q.out
@@ -16,4 +16,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.i SIMPLE [(t1)t1.FieldSchema(name:i, type:int, comment:null), ]
 FAILED: HiveAccessControlException Permission denied: Principal [name=user1, type=USER] does not have following privileges for operation QUERY [[SELECT] on Object [type=TABLE_OR_VIEW, name=default.v1]]
diff --git a/ql/src/test/results/clientnegative/authorization_view_1.q.out b/ql/src/test/results/clientnegative/authorization_view_1.q.out
index 2a36dc63ec..277726b7b6 100644
--- a/ql/src/test/results/clientnegative/authorization_view_1.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_1.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select(key) on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_2.q.out b/ql/src/test/results/clientnegative/authorization_view_2.q.out
index 099f42d120..2b0f0005d3 100644
--- a/ql/src/test/results/clientnegative/authorization_view_2.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_2.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select(key) on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_3.q.out b/ql/src/test/results/clientnegative/authorization_view_3.q.out
index a43f902888..f414d19277 100644
--- a/ql/src/test/results/clientnegative/authorization_view_3.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_3.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select(key) on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_4.q.out b/ql/src/test/results/clientnegative/authorization_view_4.q.out
index 321450853c..ab49f86516 100644
--- a/ql/src/test/results/clientnegative/authorization_view_4.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_4.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v1 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -30,6 +32,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -40,6 +44,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_5.q.out b/ql/src/test/results/clientnegative/authorization_view_5.q.out
index a185146382..fb98ca3341 100644
--- a/ql/src/test/results/clientnegative/authorization_view_5.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_5.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,4 +34,6 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 Authorization failed:No privilege 'Select' found for inputs { database:default, table:v2, columnName:key}. Use SHOW GRANT to get more details.
diff --git a/ql/src/test/results/clientnegative/authorization_view_6.q.out b/ql/src/test/results/clientnegative/authorization_view_6.q.out
index d3e73780c2..b373c59bf1 100644
--- a/ql/src/test/results/clientnegative/authorization_view_6.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_6.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientnegative/authorization_view_7.q.out b/ql/src/test/results/clientnegative/authorization_view_7.q.out
index 98186f0e69..c405a9a788 100644
--- a/ql/src/test/results/clientnegative/authorization_view_7.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_7.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_1.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_1.q.out
index 2a36dc63ec..277726b7b6 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_1.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_1.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select(key) on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_2.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_2.q.out
index 099f42d120..2b0f0005d3 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_2.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_2.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select(key) on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_3.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_3.q.out
index a43f902888..f414d19277 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_3.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_3.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select(key) on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_4.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_4.q.out
index 321450853c..ab49f86516 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_4.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_4.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v1 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -30,6 +32,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -40,6 +44,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_5.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_5.q.out
index a185146382..fb98ca3341 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_5.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_5.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,4 +34,6 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 Authorization failed:No privilege 'Select' found for inputs { database:default, table:v2, columnName:key}. Use SHOW GRANT to get more details.
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_6.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_6.q.out
index d3e73780c2..b373c59bf1 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_6.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_6.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_7.q.out b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_7.q.out
index 98186f0e69..c405a9a788 100644
--- a/ql/src/test/results/clientnegative/authorization_view_disable_cbo_7.q.out
+++ b/ql/src/test/results/clientnegative/authorization_view_disable_cbo_7.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view1.q.out b/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
index 9ec57e30de..4610ff3333 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
@@ -12,6 +12,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: alter view v add partition (ds='1',hr='2')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view2.q.out b/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
index 9ec57e30de..4610ff3333 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
@@ -12,6 +12,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: alter view v add partition (ds='1',hr='2')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view4.q.out b/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
index 71a3d80772..b83939fce1 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException [Error 10092]: At least one non-partitioning column must be present in view
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view5.q.out b/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
index 669a2287a9..6d8df2b3a0 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException Can't combine IF NOT EXISTS and OR REPLACE.
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view6.q.out b/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
index a5702abd06..a4b3d38648 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: ParseException line 2:52 cannot recognize input near 'blah' '<EOF>' '<EOF>' in create view statement
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view7.q.out b/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
index 2d73a1fd4c..7cea130c0d 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
@@ -12,6 +12,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view v2 partitioned on (ds, hr) as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
@@ -24,6 +26,8 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view v3 partitioned on (ds, hr) as select * from v2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
@@ -38,4 +42,6 @@ POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v3
+POSTHOOK: Lineage: v3.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v3.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException Recursive view default.v1 detected (cycle: default.v1 -> default.v3 -> default.v2 -> default.v1).
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view8.q.out b/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
index 2d8d5b01a9..20b979b1e2 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException Recursive view default.v1 detected (cycle: default.v1 -> default.v1).
diff --git a/ql/src/test/results/clientnegative/create_view_failure2.q.out b/ql/src/test/results/clientnegative/create_view_failure2.q.out
index 58da497283..3342a23eff 100644
--- a/ql/src/test/results/clientnegative/create_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure2.q.out
@@ -12,6 +12,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx4
+POSTHOOK: Lineage: xxx4.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: CREATE TABLE xxx4(key int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/drop_table_failure2.q.out b/ql/src/test/results/clientnegative/drop_table_failure2.q.out
index bcb4bfe518..f0097cda17 100644
--- a/ql/src/test/results/clientnegative/drop_table_failure2.q.out
+++ b/ql/src/test/results/clientnegative/drop_table_failure2.q.out
@@ -8,6 +8,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx6
+POSTHOOK: Lineage: xxx6.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DROP TABLE xxx6
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@xxx6
diff --git a/ql/src/test/results/clientnegative/insert_view_failure.q.out b/ql/src/test/results/clientnegative/insert_view_failure.q.out
index 7bc52cbab1..6bbaa10077 100644
--- a/ql/src/test/results/clientnegative/insert_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/insert_view_failure.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx2
+POSTHOOK: Lineage: xxx2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: xxx2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/invalidate_view1.q.out b/ql/src/test/results/clientnegative/invalidate_view1.q.out
index 2da46bbdfa..16e517376f 100644
--- a/ql/src/test/results/clientnegative/invalidate_view1.q.out
+++ b/ql/src/test/results/clientnegative/invalidate_view1.q.out
@@ -24,6 +24,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@xxx10
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx9
+POSTHOOK: Lineage: xxx9.key SIMPLE [(xxx10)xxx10.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: xxx9.value SIMPLE [(xxx10)xxx10.FieldSchema(name:value, type:int, comment:null), ]
 PREHOOK: query: CREATE VIEW xxx8 AS SELECT * FROM xxx9 xxx
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@xxx10
@@ -36,6 +38,8 @@ POSTHOOK: Input: default@xxx10
 POSTHOOK: Input: default@xxx9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx8
+POSTHOOK: Lineage: xxx8.key SIMPLE [(xxx10)xxx10.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: xxx8.value SIMPLE [(xxx10)xxx10.FieldSchema(name:value, type:int, comment:null), ]
 PREHOOK: query: ALTER TABLE xxx10 REPLACE COLUMNS (key int)
 PREHOOK: type: ALTERTABLE_REPLACECOLS
 PREHOOK: Input: default@xxx10
diff --git a/ql/src/test/results/clientnegative/load_view_failure.q.out b/ql/src/test/results/clientnegative/load_view_failure.q.out
index ba1e507045..23b3bfccd3 100644
--- a/ql/src/test/results/clientnegative/load_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/load_view_failure.q.out
@@ -12,4 +12,6 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xxx11
+POSTHOOK: Lineage: xxx11.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: xxx11.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/recursive_view.q.out b/ql/src/test/results/clientnegative/recursive_view.q.out
index ca785f1dfa..75c37a5130 100644
--- a/ql/src/test/results/clientnegative/recursive_view.q.out
+++ b/ql/src/test/results/clientnegative/recursive_view.q.out
@@ -36,6 +36,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r0
+POSTHOOK: Lineage: r0.id SIMPLE [(t)t.FieldSchema(name:id, type:int, comment:null), ]
 PREHOOK: query: create view r1 as select * from r0
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
@@ -48,6 +49,7 @@ POSTHOOK: Input: default@r0
 POSTHOOK: Input: default@t
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r1
+POSTHOOK: Lineage: r1.id SIMPLE [(t)t.FieldSchema(name:id, type:int, comment:null), ]
 PREHOOK: query: create view r2 as select * from r1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
@@ -62,6 +64,7 @@ POSTHOOK: Input: default@r1
 POSTHOOK: Input: default@t
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r2
+POSTHOOK: Lineage: r2.id SIMPLE [(t)t.FieldSchema(name:id, type:int, comment:null), ]
 PREHOOK: query: create view r3 as select * from r2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
@@ -78,6 +81,7 @@ POSTHOOK: Input: default@r2
 POSTHOOK: Input: default@t
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@r3
+POSTHOOK: Lineage: r3.id SIMPLE [(t)t.FieldSchema(name:id, type:int, comment:null), ]
 PREHOOK: query: drop view r0
 PREHOOK: type: DROPVIEW
 PREHOOK: Input: default@r0
diff --git a/ql/src/test/results/clientnegative/unset_view_property.q.out b/ql/src/test/results/clientnegative/unset_view_property.q.out
index 4c94e25603..ae7f4f6270 100644
--- a/ql/src/test/results/clientnegative/unset_view_property.q.out
+++ b/ql/src/test/results/clientnegative/unset_view_property.q.out
@@ -8,6 +8,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@testView
+POSTHOOK: Lineage: testView.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: ALTER VIEW testView SET TBLPROPERTIES ('propA'='100', 'propB'='200')
 PREHOOK: type: ALTERVIEW_PROPERTIES
 PREHOOK: Input: default@testview
diff --git a/ql/src/test/results/clientnegative/view_delete.q.out b/ql/src/test/results/clientnegative/view_delete.q.out
index 24e7ba57d0..29f4a5f275 100644
--- a/ql/src/test/results/clientnegative/view_delete.q.out
+++ b/ql/src/test/results/clientnegative/view_delete.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@dv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dv_view
+POSTHOOK: Lineage: dv_view.a SIMPLE [(dv_basetable)dv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: dv_view.b SIMPLE [(dv_basetable)dv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: dv_view.c SIMPLE [(dv_basetable)dv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10402]: You cannot update or delete records in a view
diff --git a/ql/src/test/results/clientnegative/view_update.q.out b/ql/src/test/results/clientnegative/view_update.q.out
index aaee442632..a33fdf7642 100644
--- a/ql/src/test/results/clientnegative/view_update.q.out
+++ b/ql/src/test/results/clientnegative/view_update.q.out
@@ -16,4 +16,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@uv_basetable
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@uv_view
+POSTHOOK: Lineage: uv_view.a SIMPLE [(uv_basetable)uv_basetable.FieldSchema(name:a, type:int, comment:null), ]
+POSTHOOK: Lineage: uv_view.b SIMPLE [(uv_basetable)uv_basetable.FieldSchema(name:b, type:varchar(256), comment:null), ]
+POSTHOOK: Lineage: uv_view.c SIMPLE [(uv_basetable)uv_basetable.FieldSchema(name:c, type:decimal(10,2), comment:null), ]
 FAILED: SemanticException [Error 10402]: You cannot update or delete records in a view
diff --git a/ql/src/test/results/clientpositive/alter_view_as_select.q.out b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
index 9cbaa24987..4eddf9404b 100644
--- a/ql/src/test/results/clientpositive/alter_view_as_select.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
@@ -14,6 +14,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:tv
 POSTHOOK: Output: tv@testView
+POSTHOOK: Lineage: testView.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: testView.hr SIMPLE [(srcpart)srcpart.FieldSchema(name:hr, type:string, comment:null), ]
+POSTHOOK: Lineage: testView.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: testView.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tv.testView
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: tv@testview
diff --git a/ql/src/test/results/clientpositive/alter_view_rename.q.out b/ql/src/test/results/clientpositive/alter_view_rename.q.out
index 300b96c685..307c0f6b12 100644
--- a/ql/src/test/results/clientpositive/alter_view_rename.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_rename.q.out
@@ -28,6 +28,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@invites
 POSTHOOK: Output: database:tv1
 POSTHOOK: Output: tv1@view1
+POSTHOOK: Lineage: view1.bar SIMPLE [(invites)invites.FieldSchema(name:bar, type:string, comment:null), ]
+POSTHOOK: Lineage: view1.ds SIMPLE [(invites)invites.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: view1.foo SIMPLE [(invites)invites.FieldSchema(name:foo, type:int, comment:null), ]
 PREHOOK: query: DESCRIBE EXTENDED tv1.view1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: tv1@view1
diff --git a/ql/src/test/results/clientpositive/authorization_8.q.out b/ql/src/test/results/clientpositive/authorization_8.q.out
index 9fed5dcb9d..eef461150e 100644
--- a/ql/src/test/results/clientpositive/authorization_8.q.out
+++ b/ql/src/test/results/clientpositive/authorization_8.q.out
@@ -20,6 +20,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@tbl_j5jbymsx8e
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_j5jbymsx8e_1
+POSTHOOK: Lineage: view_j5jbymsx8e_1.ds SIMPLE [(tbl_j5jbymsx8e)tbl_j5jbymsx8e.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: view_j5jbymsx8e_1.key SIMPLE [(tbl_j5jbymsx8e)tbl_j5jbymsx8e.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: view_j5jbymsx8e_1.value SIMPLE [(tbl_j5jbymsx8e)tbl_j5jbymsx8e.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE view_j5jbymsx8e_1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view_j5jbymsx8e_1
diff --git a/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out b/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out
index 79456ce581..eeebc85b0e 100644
--- a/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out
+++ b/ql/src/test/results/clientpositive/authorization_cli_createtab.q.out
@@ -24,6 +24,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t_cli
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v_cli
+POSTHOOK: Lineage: v_cli.i SIMPLE [(t_cli)t_cli.FieldSchema(name:i, type:int, comment:null), ]
 PREHOOK: query: show grant user hive_test_user on v_cli
 PREHOOK: type: SHOW_GRANT
 POSTHOOK: query: show grant user hive_test_user on v_cli
diff --git a/ql/src/test/results/clientpositive/authorization_cli_createtab_noauthzapi.q.out b/ql/src/test/results/clientpositive/authorization_cli_createtab_noauthzapi.q.out
index 7c8909afc9..d5a79c656e 100644
--- a/ql/src/test/results/clientpositive/authorization_cli_createtab_noauthzapi.q.out
+++ b/ql/src/test/results/clientpositive/authorization_cli_createtab_noauthzapi.q.out
@@ -16,3 +16,4 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t_cli
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v_cli
+POSTHOOK: Lineage: v_cli.i SIMPLE [(t_cli)t_cli.FieldSchema(name:i, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/authorization_owner_actions.q.out b/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
index 5edce56606..779c3babf8 100644
--- a/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
+++ b/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
@@ -40,6 +40,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt1
+POSTHOOK: Lineage: vt1.i SIMPLE [(t1)t1.FieldSchema(name:i, type:int, comment:null), ]
 PREHOOK: query: drop view vt1
 PREHOOK: type: DROPVIEW
 PREHOOK: Input: default@vt1
diff --git a/ql/src/test/results/clientpositive/authorization_view_1.q.out b/ql/src/test/results/clientpositive/authorization_view_1.q.out
index 89adf19d4b..31cc0c8888 100644
--- a/ql/src/test/results/clientpositive/authorization_view_1.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_1.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v1 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -30,6 +32,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -40,6 +44,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientpositive/authorization_view_2.q.out b/ql/src/test/results/clientpositive/authorization_view_2.q.out
index 9f909be95a..e4dd0597b0 100644
--- a/ql/src/test/results/clientpositive/authorization_view_2.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_2.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientpositive/authorization_view_3.q.out b/ql/src/test/results/clientpositive/authorization_view_3.q.out
index c9334e302b..b2d3b1f9b1 100644
--- a/ql/src/test/results/clientpositive/authorization_view_3.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_3.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientpositive/authorization_view_4.q.out b/ql/src/test/results/clientpositive/authorization_view_4.q.out
index 68fdfb6d30..c832f110a9 100644
--- a/ql/src/test/results/clientpositive/authorization_view_4.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_4.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_1.q.out b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_1.q.out
index 8395782bdc..edc0d89773 100644
--- a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_1.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_1.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v1 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -30,6 +32,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from src_autho_test
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -40,6 +44,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table src_autho_test to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@src_autho_test
diff --git a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_2.q.out b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_2.q.out
index 9f909be95a..e4dd0597b0 100644
--- a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_2.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_2.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_3.q.out b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_3.q.out
index c9334e302b..b2d3b1f9b1 100644
--- a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_3.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_3.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src_autho_test
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src_autho_test
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src_autho_test)src_autho_test.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_4.q.out b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_4.q.out
index 68fdfb6d30..c832f110a9 100644
--- a/ql/src/test/results/clientpositive/authorization_view_disable_cbo_4.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_disable_cbo_4.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view v2 as select * from v1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -32,6 +34,8 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: grant select on table v2 to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 PREHOOK: Output: default@v2
diff --git a/ql/src/test/results/clientpositive/cbo_const.q.out b/ql/src/test/results/clientpositive/cbo_const.q.out
index ecf0269605..07a89e5f7d 100644
--- a/ql/src/test/results/clientpositive/cbo_const.q.out
+++ b/ql/src/test/results/clientpositive/cbo_const.q.out
@@ -91,6 +91,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1_new
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
+POSTHOOK: Lineage: t1.key EXPRESSION [(t1_new)t1_new.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: t1.value EXPRESSION [(t1_new)t1_new.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select * from t1 where ds = '2011-10-15'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
diff --git a/ql/src/test/results/clientpositive/cbo_subq_exists.q.out b/ql/src/test/results/clientpositive/cbo_subq_exists.q.out
index 45f4524eea..06dbd30339 100644
--- a/ql/src/test/results/clientpositive/cbo_subq_exists.q.out
+++ b/ql/src/test/results/clientpositive/cbo_subq_exists.q.out
@@ -195,6 +195,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_cbo
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src_cbo)b.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src_cbo)b.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
diff --git a/ql/src/test/results/clientpositive/cbo_union_view.q.out b/ql/src/test/results/clientpositive/cbo_union_view.q.out
index d179c284a0..c8504a1ddd 100644
--- a/ql/src/test/results/clientpositive/cbo_union_view.q.out
+++ b/ql/src/test/results/clientpositive/cbo_union_view.q.out
@@ -50,6 +50,8 @@ POSTHOOK: Input: default@src_union_2
 POSTHOOK: Input: default@src_union_3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_union_view
+POSTHOOK: Lineage: src_union_view.key EXPRESSION [(src_union_1)src_union_1.FieldSchema(name:key, type:int, comment:null), (src_union_2)src_union_2.FieldSchema(name:key, type:int, comment:null), (src_union_3)src_union_3.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: src_union_view.value EXPRESSION [(src_union_1)src_union_1.FieldSchema(name:value, type:string, comment:null), (src_union_2)src_union_2.FieldSchema(name:value, type:string, comment:null), (src_union_3)src_union_3.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: EXPLAIN SELECT key, value, ds FROM src_union_view WHERE key=86
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT key, value, ds FROM src_union_view WHERE key=86
diff --git a/ql/src/test/results/clientpositive/concat_op.q.out b/ql/src/test/results/clientpositive/concat_op.q.out
index 6afefae1e1..e7fad1f7bd 100644
--- a/ql/src/test/results/clientpositive/concat_op.q.out
+++ b/ql/src/test/results/clientpositive/concat_op.q.out
@@ -172,6 +172,7 @@ POSTHOOK: Input: default@ct1
 POSTHOOK: Input: default@ct2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ct_v1
+POSTHOOK: Lineage: ct_v1.c EXPRESSION [(ct1)ct1.FieldSchema(name:c, type:int, comment:null), (ct2)ct2.FieldSchema(name:c, type:int, comment:null), ]
 PREHOOK: query: select c,c * c + c || 'x', 'c+c=' || c+c || ', c*c=' || c*c || ', (c&c)=' || (c & c) from ct_v1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@ct1
diff --git a/ql/src/test/results/clientpositive/create_big_view.q.out b/ql/src/test/results/clientpositive/create_big_view.q.out
index 08f4c870ba..e5609e5eae 100644
--- a/ql/src/test/results/clientpositive/create_big_view.q.out
+++ b/ql/src/test/results/clientpositive/create_big_view.q.out
@@ -484,6 +484,241 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@big_view
+POSTHOOK: Lineage: big_view._c1 SIMPLE []
+POSTHOOK: Lineage: big_view._c10 SIMPLE []
+POSTHOOK: Lineage: big_view._c100 SIMPLE []
+POSTHOOK: Lineage: big_view._c101 SIMPLE []
+POSTHOOK: Lineage: big_view._c102 SIMPLE []
+POSTHOOK: Lineage: big_view._c103 SIMPLE []
+POSTHOOK: Lineage: big_view._c104 SIMPLE []
+POSTHOOK: Lineage: big_view._c105 SIMPLE []
+POSTHOOK: Lineage: big_view._c106 SIMPLE []
+POSTHOOK: Lineage: big_view._c107 SIMPLE []
+POSTHOOK: Lineage: big_view._c108 SIMPLE []
+POSTHOOK: Lineage: big_view._c109 SIMPLE []
+POSTHOOK: Lineage: big_view._c11 SIMPLE []
+POSTHOOK: Lineage: big_view._c110 SIMPLE []
+POSTHOOK: Lineage: big_view._c111 SIMPLE []
+POSTHOOK: Lineage: big_view._c112 SIMPLE []
+POSTHOOK: Lineage: big_view._c113 SIMPLE []
+POSTHOOK: Lineage: big_view._c114 SIMPLE []
+POSTHOOK: Lineage: big_view._c115 SIMPLE []
+POSTHOOK: Lineage: big_view._c116 SIMPLE []
+POSTHOOK: Lineage: big_view._c117 SIMPLE []
+POSTHOOK: Lineage: big_view._c118 SIMPLE []
+POSTHOOK: Lineage: big_view._c119 SIMPLE []
+POSTHOOK: Lineage: big_view._c12 SIMPLE []
+POSTHOOK: Lineage: big_view._c120 SIMPLE []
+POSTHOOK: Lineage: big_view._c121 SIMPLE []
+POSTHOOK: Lineage: big_view._c122 SIMPLE []
+POSTHOOK: Lineage: big_view._c123 SIMPLE []
+POSTHOOK: Lineage: big_view._c124 SIMPLE []
+POSTHOOK: Lineage: big_view._c125 SIMPLE []
+POSTHOOK: Lineage: big_view._c126 SIMPLE []
+POSTHOOK: Lineage: big_view._c127 SIMPLE []
+POSTHOOK: Lineage: big_view._c128 SIMPLE []
+POSTHOOK: Lineage: big_view._c129 SIMPLE []
+POSTHOOK: Lineage: big_view._c13 SIMPLE []
+POSTHOOK: Lineage: big_view._c130 SIMPLE []
+POSTHOOK: Lineage: big_view._c131 SIMPLE []
+POSTHOOK: Lineage: big_view._c132 SIMPLE []
+POSTHOOK: Lineage: big_view._c133 SIMPLE []
+POSTHOOK: Lineage: big_view._c134 SIMPLE []
+POSTHOOK: Lineage: big_view._c135 SIMPLE []
+POSTHOOK: Lineage: big_view._c136 SIMPLE []
+POSTHOOK: Lineage: big_view._c137 SIMPLE []
+POSTHOOK: Lineage: big_view._c138 SIMPLE []
+POSTHOOK: Lineage: big_view._c139 SIMPLE []
+POSTHOOK: Lineage: big_view._c14 SIMPLE []
+POSTHOOK: Lineage: big_view._c140 SIMPLE []
+POSTHOOK: Lineage: big_view._c141 SIMPLE []
+POSTHOOK: Lineage: big_view._c142 SIMPLE []
+POSTHOOK: Lineage: big_view._c143 SIMPLE []
+POSTHOOK: Lineage: big_view._c144 SIMPLE []
+POSTHOOK: Lineage: big_view._c145 SIMPLE []
+POSTHOOK: Lineage: big_view._c146 SIMPLE []
+POSTHOOK: Lineage: big_view._c147 SIMPLE []
+POSTHOOK: Lineage: big_view._c148 SIMPLE []
+POSTHOOK: Lineage: big_view._c149 SIMPLE []
+POSTHOOK: Lineage: big_view._c15 SIMPLE []
+POSTHOOK: Lineage: big_view._c150 SIMPLE []
+POSTHOOK: Lineage: big_view._c151 SIMPLE []
+POSTHOOK: Lineage: big_view._c152 SIMPLE []
+POSTHOOK: Lineage: big_view._c153 SIMPLE []
+POSTHOOK: Lineage: big_view._c154 SIMPLE []
+POSTHOOK: Lineage: big_view._c155 SIMPLE []
+POSTHOOK: Lineage: big_view._c156 SIMPLE []
+POSTHOOK: Lineage: big_view._c157 SIMPLE []
+POSTHOOK: Lineage: big_view._c158 SIMPLE []
+POSTHOOK: Lineage: big_view._c159 SIMPLE []
+POSTHOOK: Lineage: big_view._c16 SIMPLE []
+POSTHOOK: Lineage: big_view._c160 SIMPLE []
+POSTHOOK: Lineage: big_view._c161 SIMPLE []
+POSTHOOK: Lineage: big_view._c162 SIMPLE []
+POSTHOOK: Lineage: big_view._c163 SIMPLE []
+POSTHOOK: Lineage: big_view._c164 SIMPLE []
+POSTHOOK: Lineage: big_view._c165 SIMPLE []
+POSTHOOK: Lineage: big_view._c166 SIMPLE []
+POSTHOOK: Lineage: big_view._c167 SIMPLE []
+POSTHOOK: Lineage: big_view._c168 SIMPLE []
+POSTHOOK: Lineage: big_view._c169 SIMPLE []
+POSTHOOK: Lineage: big_view._c17 SIMPLE []
+POSTHOOK: Lineage: big_view._c170 SIMPLE []
+POSTHOOK: Lineage: big_view._c171 SIMPLE []
+POSTHOOK: Lineage: big_view._c172 SIMPLE []
+POSTHOOK: Lineage: big_view._c173 SIMPLE []
+POSTHOOK: Lineage: big_view._c174 SIMPLE []
+POSTHOOK: Lineage: big_view._c175 SIMPLE []
+POSTHOOK: Lineage: big_view._c176 SIMPLE []
+POSTHOOK: Lineage: big_view._c177 SIMPLE []
+POSTHOOK: Lineage: big_view._c178 SIMPLE []
+POSTHOOK: Lineage: big_view._c179 SIMPLE []
+POSTHOOK: Lineage: big_view._c18 SIMPLE []
+POSTHOOK: Lineage: big_view._c180 SIMPLE []
+POSTHOOK: Lineage: big_view._c181 SIMPLE []
+POSTHOOK: Lineage: big_view._c182 SIMPLE []
+POSTHOOK: Lineage: big_view._c183 SIMPLE []
+POSTHOOK: Lineage: big_view._c184 SIMPLE []
+POSTHOOK: Lineage: big_view._c185 SIMPLE []
+POSTHOOK: Lineage: big_view._c186 SIMPLE []
+POSTHOOK: Lineage: big_view._c187 SIMPLE []
+POSTHOOK: Lineage: big_view._c188 SIMPLE []
+POSTHOOK: Lineage: big_view._c189 SIMPLE []
+POSTHOOK: Lineage: big_view._c19 SIMPLE []
+POSTHOOK: Lineage: big_view._c190 SIMPLE []
+POSTHOOK: Lineage: big_view._c191 SIMPLE []
+POSTHOOK: Lineage: big_view._c192 SIMPLE []
+POSTHOOK: Lineage: big_view._c193 SIMPLE []
+POSTHOOK: Lineage: big_view._c194 SIMPLE []
+POSTHOOK: Lineage: big_view._c195 SIMPLE []
+POSTHOOK: Lineage: big_view._c196 SIMPLE []
+POSTHOOK: Lineage: big_view._c197 SIMPLE []
+POSTHOOK: Lineage: big_view._c198 SIMPLE []
+POSTHOOK: Lineage: big_view._c199 SIMPLE []
+POSTHOOK: Lineage: big_view._c2 SIMPLE []
+POSTHOOK: Lineage: big_view._c20 SIMPLE []
+POSTHOOK: Lineage: big_view._c200 SIMPLE []
+POSTHOOK: Lineage: big_view._c201 SIMPLE []
+POSTHOOK: Lineage: big_view._c202 SIMPLE []
+POSTHOOK: Lineage: big_view._c203 SIMPLE []
+POSTHOOK: Lineage: big_view._c204 SIMPLE []
+POSTHOOK: Lineage: big_view._c205 SIMPLE []
+POSTHOOK: Lineage: big_view._c206 SIMPLE []
+POSTHOOK: Lineage: big_view._c207 SIMPLE []
+POSTHOOK: Lineage: big_view._c208 SIMPLE []
+POSTHOOK: Lineage: big_view._c209 SIMPLE []
+POSTHOOK: Lineage: big_view._c21 SIMPLE []
+POSTHOOK: Lineage: big_view._c210 SIMPLE []
+POSTHOOK: Lineage: big_view._c211 SIMPLE []
+POSTHOOK: Lineage: big_view._c212 SIMPLE []
+POSTHOOK: Lineage: big_view._c213 SIMPLE []
+POSTHOOK: Lineage: big_view._c214 SIMPLE []
+POSTHOOK: Lineage: big_view._c215 SIMPLE []
+POSTHOOK: Lineage: big_view._c216 SIMPLE []
+POSTHOOK: Lineage: big_view._c217 SIMPLE []
+POSTHOOK: Lineage: big_view._c218 SIMPLE []
+POSTHOOK: Lineage: big_view._c219 SIMPLE []
+POSTHOOK: Lineage: big_view._c22 SIMPLE []
+POSTHOOK: Lineage: big_view._c220 SIMPLE []
+POSTHOOK: Lineage: big_view._c221 SIMPLE []
+POSTHOOK: Lineage: big_view._c222 SIMPLE []
+POSTHOOK: Lineage: big_view._c223 SIMPLE []
+POSTHOOK: Lineage: big_view._c224 SIMPLE []
+POSTHOOK: Lineage: big_view._c225 SIMPLE []
+POSTHOOK: Lineage: big_view._c226 SIMPLE []
+POSTHOOK: Lineage: big_view._c227 SIMPLE []
+POSTHOOK: Lineage: big_view._c228 SIMPLE []
+POSTHOOK: Lineage: big_view._c229 SIMPLE []
+POSTHOOK: Lineage: big_view._c23 SIMPLE []
+POSTHOOK: Lineage: big_view._c230 SIMPLE []
+POSTHOOK: Lineage: big_view._c231 SIMPLE []
+POSTHOOK: Lineage: big_view._c232 SIMPLE []
+POSTHOOK: Lineage: big_view._c233 SIMPLE []
+POSTHOOK: Lineage: big_view._c234 SIMPLE []
+POSTHOOK: Lineage: big_view._c24 SIMPLE []
+POSTHOOK: Lineage: big_view._c25 SIMPLE []
+POSTHOOK: Lineage: big_view._c26 SIMPLE []
+POSTHOOK: Lineage: big_view._c27 SIMPLE []
+POSTHOOK: Lineage: big_view._c28 SIMPLE []
+POSTHOOK: Lineage: big_view._c29 SIMPLE []
+POSTHOOK: Lineage: big_view._c3 SIMPLE []
+POSTHOOK: Lineage: big_view._c30 SIMPLE []
+POSTHOOK: Lineage: big_view._c31 SIMPLE []
+POSTHOOK: Lineage: big_view._c32 SIMPLE []
+POSTHOOK: Lineage: big_view._c33 SIMPLE []
+POSTHOOK: Lineage: big_view._c34 SIMPLE []
+POSTHOOK: Lineage: big_view._c35 SIMPLE []
+POSTHOOK: Lineage: big_view._c36 SIMPLE []
+POSTHOOK: Lineage: big_view._c37 SIMPLE []
+POSTHOOK: Lineage: big_view._c38 SIMPLE []
+POSTHOOK: Lineage: big_view._c39 SIMPLE []
+POSTHOOK: Lineage: big_view._c4 SIMPLE []
+POSTHOOK: Lineage: big_view._c40 SIMPLE []
+POSTHOOK: Lineage: big_view._c41 SIMPLE []
+POSTHOOK: Lineage: big_view._c42 SIMPLE []
+POSTHOOK: Lineage: big_view._c43 SIMPLE []
+POSTHOOK: Lineage: big_view._c44 SIMPLE []
+POSTHOOK: Lineage: big_view._c45 SIMPLE []
+POSTHOOK: Lineage: big_view._c46 SIMPLE []
+POSTHOOK: Lineage: big_view._c47 SIMPLE []
+POSTHOOK: Lineage: big_view._c48 SIMPLE []
+POSTHOOK: Lineage: big_view._c49 SIMPLE []
+POSTHOOK: Lineage: big_view._c5 SIMPLE []
+POSTHOOK: Lineage: big_view._c50 SIMPLE []
+POSTHOOK: Lineage: big_view._c51 SIMPLE []
+POSTHOOK: Lineage: big_view._c52 SIMPLE []
+POSTHOOK: Lineage: big_view._c53 SIMPLE []
+POSTHOOK: Lineage: big_view._c54 SIMPLE []
+POSTHOOK: Lineage: big_view._c55 SIMPLE []
+POSTHOOK: Lineage: big_view._c56 SIMPLE []
+POSTHOOK: Lineage: big_view._c57 SIMPLE []
+POSTHOOK: Lineage: big_view._c58 SIMPLE []
+POSTHOOK: Lineage: big_view._c59 SIMPLE []
+POSTHOOK: Lineage: big_view._c6 SIMPLE []
+POSTHOOK: Lineage: big_view._c60 SIMPLE []
+POSTHOOK: Lineage: big_view._c61 SIMPLE []
+POSTHOOK: Lineage: big_view._c62 SIMPLE []
+POSTHOOK: Lineage: big_view._c63 SIMPLE []
+POSTHOOK: Lineage: big_view._c64 SIMPLE []
+POSTHOOK: Lineage: big_view._c65 SIMPLE []
+POSTHOOK: Lineage: big_view._c66 SIMPLE []
+POSTHOOK: Lineage: big_view._c67 SIMPLE []
+POSTHOOK: Lineage: big_view._c68 SIMPLE []
+POSTHOOK: Lineage: big_view._c69 SIMPLE []
+POSTHOOK: Lineage: big_view._c7 SIMPLE []
+POSTHOOK: Lineage: big_view._c70 SIMPLE []
+POSTHOOK: Lineage: big_view._c71 SIMPLE []
+POSTHOOK: Lineage: big_view._c72 SIMPLE []
+POSTHOOK: Lineage: big_view._c73 SIMPLE []
+POSTHOOK: Lineage: big_view._c74 SIMPLE []
+POSTHOOK: Lineage: big_view._c75 SIMPLE []
+POSTHOOK: Lineage: big_view._c76 SIMPLE []
+POSTHOOK: Lineage: big_view._c77 SIMPLE []
+POSTHOOK: Lineage: big_view._c78 SIMPLE []
+POSTHOOK: Lineage: big_view._c79 SIMPLE []
+POSTHOOK: Lineage: big_view._c8 SIMPLE []
+POSTHOOK: Lineage: big_view._c80 SIMPLE []
+POSTHOOK: Lineage: big_view._c81 SIMPLE []
+POSTHOOK: Lineage: big_view._c82 SIMPLE []
+POSTHOOK: Lineage: big_view._c83 SIMPLE []
+POSTHOOK: Lineage: big_view._c84 SIMPLE []
+POSTHOOK: Lineage: big_view._c85 SIMPLE []
+POSTHOOK: Lineage: big_view._c86 SIMPLE []
+POSTHOOK: Lineage: big_view._c87 SIMPLE []
+POSTHOOK: Lineage: big_view._c88 SIMPLE []
+POSTHOOK: Lineage: big_view._c89 SIMPLE []
+POSTHOOK: Lineage: big_view._c9 SIMPLE []
+POSTHOOK: Lineage: big_view._c90 SIMPLE []
+POSTHOOK: Lineage: big_view._c91 SIMPLE []
+POSTHOOK: Lineage: big_view._c92 SIMPLE []
+POSTHOOK: Lineage: big_view._c93 SIMPLE []
+POSTHOOK: Lineage: big_view._c94 SIMPLE []
+POSTHOOK: Lineage: big_view._c95 SIMPLE []
+POSTHOOK: Lineage: big_view._c96 SIMPLE []
+POSTHOOK: Lineage: big_view._c97 SIMPLE []
+POSTHOOK: Lineage: big_view._c98 SIMPLE []
+POSTHOOK: Lineage: big_view._c99 SIMPLE []
+POSTHOOK: Lineage: big_view.a SIMPLE []
 PREHOOK: query: SELECT a FROM big_view
 LIMIT 1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
index bef54a89b1..19459fbcd1 100644
--- a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
@@ -186,6 +186,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_view
+POSTHOOK: Lineage: test_view.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: test_view.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE TABLE test_table4 LIKE test_view TBLPROPERTIES('key'='value')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_like_view.q.out b/ql/src/test/results/clientpositive/create_like_view.q.out
index c1b5c7e1c6..9e6dcd178c 100644
--- a/ql/src/test/results/clientpositive/create_like_view.q.out
+++ b/ql/src/test/results/clientpositive/create_like_view.q.out
@@ -75,6 +75,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view1
+POSTHOOK: Lineage: view1.a SIMPLE [(table1)table1.FieldSchema(name:a, type:string, comment:null), ]
+POSTHOOK: Lineage: view1.b SIMPLE [(table1)table1.FieldSchema(name:b, type:string, comment:null), ]
 PREHOOK: query: CREATE TABLE table2 LIKE view1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
@@ -259,6 +261,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view1
+POSTHOOK: Lineage: view1.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view1.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create table table1 like view1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_or_replace_view.q.out b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
index 2ad6b47c3a..98e0ca2212 100644
--- a/ql/src/test/results/clientpositive/create_or_replace_view.q.out
+++ b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
@@ -14,6 +14,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
+POSTHOOK: Lineage: v.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: v.hr SIMPLE [(srcpart)srcpart.FieldSchema(name:hr, type:string, comment:null), ]
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted vt.v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: vt@v
@@ -330,6 +334,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart_temp
 POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@v
+POSTHOOK: Lineage: v.key SIMPLE [(srcpart_temp)srcpart_temp.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(srcpart_temp)srcpart_temp.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: drop table srcpart_temp
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@srcpart_temp
diff --git a/ql/src/test/results/clientpositive/create_view.q.out b/ql/src/test/results/clientpositive/create_view.q.out
index a7f32293e7..7deac3e044 100644
--- a/ql/src/test/results/clientpositive/create_view.q.out
+++ b/ql/src/test/results/clientpositive/create_view.q.out
@@ -93,6 +93,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view1
+POSTHOOK: Lineage: view1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW view2 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -103,6 +104,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view2
+POSTHOOK: Lineage: view2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW view3(valoo) 
 TBLPROPERTIES ("fear" = "factor")
 AS SELECT upper(value) FROM src WHERE key=86
@@ -117,6 +120,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view3
+POSTHOOK: Lineage: view3.valoo EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: SELECT * from view1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -479,6 +483,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view4
+POSTHOOK: Lineage: view4.key SIMPLE [(table1)table1.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: SELECT * FROM view4
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table1
@@ -554,6 +559,8 @@ POSTHOOK: Input: default@table1
 POSTHOOK: Input: default@view4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view5
+POSTHOOK: Lineage: view5.key1 SIMPLE [(table1)table1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: view5.key2 SIMPLE [(table1)table1.FieldSchema(name:key, type:int, comment:null), ]
 Warning: Shuffle Join JOIN[6][tables = [$hdt$_0, $hdt$_1]] in Stage 'Stage-1:MAPRED' is a cross product
 PREHOOK: query: SELECT * FROM view5
 PREHOOK: type: QUERY
@@ -588,6 +595,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view6
+POSTHOOK: Lineage: view6.valoo EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE view6
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view6
@@ -613,6 +621,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view7
+POSTHOOK: Lineage: view7.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view7.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: SELECT * FROM view7
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -710,6 +720,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view8
+POSTHOOK: Lineage: view8.c EXPRESSION []
 PREHOOK: query: DESCRIBE EXTENDED view8
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view8
@@ -787,6 +798,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view9
+POSTHOOK: Lineage: view9.m EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view9
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view9
@@ -864,6 +876,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view9
+POSTHOOK: Lineage: view9.m EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view9
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view9
@@ -931,6 +944,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view10
+POSTHOOK: Lineage: view10.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view10.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view10
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view10
@@ -1006,6 +1021,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view11
+POSTHOOK: Lineage: view11.boom SCRIPT []
 PREHOOK: query: DESCRIBE EXTENDED view11
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view11
@@ -1075,6 +1091,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view12
+POSTHOOK: Lineage: view12.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view12.mycol SCRIPT []
+POSTHOOK: Lineage: view12.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view12
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view12
@@ -1159,6 +1178,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcbucket
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view13
+POSTHOOK: Lineage: view13.key SIMPLE [(srcbucket)s.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: DESCRIBE EXTENDED view13
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view13
@@ -1257,6 +1277,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view14
+POSTHOOK: Lineage: view14.k1 EXPRESSION [(src)s2.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view14.k2 EXPRESSION [(src)s4.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view14.v1 EXPRESSION [(src)s1.null, (src)s2.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: view14.v2 EXPRESSION [(src)s3.null, (src)s4.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view14
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view14
@@ -1390,6 +1414,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view15
+POSTHOOK: Lineage: view15.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: view15.value_count EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view15
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view15
@@ -1478,6 +1504,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view16
+POSTHOOK: Lineage: view16.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view16
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@view16
diff --git a/ql/src/test/results/clientpositive/create_view_defaultformats.q.out b/ql/src/test/results/clientpositive/create_view_defaultformats.q.out
index 24125136f1..1ac20c2b4d 100644
--- a/ql/src/test/results/clientpositive/create_view_defaultformats.q.out
+++ b/ql/src/test/results/clientpositive/create_view_defaultformats.q.out
@@ -16,6 +16,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sfsrc
+POSTHOOK: Lineage: sfsrc.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: sfsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view rcsrc as select * from src
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -26,6 +28,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rcsrc
+POSTHOOK: Lineage: rcsrc.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: rcsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted sfsrc
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@sfsrc
diff --git a/ql/src/test/results/clientpositive/create_view_partitioned.q.out b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
index 85667b6641..46a81c400d 100644
--- a/ql/src/test/results/clientpositive/create_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
@@ -30,6 +30,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vp1
+POSTHOOK: Lineage: vp1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED vp1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@vp1
@@ -239,6 +240,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vp2
+POSTHOOK: Lineage: vp2.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: vp2.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: vp2.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED vp2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@vp2
@@ -351,6 +355,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vp3
+POSTHOOK: Lineage: vp3.k SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED vp3
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@vp3
diff --git a/ql/src/test/results/clientpositive/create_view_translate.q.out b/ql/src/test/results/clientpositive/create_view_translate.q.out
index 4b3e196735..78614f7458 100644
--- a/ql/src/test/results/clientpositive/create_view_translate.q.out
+++ b/ql/src/test/results/clientpositive/create_view_translate.q.out
@@ -16,6 +16,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -61,6 +62,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@w
+POSTHOOK: Lineage: w.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: w.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted w
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@w
@@ -151,6 +154,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@items
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@priceview
+POSTHOOK: Lineage: priceview._c1 EXPRESSION [(items)items.FieldSchema(name:info, type:map<string,string>, comment:null), ]
+POSTHOOK: Lineage: priceview.id SIMPLE [(items)items.FieldSchema(name:id, type:int, comment:null), ]
 PREHOOK: query: select * from priceview
 PREHOOK: type: QUERY
 PREHOOK: Input: default@items
diff --git a/ql/src/test/results/clientpositive/ctas_char.q.out b/ql/src/test/results/clientpositive/ctas_char.q.out
index d5f77cd0e0..e0fc050876 100644
--- a/ql/src/test/results/clientpositive/ctas_char.q.out
+++ b/ql/src/test/results/clientpositive/ctas_char.q.out
@@ -52,6 +52,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_char_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_char_3
+POSTHOOK: Lineage: ctas_char_3.key SIMPLE [(ctas_char_2)ctas_char_2.FieldSchema(name:key, type:char(10), comment:null), ]
+POSTHOOK: Lineage: ctas_char_3.value SIMPLE [(ctas_char_2)ctas_char_2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select key, value from ctas_char_1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@ctas_char_1
diff --git a/ql/src/test/results/clientpositive/ctas_date.q.out b/ql/src/test/results/clientpositive/ctas_date.q.out
index cd2a240c4b..44f112651c 100644
--- a/ql/src/test/results/clientpositive/ctas_date.q.out
+++ b/ql/src/test/results/clientpositive/ctas_date.q.out
@@ -59,6 +59,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_date_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_date_3
+POSTHOOK: Lineage: ctas_date_3._c3 SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:_c3, type:date, comment:null), ]
+POSTHOOK: Lineage: ctas_date_3.dd SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:dd, type:date, comment:null), ]
+POSTHOOK: Lineage: ctas_date_3.key SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: ctas_date_3.value SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view ctas_date_4 as select * from ctas_date_2 where dd < date '2000-01-01'
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@ctas_date_2
@@ -69,6 +73,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_date_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_date_4
+POSTHOOK: Lineage: ctas_date_4._c3 SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:_c3, type:date, comment:null), ]
+POSTHOOK: Lineage: ctas_date_4.dd SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:dd, type:date, comment:null), ]
+POSTHOOK: Lineage: ctas_date_4.key SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: ctas_date_4.value SIMPLE [(ctas_date_2)ctas_date_2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select key, value, dd, date '1980-12-12' from ctas_date_1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@ctas_date_1
diff --git a/ql/src/test/results/clientpositive/ctas_varchar.q.out b/ql/src/test/results/clientpositive/ctas_varchar.q.out
index 3ed5e867de..d9a9519fbf 100644
--- a/ql/src/test/results/clientpositive/ctas_varchar.q.out
+++ b/ql/src/test/results/clientpositive/ctas_varchar.q.out
@@ -52,6 +52,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@ctas_varchar_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ctas_varchar_3
+POSTHOOK: Lineage: ctas_varchar_3.key SIMPLE [(ctas_varchar_2)ctas_varchar_2.FieldSchema(name:key, type:varchar(10), comment:null), ]
+POSTHOOK: Lineage: ctas_varchar_3.value SIMPLE [(ctas_varchar_2)ctas_varchar_2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select key, value from ctas_varchar_1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@ctas_varchar_1
diff --git a/ql/src/test/results/clientpositive/cteViews.q.out b/ql/src/test/results/clientpositive/cteViews.q.out
index 69f0a91273..3a9bd43701 100644
--- a/ql/src/test/results/clientpositive/cteViews.q.out
+++ b/ql/src/test/results/clientpositive/cteViews.q.out
@@ -35,6 +35,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -107,6 +108,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -180,6 +183,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -244,6 +248,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
diff --git a/ql/src/test/results/clientpositive/cte_2.q.out b/ql/src/test/results/clientpositive/cte_2.q.out
index 1506217c9d..c2bc5657f5 100644
--- a/ql/src/test/results/clientpositive/cte_2.q.out
+++ b/ql/src/test/results/clientpositive/cte_2.q.out
@@ -118,6 +118,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: select * from v1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -153,6 +154,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: with q1 as ( select key from src where key = '4')
 select * from v1
 PREHOOK: type: QUERY
@@ -190,6 +192,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_3
+POSTHOOK: Lineage: view_3._c1 EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: view_3.cstring2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cstring2, type:string, comment:null), ]
 PREHOOK: query: drop view if exists view_4
 PREHOOK: type: DROPVIEW
 POSTHOOK: query: drop view if exists view_4
@@ -204,3 +208,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_4
+POSTHOOK: Lineage: view_4.cstring1 SIMPLE [(alltypesorc)s.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: view_4.ctimestamp1 SIMPLE [(alltypesorc)v.FieldSchema(name:ctimestamp1, type:timestamp, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/cte_4.q.out b/ql/src/test/results/clientpositive/cte_4.q.out
index de976c3d2b..ce92dca916 100644
--- a/ql/src/test/results/clientpositive/cte_4.q.out
+++ b/ql/src/test/results/clientpositive/cte_4.q.out
@@ -148,6 +148,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: select * from v1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -183,6 +184,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: with q1 as ( select key from src where key = '4')
 select * from v1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/database_drop.q.out b/ql/src/test/results/clientpositive/database_drop.q.out
index f37d8f7c51..9059c3853a 100644
--- a/ql/src/test/results/clientpositive/database_drop.q.out
+++ b/ql/src/test/results/clientpositive/database_drop.q.out
@@ -43,6 +43,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db5@temp_tbl
 POSTHOOK: Output: database:db5
 POSTHOOK: Output: db5@temp_tbl_view
+POSTHOOK: Lineage: temp_tbl_view.id SIMPLE [(temp_tbl)temp_tbl.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: temp_tbl_view.name SIMPLE [(temp_tbl)temp_tbl.FieldSchema(name:name, type:string, comment:null), ]
 PREHOOK: query: CREATE INDEX idx1 ON TABLE temp_tbl(id) AS 'COMPACT' with DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
 PREHOOK: Input: db5@temp_tbl
@@ -89,6 +91,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db5@temp_tbl2
 POSTHOOK: Output: database:db5
 POSTHOOK: Output: db5@temp_tbl2_view
+POSTHOOK: Lineage: temp_tbl2_view.id SIMPLE [(temp_tbl2)temp_tbl2.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: temp_tbl2_view.name SIMPLE [(temp_tbl2)temp_tbl2.FieldSchema(name:name, type:string, comment:null), ]
 #### A masked pattern was here ####
 PREHOOK: type: CREATEINDEX
 PREHOOK: Input: db5@temp_tbl2
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
index f9adbc9eff..836ab3fb85 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
@@ -224,6 +224,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
+POSTHOOK: Lineage: V1.key SIMPLE [(t1)t1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: alter view V1 set tblproperties ('test'='thisisatest')
 PREHOOK: type: ALTERVIEW_PROPERTIES
 PREHOOK: Input: default@v1
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
index a95c5aaf88..facd497095 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
@@ -35,6 +35,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: foo@t1
 POSTHOOK: Output: database:foo
 POSTHOOK: Output: foo@V1
+POSTHOOK: Lineage: V1.key SIMPLE [(t1)t1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: show tables
 PREHOOK: type: SHOWTABLES
 PREHOOK: Input: database:foo
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
index 978df22b0b..c55239b322 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
@@ -22,6 +22,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_partitioned
+POSTHOOK: Lineage: view_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: ALTER VIEW view_partitioned
 ADD PARTITION (value='val_86')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
index b0bac90eeb..001abb6305 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
@@ -22,6 +22,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_partitioned
+POSTHOOK: Lineage: view_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: ALTER VIEW view_partitioned
 ADD PARTITION (value='val_86')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_drop_view.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_drop_view.q.out
index 7958b391d8..97c7275ed5 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_drop_view.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_drop_view.q.out
@@ -24,6 +24,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@dve_encrypted_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dve_view
+POSTHOOK: Lineage: dve_view.key SIMPLE [(dve_encrypted_table)dve_encrypted_table.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: dve_view.value SIMPLE [(dve_encrypted_table)dve_encrypted_table.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: DROP VIEW dve_view
 PREHOOK: type: DROPVIEW
 PREHOOK: Input: default@dve_view
diff --git a/ql/src/test/results/clientpositive/escape_comments.q.out b/ql/src/test/results/clientpositive/escape_comments.q.out
index 5965c5e6b4..111c1038bd 100644
--- a/ql/src/test/results/clientpositive/escape_comments.q.out
+++ b/ql/src/test/results/clientpositive/escape_comments.q.out
@@ -34,6 +34,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: escape_comments_db@escape_comments_tbl1
 POSTHOOK: Output: database:escape_comments_db
 POSTHOOK: Output: escape_comments_db@escape_comments_view1
+POSTHOOK: Lineage: escape_comments_view1.col1 SIMPLE [(escape_comments_tbl1)escape_comments_tbl1.FieldSchema(name:col1, type:string, comment:a
+b';), ]
 PREHOOK: query: create index index2 on table escape_comments_tbl1(col1) as 'COMPACT' with deferred rebuild comment 'a\nb'
 PREHOOK: type: CREATEINDEX
 PREHOOK: Input: escape_comments_db@escape_comments_tbl1
diff --git a/ql/src/test/results/clientpositive/explain_ddl.q.out b/ql/src/test/results/clientpositive/explain_ddl.q.out
index 6da67e7daa..ee2a60ac11 100644
--- a/ql/src/test/results/clientpositive/explain_ddl.q.out
+++ b/ql/src/test/results/clientpositive/explain_ddl.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
+POSTHOOK: Lineage: V1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: select count(*) from V1 where key > 0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/explain_dependency.q.out b/ql/src/test/results/clientpositive/explain_dependency.q.out
index 1b18a3254d..6ab41c7e7f 100644
--- a/ql/src/test/results/clientpositive/explain_dependency.q.out
+++ b/ql/src/test/results/clientpositive/explain_dependency.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
+POSTHOOK: Lineage: V1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
@@ -18,6 +20,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V2
+POSTHOOK: Lineage: V2.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: V2.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V2.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
@@ -36,6 +41,8 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V3
+POSTHOOK: Lineage: V3.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V3.value SIMPLE [(src)src2.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
@@ -56,6 +63,9 @@ POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V4
+POSTHOOK: Lineage: V4.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V4.value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: V4.value2 SIMPLE [(src)src3.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: EXPLAIN DEPENDENCY 
   SELECT key, count(1) FROM srcpart WHERE ds IS NOT NULL GROUP BY key
 PREHOOK: type: QUERY
@@ -118,6 +128,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V5
+POSTHOOK: Lineage: V5.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: V5.hr SIMPLE [(srcpart)srcpart.FieldSchema(name:hr, type:string, comment:null), ]
+POSTHOOK: Lineage: V5.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V5.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: EXPLAIN DEPENDENCY SELECT * FROM V5
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN DEPENDENCY SELECT * FROM V5
diff --git a/ql/src/test/results/clientpositive/explain_logical.q.out b/ql/src/test/results/clientpositive/explain_logical.q.out
index 90f7aca63d..d1176c1d82 100644
--- a/ql/src/test/results/clientpositive/explain_logical.q.out
+++ b/ql/src/test/results/clientpositive/explain_logical.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V1
+POSTHOOK: Lineage: V1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@srcpart
@@ -18,6 +20,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V2
+POSTHOOK: Lineage: V2.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: V2.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V2.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
@@ -36,6 +41,8 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V3
+POSTHOOK: Lineage: V3.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V3.value SIMPLE [(src)src2.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
@@ -56,6 +63,9 @@ POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V4
+POSTHOOK: Lineage: V4.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V4.value1 SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: V4.value2 SIMPLE [(src)src3.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: EXPLAIN LOGICAL 
   SELECT key, count(1) FROM srcpart WHERE ds IS NOT NULL GROUP BY key
 PREHOOK: type: QUERY
@@ -462,6 +472,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@V5
+POSTHOOK: Lineage: V5.ds SIMPLE [(srcpart)srcpart.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: V5.hr SIMPLE [(srcpart)srcpart.FieldSchema(name:hr, type:string, comment:null), ]
+POSTHOOK: Lineage: V5.key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: V5.value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V5
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL SELECT * FROM V5
diff --git a/ql/src/test/results/clientpositive/join_view.q.out b/ql/src/test/results/clientpositive/join_view.q.out
index 394706daa5..1d83742dd4 100644
--- a/ql/src/test/results/clientpositive/join_view.q.out
+++ b/ql/src/test/results/clientpositive/join_view.q.out
@@ -34,6 +34,9 @@ POSTHOOK: Input: default@invites
 POSTHOOK: Input: default@invites2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.bar SIMPLE [(invites)invites.FieldSchema(name:bar, type:string, comment:null), ]
+POSTHOOK: Lineage: v.ds SIMPLE [(invites2)invites2.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: v.foo SIMPLE [(invites2)invites2.FieldSchema(name:foo, type:int, comment:null), ]
 Warning: Shuffle Join JOIN[8][tables = [$hdt$_0, $hdt$_1]] in Stage 'Stage-1:MAPRED' is a cross product
 PREHOOK: query: explain select * from v where ds='2011-09-01'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/lateral_view_noalias.q.out b/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
index 47b1249527..25a85a89a1 100644
--- a/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
@@ -108,6 +108,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@lv_noalias
+POSTHOOK: Lineage: lv_noalias.key SCRIPT []
+POSTHOOK: Lineage: lv_noalias.value SCRIPT []
 PREHOOK: query: explain select * from lv_noalias a join lv_noalias b on a.key=b.key
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from lv_noalias a join lv_noalias b on a.key=b.key
diff --git a/ql/src/test/results/clientpositive/lateral_view_onview.q.out b/ql/src/test/results/clientpositive/lateral_view_onview.q.out
index 6ce31f45b9..1d3e8253a5 100644
--- a/ql/src/test/results/clientpositive/lateral_view_onview.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_onview.q.out
@@ -28,6 +28,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@lv_table
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@lv_view
+POSTHOOK: Lineage: lv_view.c1 SIMPLE [(lv_table)lv_table.FieldSchema(name:c1, type:string, comment:null), ]
+POSTHOOK: Lineage: lv_view.c2 SIMPLE [(lv_table)lv_table.FieldSchema(name:c2, type:array<int>, comment:null), ]
+POSTHOOK: Lineage: lv_view.c3 SIMPLE [(lv_table)lv_table.FieldSchema(name:c3, type:int, comment:null), ]
+POSTHOOK: Lineage: lv_view.c4 SIMPLE [(lv_table)lv_table.FieldSchema(name:c4, type:char(1), comment:null), ]
 PREHOOK: query: EXPLAIN SELECT * FROM lv_view LATERAL VIEW explode(array(1,2,3)) myTable AS myCol SORT BY c1 ASC, myCol ASC LIMIT 1
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN SELECT * FROM lv_view LATERAL VIEW explode(array(1,2,3)) myTable AS myCol SORT BY c1 ASC, myCol ASC LIMIT 1
diff --git a/ql/src/test/results/clientpositive/llap/cbo_rp_unionDistinct_2.q.out b/ql/src/test/results/clientpositive/llap/cbo_rp_unionDistinct_2.q.out
index 7cc6324400..3b3983f896 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_rp_unionDistinct_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_rp_unionDistinct_2.q.out
@@ -338,6 +338,8 @@ POSTHOOK: Input: default@u2
 POSTHOOK: Input: default@u3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), (u3)u3.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), (u3)u3.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -412,6 +414,8 @@ POSTHOOK: Input: default@u1
 POSTHOOK: Input: default@u2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -477,6 +481,8 @@ POSTHOOK: Input: default@u1
 POSTHOOK: Input: default@u2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
diff --git a/ql/src/test/results/clientpositive/llap/cbo_rp_views.q.out b/ql/src/test/results/clientpositive/llap/cbo_rp_views.q.out
index e412ee1908..2ac2d3a347 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_rp_views.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_rp_views.q.out
@@ -8,6 +8,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.c_boolean SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:c_boolean, type:boolean, comment:null), ]
+POSTHOOK: Lineage: v1.c_int SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v1.dt SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:dt, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select c_int, value from cbo_t2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@cbo_t2
@@ -18,6 +22,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.c_int SIMPLE [(cbo_t2)cbo_t2.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(cbo_t2)cbo_t2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select value from v1 where c_boolean=false
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -108,6 +114,7 @@ POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v3
+POSTHOOK: Lineage: v3.val SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select count(val) from v3 where val != '1'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -165,6 +172,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v4
+POSTHOOK: Lineage: v4.c_int SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v4.key SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: with q1 as ( select c_int from q2 where c_boolean = false),
 q2 as ( select c_int,c_boolean from v1  where value = '1')
 select sum(c_int) from (select c_int from q1) a
diff --git a/ql/src/test/results/clientpositive/llap/cbo_rp_windowing_2.q.out b/ql/src/test/results/clientpositive/llap/cbo_rp_windowing_2.q.out
index fe28e1dfbc..d4ab0f9099 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_rp_windowing_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_rp_windowing_2.q.out
@@ -950,6 +950,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part)part.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: select * 
 from (
 select p_mfgr, p_brand, s, 
@@ -1040,6 +1043,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_brand_price_view
+POSTHOOK: Lineage: mfgr_brand_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_brand_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_brand_price_view.s SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), ]
 PREHOOK: query: select * from mfgr_brand_price_view
 PREHOOK: type: QUERY
 PREHOOK: Input: default@mfgr_brand_price_view
diff --git a/ql/src/test/results/clientpositive/llap/cbo_subq_exists.q.out b/ql/src/test/results/clientpositive/llap/cbo_subq_exists.q.out
index 45f4524eea..06dbd30339 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_subq_exists.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_subq_exists.q.out
@@ -195,6 +195,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_cbo
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src_cbo)b.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src_cbo)b.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
diff --git a/ql/src/test/results/clientpositive/llap/cbo_views.q.out b/ql/src/test/results/clientpositive/llap/cbo_views.q.out
index e412ee1908..2ac2d3a347 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_views.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_views.q.out
@@ -8,6 +8,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.c_boolean SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:c_boolean, type:boolean, comment:null), ]
+POSTHOOK: Lineage: v1.c_int SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v1.dt SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:dt, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select c_int, value from cbo_t2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@cbo_t2
@@ -18,6 +22,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.c_int SIMPLE [(cbo_t2)cbo_t2.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(cbo_t2)cbo_t2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select value from v1 where c_boolean=false
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -108,6 +114,7 @@ POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v3
+POSTHOOK: Lineage: v3.val SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select count(val) from v3 where val != '1'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -165,6 +172,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v4
+POSTHOOK: Lineage: v4.c_int SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v4.key SIMPLE [(cbo_t1)cbo_t1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: with q1 as ( select c_int from q2 where c_boolean = false),
 q2 as ( select c_int,c_boolean from v1  where value = '1')
 select sum(c_int) from (select c_int from q1) a
diff --git a/ql/src/test/results/clientpositive/llap/cte_2.q.out b/ql/src/test/results/clientpositive/llap/cte_2.q.out
index a0b703fafe..ef66c40611 100644
--- a/ql/src/test/results/clientpositive/llap/cte_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/cte_2.q.out
@@ -118,6 +118,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: select * from v1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -153,6 +154,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: with q1 as ( select key from src where key = '4')
 select * from v1
 PREHOOK: type: QUERY
@@ -190,6 +192,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_3
+POSTHOOK: Lineage: view_3._c1 EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: view_3.cstring2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cstring2, type:string, comment:null), ]
 PREHOOK: query: drop view if exists view_4
 PREHOOK: type: DROPVIEW
 POSTHOOK: query: drop view if exists view_4
@@ -204,3 +208,5 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@view_4
+POSTHOOK: Lineage: view_4.cstring1 SIMPLE [(alltypesorc)s.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: view_4.ctimestamp1 SIMPLE [(alltypesorc)v.FieldSchema(name:ctimestamp1, type:timestamp, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/cte_4.q.out b/ql/src/test/results/clientpositive/llap/cte_4.q.out
index de976c3d2b..ce92dca916 100644
--- a/ql/src/test/results/clientpositive/llap/cte_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/cte_4.q.out
@@ -148,6 +148,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: select * from v1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -183,6 +184,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: with q1 as ( select key from src where key = '4')
 select * from v1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/explainuser_1.q.out b/ql/src/test/results/clientpositive/llap/explainuser_1.q.out
index f79cc358ff..b9489eb977 100644
--- a/ql/src/test/results/clientpositive/llap/explainuser_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/explainuser_1.q.out
@@ -1982,6 +1982,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src_cbo
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src_cbo)b.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src_cbo)b.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: explain select * from cv1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from cv1
diff --git a/ql/src/test/results/clientpositive/llap/multi_column_in.q.out b/ql/src/test/results/clientpositive/llap/multi_column_in.q.out
index acbd9622c5..d8f9f03b31 100644
--- a/ql/src/test/results/clientpositive/llap/multi_column_in.q.out
+++ b/ql/src/test/results/clientpositive/llap/multi_column_in.q.out
@@ -327,6 +327,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.deptno EXPRESSION [(emps)emps.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: v.empname EXPRESSION [(emps)emps.FieldSchema(name:empname, type:string, comment:null), ]
+POSTHOOK: Lineage: v.empno EXPRESSION [(emps)emps.FieldSchema(name:empno, type:int, comment:null), ]
 PREHOOK: query: select * from v
 PREHOOK: type: QUERY
 PREHOOK: Input: default@emps
diff --git a/ql/src/test/results/clientpositive/llap/multi_column_in_single.q.out b/ql/src/test/results/clientpositive/llap/multi_column_in_single.q.out
index 8bbf9607a0..76bc521e59 100644
--- a/ql/src/test/results/clientpositive/llap/multi_column_in_single.q.out
+++ b/ql/src/test/results/clientpositive/llap/multi_column_in_single.q.out
@@ -290,6 +290,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@emps
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.deptno EXPRESSION [(emps)emps.FieldSchema(name:deptno, type:int, comment:null), ]
+POSTHOOK: Lineage: v.empname EXPRESSION [(emps)emps.FieldSchema(name:empname, type:string, comment:null), ]
+POSTHOOK: Lineage: v.empno EXPRESSION [(emps)emps.FieldSchema(name:empno, type:int, comment:null), ]
 PREHOOK: query: select * from v
 PREHOOK: type: QUERY
 PREHOOK: Input: default@emps
diff --git a/ql/src/test/results/clientpositive/llap/ppd_union_view.q.out b/ql/src/test/results/clientpositive/llap/ppd_union_view.q.out
index 0c474d7603..543d17630a 100644
--- a/ql/src/test/results/clientpositive/llap/ppd_union_view.q.out
+++ b/ql/src/test/results/clientpositive/llap/ppd_union_view.q.out
@@ -128,6 +128,8 @@ POSTHOOK: Input: default@t1_new
 POSTHOOK: Input: default@t1_old
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
+POSTHOOK: Lineage: t1.key EXPRESSION [(t1_new)t1_new.FieldSchema(name:key, type:string, comment:null), (t1_mapping)t1_mapping.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: t1.value EXPRESSION [(t1_new)t1_new.FieldSchema(name:value, type:string, comment:null), (t1_old)t1_old.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: explain extended
 select * from t1 where ds = '2011-10-13'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/llap/ptf.q.out b/ql/src/test/results/clientpositive/llap/ptf.q.out
index 24516fc88f..df55238d7b 100644
--- a/ql/src/test/results/clientpositive/llap/ptf.q.out
+++ b/ql/src/test/results/clientpositive/llap/ptf.q.out
@@ -2706,6 +2706,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part)part.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: explain
 select p_mfgr, p_brand, s, 
 round(sum(s) over w1,2)  as s1
diff --git a/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out b/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out
index 6354007771..afb9c4f5a2 100644
--- a/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out
+++ b/ql/src/test/results/clientpositive/llap/selectDistinctStar.q.out
@@ -1366,6 +1366,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sdi
+POSTHOOK: Lineage: sdi.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: sdi.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended sdi
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@sdi
@@ -3828,6 +3830,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@sdi
+POSTHOOK: Lineage: sdi.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: sdi.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended sdi
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@sdi
diff --git a/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out b/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out
index 51be593c17..d01b373dce 100644
--- a/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/special_character_in_tabnames_1.q.out
@@ -17009,6 +17009,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src/_/cbo
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src/_/cbo)b.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src/_/cbo)b.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
@@ -18764,6 +18766,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@c/b/o_t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.c_boolean SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:c_boolean, type:boolean, comment:null), ]
+POSTHOOK: Lineage: v1.c_int SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v1.dt SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:dt, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: create view v2 as select c_int, value from `//cbo_t2`
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@//cbo_t2
@@ -18774,6 +18780,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@//cbo_t2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v2
+POSTHOOK: Lineage: v2.c_int SIMPLE [(//cbo_t2)//cbo_t2.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(//cbo_t2)//cbo_t2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select value from v1 where c_boolean=false
 PREHOOK: type: QUERY
 PREHOOK: Input: default@c/b/o_t1
@@ -18864,6 +18872,7 @@ POSTHOOK: Input: default@c/b/o_t1
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v3
+POSTHOOK: Lineage: v3.val SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: select count(val) from v3 where val != '1'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@c/b/o_t1
@@ -18929,6 +18938,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@c/b/o_t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v4
+POSTHOOK: Lineage: v4.c_int SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:c_int, type:int, comment:null), ]
+POSTHOOK: Lineage: v4.key SIMPLE [(c/b/o_t1)c/b/o_t1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: with q1 as ( select c_int from q2 where c_boolean = false),
 
 q2 as ( select c_int,c_boolean from v1  where value = '1')
diff --git a/ql/src/test/results/clientpositive/llap/subquery_exists.q.out b/ql/src/test/results/clientpositive/llap/subquery_exists.q.out
index 4f3d796c91..14b592b856 100644
--- a/ql/src/test/results/clientpositive/llap/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/llap/subquery_exists.q.out
@@ -208,6 +208,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
diff --git a/ql/src/test/results/clientpositive/llap/subquery_notin.q.out b/ql/src/test/results/clientpositive/llap/subquery_notin.q.out
index e8ba1173d7..01604dadee 100644
--- a/ql/src/test/results/clientpositive/llap/subquery_notin.q.out
+++ b/ql/src/test/results/clientpositive/llap/subquery_notin.q.out
@@ -1230,6 +1230,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1_v
+POSTHOOK: Lineage: T1_v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: create view T2_v as 
 select case when key > '104' then null else key end as key from T1_v
 PREHOOK: type: CREATEVIEW
@@ -1244,6 +1245,7 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@t1_v
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T2_v
+POSTHOOK: Lineage: T2_v.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 Warning: Shuffle Join MERGEJOIN[33][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
 PREHOOK: query: explain
 select * 
diff --git a/ql/src/test/results/clientpositive/llap/subquery_views.q.out b/ql/src/test/results/clientpositive/llap/subquery_views.q.out
index 22da51c908..d96a5a4a75 100644
--- a/ql/src/test/results/clientpositive/llap/subquery_views.q.out
+++ b/ql/src/test/results/clientpositive/llap/subquery_views.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended cv1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cv1
@@ -81,6 +83,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv2
+POSTHOOK: Lineage: cv2.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: cv2.value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended cv2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cv2
@@ -817,6 +821,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv3
+POSTHOOK: Lineage: cv3._c2 EXPRESSION [(src)b.null, ]
+POSTHOOK: Lineage: cv3.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: cv3.value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended cv3
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@cv3
@@ -917,6 +924,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@tc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tcv
+POSTHOOK: Lineage: tcv.@d SIMPLE [(tc)b.FieldSchema(name:@d, type:int, comment:null), ]
 PREHOOK: query: describe extended tcv
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@tcv
diff --git a/ql/src/test/results/clientpositive/llap/tez_union.q.out b/ql/src/test/results/clientpositive/llap/tez_union.q.out
index cda74f8225..395961ee0c 100644
--- a/ql/src/test/results/clientpositive/llap/tez_union.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_union.q.out
@@ -1429,6 +1429,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@table1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@TABLE3
+POSTHOOK: Lineage: TABLE3.emp_id SIMPLE [(table1)table1.FieldSchema(name:emp_id, type:int, comment:null), ]
+POSTHOOK: Lineage: TABLE3.emp_name SIMPLE [(table1)table1.FieldSchema(name:emp_name, type:string, comment:null), ]
 PREHOOK: query: explain formatted select count(*) from TABLE3
 PREHOOK: type: QUERY
 POSTHOOK: query: explain formatted select count(*) from TABLE3
diff --git a/ql/src/test/results/clientpositive/llap/unionDistinct_2.q.out b/ql/src/test/results/clientpositive/llap/unionDistinct_2.q.out
index 7cc6324400..3b3983f896 100644
--- a/ql/src/test/results/clientpositive/llap/unionDistinct_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/unionDistinct_2.q.out
@@ -338,6 +338,8 @@ POSTHOOK: Input: default@u2
 POSTHOOK: Input: default@u3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), (u3)u3.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), (u3)u3.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -412,6 +414,8 @@ POSTHOOK: Input: default@u1
 POSTHOOK: Input: default@u2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -477,6 +481,8 @@ POSTHOOK: Input: default@u1
 POSTHOOK: Input: default@u2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
diff --git a/ql/src/test/results/clientpositive/llap/union_top_level.q.out b/ql/src/test/results/clientpositive/llap/union_top_level.q.out
index 14c9dc6f99..de23f48b96 100644
--- a/ql/src/test/results/clientpositive/llap/union_top_level.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_top_level.q.out
@@ -1141,6 +1141,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@union_top_view
+POSTHOOK: Lineage: union_top_view.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: union_top_view.value EXPRESSION []
 PREHOOK: query: select * from union_top_view
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/llap/vectorized_ptf.q.out
index 695262e438..b40acf9ef9 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_ptf.q.out
@@ -4177,6 +4177,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part_orc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part_orc)part_orc.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part_orc)part_orc.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part_orc)part_orc.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: explain extended
 select p_mfgr, p_brand, s, 
 round(sum(s) over w1,2) as s1
diff --git a/ql/src/test/results/clientpositive/llap/windowing.q.out b/ql/src/test/results/clientpositive/llap/windowing.q.out
index 61c559130a..86804f2c72 100644
--- a/ql/src/test/results/clientpositive/llap/windowing.q.out
+++ b/ql/src/test/results/clientpositive/llap/windowing.q.out
@@ -950,6 +950,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part)part.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: select * 
 from (
 select p_mfgr, p_brand, s, 
@@ -1040,6 +1043,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_brand_price_view
+POSTHOOK: Lineage: mfgr_brand_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_brand_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_brand_price_view.s SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), ]
 PREHOOK: query: select * from mfgr_brand_price_view
 PREHOOK: type: QUERY
 PREHOOK: Input: default@mfgr_brand_price_view
diff --git a/ql/src/test/results/clientpositive/masking_2.q.out b/ql/src/test/results/clientpositive/masking_2.q.out
index 4900a5a0d8..83fca416b4 100644
--- a/ql/src/test/results/clientpositive/masking_2.q.out
+++ b/ql/src/test/results/clientpositive/masking_2.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test
+POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: masking_test.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: explain select * from masking_test
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from masking_test
diff --git a/ql/src/test/results/clientpositive/masking_6.q.out b/ql/src/test/results/clientpositive/masking_6.q.out
index 56e4006549..b9004b97b0 100644
--- a/ql/src/test/results/clientpositive/masking_6.q.out
+++ b/ql/src/test/results/clientpositive/masking_6.q.out
@@ -12,6 +12,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test
+POSTHOOK: Lineage: masking_test._c2 SIMPLE []
+POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: masking_test.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: explain select * from masking_test
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from masking_test
@@ -139,6 +142,18 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test
+POSTHOOK: Lineage: masking_test._c1 SIMPLE []
+POSTHOOK: Lineage: masking_test._c10 SIMPLE []
+POSTHOOK: Lineage: masking_test._c11 SIMPLE []
+POSTHOOK: Lineage: masking_test._c2 SIMPLE []
+POSTHOOK: Lineage: masking_test._c3 SIMPLE []
+POSTHOOK: Lineage: masking_test._c4 SIMPLE []
+POSTHOOK: Lineage: masking_test._c5 SIMPLE []
+POSTHOOK: Lineage: masking_test._c6 SIMPLE []
+POSTHOOK: Lineage: masking_test._c7 SIMPLE []
+POSTHOOK: Lineage: masking_test._c8 SIMPLE []
+POSTHOOK: Lineage: masking_test._c9 SIMPLE []
+POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: explain select * from masking_test
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from masking_test
diff --git a/ql/src/test/results/clientpositive/masking_7.q.out b/ql/src/test/results/clientpositive/masking_7.q.out
index c4531f87b3..691cd891f3 100644
--- a/ql/src/test/results/clientpositive/masking_7.q.out
+++ b/ql/src/test/results/clientpositive/masking_7.q.out
@@ -12,6 +12,10 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test
+POSTHOOK: Lineage: masking_test._c2 SIMPLE []
+POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: masking_test.row__id SIMPLE [(src)src.FieldSchema(name:ROW__ID, type:struct<transactionId:bigint,bucketId:int,rowId:bigint>, comment:), ]
+POSTHOOK: Lineage: masking_test.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: explain select * from masking_test
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from masking_test
@@ -139,6 +143,19 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test
+POSTHOOK: Lineage: masking_test._c1 SIMPLE []
+POSTHOOK: Lineage: masking_test._c10 SIMPLE []
+POSTHOOK: Lineage: masking_test._c11 SIMPLE []
+POSTHOOK: Lineage: masking_test._c12 SIMPLE []
+POSTHOOK: Lineage: masking_test._c3 SIMPLE []
+POSTHOOK: Lineage: masking_test._c4 SIMPLE []
+POSTHOOK: Lineage: masking_test._c5 SIMPLE []
+POSTHOOK: Lineage: masking_test._c6 SIMPLE []
+POSTHOOK: Lineage: masking_test._c7 SIMPLE []
+POSTHOOK: Lineage: masking_test._c8 SIMPLE []
+POSTHOOK: Lineage: masking_test._c9 SIMPLE []
+POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: masking_test.row__id SIMPLE [(src)src.FieldSchema(name:ROW__ID, type:struct<transactionId:bigint,bucketId:int,rowId:bigint>, comment:), ]
 PREHOOK: query: explain select * from masking_test
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from masking_test
diff --git a/ql/src/test/results/clientpositive/masking_disablecbo_2.q.out b/ql/src/test/results/clientpositive/masking_disablecbo_2.q.out
index 48a366eff9..a9ace62037 100644
--- a/ql/src/test/results/clientpositive/masking_disablecbo_2.q.out
+++ b/ql/src/test/results/clientpositive/masking_disablecbo_2.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@masking_test
+POSTHOOK: Lineage: masking_test.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: masking_test.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: explain select * from masking_test
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from masking_test
diff --git a/ql/src/test/results/clientpositive/ppd_field_garbage.q.out b/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
index 0dac9800dd..3b9498cbcb 100644
--- a/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
+++ b/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
@@ -16,6 +16,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@test_issue
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v_test_issue
+POSTHOOK: Lineage: v_test_issue.age EXPRESSION [(test_issue)test_issue.FieldSchema(name:test_c, type:struct<user_c:struct<age:int>>, comment:null), ]
+POSTHOOK: Lineage: v_test_issue.fileid SIMPLE [(test_issue)test_issue.FieldSchema(name:fileid, type:int, comment:null), ]
+POSTHOOK: Lineage: v_test_issue.u SCRIPT [(test_issue)test_issue.FieldSchema(name:infos, type:array<struct<u:int>>, comment:null), ]
 PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/kv1.txt' INTO TABLE test_issue
 PREHOOK: type: LOAD
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/quotedid_basic.q.out b/ql/src/test/results/clientpositive/quotedid_basic.q.out
index 382c4ad477..8897ae99c1 100644
--- a/ql/src/test/results/clientpositive/quotedid_basic.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_basic.q.out
@@ -391,6 +391,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t4
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v1
+POSTHOOK: Lineage: v1.x+1` SIMPLE [(t4)t4.FieldSchema(name:x+1`, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.y&y SIMPLE [(t4)t4.FieldSchema(name:y&y, type:string, comment:null), ]
 PREHOOK: query: select `x+1```, `y&y`, rank() over(partition by `x+1``` order by  `y&y`)
 from v1
 group by `x+1```, `y&y`
diff --git a/ql/src/test/results/clientpositive/show_create_table_view.q.out b/ql/src/test/results/clientpositive/show_create_table_view.q.out
index a27209de0d..7756ef1480 100644
--- a/ql/src/test/results/clientpositive/show_create_table_view.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_view.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmp_copy_src
+POSTHOOK: Lineage: tmp_copy_src.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: tmp_copy_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: SHOW CREATE TABLE tmp_copy_src
 PREHOOK: type: SHOW_CREATETABLE
 PREHOOK: Input: default@tmp_copy_src
diff --git a/ql/src/test/results/clientpositive/show_views.q.out b/ql/src/test/results/clientpositive/show_views.q.out
index 723b33498a..41f1e65857 100644
--- a/ql/src/test/results/clientpositive/show_views.q.out
+++ b/ql/src/test/results/clientpositive/show_views.q.out
@@ -34,6 +34,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_test1_view1
+POSTHOOK: Lineage: shtb_test1_view1.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW shtb_test1_view2 AS SELECT * FROM shtb_test1 where KEY > 100 and KEY < 200
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: test1@shtb_test1
@@ -44,6 +47,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_test1_view2
+POSTHOOK: Lineage: shtb_test1_view2.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view2.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view2.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW shtb_full_view2 AS SELECT * FROM shtb_test1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: test1@shtb_test1
@@ -54,6 +60,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: test1@shtb_test1
 POSTHOOK: Output: database:test1
 POSTHOOK: Output: test1@shtb_full_view2
+POSTHOOK: Lineage: shtb_full_view2.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_full_view2.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_full_view2.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: USE test2
 PREHOOK: type: SWITCHDATABASE
 PREHOOK: Input: database:test2
@@ -86,6 +95,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: test2@shtb_test1
 POSTHOOK: Output: database:test2
 POSTHOOK: Output: test2@shtb_test1_view1
+POSTHOOK: Lineage: shtb_test1_view1.ds SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.key SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test1_view1.value SIMPLE [(shtb_test1)shtb_test1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW shtb_test2_view2 AS SELECT * FROM shtb_test2 where KEY > 100 and KEY < 200
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: test2@shtb_test2
@@ -96,6 +108,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: test2@shtb_test2
 POSTHOOK: Output: database:test2
 POSTHOOK: Output: test2@shtb_test2_view2
+POSTHOOK: Lineage: shtb_test2_view2.ds SIMPLE [(shtb_test2)shtb_test2.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: shtb_test2_view2.key SIMPLE [(shtb_test2)shtb_test2.FieldSchema(name:key, type:int, comment:null), ]
+POSTHOOK: Lineage: shtb_test2_view2.value SIMPLE [(shtb_test2)shtb_test2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: USE test1
 PREHOOK: type: SWITCHDATABASE
 PREHOOK: Input: database:test1
@@ -203,6 +218,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: database@foo
 POSTHOOK: Output: database:database
 POSTHOOK: Output: database@fooview
+POSTHOOK: Lineage: fooview.a SIMPLE [(foo)foo.FieldSchema(name:a, type:int, comment:null), ]
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
 PREHOOK: Input: database:default
diff --git a/ql/src/test/results/clientpositive/spark/join_view.q.out b/ql/src/test/results/clientpositive/spark/join_view.q.out
index 680021846d..61867f75f3 100644
--- a/ql/src/test/results/clientpositive/spark/join_view.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_view.q.out
@@ -34,6 +34,9 @@ POSTHOOK: Input: default@invites
 POSTHOOK: Input: default@invites2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.bar SIMPLE [(invites)invites.FieldSchema(name:bar, type:string, comment:null), ]
+POSTHOOK: Lineage: v.ds SIMPLE [(invites2)invites2.FieldSchema(name:ds, type:string, comment:null), ]
+POSTHOOK: Lineage: v.foo SIMPLE [(invites2)invites2.FieldSchema(name:foo, type:int, comment:null), ]
 Warning: Shuffle Join JOIN[8][tables = [$hdt$_0, $hdt$_1]] in Work 'Reducer 2' is a cross product
 PREHOOK: query: explain select * from v where ds='2011-09-01'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/spark/ptf.q.out b/ql/src/test/results/clientpositive/spark/ptf.q.out
index 95d16b54d2..d7a7de0717 100644
--- a/ql/src/test/results/clientpositive/spark/ptf.q.out
+++ b/ql/src/test/results/clientpositive/spark/ptf.q.out
@@ -2621,6 +2621,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part)part.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: explain
 select p_mfgr, p_brand, s, 
 round(sum(s) over w1,2)  as s1
diff --git a/ql/src/test/results/clientpositive/spark/subquery_exists.q.out b/ql/src/test/results/clientpositive/spark/subquery_exists.q.out
index fc76158aa4..4c1560d33e 100644
--- a/ql/src/test/results/clientpositive/spark/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/spark/subquery_exists.q.out
@@ -201,6 +201,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
diff --git a/ql/src/test/results/clientpositive/spark/union_top_level.q.out b/ql/src/test/results/clientpositive/spark/union_top_level.q.out
index 0b4ed79c44..74719bb433 100644
--- a/ql/src/test/results/clientpositive/spark/union_top_level.q.out
+++ b/ql/src/test/results/clientpositive/spark/union_top_level.q.out
@@ -1010,6 +1010,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@union_top_view
+POSTHOOK: Lineage: union_top_view.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: union_top_view.value EXPRESSION []
 PREHOOK: query: select * from union_top_view
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
index 71e4818082..59d0acb686 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
@@ -4106,6 +4106,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part_orc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part_orc)part_orc.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part_orc)part_orc.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part_orc)part_orc.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: explain extended
 select p_mfgr, p_brand, s, 
 round(sum(s) over w1,2) as s1
diff --git a/ql/src/test/results/clientpositive/spark/windowing.q.out b/ql/src/test/results/clientpositive/spark/windowing.q.out
index 8eba5ae39e..e72babc736 100644
--- a/ql/src/test/results/clientpositive/spark/windowing.q.out
+++ b/ql/src/test/results/clientpositive/spark/windowing.q.out
@@ -950,6 +950,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_price_view
+POSTHOOK: Lineage: mfgr_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_price_view.s EXPRESSION [(part)part.FieldSchema(name:p_retailprice, type:double, comment:null), ]
 PREHOOK: query: select * 
 from (
 select p_mfgr, p_brand, s, 
@@ -1040,6 +1043,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@part
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mfgr_brand_price_view
+POSTHOOK: Lineage: mfgr_brand_price_view.p_brand SIMPLE [(part)part.FieldSchema(name:p_brand, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_brand_price_view.p_mfgr SIMPLE [(part)part.FieldSchema(name:p_mfgr, type:string, comment:null), ]
+POSTHOOK: Lineage: mfgr_brand_price_view.s SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), ]
 PREHOOK: query: select * from mfgr_brand_price_view
 PREHOOK: type: QUERY
 PREHOOK: Input: default@mfgr_brand_price_view
diff --git a/ql/src/test/results/clientpositive/struct_in_view.q.out b/ql/src/test/results/clientpositive/struct_in_view.q.out
index 8d375216a1..bea35fcce5 100644
--- a/ql/src/test/results/clientpositive/struct_in_view.q.out
+++ b/ql/src/test/results/clientpositive/struct_in_view.q.out
@@ -20,6 +20,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@testreserved
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@testreservedview
+POSTHOOK: Lineage: testreservedview.data_end EXPRESSION [(testreserved)testreserved.FieldSchema(name:data, type:struct<end:string,id:string>, comment:null), ]
+POSTHOOK: Lineage: testreservedview.data_id EXPRESSION [(testreserved)testreserved.FieldSchema(name:data, type:struct<end:string,id:string>, comment:null), ]
 PREHOOK: query: describe extended testreservedview
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@testreservedview
@@ -72,6 +74,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@s
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vs1
+POSTHOOK: Lineage: vs1.key EXPRESSION [(s)s.FieldSchema(name:default, type:struct<src:struct<end:struct<key:string>,id:string>,id:string>, comment:null), ]
 PREHOOK: query: describe extended vs1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@vs1
@@ -91,6 +94,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@s
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vs2
+POSTHOOK: Lineage: vs2.end EXPRESSION [(s)s.FieldSchema(name:default, type:struct<src:struct<end:struct<key:string>,id:string>,id:string>, comment:null), ]
 PREHOOK: query: describe extended vs2
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@vs2
@@ -126,6 +130,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION []
 PREHOOK: query: desc extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -175,6 +180,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.end EXPRESSION []
 PREHOOK: query: desc extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
diff --git a/ql/src/test/results/clientpositive/subquery_exists.q.out b/ql/src/test/results/clientpositive/subquery_exists.q.out
index 5b8d5101d4..a310e494b5 100644
--- a/ql/src/test/results/clientpositive/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists.q.out
@@ -221,6 +221,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: cv1.value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
diff --git a/ql/src/test/results/clientpositive/subquery_exists_having.q.out b/ql/src/test/results/clientpositive/subquery_exists_having.q.out
index a369c693fd..96263bfcbd 100644
--- a/ql/src/test/results/clientpositive/subquery_exists_having.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists_having.q.out
@@ -479,6 +479,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cv1
+POSTHOOK: Lineage: cv1.c EXPRESSION [(src)b.null, ]
+POSTHOOK: Lineage: cv1.key SIMPLE [(src)b.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cv1
diff --git a/ql/src/test/results/clientpositive/tez/unionDistinct_2.q.out b/ql/src/test/results/clientpositive/tez/unionDistinct_2.q.out
index 7cc6324400..3b3983f896 100644
--- a/ql/src/test/results/clientpositive/tez/unionDistinct_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/unionDistinct_2.q.out
@@ -338,6 +338,8 @@ POSTHOOK: Input: default@u2
 POSTHOOK: Input: default@u3
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), (u3)u3.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), (u3)u3.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -412,6 +414,8 @@ POSTHOOK: Input: default@u1
 POSTHOOK: Input: default@u2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -477,6 +481,8 @@ POSTHOOK: Input: default@u1
 POSTHOOK: Input: default@u2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v.key EXPRESSION [(u1)u1.FieldSchema(name:key, type:string, comment:null), (u2)u2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v.value EXPRESSION [(u1)u1.FieldSchema(name:value, type:string, comment:null), (u2)u2.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe extended v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
diff --git a/ql/src/test/results/clientpositive/unicode_comments.q.out b/ql/src/test/results/clientpositive/unicode_comments.q.out
index 19413b9a7e..ae50c670e4 100644
--- a/ql/src/test/results/clientpositive/unicode_comments.q.out
+++ b/ql/src/test/results/clientpositive/unicode_comments.q.out
@@ -34,6 +34,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: unicode_comments_db@unicode_comments_tbl1
 POSTHOOK: Output: database:unicode_comments_db
 POSTHOOK: Output: unicode_comments_db@unicode_comments_view1
+POSTHOOK: Lineage: unicode_comments_view1.col1 SIMPLE [(unicode_comments_tbl1)unicode_comments_tbl1.FieldSchema(name:col1, type:string, comment:), ]
 PREHOOK: query: create index index2 on table unicode_comments_tbl1(col1) as 'COMPACT' with deferred rebuild comment ''
 PREHOOK: type: CREATEINDEX
 PREHOOK: Input: unicode_comments_db@unicode_comments_tbl1
diff --git a/ql/src/test/results/clientpositive/unionall_join_nullconstant.q.out b/ql/src/test/results/clientpositive/unionall_join_nullconstant.q.out
index cced114fb3..9355b02170 100644
--- a/ql/src/test/results/clientpositive/unionall_join_nullconstant.q.out
+++ b/ql/src/test/results/clientpositive/unionall_join_nullconstant.q.out
@@ -100,6 +100,8 @@ POSTHOOK: Input: default@table_b1
 POSTHOOK: Input: default@table_b2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@a_view
+POSTHOOK: Lineage: a_view.autoname EXPRESSION [(table_a1)a1.FieldSchema(name:composite_key, type:string, comment:null), (table_b1)b1.FieldSchema(name:composite_key, type:string, comment:null), ]
+POSTHOOK: Lineage: a_view.col1 EXPRESSION [(table_b1)b1.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: INSERT INTO TABLE table_b1
 SELECT * FROM (
 SELECT 'something|awful', 'col1'
diff --git a/ql/src/test/results/clientpositive/unionall_unbalancedppd.q.out b/ql/src/test/results/clientpositive/unionall_unbalancedppd.q.out
index 0e8b8977b0..b3e128a3d6 100644
--- a/ql/src/test/results/clientpositive/unionall_unbalancedppd.q.out
+++ b/ql/src/test/results/clientpositive/unionall_unbalancedppd.q.out
@@ -532,6 +532,8 @@ POSTHOOK: Input: default@map_json1
 POSTHOOK: Input: default@map_json2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@explode
+POSTHOOK: Lineage: explode.id EXPRESSION [(map_json1)map_json1.FieldSchema(name:id, type:int, comment:null), (map_json2)map_json2.FieldSchema(name:id, type:int, comment:null), (map_json)map_json.FieldSchema(name:id, type:int, comment:null), ]
+POSTHOOK: Lineage: explode.l SCRIPT [(map_json1)map_json1.FieldSchema(name:val, type:array<string>, comment:null), (map_json2)map_json2.FieldSchema(name:val, type:array<string>, comment:null), (map_json)map_json.FieldSchema(name:val, type:array<string>, comment:null), ]
 PREHOOK: query: select count(*) from explode where get_json_object(l, '$') is NOT NULL
 PREHOOK: type: QUERY
 PREHOOK: Input: default@explode
diff --git a/ql/src/test/results/clientpositive/unset_table_view_property.q.out b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
index f3068576fc..f9c96971b8 100644
--- a/ql/src/test/results/clientpositive/unset_table_view_property.q.out
+++ b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
@@ -197,6 +197,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:vt
 POSTHOOK: Output: vt@testView
+POSTHOOK: Lineage: testView.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: ALTER VIEW vt.testView SET TBLPROPERTIES ('propA'='100', 'propB'='200')
 PREHOOK: type: ALTERVIEW_PROPERTIES
 PREHOOK: Input: vt@testview
diff --git a/ql/src/test/results/clientpositive/view.q.out b/ql/src/test/results/clientpositive/view.q.out
index 9896d189e2..07eba084c3 100644
--- a/ql/src/test/results/clientpositive/view.q.out
+++ b/ql/src/test/results/clientpositive/view.q.out
@@ -60,6 +60,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v1
+POSTHOOK: Lineage: v1.key SIMPLE [(table1)table1.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v1.value SIMPLE [(table1)table1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v2 AS SELECT t1.* FROM table1 t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -70,6 +72,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v2
+POSTHOOK: Lineage: v2.key SIMPLE [(table1)t1.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v2.value SIMPLE [(table1)t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v3 AS SELECT t1.*, t2.key k FROM table1 t1 JOIN table2 t2 ON t1.key = t2.key
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -82,6 +86,9 @@ POSTHOOK: Input: db1@table1
 POSTHOOK: Input: db1@table2
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v3
+POSTHOOK: Lineage: v3.k SIMPLE [(table2)t2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v3.key SIMPLE [(table1)t1.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v3.value SIMPLE [(table1)t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v4 AS SELECT * FROM db1.table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -92,6 +99,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v4
+POSTHOOK: Lineage: v4.key SIMPLE [(table1)table1.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v4.value SIMPLE [(table1)table1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v5 AS SELECT t1.* FROM db1.table1 t1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -102,6 +111,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v5
+POSTHOOK: Lineage: v5.key SIMPLE [(table1)t1.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v5.value SIMPLE [(table1)t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v6 AS SELECT t1.*, t2.key k FROM db1.table1 t1 JOIN db1.table2 t2 ON t1.key = t2.key
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -114,6 +125,9 @@ POSTHOOK: Input: db1@table1
 POSTHOOK: Input: db1@table2
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v6
+POSTHOOK: Lineage: v6.k SIMPLE [(table2)t2.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v6.key SIMPLE [(table1)t1.FieldSchema(name:key, type:string, comment:null), ]
+POSTHOOK: Lineage: v6.value SIMPLE [(table1)t1.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v7 AS SELECT key from table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -124,6 +138,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v7
+POSTHOOK: Lineage: v7.key SIMPLE [(table1)table1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: CREATE VIEW v8 AS SELECT key from db1.table1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: db1@table1
@@ -134,6 +149,7 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: db1@table1
 POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@v8
+POSTHOOK: Lineage: v8.key SIMPLE [(table1)table1.FieldSchema(name:key, type:string, comment:null), ]
 PREHOOK: query: CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
 PREHOOK: Output: database:db2
diff --git a/ql/src/test/results/clientpositive/view_alias.q.out b/ql/src/test/results/clientpositive/view_alias.q.out
index 4e952bb69b..0d7e72f72b 100644
--- a/ql/src/test/results/clientpositive/view_alias.q.out
+++ b/ql/src/test/results/clientpositive/view_alias.q.out
@@ -12,6 +12,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v._c1 SIMPLE []
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: desc formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -77,6 +79,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v._c1 SIMPLE []
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: desc formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -142,6 +146,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v._c2 SIMPLE []
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -208,6 +215,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v._c121 SIMPLE []
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: v.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -274,6 +284,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v._c1 EXPRESSION [(src)src.null, ]
+POSTHOOK: Lineage: v.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: desc formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
@@ -377,6 +389,13 @@ POSTHOOK: Input: default@a
 POSTHOOK: Input: default@b
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@v
+POSTHOOK: Lineage: v._c0 SIMPLE []
+POSTHOOK: Lineage: v._c3 SIMPLE []
+POSTHOOK: Lineage: v._c6 SIMPLE []
+POSTHOOK: Lineage: v.ca SIMPLE [(a)a.FieldSchema(name:ca, type:string, comment:null), ]
+POSTHOOK: Lineage: v.caa SIMPLE [(a)a.FieldSchema(name:caa, type:string, comment:null), ]
+POSTHOOK: Lineage: v.cb SIMPLE [(b)b.FieldSchema(name:cb, type:string, comment:null), ]
+POSTHOOK: Lineage: v.cbb SIMPLE [(b)b.FieldSchema(name:cbb, type:string, comment:null), ]
 PREHOOK: query: desc formatted v
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@v
diff --git a/ql/src/test/results/clientpositive/view_authorization_sqlstd.q.out b/ql/src/test/results/clientpositive/view_authorization_sqlstd.q.out
index 3832fcff36..4130428576 100644
--- a/ql/src/test/results/clientpositive/view_authorization_sqlstd.q.out
+++ b/ql/src/test/results/clientpositive/view_authorization_sqlstd.q.out
@@ -30,6 +30,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt1
+POSTHOOK: Lineage: vt1.i SIMPLE [(t1)t1.FieldSchema(name:i, type:int, comment:null), ]
+POSTHOOK: Lineage: vt1.k SIMPLE [(t1)t1.FieldSchema(name:k, type:int, comment:null), ]
 PREHOOK: query: create view vt2 as select * from t1 where i > 1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@t1
@@ -40,6 +42,9 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt2
+POSTHOOK: Lineage: vt2.i SIMPLE [(t1)t1.FieldSchema(name:i, type:int, comment:null), ]
+POSTHOOK: Lineage: vt2.j SIMPLE [(t1)t1.FieldSchema(name:j, type:int, comment:null), ]
+POSTHOOK: Lineage: vt2.k SIMPLE [(t1)t1.FieldSchema(name:k, type:int, comment:null), ]
 PREHOOK: query: show grant user user1 on all
 PREHOOK: type: SHOW_GRANT
 POSTHOOK: query: show grant user user1 on all
@@ -83,6 +88,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@t1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@vt3
+POSTHOOK: Lineage: vt3.i SIMPLE [(t1)t1.FieldSchema(name:i, type:int, comment:null), ]
+POSTHOOK: Lineage: vt3.k SIMPLE [(t1)t1.FieldSchema(name:k, type:int, comment:null), ]
 PREHOOK: query: show grant user user3 on table vt1
 PREHOOK: type: SHOW_GRANT
 POSTHOOK: query: show grant user user3 on table vt1
diff --git a/ql/src/test/results/clientpositive/view_cast.q.out b/ql/src/test/results/clientpositive/view_cast.q.out
index b771b7f844..6c89960c6d 100644
--- a/ql/src/test/results/clientpositive/view_cast.q.out
+++ b/ql/src/test/results/clientpositive/view_cast.q.out
@@ -63,6 +63,13 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@atab
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@aa_view_tw
+POSTHOOK: Lineage: aa_view_tw.act SIMPLE [(atab)atab.FieldSchema(name:act, type:string, comment:null), ]
+POSTHOOK: Lineage: aa_view_tw.act_date EXPRESSION [(atab)atab.FieldSchema(name:tstamp, type:string, comment:null), ]
+POSTHOOK: Lineage: aa_view_tw.at_ks_uid SIMPLE [(atab)atab.FieldSchema(name:at_ks_uid, type:bigint, comment:null), ]
+POSTHOOK: Lineage: aa_view_tw.at_sr_uid SIMPLE [(atab)atab.FieldSchema(name:at_sr_uid, type:string, comment:null), ]
+POSTHOOK: Lineage: aa_view_tw.content_creation_date EXPRESSION [(atab)atab.FieldSchema(name:original_tstamp, type:string, comment:null), ]
+POSTHOOK: Lineage: aa_view_tw.ks_uid SIMPLE [(atab)atab.FieldSchema(name:ks_uid, type:bigint, comment:null), ]
+POSTHOOK: Lineage: aa_view_tw.sr_id SIMPLE [(atab)atab.FieldSchema(name:sr_id, type:string, comment:null), ]
 PREHOOK: query: DROP VIEW IF EXISTS joined_aa_view_tw
 PREHOOK: type: DROPVIEW
 POSTHOOK: query: DROP VIEW IF EXISTS joined_aa_view_tw
@@ -81,6 +88,15 @@ POSTHOOK: Input: default@atab
 POSTHOOK: Input: default@mstab
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@joined_aa_view_tw
+POSTHOOK: Lineage: joined_aa_view_tw.act SIMPLE [(atab)atab.FieldSchema(name:act, type:string, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.act_date EXPRESSION [(atab)atab.FieldSchema(name:tstamp, type:string, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.at_ks_uid SIMPLE [(atab)atab.FieldSchema(name:at_ks_uid, type:bigint, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.at_ksc EXPRESSION [(mstab)mstab.FieldSchema(name:csc, type:int, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.at_sr_uid SIMPLE [(atab)atab.FieldSchema(name:at_sr_uid, type:string, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.content_creation_date EXPRESSION [(atab)atab.FieldSchema(name:original_tstamp, type:string, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.ks_uid SIMPLE [(atab)atab.FieldSchema(name:ks_uid, type:bigint, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.self_ksc EXPRESSION [(mstab)mstab.FieldSchema(name:csc, type:int, comment:null), ]
+POSTHOOK: Lineage: joined_aa_view_tw.sr_id SIMPLE [(atab)atab.FieldSchema(name:sr_id, type:string, comment:null), ]
 PREHOOK: query: SELECT * FROM joined_aa_view_tw
 PREHOOK: type: QUERY
 PREHOOK: Input: default@aa_view_tw
diff --git a/ql/src/test/results/clientpositive/view_inputs.q.out b/ql/src/test/results/clientpositive/view_inputs.q.out
index aa52b332e1..f4d679ff06 100644
--- a/ql/src/test/results/clientpositive/view_inputs.q.out
+++ b/ql/src/test/results/clientpositive/view_inputs.q.out
@@ -8,6 +8,8 @@ POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_view1
+POSTHOOK: Lineage: test_view1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: test_view1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE VIEW test_view2 AS SELECT * FROM test_view1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@src
@@ -20,6 +22,8 @@ POSTHOOK: Input: default@src
 POSTHOOK: Input: default@test_view1
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_view2
+POSTHOOK: Lineage: test_view2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
+POSTHOOK: Lineage: test_view2.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: SELECT COUNT(*) FROM test_view1 a JOIN test_view2 b ON a.key = b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
