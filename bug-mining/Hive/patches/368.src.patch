diff --git a/CHANGES.txt b/CHANGES.txt
index 54cb2e4f9a..49801a5bc2 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -312,6 +312,9 @@ Trunk -  Unreleased
     HIVE-1279 Temporarily disable TestHBaseCliDriver
     (John Sichi via namit)
 
+    HIVE-1275 Fix TestHBaseCliDriver
+    (John Sichi via namit)
+
 Release 0.5.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/hbase-handler/build.xml b/hbase-handler/build.xml
index 8e1dd566bf..a0a3ad5408 100644
--- a/hbase-handler/build.xml
+++ b/hbase-handler/build.xml
@@ -50,11 +50,6 @@
     <path refid="classpath"/>
   </path>
 
-  <target name="test"
-  	depends="test-conditions,gen-test,compile-test,test-jar,test-init">
-    <echo message="HBase test execution is temporarily disabled"/>
-  </target>
-
   <target name="test-jar" depends="compile-test, jar">
     <delete file="${test.build.dir}/test-udfs.jar"/>
     <jar jarfile="${test.build.dir}/test-udfs.jar">
diff --git a/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseQTestUtil.java b/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseQTestUtil.java
index 5c3ec1730e..12d70a3fc2 100644
--- a/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseQTestUtil.java
+++ b/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseQTestUtil.java
@@ -15,89 +15,24 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-
 package org.apache.hadoop.hive.hbase;
 
-import java.io.File;
-
-import org.apache.hadoop.hbase.HBaseConfiguration;
-import org.apache.hadoop.hbase.HConstants;
-import org.apache.hadoop.hbase.MiniHBaseCluster;
-import org.apache.hadoop.hbase.MiniZooKeeperCluster;
-import org.apache.hadoop.hbase.client.HConnectionManager;
-import org.apache.hadoop.hbase.client.HTable;
 import org.apache.hadoop.hive.ql.QTestUtil;
-import org.apache.hadoop.mapred.JobConf;
-import org.apache.zookeeper.Watcher;
-
 
 /**
- * HBaseQTestUtil defines HBase-specific test fixtures.
+ * HBaseQTestUtil initializes HBase-specific test fixtures.
  */
 public class HBaseQTestUtil extends QTestUtil {
-
-  private String tmpdir;
-  
-  private MiniHBaseCluster hbase = null;
-  private MiniZooKeeperCluster zooKeeperCluster;
-  private static final int NUM_REGIONSERVERS = 1;
-  
   public HBaseQTestUtil(
-    String outDir, String logDir, boolean miniMr) throws Exception {
+    String outDir, String logDir, boolean miniMr, HBaseTestSetup setup)
+    throws Exception {
 
     super(outDir, logDir, miniMr);
-  }
-  
-  protected void preTestUtilInit() throws Exception {
-    // Setup the hbase Cluster
-    boolean success = false;
-    try {
-      conf.set("hbase.master", "local");
-      tmpdir =  System.getProperty("user.dir")+"/../build/ql/tmp";
-      conf.set("hbase.rootdir", "file://" + tmpdir + "/hbase");
-      zooKeeperCluster = new MiniZooKeeperCluster();
-      int clientPort = zooKeeperCluster.startup(
-        new File(tmpdir, "zookeeper"));
-      conf.set("hbase.zookeeper.property.clientPort",
-        Integer.toString(clientPort));
-      HBaseConfiguration hbaseConf = new HBaseConfiguration(conf);
-      hbase = new MiniHBaseCluster(hbaseConf, NUM_REGIONSERVERS);
-      conf.set("hbase.master", hbase.getHMasterAddress().toString());
-      // opening the META table ensures that cluster is running
-      new HTable(new HBaseConfiguration(conf), HConstants.META_TABLE_NAME);
-      success = true;
-    } finally {
-      if (!success) {
-        if (hbase != null) {
-          hbase.shutdown();
-        }
-        if (zooKeeperCluster != null) {
-          zooKeeperCluster.shutdown();
-        }
-      }
-    }
-    
-    String auxJars = conf.getAuxJars();
-    auxJars = ((auxJars == null) ? "" : (auxJars + ",")) + "file://"
-      + new JobConf(conf, HBaseConfiguration.class).getJar();
-    auxJars += ",file://" + new JobConf(conf, HBaseSerDe.class).getJar();
-    auxJars += ",file://" + new JobConf(conf, Watcher.class).getJar();
-    conf.setAuxJars(auxJars);
-  }
-  
-  public void shutdown() throws Exception {
-    if (hbase != null) {
-      HConnectionManager.deleteConnectionInfo(
-        new HBaseConfiguration(conf), true);
-      hbase.shutdown();
-      hbase = null;
-    }
-    if (zooKeeperCluster != null) {
-      zooKeeperCluster.shutdown();
-      zooKeeperCluster = null;
-    }
-    
-    super.shutdown();
+    setup.preTest(conf);
+    super.init();
   }
 
+  public void init() throws Exception {
+    // defer
+  }
 }
diff --git a/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseTestSetup.java b/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseTestSetup.java
new file mode 100644
index 0000000000..5b5c391cc0
--- /dev/null
+++ b/hbase-handler/src/test/org/apache/hadoop/hive/hbase/HBaseTestSetup.java
@@ -0,0 +1,102 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.hbase;
+
+import java.io.File;
+
+import junit.extensions.TestSetup;
+import junit.framework.Test;
+
+import org.apache.hadoop.hbase.HBaseConfiguration;
+import org.apache.hadoop.hbase.HConstants;
+import org.apache.hadoop.hbase.MiniHBaseCluster;
+import org.apache.hadoop.hbase.MiniZooKeeperCluster;
+import org.apache.hadoop.hbase.client.HConnectionManager;
+import org.apache.hadoop.hbase.client.HTable;
+import org.apache.hadoop.hive.conf.HiveConf;
+import org.apache.hadoop.mapred.JobConf;
+import org.apache.zookeeper.Watcher;
+
+/**
+ * HBaseTestSetup defines HBase-specific test fixtures which are
+ * reused across testcases.
+ */
+public class HBaseTestSetup extends TestSetup
+{
+  private MiniHBaseCluster hbaseCluster;
+  private MiniZooKeeperCluster zooKeeperCluster;
+  private int zooKeeperPort;
+  private String hbaseRoot;
+
+  private static final int NUM_REGIONSERVERS = 1;
+
+  public HBaseTestSetup(Test test) {
+    super(test);
+  }
+  
+  void preTest(HiveConf conf) throws Exception {
+    if (hbaseCluster == null) {
+      // We set up fixtures on demand for the first testcase, and leave
+      // them allocated for reuse across all others.  Then tearDown
+      // will get called once at the very end after all testcases have
+      // run, giving us a guaranteed opportunity to shut them down.
+      setUpFixtures(conf);
+    }
+    conf.set("hbase.rootdir", hbaseRoot);
+    conf.set("hbase.master", hbaseCluster.getHMasterAddress().toString());
+    conf.set("hbase.zookeeper.property.clientPort",
+      Integer.toString(zooKeeperPort));
+    String auxJars = conf.getAuxJars();
+    auxJars = ((auxJars == null) ? "" : (auxJars + ",")) + "file://"
+      + new JobConf(conf, HBaseConfiguration.class).getJar();
+    auxJars += ",file://" + new JobConf(conf, HBaseSerDe.class).getJar();
+    auxJars += ",file://" + new JobConf(conf, Watcher.class).getJar();
+    conf.setAuxJars(auxJars);
+  }
+
+  private void setUpFixtures(HiveConf conf) throws Exception {
+    conf.set("hbase.master", "local");
+    String tmpdir =  System.getProperty("user.dir")+"/../build/ql/tmp";
+    hbaseRoot = "file://" + tmpdir + "/hbase";
+    conf.set("hbase.rootdir", hbaseRoot);
+    zooKeeperCluster = new MiniZooKeeperCluster();
+    zooKeeperPort = zooKeeperCluster.startup(
+      new File(tmpdir, "zookeeper"));
+    conf.set("hbase.zookeeper.property.clientPort",
+      Integer.toString(zooKeeperPort));
+    HBaseConfiguration hbaseConf = new HBaseConfiguration(conf);
+    hbaseCluster = new MiniHBaseCluster(hbaseConf, NUM_REGIONSERVERS);
+    conf.set("hbase.master", hbaseCluster.getHMasterAddress().toString());
+    // opening the META table ensures that cluster is running
+    new HTable(new HBaseConfiguration(conf), HConstants.META_TABLE_NAME);
+  }
+
+  @Override
+  protected void tearDown() throws Exception {
+    if (hbaseCluster != null) {
+      HConnectionManager.deleteAllConnections(true);
+      hbaseCluster.shutdown();
+      hbaseCluster = null;
+    }
+    if (zooKeeperCluster != null) {
+      zooKeeperCluster.shutdown();
+      zooKeeperCluster = null;
+    }
+  }
+}
diff --git a/hbase-handler/src/test/templates/TestHBaseCliDriver.vm b/hbase-handler/src/test/templates/TestHBaseCliDriver.vm
index 6751c72985..db8571dc55 100644
--- a/hbase-handler/src/test/templates/TestHBaseCliDriver.vm
+++ b/hbase-handler/src/test/templates/TestHBaseCliDriver.vm
@@ -8,6 +8,7 @@ import java.io.*;
 import java.util.*;
 
 import org.apache.hadoop.hive.hbase.HBaseQTestUtil;
+import org.apache.hadoop.hive.hbase.HBaseTestSetup;
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.history.HiveHistoryViewer;
 import org.apache.hadoop.hive.ql.history.HiveHistory.QueryInfo;
@@ -23,10 +24,12 @@ import org.antlr.runtime.tree.*;
 public class $className extends TestCase {
 
   private HBaseQTestUtil qt;
+  private HBaseTestSetup setup;
 
-  public $className(String name) {
+  public $className(String name, HBaseTestSetup setup) {
     super(name);
     qt = null;
+    this.setup = setup;
   }
 
   @Override
@@ -38,7 +41,8 @@ public class $className extends TestCase {
       }
 
       qt = new HBaseQTestUtil(
-        "$resultsDir.getCanonicalPath()", "$logDir.getCanonicalPath()", miniMR);
+        "$resultsDir.getCanonicalPath()",
+        "$logDir.getCanonicalPath()", miniMR, setup);
 
 #foreach ($qf in $qfiles)
       qt.addFile("$qf.getCanonicalPath()");
@@ -66,13 +70,14 @@ public class $className extends TestCase {
 
   public static Test suite() {
     TestSuite suite = new TestSuite();
+    HBaseTestSetup setup = new HBaseTestSetup(suite);
 #foreach ($qf in $qfiles)
   #set ($fname = $qf.getName())
   #set ($eidx = $fname.length() - 2)
   #set ($tname = $fname.substring(0, $eidx))
-    suite.addTest(new $className("testCliDriver_$tname"));
+    suite.addTest(new $className("testCliDriver_$tname", setup));
 #end
-    return suite;
+    return setup;
   }
 
 #foreach ($qf in $qfiles)
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
index 3bae86978f..69f1b3f6ec 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
@@ -200,15 +200,9 @@ public QTestUtil(String outDir, String logDir, boolean miniMr) throws Exception
 
     srcTables = new LinkedList<String>();
 
-    preTestUtilInit();
     init();
   }
 
-  protected void preTestUtilInit() throws Exception {
-    // do some initialization before we setup the hive
-    // for example, in a HBase Test Util, we setup a hbase mini cluster here
-  }
-
   public void shutdown() throws Exception {
     cleanUp();
 
