diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/optiq/HiveOptiqUtil.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/optiq/HiveOptiqUtil.java
index 7c2b0cd020..4bb99d9086 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/optiq/HiveOptiqUtil.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/optiq/HiveOptiqUtil.java
@@ -77,7 +77,8 @@ public static List<Integer> getVirtualCols(List<? extends RexNode> exps) {
 
   public static boolean validateASTForCBO(ASTNode ast) {
     String astTree = ast.toStringTree();
-    String[] tokens = { "TOK_CHARSETLITERAL" };
+    // if any of following tokens are present in AST, bail out
+    String[] tokens = { "TOK_CHARSETLITERAL","TOK_TABLESPLITSAMPLE" };
     for (String token : tokens) {
       if (astTree.contains(token)) {
         return false;
