<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:40:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8979] XML (Woodstox/MSV) based schema validation is broken</title>
                <link>https://issues.apache.org/jira/browse/CXF-8979</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The current approach to implement the xml schema validation with the Woodstox/&lt;br/&gt;
W3CMultiSchemaFactory is unable to validate many schema and returns false-positive results for them.&lt;br/&gt;
&#160;&lt;br/&gt;
The validator is attached on an&#160; (&lt;tt&gt;NUllOutputStream&lt;/tt&gt;-) XMLStreamWriter (see org/apache/cxf/databinding/source/XMLStreamDataReader.java:231) but this can&apos;t work for abstract elements which needs to be declared explicit thru xsi:type attribute.&lt;br/&gt;
&#160;&lt;br/&gt;
For example the following element:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AbstractElement xsi:type=&lt;span class=&quot;code-quote&quot;&gt;&quot;test:STE_ReproducerBasis&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Valid1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/AbstractElement&amp;gt;&lt;/span&gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;can&apos;t be validate thru this approach because at time of the &quot;StartElement&quot; validation&#160; of the AbstractElement tag (see &lt;em&gt;com.ctc.wstx.msv.GenericMsvValidator#validateElementStart&lt;/em&gt;) the &lt;tt&gt;xsi:type&lt;/tt&gt; attribute is not known to the current attribute-context and therefore it&apos;s not possible to create the right &quot;ChildAcceptor&quot;.&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;It returns with an (false-positive) validation error.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;I&apos;ve attached an reproducer&lt;/b&gt; which shows an example and that the validation fails only because it was attached on an writer. &lt;/p&gt;

&lt;p&gt;The same xml could be successfully validated if the validator was attached to the reader instance.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t understand the decision why the validator was attached on the writer and not the reader.&#160;&lt;/p&gt;

&lt;p&gt;Perhaps someone could give some more details about this and then i could try to solve this bug by myself (pull-request).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Another point: it looks like there is no way to choose between MSV and the fallback (schema.newValidator().validate(..)) implementation.&lt;br/&gt;
&lt;b&gt;This leaves me in a problematic situation, i can&apos;t explicit switch to the fallback (which will work).&lt;/b&gt; Perhaps this should be allowed in the fix of this issue too.&lt;br/&gt;
&#160;&lt;br/&gt;
&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13067108/13067108_reproducer.tgz&quot; title=&quot;reproducer.tgz attached to CXF-8979&quot;&gt;reproducer.tgz&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13570128">CXF-8979</key>
            <summary>XML (Woodstox/MSV) based schema validation is broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="msc@onesty-tech.de">Markus Schulz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Feb 2024 09:44:55 +0000</created>
                <updated>Thu, 21 Nov 2024 18:39:34 +0000</updated>
                            <resolved>Thu, 21 Nov 2024 18:39:34 +0000</resolved>
                                    <version>3.6.2</version>
                    <version>4.0.3</version>
                                    <fixVersion>4.1.0</fixVersion>
                    <fixVersion>3.5.10</fixVersion>
                    <fixVersion>3.6.5</fixVersion>
                    <fixVersion>4.0.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17900113" author="ffang" created="Thu, 21 Nov 2024 16:21:26 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msc%40onesty-tech.de&quot; class=&quot;user-hover&quot; rel=&quot;msc@onesty-tech.de&quot;&gt;msc@onesty-tech.de&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks for the reproducer, this helps a lot!&lt;/p&gt;

&lt;p&gt;However, I don&apos;t think this is a CXF side issue, more like a woodstax/msv side problem. Please see the attached revised SchemaValidationTest.java from which no CXF code gets involved at all, and we can see exactly the same behaviour. Please report this to woodstax/msv community.&lt;/p&gt;

&lt;p&gt;Also, I think we can introduce a context property, with it value as &quot;true&quot;(default is false to keep the behaviour as is), we can force to use the fallback schema validator like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
schema.newValidator().validate(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DOMSource(newElement));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Best Regards&lt;br/&gt;
Freeman&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                            <attachment id="13072994" name="SchemaValidationTest.java" size="3347" author="ffang" created="Thu, 21 Nov 2024 16:17:51 +0000"/>
                            <attachment id="13067108" name="reproducer.tgz" size="3109" author="msc@onesty-tech.de" created="Wed, 28 Feb 2024 09:03:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1no2w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>