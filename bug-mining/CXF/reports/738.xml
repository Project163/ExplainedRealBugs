<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:43:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-3148] CXF converts collections to arrays during serialization</title>
                <link>https://issues.apache.org/jira/browse/CXF-3148</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;In org.apache.cxf.jaxrs.provider.JAXBElementProvider.marshalCollection(Class&amp;lt;?&amp;gt;, Object, Class&amp;lt;?&amp;gt;, Type, String, OutputStream, MediaType), it converts the resulting collection into an array before serializing it.&lt;/p&gt;

&lt;p&gt;Unfortunately, this prevents us from using a collection that lazily loads its contents from the DB as it goes, since toArray() would require us to create and return all the results immediately.&lt;/p&gt;

&lt;p&gt;Ideally this method would be changed to operate in a manner that is &quot;friendly&quot; to lazy collections, by only using the collection&apos;s iterator (once).&lt;/p&gt;

&lt;p&gt;This version iterates over the collection only once, which would be the most efficient for collections that are backed by out of memory storage:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void marshalCollection(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; originalCls, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; actualObject, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; actualClass, Type genericType, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; encoding,
			OutputStream os, MediaType m) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

		Collection c = originalCls.isArray() ? Arrays.asList((&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[]) actualObject) : (Collection) actualObject;
		
		Iterator it = c.iterator();
		
		&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; empty = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; == it.hasNext();
		&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; firstObj = empty?&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:it.next();
		QName qname = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (firstObj &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; JAXBElement) {
			JAXBElement el = (JAXBElement) firstObj;
			qname = el.getName();
			actualClass = el.getDeclaredType();
		} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
			qname = getCollectionWrapperQName(actualClass, genericType, actualObject, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
		}
		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (qname == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
			&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; message = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.cxf.common.i18n.Message(&lt;span class=&quot;code-quote&quot;&gt;&quot;NO_COLLECTION_ROOT&quot;&lt;/span&gt;, BUNDLE).toString();
			&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; WebApplicationException(Response.serverError().entity(message).build());
		}

		&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; startTag = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
		&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; endTag = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (qname.getNamespaceURI().length() &amp;gt; 0) {
			startTag = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;ns1:&quot;&lt;/span&gt; + qname.getLocalPart() + &lt;span class=&quot;code-quote&quot;&gt;&quot; xmlns:ns1=\&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot; + qname.getNamespaceURI() + &quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;;
			endTag = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/ns1:&quot;&lt;/span&gt; + qname.getLocalPart() + &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;;
		} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
			startTag = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;&quot;&lt;/span&gt; + qname.getLocalPart() + &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;;
			endTag = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/&quot;&lt;/span&gt; + qname.getLocalPart() + &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;;
		}
		os.write(startTag.getBytes());
		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(!empty) {
			marshalCollectionMember(firstObj &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; JAXBElement ? ((JAXBElement) firstObj).getValue() : firstObj, actualClass, genericType, encoding, os, m, qname
					.getNamespaceURI());
			&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (it.hasNext()) {
				&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o = it.next();
				marshalCollectionMember(o &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; JAXBElement ? ((JAXBElement) o).getValue() : o, actualClass, genericType, encoding, os, m, qname
						.getNamespaceURI());
			}
		}
		os.write(endTag.getBytes());
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12480751">CXF-3148</key>
            <summary>CXF converts collections to arrays during serialization</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="dobes_vandermeer">Dobes Vandermeer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Nov 2010 23:30:07 +0000</created>
                <updated>Mon, 6 Dec 2010 22:49:14 +0000</updated>
                            <resolved>Wed, 24 Nov 2010 18:25:16 +0000</resolved>
                                    <version>2.3</version>
                                    <fixVersion>2.2.12</fixVersion>
                    <fixVersion>2.3.1</fixVersion>
                    <fixVersion>2.4</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12935426" author="sergey_beryozkin" created="Wed, 24 Nov 2010 18:25:16 +0000"  >&lt;p&gt;Fix has been applied, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47060</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kl1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>118226</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>