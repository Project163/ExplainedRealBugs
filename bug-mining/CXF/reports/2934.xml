<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:22:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7174] NullPointerException when Content-Type is not specified in the http request</title>
                <link>https://issues.apache.org/jira/browse/CXF-7174</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When the Content-Type header is not specified in the HttpServletRequest, a null pointer is possible when calling Headers.copyFromRequest(...) followed by Headers.determineContentType().  This scenario is possible when using non-traditional clients like curl.&lt;/p&gt;

&lt;p&gt;Here is an example (snippet) of the NPE:&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR Caused by: java.lang.NullPointerException&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR    at org.apache.cxf.transport.http.Headers.determineContentType(Headers.java:374)&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR    at org.apache.cxf.transport.http.Headers.setProtocolHeadersInConnection(Headers.java:363)&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR    at org.apache.cxf.transport.http.URLConnectionHTTPConduit$URLConnectionWrappedOutputStream.setProtocolHeaders(URLConnectionHTTPConduit.java:279)&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleHeadersTrustCaching(HTTPConduit.java:1301)&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1337)&lt;br/&gt;
2016-12-09T09:29:47.24-0600 &lt;span class=&quot;error&quot;&gt;&amp;#91;APP/0&amp;#93;&lt;/span&gt;      ERR    ... 56 more&lt;/p&gt;

&lt;p&gt;The failing line of code is:&lt;br/&gt;
if (ctList != null &amp;amp;&amp;amp; ctList.size() == 1) {&lt;br/&gt;
            ct = ctList.get(0).toString();  // &amp;lt;--- here&lt;/p&gt;

&lt;p&gt;The reason it fails is that copyFromRequest(...) will create a singleton list and wrap the request&apos;s content-type value in it.  If the content-type from the request is null, then ctList will be a singleton list with a null value in it, so the call to toString() will be on a null value.&lt;/p&gt;

&lt;p&gt;Instead, the code should be:&lt;br/&gt;
if (ctList != null &amp;amp;&amp;amp; ctList.size() == 1 &amp;amp;&amp;amp; ctList.get(0) != null) {&lt;br/&gt;
            ct = ctList.get(0).toString(); &lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;This ensures that a default content type of text/xml is returned when no content-type is specified in the request &amp;#8211; or whatever was specified in the Message.&lt;/p&gt;

&lt;p&gt;This approach is preferable to just setting ctList (via the headers.get(Message.CONTENT_TYPE) field) to null because other places in the code depend on that list to be non-null.&lt;/p&gt;

&lt;p&gt;I have a patch and test case to be delivered shortly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13027138">CXF-7174</key>
            <summary>NullPointerException when Content-Type is not specified in the http request</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="andymc">Andrew J McMurry</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Dec 2016 23:40:25 +0000</created>
                <updated>Mon, 27 Feb 2017 15:08:25 +0000</updated>
                            <resolved>Mon, 12 Dec 2016 10:42:07 +0000</resolved>
                                    <version>3.1.8</version>
                                    <fixVersion>3.1.10</fixVersion>
                    <fixVersion>3.0.13</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15736701" author="githubbot" created="Fri, 9 Dec 2016 23:45:29 +0000"  >&lt;p&gt;GitHub user andymc12 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/213&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7174&quot; title=&quot;NullPointerException when Content-Type is not specified in the http request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7174&quot;&gt;&lt;del&gt;CXF-7174&lt;/del&gt;&lt;/a&gt;: Avoid NPE when content-type not set in http request&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/andymc12/cxf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/andymc12/cxf&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/213.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/213.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #213&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 96e5325b013ecb43ab81ae1ee2094a7b0ff06e20&lt;br/&gt;
Author: andymc12 &amp;lt;j.andrew.mccright@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-12-09T23:41:33Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7174&quot; title=&quot;NullPointerException when Content-Type is not specified in the http request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7174&quot;&gt;&lt;del&gt;CXF-7174&lt;/del&gt;&lt;/a&gt;: Avoid NPE when content-type not set in http request&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15741525" author="githubbot" created="Mon, 12 Dec 2016 10:04:17 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/213&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15741589" author="sergey_beryozkin" created="Mon, 12 Dec 2016 10:42:07 +0000"  >&lt;p&gt;Hi Andy, thanks for the patch&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 49 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37ff3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>