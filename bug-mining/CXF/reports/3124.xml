<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:26:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7488] Protocol Mismatch when using Netty with TLS</title>
                <link>https://issues.apache.org/jira/browse/CXF-7488</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I&apos;m using the classes NettyHttpServerEngineFactory and NettyHttpServerEngine to configure a server with TLS using only Java code (without Spring or other XML configurations). Therefore I constructed the necessary TLSServerParameters and created an engine factory:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TLSServerParameters tlsParams = new TLSServerParameters();
tlsParams.setKeyManagers(km);
tlsParams.setTrustManagers(tm);
tlsParams.setCipherSuitesFilter(filter);
tlsParams.setClientAuthentication(ca);
NettyHttpServerEngineFactory factory = new NettyHttpServerEngineFactory(sf.getBus());
Map&amp;lt;String, TLSServerParameters&amp;gt; tlsParamsMap = new HashMap&amp;lt;&amp;gt;();
tlsParamsMap.put(Integer.toString(port), tlsParams);
factory.setTlsServerParameters(tlsParamsMap);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Where sf is an object of JaxWsServerFactoryBean and I previously initialized all the necessary KeyManagers etc.&lt;br/&gt;
Afterwards I want to create an engine using the factory:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;NettyHttpServerEngine engine = localFactory.createNettyHttpServerEngine(port, &quot;https&quot;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Afterwards I get the following Exception:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.io.IOException: Protocol mismatch for port 4816: engine&apos;s protocol is http, the url protocol is https
	at org.apache.cxf.transport.http.netty.server.NettyHttpServerEngineFactory.createNettyHttpServerEngine(NettyHttpServerEngineFactory.java:184)
	at org.apache.cxf.transport.http.netty.server.NettyHttpServerEngineFactory.createNettyHttpServerEngine(NettyHttpServerEngineFactory.java:194)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When looking at the (really similar) class &lt;cite&gt;JettyHTTPServerEngineFactory&lt;/cite&gt; there is a method &lt;cite&gt;retrieveListenerFactory&lt;/cite&gt; called in methods &lt;cite&gt;setTlsServerParameters&lt;/cite&gt; and &lt;cite&gt;finalizeConfig&lt;/cite&gt; which changes the protocol of the engine to https when tls parameters are provided, in &lt;cite&gt;NettyHttpServerEngineFactory&lt;/cite&gt; it doesn&apos;t exist so far and the &lt;cite&gt;finalizeConfig&lt;/cite&gt; method is empty.&lt;/p&gt;

&lt;p&gt;Could you provide something similar to used code in &lt;cite&gt;JettyHTTPServerEngineFactory&lt;/cite&gt; aswell in &lt;cite&gt;NettyHttpServerEngineFactory&lt;/cite&gt; as it would solve my problems perfectly.&lt;/p&gt;

&lt;p&gt;Let me know if I need to provide any other informations/code.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7, JDK 1.8.0_144&lt;/p&gt;</environment>
        <key id="13098249">CXF-7488</key>
            <summary>Protocol Mismatch when using Netty with TLS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="lars.kaulen">Lars Kaulen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Aug 2017 12:24:41 +0000</created>
                <updated>Tue, 28 Nov 2017 10:42:15 +0000</updated>
                            <resolved>Tue, 29 Aug 2017 16:20:23 +0000</resolved>
                                    <version>3.1.12</version>
                                    <fixVersion>3.1.13</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16145579" author="coheigea" created="Tue, 29 Aug 2017 16:20:23 +0000"  >
&lt;p&gt;Please give the latest source code a go and see if it works for you.&lt;/p&gt;</comment>
                            <comment id="16146823" author="lars.kaulen" created="Wed, 30 Aug 2017 07:42:24 +0000"  >&lt;p&gt;Thanks for the (incredible) fast support/fix, works perfectly for me.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3jedj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>