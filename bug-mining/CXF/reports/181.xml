<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:36:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-1895] Invalid character set UTF-8; action= urn:ihe:iti:2007:RetrieveDocumentSet in request in Contet-type</title>
                <link>https://issues.apache.org/jira/browse/CXF-1895</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>

&lt;p&gt;Hi, I have a problem reading this soap Message, CXF throw  &quot;java.io.IOException: Invalid character set UTF-8; action= urn:ihe:iti:2007:RetrieveDocumentSet in request.&quot;&lt;/p&gt;

&lt;p&gt;POST /EuleroXDSRepository/repositoryb HTTP/1.1&lt;br/&gt;
Content-Type: application/soap+xml; charset=UTF-8; action=&quot;urn:ihe:iti:2007:RetrieveDocumentSet&quot;&lt;br/&gt;
User-Agent: Axis2&lt;br/&gt;
Host: 172.30.20.161:8888&lt;br/&gt;
Transfer-Encoding: chunked&lt;/p&gt;

&lt;p&gt;2f3&lt;br/&gt;
&amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;UTF-8&apos;?&amp;gt;&amp;lt;soapenv:Envelope xmlns:soapenv=&quot;http://www.w3.org/2003/05/soap-envelope&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot;&amp;gt;&amp;lt;soapenv:Header&amp;gt;&amp;lt;wsa:To&amp;gt;&lt;a href=&quot;http://localhost:8888/EuleroXDSRepository/repositoryb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8888/EuleroXDSRepository/repositoryb&lt;/a&gt;&amp;lt;/wsa:To&amp;gt;&amp;lt;wsa:MessageID&amp;gt;urn:uuid:F99C8EB3F258E6DC751225718664373&amp;lt;/wsa:MessageID&amp;gt;&amp;lt;wsa:Action&amp;gt;urn:ihe:iti:2007:RetrieveDocumentSet&amp;lt;/wsa:Action&amp;gt;&amp;lt;/soapenv:Header&amp;gt;&amp;lt;soapenv:Body&amp;gt;&amp;lt;RetrieveDocumentSetRequest xmlns=&quot;urn:ihe:iti:xds-b:2007&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;DocumentRequest&amp;gt;&lt;br/&gt;
        &amp;lt;RepositoryUniqueId&amp;gt;urn:4a8afe2&amp;lt;/RepositoryUniqueId&amp;gt;&lt;br/&gt;
        &amp;lt;DocumentUniqueId&amp;gt;172.30.20.187262&amp;lt;/DocumentUniqueId&amp;gt;&lt;br/&gt;
    &amp;lt;/DocumentRequest&amp;gt;&lt;br/&gt;
&amp;lt;/RetrieveDocumentSetRequest&amp;gt;&amp;lt;/soapenv:Body&amp;gt;&amp;lt;/soapenv:Envelope&amp;gt;&lt;br/&gt;
0&lt;/p&gt;

</description>
                <environment>&lt;p&gt;Linux, Ubuntu 8.04&lt;/p&gt;</environment>
        <key id="12407706">CXF-1895</key>
            <summary>Invalid character set UTF-8; action= urn:ihe:iti:2007:RetrieveDocumentSet in request in Contet-type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="andrea.bozzetto">Andrea Bozzetto</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Nov 2008 13:40:46 +0000</created>
                <updated>Mon, 9 Feb 2009 22:19:40 +0000</updated>
                            <resolved>Thu, 22 Jan 2009 20:06:32 +0000</resolved>
                                    <version>2.1.3</version>
                                    <fixVersion>2.0.10</fixVersion>
                    <fixVersion>2.1.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12644753" author="sergey_beryozkin" created="Mon, 3 Nov 2008 17:05:11 +0000"  >&lt;p&gt;The problem seems to be quite obvious - cxf code assumes that there&apos;re only one possible content type value parameter (charset). Fixing it should be easy - but if the action parameter needs to be preserved then it might be worth saving the ContentType info in a wrapper class, similar to a MediaType JAX-RS class. A similar CXF-specific class can be introduced.&lt;/p&gt;

&lt;p&gt;in CXF JAX-RS we have an implementation of MediaType so one option is to move its internals  into some common utility code like MediaTypeUtils.java, and have it reused between JAXWS and JAXRS runtimes  &lt;/p&gt;</comment>
                            <comment id="12644923" author="andrea.bozzetto" created="Tue, 4 Nov 2008 08:20:13 +0000"  >&lt;p&gt;I don&apos;t understand what you mean. &lt;/p&gt;

&lt;p&gt;The charset parameter is used by servlet class. This is the callstack:&lt;/p&gt;

&lt;p&gt;17:29:21,163 ERROR [&lt;span class=&quot;error&quot;&gt;&amp;#91;CXFServlet&amp;#93;&lt;/span&gt;] Servlet.service() for servlet CXFServlet threw exception&lt;br/&gt;
java.io.IOException: Invalid character set UTF-8; action= urn:ihe:iti:2007:RetrieveDocumentSet in request.&lt;br/&gt;
	at org.apache.cxf.transport.http.AbstractHTTPDestination.setupMessage(AbstractHTTPDestination.java:271)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletDestination.invoke(ServletDestination.java:82)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:285)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:168)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractCXFServlet.invoke(AbstractCXFServlet.java:175)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractCXFServlet.doPost(AbstractCXFServlet.java:153)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:810)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)&lt;/p&gt;


&lt;p&gt;I try to patch the class HTTPConduit in this way:&lt;/p&gt;

&lt;p&gt; protected void handleResponseInternal() throws IOException {&lt;/p&gt;

&lt;p&gt;.....&lt;/p&gt;


&lt;p&gt;            inMessage.put(Message.PROTOCOL_HEADERS, headers);&lt;br/&gt;
            inMessage.put(Message.RESPONSE_CODE, responseCode);&lt;br/&gt;
            String ct = connection.getContentType();&lt;br/&gt;
            inMessage.put(Message.CONTENT_TYPE, ct);&lt;br/&gt;
            String charset = null;&lt;br/&gt;
            if (ct != null &lt;br/&gt;
                &amp;amp;&amp;amp; ct.indexOf(&quot;charset&quot;) != -1) {&lt;br/&gt;
                charset = ct.substring(ct.indexOf(&quot;charset&quot;) + 8);&lt;br/&gt;
                if (charset.indexOf(&quot;;&quot;) != -1) &lt;/p&gt;
{
                    charset = charset.substring(0, charset.indexOf(&quot;;&quot;));
                }

&lt;p&gt;    		int idx2 = charset.indexOf(&quot;;&quot;);&lt;br/&gt;
   	 	if (idx2 != -1)&lt;br/&gt;
			charset = charset.substring(0, idx2).trim();&lt;br/&gt;
  	 	else&lt;br/&gt;
   	 		charset = charset.trim();&lt;/p&gt;


&lt;p&gt;            }&lt;/p&gt;

&lt;p&gt;....&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;If it works I will submit the class.&lt;/p&gt;

&lt;p&gt;bye&lt;/p&gt;</comment>
                            <comment id="12644929" author="njiang" created="Tue, 4 Nov 2008 08:57:25 +0000"  >&lt;p&gt;Hi Andrea,&lt;/p&gt;

&lt;p&gt;You could use below code to get the the charset string. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] tokens = contentType.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;;&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; token : tokens) {
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; index = token.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;charset=&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (index &amp;gt;= 0) {
                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; charset = token.substring(index + 8); 
                &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt; ; 
            }            
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Willem&lt;/p&gt;</comment>
                            <comment id="12644939" author="andrea.bozzetto" created="Tue, 4 Nov 2008 10:42:15 +0000"  >&lt;p&gt;Finally I did change the class HttpHeaderHelper in this way because HTTPConduit was not called :&lt;/p&gt;

&lt;p&gt;    public static String mapCharset(String enc) {&lt;br/&gt;
        if (enc == null) &lt;/p&gt;
{
            return UTF8.name();
        }&lt;br/&gt;
&lt;br/&gt;
	if (enc != null &lt;br/&gt;
                &amp;amp;&amp;amp; enc.indexOf(&quot;;&quot;) != -1) {
    		int idx2 = enc.indexOf(&quot;;&quot;);
   	 	if (idx2 != -1)
			enc = enc.substring(0, idx2).trim();
  	 	else
   	 		enc = enc.trim();
    			

            }&lt;br/&gt;
&lt;br/&gt;
        // Charsets can be quoted. But it&apos;s quite certain that they can&apos;t have escaped quoted or&lt;br/&gt;
        // anything like that.&lt;br/&gt;
        enc = enc.replace(&quot;\&quot;&quot;, &quot;&quot;);&lt;br/&gt;
        enc = enc.replace(&quot;&apos;&quot;, &quot;&quot;);&lt;br/&gt;
        if (&quot;&quot;.equals(enc)) {            return UTF8.name();        }
&lt;p&gt;        String newenc = encodings.get(enc);&lt;br/&gt;
        if (newenc == null) {&lt;br/&gt;
            try &lt;/p&gt;
{
                newenc = Charset.forName(enc).name();
            }
&lt;p&gt; catch (IllegalCharsetNameException icne) &lt;/p&gt;
{
                return null;
            } catch (UnsupportedCharsetException uce) {                return null;            }
&lt;p&gt;            encodings.put(enc, newenc);&lt;br/&gt;
        }&lt;br/&gt;
        return newenc;&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;bye&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>50412</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1aczb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>268569</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>