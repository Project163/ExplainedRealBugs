<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:01:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5059] Refine classloader in org.apache.cxf.wsdl11.WSDLManagerImpl</title>
                <link>https://issues.apache.org/jira/browse/CXF-5059</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I was packaging the CXF jars(e.g.cxf-rt-core-2.6.2.jar ) into a OSGi bundle then use it to create web service. In my scenario, it is found that if there are respect binding resources defined in the .war/META-INF/extensions.xml, it will not be properly loaded and will caused the &quot;Unknown wsdl binding extension&quot; error.&lt;br/&gt;
After investigation, it&apos;s found that in the org.apache.cxf.wsdl11.WSDLManagerImpl.registerInitialXmlExtensions()method, the classloader is got by the following line:&lt;br/&gt;
             initialExtensions = PropertiesLoaderUtils.loadAllProperties(resource, &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.getClass().getClassLoader());&lt;br/&gt;
And caused the classes defined in .war/META-INF/extensions.xml was not correctly loaded.&lt;br/&gt;
I checked the similar scenario in org.apache.cxf.catalog.OASISCatalogManager.loadContextCatalogs and found it get classload like this:&lt;br/&gt;
loadCatalogs(Thread.currentThread().getContextClassLoader(), name);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I tried to refine the classloader in WSDLManagerImpl like this and now it works in my test. Could someone help review this patch? Thanks in advance.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12651289">CXF-5059</key>
            <summary>Refine classloader in org.apache.cxf.wsdl11.WSDLManagerImpl</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="zhubinbj">Bin Zhu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jun 2013 08:27:08 +0000</created>
                <updated>Wed, 14 Aug 2013 15:49:22 +0000</updated>
                            <resolved>Fri, 7 Jun 2013 08:14:07 +0000</resolved>
                                    <version>2.6.2</version>
                    <version>2.6.8</version>
                                    <fixVersion>2.5.11</fixVersion>
                    <fixVersion>2.6.9</fixVersion>
                    <fixVersion>2.7.6</fixVersion>
                    <fixVersion>3.0.0-milestone1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13676847" author="ffang" created="Thu, 6 Jun 2013 08:50:45 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Though not take a close look at this issue, just a quick hint, since CXF 2.6.0, cxf-rt-core is already an OSGi bundle, so you needn&apos;t package it as a bundle yourself. Try use it as a bundle directly and see if you still run into this issue.&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="13676889" author="zhubinbj" created="Thu, 6 Jun 2013 10:23:45 +0000"  >&lt;p&gt;Hi Freeman,&lt;br/&gt;
Thanks for the information. I will try the cxf jar directly later.&lt;br/&gt;
But based on my understanding, it seems the this.getClass().getClassLoader() will only get the classloader for current bundler and may not allow CXF to load the classes defined in .war/META-INF/extensions.xml.&lt;br/&gt;
And in org.apache.cxf.catalog.OASISCatalogManager.loadContextCatalogs, there is a similar usage to get classloader by (Thread.currentThread().getContextClassLoader(). And there will be no problem in my scenario.&lt;br/&gt;
Any thought why the .OASISCatalogManager.loadContextCatalogs get classloader in this way but WSDLManagerImpl not?&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13677809" author="ffang" created="Fri, 7 Jun 2013 04:57:47 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Revise your patch a little bit, add TCCL as fallback so it can load resources from other bundles in OSGi container&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/r1490506&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490506&lt;/a&gt; for trunk&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490509&lt;/a&gt; for 2.7.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490510&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490510&lt;/a&gt; for 2.6.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490513&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490513&lt;/a&gt; for 2.5.x branch&lt;/p&gt;</comment>
                            <comment id="13677815" author="zhubinbj" created="Fri, 7 Jun 2013 05:37:49 +0000"  >&lt;p&gt;Thanks for the revision. It looks pretty good now and works well in my scenario.&lt;/p&gt;</comment>
                            <comment id="13677862" author="dkulp" created="Fri, 7 Jun 2013 06:41:00 +0000"  >&lt;p&gt;Freeman and Bin,&lt;/p&gt;

&lt;p&gt;Actually, both usecases should likely use the classloader from the bus (bus.getExtension(ClassLoader.class)) if there is one, otherwise fall back to the TCCL.  In OSGi, if using blueprint, the TCCL is likely null or not set to the applications classloader.  If using Spring, it may be set, but in other cases, it may not be.  &lt;/p&gt;

&lt;p&gt;That said, I would suggest not using extensions.xml thing at all.   I&apos;m strongly considering removing it for 3.0 as nothing within CXF uses it anymore.   It also doesn&apos;t work well in OSGi anyway.   To work correctly in OSGi, there would need to be a bundle listener or something that check all the loaded bundles for those files (like we do for the bus-extensions.xml).  My suggestion is to create a bean that WSDLExtensionLoader which registers things it needs to register.  Stick that bean in the bus-extensions.txt. &lt;/p&gt;</comment>
                            <comment id="13677872" author="ffang" created="Fri, 7 Jun 2013 07:10:45 +0000"  >&lt;p&gt;@Dan,&lt;br/&gt;
Thanks for the input, I will revise per your suggestion to use bus.getExtension(ClassLoader.class) for now.&lt;/p&gt;

&lt;p&gt;@Bin,&lt;br/&gt;
Without fix for this issue, in your customer bundle, you can implements your own WSDLExtensionLoader and then put that bean in the bus-extensions.txt in your bundle, you can take a look at how it is implemented similarly in cxf jms transport bundle, the JMSWSDLExtensionLoader&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; which can register jms related wsdl extensions, and the bus-extensions.txt&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; which could be loaded automatically by bus. And this is the recommended way in OSGi container and would work with any future CXF releases.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;https://svn.apache.org/repos/asf/cxf/trunk/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/wsdl11/JMSWSDLExtensionLoader.java&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;https://svn.apache.org/repos/asf/cxf/trunk/rt/transports/jms/src/main/resources/META-INF/cxf/bus-extensions.txt&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="13677885" author="ffang" created="Fri, 7 Jun 2013 08:14:07 +0000"  >&lt;p&gt;use bus.getExtension(ClassLoader.class) as default CL&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490526&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490526&lt;/a&gt; for trunk&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490529&lt;/a&gt; for 2.7.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490530&lt;/a&gt; for 2.6.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1490532&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490532&lt;/a&gt; for 2.5.x branch&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12586471" name="CXF-5059.patch" size="560" author="zhubinbj" created="Thu, 6 Jun 2013 08:28:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331615</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l7jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331946</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>