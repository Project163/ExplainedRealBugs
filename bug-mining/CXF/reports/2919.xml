<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:22:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7117] Swagger2Feature not working in OSGi container when jaxrs server address not attached to CXF servlet</title>
                <link>https://issues.apache.org/jira/browse/CXF-7117</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Just modify sample description_swagger2_osgi as follows:&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- CXF Swagger2Feature --&amp;gt;  &lt;br/&gt;
    &amp;lt;bean id=&quot;swagger2Feature&quot; class=&quot;org.apache.cxf.jaxrs.swagger.Swagger2Feature&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;basePath&quot; value=&quot;/test/swaggerSample&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;usePathBasedConfig&quot; value=&quot;true&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;cxf:bus&amp;gt;&lt;br/&gt;
        &amp;lt;cxf:features&amp;gt;&lt;br/&gt;
            &amp;lt;cxf:logging /&amp;gt;&lt;br/&gt;
        &amp;lt;/cxf:features&amp;gt;&lt;br/&gt;
    &amp;lt;/cxf:bus&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;jaxrs:server id=&quot;sampleServer&quot; address=&quot;http://localhost:9091/test/swaggerSample&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;jaxrs:serviceBeans&amp;gt;&lt;br/&gt;
            &amp;lt;ref component-id=&quot;sampleResource&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;/jaxrs:serviceBeans&amp;gt;&lt;br/&gt;
        &amp;lt;jaxrs:providers&amp;gt;&lt;br/&gt;
            &amp;lt;ref component-id=&quot;jsonProvider&quot; /&amp;gt;&lt;br/&gt;
            &amp;lt;ref component-id=&quot;multipartProvider&quot; /&amp;gt;&lt;br/&gt;
            &amp;lt;ref component-id=&quot;originFilter&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;/jaxrs:providers&amp;gt;&lt;br/&gt;
        &amp;lt;jaxrs:features&amp;gt;&lt;br/&gt;
            &amp;lt;ref component-id=&quot;swagger2Feature&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;/jaxrs:features&amp;gt;&lt;br/&gt;
    &amp;lt;/jaxrs:server&amp;gt;&lt;/p&gt;


&lt;p&gt;Then deploy modified bundle into Karaf and browse Swagger service definition at &lt;a href=&quot;http://localhost:9091/test/swaggerSample/swagger.json&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9091/test/swaggerSample/swagger.json&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Result is:&lt;/p&gt;
{&quot;swagger&quot;:&quot;2.0&quot;}</description>
                <environment>&lt;p&gt;Apache Karaf 3.0.8&lt;/p&gt;</environment>
        <key id="13016684">CXF-7117</key>
            <summary>Swagger2Feature not working in OSGi container when jaxrs server address not attached to CXF servlet</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="nsaboy">Concombre Masqu&#233;</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Oct 2016 18:09:24 +0000</created>
                <updated>Wed, 22 Mar 2017 17:25:03 +0000</updated>
                            <resolved>Thu, 17 Nov 2016 12:23:06 +0000</resolved>
                                    <version>3.1.8</version>
                                    <fixVersion>3.1.9</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>OSGi</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15636794" author="sergey_beryozkin" created="Fri, 4 Nov 2016 15:56:03 +0000"  >&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;Can you please remove a &quot;basePath&quot; and &quot;usePathBasedConfig&quot; properties ?&lt;/p&gt;

&lt;p&gt;thanks &lt;/p&gt;</comment>
                            <comment id="15641468" author="nsaboy" created="Sun, 6 Nov 2016 09:17:04 +0000"  >&lt;p&gt;Hi Sergey,&lt;/p&gt;

&lt;p&gt;If I remove both &quot;basePath&quot; and &quot;usePathBasedConfig&quot; it works yes. But I have to use these properties since I deploy several bundles that expose jax-rs servers. &lt;br/&gt;
Following what you suggest, if I deploy a second bundle (a modified version of sample description_swagger2_osgi listening on &lt;a href=&quot;http://localhost:9090/test/swaggerSample2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9090/test/swaggerSample2&lt;/a&gt; for example) then I get the same Swagger descriptor as first bundle (see issue &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6740&quot; title=&quot;Collision by Swagger2Feature in two OSGI bundles &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6740&quot;&gt;&lt;del&gt;CXF-6740&lt;/del&gt;&lt;/a&gt;). &lt;/p&gt;

&lt;p&gt;That&apos;s why I use &quot;usePathBasedConfig&quot; but the fix for issue &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6740&quot; title=&quot;Collision by Swagger2Feature in two OSGI bundles &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6740&quot;&gt;&lt;del&gt;CXF-6740&lt;/del&gt;&lt;/a&gt; does not seem to handle jax-rs servers using addresses not under CXF servlet path (&quot;/cxf&quot;).&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="15642217" author="sergey_beryozkin" created="Sun, 6 Nov 2016 18:41:47 +0000"  >&lt;p&gt;Hi, &lt;br/&gt;
So the issue is not about Swagger2Feature not working in OSGI when the endpoints have the absolute URIs - it does for a single endpoint in a given context case. But that the fix which supports the separation between Swagger infos for different endpoints does not apply in this case. &lt;br/&gt;
The reason that fix does not apply is because it depends on the availability of the servlet config which is not available in the case of the embedded Jetty transport.&lt;/p&gt;

&lt;p&gt;I can only suggest to disable those properties nonetheless and set a &apos;scan&apos; property to false, would that work ?&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt; Hey Andriy - please watch this issue in case you have some more ideas.&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="15643634" author="nsaboy" created="Mon, 7 Nov 2016 09:38:14 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;You are right, my issue is that the fix &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6740&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-6740&lt;/a&gt; does not apply in this case.&lt;/p&gt;

&lt;p&gt;Unfortunately, setting &apos;scan&apos; property to false does not solve the issue: I still get first bundle&apos;s Swagger descriptor when I browse the Swagger descriptor of the second bundle.&lt;/p&gt;</comment>
                            <comment id="15644085" author="reta" created="Mon, 7 Nov 2016 12:46:36 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nsaboy&quot; class=&quot;user-hover&quot; rel=&quot;nsaboy&quot;&gt;nsaboy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;That&apos;s quite interesting use case we certainly may not have test with. &lt;br/&gt;
I will try to look at this issue to figure out if there is any workaround or fix we can do.&lt;br/&gt;
Thanks!&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="15644183" author="sergey_beryozkin" created="Mon, 7 Nov 2016 13:31:18 +0000"  >&lt;p&gt;Hi Andriy&lt;/p&gt;

&lt;p&gt;As far as I recall, Swagger will still scan even if a &apos;scan&apos; property is disabled which is not a &apos;problem&apos; when a single endpoint is available - Swagger2Feature will still provide a JAX-RS Application info to Swagger if the &apos;scan&apos; is disabled which helps, especially in OSGI, to resolve various things.&lt;br/&gt;
If we have more than one endpoint in the context, with each endpoint having an absolute address, then these two endpoints are completely independent and I really do not see how to tell Swagger not to mix things up. &lt;br/&gt;
I wonder, if we can somehow install a JAXRS Reflections handler into Swagger if &apos;scan&apos; is disabled. I recall @splatch saw some issues with Swagger not loading  JAXRS Reflections handler in time, or something like that, Lukasz, can you remind please ?&lt;/p&gt;

&lt;p&gt;Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="15665689" author="reta" created="Tue, 15 Nov 2016 01:35:55 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nsaboy&quot; class=&quot;user-hover&quot; rel=&quot;nsaboy&quot;&gt;nsaboy&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I have done a quick investigation and indeed, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; is right: the issue is that ServletConfig, which Swagger uses for different parameters resolution, is not available in case of the embedded Jetty transport. I will try to figure out what options do we have here, but as for now, not much we can do. As you already know, using `scan` would help but will interleave with other JAX-RS resources deployed.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="15666597" author="nsaboy" created="Tue, 15 Nov 2016 09:11:20 +0000"  >&lt;p&gt;Hi Andriy,&lt;/p&gt;

&lt;p&gt;Thank you for your effort on this issue. Yes, after my own investigation, I have figured out that ServletConfig is required to make Swagger2Feature work as expected.&lt;br/&gt;
Using &quot;scan&quot; does not help in fact since I always have to deploy several bundles with JAX-RS servers. And I think my use case is not an exception. As a result Swagger2Feature seems to be of no use in an OSGi environment.&lt;/p&gt;

&lt;p&gt;Do you think it is possible to instantiate a ServletConfig object and provide it to Swagger2Feature (by exposing a dedicated setter) to solve the problem?&lt;/p&gt;

&lt;p&gt;Many thanks.&lt;/p&gt;</comment>
                            <comment id="15667024" author="reta" created="Tue, 15 Nov 2016 12:37:06 +0000"  >&lt;p&gt;Hi Concombre,&lt;/p&gt;

&lt;p&gt;Yes, there is a way to introduce the ServletConfig even if it not available. We are discussing this option with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; at the moment to make sure that we won&apos;t have unexpected side-effects (where Swagger will work but some other parts may stop working). I will post an update shortly. Thanks! &lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="15667025" author="reta" created="Tue, 15 Nov 2016 12:37:10 +0000"  >&lt;p&gt;Hi Concombre,&lt;/p&gt;

&lt;p&gt;Yes, there is a way to introduce the ServletConfig even if it is not available. We are discussing this option with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; at the moment to make sure that we won&apos;t have unexpected side-effects (where Swagger will work but some other parts may stop working). I will post an update shortly. Thanks! &lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="15667651" author="sergey_beryozkin" created="Tue, 15 Nov 2016 16:58:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nsaboy&quot; class=&quot;user-hover&quot; rel=&quot;nsaboy&quot;&gt;nsaboy&lt;/a&gt;, as I already noted the feature does work in OSGI for a case where JAX-RS endpoints bind to OSGI HttpService which is usually a recommended approach for CXF endpoints, it also works for embedded Jetty, the only limitation I see is that if you have multiple endpoints with absolute HTTP addresses in a single bundle then it won&apos;t work correctly which is not the same as the feature is of no use in OSGI.&lt;/p&gt;

&lt;p&gt;Hi Andriy, I wonder if we should explore why &apos;scan&apos;=&apos;false&apos; has no effect in this case...&lt;/p&gt;

&lt;p&gt;Thanks, Sergey &lt;/p&gt;</comment>
                            <comment id="15667736" author="nsaboy" created="Tue, 15 Nov 2016 17:31:23 +0000"  >&lt;p&gt;Hi Sergey,&lt;/p&gt;

&lt;p&gt;That&apos;s not exactly what I experience: the limitation is mostly annoying when you have several bundle exposing one JAX-RS endpoint with absolute HTTP address. This is my use case (1 JAX-RS endpoint with absolute HTTP address per bundle and several bundle deployed in Karaf: always got same Swagger descriptor for all JAX-RS endpoints). Thus, to me, this feature is of no use in OSGi (unless you use default CXF Servlet but I don&apos;t want to have all of my REST services on the same port).&lt;/p&gt;

&lt;p&gt;Regards.&lt;/p&gt;</comment>
                            <comment id="15668455" author="sergey_beryozkin" created="Tue, 15 Nov 2016 21:39:45 +0000"  >&lt;p&gt;Right, I see what you mean. Swagger just picks up everything and at least with a servlet based approach it can be dealt with. It is quite hard to control the Swagger behaviour, Swagger2Feature already does many tricks. Looks like one more is needed, surely Andriy will think of something &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15672347" author="reta" created="Thu, 17 Nov 2016 01:28:39 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nsaboy&quot; class=&quot;user-hover&quot; rel=&quot;nsaboy&quot;&gt;nsaboy&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I have just committed a fix to 3.1.x-fixes branch (3.1.9-SNAPSHOT). It seems to work pretty good, could you please give it a try?&lt;br/&gt;
Thanks a lot!&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="15673335" author="nsaboy" created="Thu, 17 Nov 2016 10:20:44 +0000"  >&lt;p&gt;Hi Andriy,&lt;/p&gt;

&lt;p&gt;I confirm it works great. I deployed two bundles, each bundle exposing a JAX-RS server with absolute HTTP address, and the Swagger descriptors were ok (not the same anymore). Maybe one thing that should be clearly documented is that you must use property &apos;usePathBasedConfig&apos; with value set to &apos;true&apos; to make it works correctly (if not you will end up with same Swagger descriptor for all your REST api, as before).&lt;/p&gt;

&lt;p&gt;Great job and thank you for this quick (and smart) fix.&lt;/p&gt;

&lt;p&gt;Best regards.&lt;/p&gt;</comment>
                            <comment id="15673570" author="reta" created="Thu, 17 Nov 2016 12:22:52 +0000"  >&lt;p&gt;Hi Concombre, &lt;/p&gt;

&lt;p&gt;Awesome, great it works, a bit hack&apos;ish but not much choice we have here. &lt;br/&gt;
Sure, good point, I will update the documentation accordingly, thanks a lot for reporting the issue!&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35mwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>