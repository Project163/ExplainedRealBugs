<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:55:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4534] SortedMap is returned as HashMap</title>
                <link>https://issues.apache.org/jira/browse/CXF-4534</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;We have recently upgraded to 2.6.2 and revisit our test suite. Looks like all bugs submitted by use have been fixed. Very impressive, thanks a lot.&lt;/p&gt;

&lt;p&gt;In our test suite there is a bug that has not been submitted in JIRA. A discussion about that bug can be found at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://comments.gmane.org/gmane.comp.apache.cxf.user/12388&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://comments.gmane.org/gmane.comp.apache.cxf.user/12388&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I decided to submit this bug anyway for documentation purposes.&lt;/p&gt;

&lt;p&gt;The problem:&lt;br/&gt;
------------&lt;/p&gt;

&lt;p&gt;The problem is when the interface declares a SortedMap as an argument or as a returned value. Here is the relevant snippets.&lt;/p&gt;

&lt;p&gt;Interface&lt;br/&gt;
---------&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-comment&quot;&gt;// fail -- &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; exception in the server
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; testSortedMapArgument(SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; map);

    &lt;span class=&quot;code-comment&quot;&gt;// fail -- puts data into a hashmap instead of a SortedMap
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; testSortedMapResult();

    &lt;span class=&quot;code-comment&quot;&gt;// fail -- puts data into a hashmap instead of a SortedMap
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt; testDirectComplexTreeMapResult();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Implementation&lt;br/&gt;
--------------&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; testSortedMapArgument(SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; map) {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; map_class = map.getClass();
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;gt; klasses = Arrays.asList(map_class.getClasses());
        log.info(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Classes of %s are %s&quot;&lt;/span&gt;, map_class, klasses));
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; klasses.contains(SortedMap.class);
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; testSortedMapResult() {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;();
        result.put(1, 3);
        result.put(0, 2);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt; testDirectComplexTreeMapResult() {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt; result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;&amp;gt;();
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; TreeMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; map1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;();
        map1.put(1, 3);
        map1.put(0, 2);
        result.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;key1&quot;&lt;/span&gt;, map1);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test Client:&lt;br/&gt;
------------&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testSortedMapArgument() {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; map = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt;();
        map.put(1, 3);
        map.put(0, 2);
        Assert.assertTrue(TestServiceFactory.getService()
                .testSortedMapArgument(map));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testSortedMapResult() {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; map_class = ((&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;) TestServiceFactory.getService()
                .testDirectComplexTreeMapResult()).getClass();
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;gt; klasses = Arrays.asList(map_class.getClasses());
        log.info(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Classes of %s are %s&quot;&lt;/span&gt;, map_class, klasses));
        Assert.assertTrue(klasses.contains(SortedMap.class));
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testDirectComplexTreeMapResult() {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; map_class = ((&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;) TestServiceFactory.getService()
                .testDirectComplexTreeMapResult().get(&lt;span class=&quot;code-quote&quot;&gt;&quot;key1&quot;&lt;/span&gt;)).getClass();
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;gt; klasses = Arrays.asList(map_class.getClasses());
        log.info(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Classes of %s are %s&quot;&lt;/span&gt;, map_class, klasses));
        Assert.assertTrue(klasses.contains(SortedMap.class));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result:&lt;br/&gt;
-----------&lt;/p&gt;

&lt;p&gt;In cases 2 and 3 I get a hashmap instead of a SortedMap. This is very dangerous since it changes program semantics in a very subtle way.&lt;/p&gt;

&lt;p&gt;In case 1 I get an exception. Here is the server side part:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WARNING: Application {http:&lt;span class=&quot;code-comment&quot;&gt;//iface/}TestInterface#{http://iface/}testSortedMapArgument has thrown exception, unwinding now
&lt;/span&gt;org.apache.cxf.interceptor.Fault: argument type mismatch &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; invoking &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; iface.TestInterface.testSortedMapArgument(java.util.SortedMap) with params [{0=2, 1=3}].
        at org.apache.cxf.service.invoker.AbstractInvoker.createFault(AbstractInvoker.java:166)
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:140)
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:75)
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:58)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at org.apache.cxf.workqueue.SynchronousExecutor.execute(SynchronousExecutor.java:37)
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:107)
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:262)
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:211)
        at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:213)
        at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:193)
        at org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:130)
        at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:221)
        at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doPost(AbstractHTTPServlet.java:141)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
        at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:197)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
Caused by: java.lang.IllegalArgumentException: argument type mismatch
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:180)
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)
        ... 33 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Expected result:&lt;br/&gt;
----------------&lt;/p&gt;

&lt;p&gt;To safely transfer a SortedMap both ways.&lt;/p&gt;

&lt;p&gt;I would understand if due to WSDL  constraints reliably transferring a sortedMap is not possible. What it would be nice is at least during the deploy time an error / warning is issued stating that fact.&lt;/p&gt;

&lt;p&gt;Right now we are getting incorrect results in a silent way or a the best case an exception at run time.&lt;/p&gt;</description>
                <environment>&lt;p&gt;debian wheezy/testing, unstable&lt;/p&gt;</environment>
        <key id="12609894">CXF-4534</key>
            <summary>SortedMap is returned as HashMap</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="vasvir">Vassilis Virvilis</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Oct 2012 10:31:02 +0000</created>
                <updated>Thu, 8 Nov 2012 17:15:00 +0000</updated>
                            <resolved>Wed, 24 Oct 2012 19:39:14 +0000</resolved>
                                    <version>2.6.2</version>
                    <version>2.7</version>
                                    <fixVersion>2.6.3</fixVersion>
                    <fixVersion>2.7</fixVersion>
                                    <component>Aegis Databinding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13469624" author="dkulp" created="Thu, 4 Oct 2012 19:37:27 +0000"  >&lt;p&gt;&lt;br/&gt;
This should now be fixed.  It would be great if you could verify with tomorrows snapshots.&lt;/p&gt;</comment>
                            <comment id="13471563" author="vasvir" created="Mon, 8 Oct 2012 14:09:33 +0000"  >&lt;p&gt;I tried with apache-cxf-2.6.3-20121005.080754-29.tar.gz and all 3 problems persist.&lt;/p&gt;

&lt;p&gt;Should I try with 2.7.0 snapshot?&lt;/p&gt;

&lt;p&gt;   Vassilis&lt;/p&gt;</comment>
                            <comment id="13473050" author="vasvir" created="Wed, 10 Oct 2012 07:23:39 +0000"  >&lt;p&gt;The fix is supposed to be applied at 2.6.3 but it still does not work for me. Tested with apache-cxf-2.6.3-20121005.080754-29.tar.gz in both server and client.&lt;/p&gt;

&lt;p&gt;Hence I am reopening the bug...&lt;/p&gt;

&lt;p&gt;If I shouldn&apos;t do this please let me know since I am not fully familiarized with CXF bug-etiquette.&lt;/p&gt;

&lt;p&gt;Could you also please tell us what is the expected behaviour? Normal transmission of SortedMap or some kind of error / warning? Anyway I didn&apos;t get any errors warnings during deploy...&lt;/p&gt;


&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13473053" author="vasvir" created="Wed, 10 Oct 2012 07:24:50 +0000"  >&lt;p&gt;The fix is supposed to be applied at 2.6.3 but it still does not work for me. Tested with apache-cxf-2.6.3-20121005.080754-29.tar.gz in both server and client.&lt;/p&gt;

&lt;p&gt;Hence I am reopening the bug...&lt;/p&gt;

&lt;p&gt;If I shouldn&apos;t do this please let me know since I am not fully familiarized with CXF bug-etiquette.&lt;/p&gt;

&lt;p&gt;Could you also please tell us what is the expected behaviour? Normal transmission of SortedMap or some kind of error / warning? Anyway I didn&apos;t get any errors warnings during deploy...&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13474877" author="vasvir" created="Fri, 12 Oct 2012 08:13:31 +0000"  >&lt;p&gt;I also tested it with 2.7.0&lt;/p&gt;</comment>
                            <comment id="13475297" author="dkulp" created="Fri, 12 Oct 2012 20:00:26 +0000"  >&lt;p&gt;Any chance you can create a simple and small complete test case?&lt;/p&gt;</comment>
                            <comment id="13476950" author="vasvir" created="Tue, 16 Oct 2012 12:10:06 +0000"  >&lt;p&gt;Sure why not? Here is the test case. I have not included necessary third party libraries. The project requires&lt;/p&gt;

&lt;p&gt;cxf-libraries&lt;br/&gt;
log4j&lt;br/&gt;
commons-logging&lt;br/&gt;
junit&lt;/p&gt;

&lt;p&gt;After that you do&lt;br/&gt;
  ant war&lt;br/&gt;
and the war will be created.&lt;/p&gt;

&lt;p&gt;The TestClient will try to connect at localhost:8080 by default&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13483509" author="dkulp" created="Wed, 24 Oct 2012 19:38:51 +0000"  >
&lt;p&gt;The testcase is not valid.  The call to cls.getClasses() is returning the internal classes, not the interfaces and such.   If you actually look at the output, you see:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Classes of &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java.util.TreeMap are [&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java.util.AbstractMap$SimpleImmutableEntry, &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;java.util.AbstractMap$SimpleEntry]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so it is indeed creating a TreeMap (which implements SortedMap).   If you just take the return maps and do a:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Assert.assertTrue(ret &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; SortedMap);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;then you would see that the values really are the sorted maps that are expected.&lt;/p&gt;</comment>
                            <comment id="13484871" author="vasvir" created="Fri, 26 Oct 2012 12:10:24 +0000"  >&lt;p&gt;Aah. I agree. I was fooled by my own tests.&lt;/p&gt;

&lt;p&gt;I can confirm that the mini test case now works.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549296" name="ws-test-issue-4534.tgz" size="9241" author="vasvir" created="Tue, 16 Oct 2012 12:10:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239834</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 4 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00u9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2836</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>