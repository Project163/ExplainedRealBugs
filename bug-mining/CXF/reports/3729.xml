<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:39:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8962] HttpClientHTTPConduit sets Content-Type Header for DELETE requests with empty body</title>
                <link>https://issues.apache.org/jira/browse/CXF-8962</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;We call a DELETE endoint of a REST API, but the server rejects the call with a client error, because CXF sends &quot;Content-Type: text/xml&quot; although the content is empty (as suggested by RFC 9110).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The implementation of &lt;tt&gt;setProtocolHeaders()&lt;/tt&gt; in&#160;&lt;tt&gt;HttpClientHTTPConduit&lt;/tt&gt; calls &lt;tt&gt;setProtocolHeadersInBuilder()&lt;/tt&gt; to set the HTTP headers. This methods computes a &quot;Content-Type&quot; header if the verb is not in the list KNOWN_HTTP_VERBS_WITH_NO_CONTENT. DELETE is not part of this list although RFC 9110 states that DELETE requests should not have content &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. Thus if a client follows the RFC and sends a DELETE request with no content, CXF will nonetheless set a Content-Type header. &lt;tt&gt;Headers#determineContentType&lt;/tt&gt; uses &quot;text/xml&quot; as fallback if no content type can be computed.&#160;&lt;/p&gt;

&lt;p&gt;The old implementation &lt;tt&gt;URLConnectionHTTPConduit&lt;/tt&gt; called a &lt;tt&gt;Headers#setProtocolHeadersInConnection&lt;/tt&gt; to set the headers. This method allowed to omit the &quot;Content-Type&quot; header via the property &quot;set.content.type.for.empty.request&quot;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The new implementation should handle DELETE requests with empty body correctly or evaluate the existing property &quot;set.content.type.for.empty.request&quot;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Although request message framing is independent of the method used, content received in a DELETE request has no generally defined semantics, cannot alter the meaning or target of the request, and might lead some implementations to reject the request and close the connection because of its potential as a request smuggling attack (Section 11.2 of &lt;span class=&quot;error&quot;&gt;&amp;#91;HTTP/1.1&amp;#93;&lt;/span&gt;). A client SHOULD NOT generate content in a DELETE request unless it is made directly to an origin server that has previously indicated, in or out of band, that such a request has a purpose and will be adequately supported.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc9110.html#name-delete&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.rfc-editor.org/rfc/rfc9110.html#name-delete&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13559332">CXF-8962</key>
            <summary>HttpClientHTTPConduit sets Content-Type Header for DELETE requests with empty body</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="a.gonzalez">Alonso Gonzalez</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Nov 2023 13:20:20 +0000</created>
                <updated>Tue, 5 Mar 2024 01:55:25 +0000</updated>
                            <resolved>Tue, 5 Mar 2024 01:55:03 +0000</resolved>
                                    <version>3.6.2</version>
                    <version>4.0.3</version>
                                    <fixVersion>3.6.3</fixVersion>
                    <fixVersion>4.0.4</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17813667" author="gchauvet" created="Fri, 2 Feb 2024 13:09:45 +0000"  >&lt;p&gt;Same issue on versions 3.1.4 to 3.5.7:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Address: https://XXXXXXXX
Http-Method: DELETE
Content-Type:
Headers: {Accept=[text/plain] }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17815784" author="amichai" created="Thu, 8 Feb 2024 18:33:48 +0000"  >&lt;p&gt;We&apos;re also seeing rejected DELETE requests due to this issue (on 3.5.2) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Is there a known workaround?&lt;/p&gt;</comment>
                            <comment id="17815872" author="reta" created="Fri, 9 Feb 2024 00:10:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchauvet&quot; class=&quot;user-hover&quot; rel=&quot;gchauvet&quot;&gt;gchauvet&lt;/a&gt;&#160; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amichai&quot; class=&quot;user-hover&quot; rel=&quot;amichai&quot;&gt;amichai&lt;/a&gt; you could set `&lt;font color=&quot;#000000&quot;&gt;set.content.type.for.empty.request&lt;/font&gt;` context property to `false to skip Content-Type header for empty request (for &amp;lt; 3.6.x release branches).&lt;/p&gt;</comment>
                            <comment id="17815956" author="gchauvet" created="Fri, 9 Feb 2024 07:57:31 +0000"  >&lt;p&gt;hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt; ,&lt;/p&gt;

&lt;p&gt;Works for me with 3.5.7 and 3.3.13. However, we&apos;re going to put our version 3.1.x problem on hold, as our supplier will be updating its technical stack in the next update (we are stuck by this).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for everything,&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="17816318" author="amichai" created="Sat, 10 Feb 2024 14:11:59 +0000"  >&lt;p&gt;This is embarassing but I can&apos;t figure out where to set that property on the WebClient... client.getConfiguration().getBus().setProperty() didn&apos;t work, client.&lt;br/&gt;
getConfiguration().getRequestContext().put() didn&apos;t work, where are these properties supposed to come from?&lt;/p&gt;</comment>
                            <comment id="17816362" author="reta" created="Sun, 11 Feb 2024 01:11:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amichai&quot; class=&quot;user-hover&quot; rel=&quot;amichai&quot;&gt;amichai&lt;/a&gt; Hm ... you could do it like that:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WebClient.getConfig(client).getRequestContext().put(&quot;set.content.type.for.empty.request&quot;, true); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;font color=&quot;#000000&quot;&gt;which is actually equivalent to client.getConfiguration().getRequestContext().put(...) &lt;/font&gt;&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17816378" author="amichai" created="Sun, 11 Feb 2024 08:41:55 +0000"  >&lt;p&gt;That doesn&apos;t work. I put a breakpoint there and see it set, then another breakpoint in Headers.setProtocolHeadersInConnection where it reads it with setCtForEmptyRequestProp = message.getContextualProperty(SET_EMPTY_REQUEST_CT_PROPERTY); but there the property is null.&lt;/p&gt;</comment>
                            <comment id="17816382" author="amichai" created="Sun, 11 Feb 2024 09:35:16 +0000"  >&lt;p&gt;Scrath that, it&apos;s working now, though I have no idea why it didn&apos;t the first few hours I was debugging through it, and now it does. Didn&apos;t change the code in between... maybe just something not updating right in debugger or something. Thanks for the workaround! btw does anyone know in what version the workaround broke? So we don&apos;t update to it by mistake...&lt;/p&gt;</comment>
                            <comment id="17816407" author="reta" created="Sun, 11 Feb 2024 13:06:59 +0000"  >&lt;p&gt;Thanks for the update &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amichai&quot; class=&quot;user-hover&quot; rel=&quot;amichai&quot;&gt;amichai&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt; Thanks for the workaround! btw does anyone know in what version the workaround broke?&#160;&lt;/p&gt;

&lt;p&gt;So it does not really broke, but 3.6.2+/ 4.0.1+switched to JDK-11 HttpClient based conduit by default (so this setting does not apply there). But you still have a choice to select the previous conduit (by setting another property) so the things should continue working.&lt;/p&gt;</comment>
                            <comment id="17823387" author="reta" created="Tue, 5 Mar 2024 01:18:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=freeman.fang&quot; class=&quot;user-hover&quot; rel=&quot;freeman.fang&quot;&gt;freeman.fang&lt;/a&gt;&#160; May I ask you please to backport this fix from main to 3.6.x, I sadly won&apos;t have access to laptop till Friday. Thank you very much, really appreciate it.&lt;/p&gt;</comment>
                            <comment id="17823393" author="ffang" created="Tue, 5 Mar 2024 01:55:25 +0000"  >&lt;p&gt;Sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, done!&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ltz4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>