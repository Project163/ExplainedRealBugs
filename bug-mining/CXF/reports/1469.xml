<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:55:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4496] find of ResponseExceptionMapper do not handle runtime exceptions</title>
                <link>https://issues.apache.org/jira/browse/CXF-4496</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;In org.apache.cxf.jaxrs.client.ClientProxyImpl.findExceptionMapper(Method, Message)&lt;/p&gt;

&lt;p&gt;The responseExceptionMapper is selected based on exception defined in the resource method signature but this method may have thrown a RuntimeException :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; RestMcuBoardResource {
    @GET
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; RestMcuBoard getBoard();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;does not work where this one work&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; RestMcuBoardResource {
    @GET
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; RestMcuBoard getBoard() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; runtimeException;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;a fix could be :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; ResponseExceptionMapper&amp;lt;?&amp;gt; findExceptionMapper(Method m, Message message) {
        ProviderFactory pf = ProviderFactory.getInstance(message);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; exType : m.getExceptionTypes()) {
            ResponseExceptionMapper&amp;lt;?&amp;gt; mapper = pf.createResponseExceptionMapper(exType);
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mapper != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; mapper;
            }
        }
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; pf.createResponseExceptionMapper(RuntimeException.class);
-        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; 
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </description>
                <environment></environment>
        <key id="12606015">CXF-4496</key>
            <summary>find of ResponseExceptionMapper do not handle runtime exceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="n0rad">n0rad</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Sep 2012 17:22:38 +0000</created>
                <updated>Sat, 23 Mar 2013 07:59:39 +0000</updated>
                            <resolved>Fri, 28 Sep 2012 11:02:24 +0000</resolved>
                                    <version>2.6.2</version>
                                    <fixVersion>2.6.3</fixVersion>
                    <fixVersion>2.7</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13447596" author="sergey_beryozkin" created="Tue, 4 Sep 2012 10:10:30 +0000"  >&lt;p&gt;If no mapper is available then ServerWebApplicationException mapper gets thrown which is an instance of RuntimeException&lt;/p&gt;</comment>
                            <comment id="13447600" author="n0rad" created="Tue, 4 Sep 2012 10:29:17 +0000"  >&lt;p&gt;but if the ExceptionMapper store the real class into the payload (for example SecurityException)&lt;/p&gt;

&lt;p&gt;The client side should be able to reconstruct this Exception, and its working if you add throws RuntimeException into the signature.&lt;/p&gt;</comment>
                            <comment id="13447601" author="n0rad" created="Tue, 4 Sep 2012 10:32:56 +0000"  >&lt;p&gt;Example that store any kind of runtime and rebuild it on client side : &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AjslRuntimeExceptionMapper &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ExceptionMapper&amp;lt;RuntimeException&amp;gt; {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Logger log = LoggerFactory.getLogger(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass());

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Response toResponse(RuntimeException exception) {
        log.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Uncaught RuntimeException&quot;&lt;/span&gt;, exception);

        Error error = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Error();
        error.setMessage(exception.getMessage());
        error.setErrorClass(exception.getClass());
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Response.status(500).entity(error).build();
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AjslResponseExceptionMapper &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ResponseExceptionMapper&amp;lt;Exception&amp;gt; {

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Exception fromResponse(Response r) {
        Error error = findError(r);
        Exception exception;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (error.getErrorClass() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                exception = error.getErrorClass().getConstructor(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class)
                        .newInstance(Strings.nullToEmpty(error.getMessage()));
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot Create Exception from Error : &quot;&lt;/span&gt; + error, e);
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            exception = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(error.getMessage());
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; exception;
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13464026" author="exabrial" created="Wed, 26 Sep 2012 18:25:39 +0000"  >&lt;p&gt;This is a fairly simple fix, any chance this could be included in the next release?&lt;/p&gt;</comment>
                            <comment id="13464201" author="sergey_beryozkin" created="Wed, 26 Sep 2012 21:43:00 +0000"  >&lt;p&gt;I&apos;m not really sure this is the right thing to do though.&lt;/p&gt;

&lt;p&gt;I guess what might be done is add a check for JAX-RS 2.0 ClientException mapper (CXF 2.7.0), or, on CXF 2.6.2: ServerWebApplicationException&lt;/p&gt;</comment>
                            <comment id="13464222" author="n0rad" created="Wed, 26 Sep 2012 21:58:31 +0000"  >&lt;p&gt;If the user has registered a ResponseExceptionMapper for this RuntimeException class (or super), it will use it (exactly the same system as checked exception)&lt;/p&gt;

&lt;p&gt;If the user has not registered a ResponseExceptionMapper for this class it will not found it, will return null and the caller function that is checkResponse() will build the ServerWebApplicationException.&lt;/p&gt;

&lt;p&gt;It doesn&apos;t change the way its actually working until the user register an exceptionMapper for runtimes.&lt;/p&gt;
</comment>
                            <comment id="13464226" author="sergey_beryozkin" created="Wed, 26 Sep 2012 22:01:33 +0000"  >&lt;p&gt;The point is that bare RuntimeException is not what the client runtime returns if no exception mapper has been found&lt;/p&gt;</comment>
                            <comment id="13464234" author="n0rad" created="Wed, 26 Sep 2012 22:12:15 +0000"  >&lt;p&gt;That&apos;s what I&apos;m saying, maybe my example with RuntimeException is not a good one, it could be a responseExceptionMapper for SecurityException for example.&lt;/p&gt;

&lt;p&gt;And if the user has not registered a ResponseExceptionMapper for SecurityException, it will throw the ServerWebApplicationException as expected. &lt;/p&gt;</comment>
                            <comment id="13464248" author="n0rad" created="Wed, 26 Sep 2012 22:23:11 +0000"  >&lt;p&gt;Hum, I forget that you cannot know the specific RuntimeException so you can only handle RuntimeException globally (but still if the user has registered one).&lt;/p&gt;</comment>
                            <comment id="13464573" author="sergey_beryozkin" created="Thu, 27 Sep 2012 09:21:44 +0000"  >&lt;p&gt;The client runtime guarantees (unless some bug is there) that it will throw ClientException (JAX-RS 2.0) or ServerWebApplicationExxception representing the remote service failure. To be honest I have doubts ResponseExceptionMapper has to be checked when proxies have no exception classes in the signature, however, at the same time, I guess proxies should be given a chance to &apos;pre-process&apos; unchecked exceptions.&lt;/p&gt;

&lt;p&gt;If you have a catch statement expecting RuntimeException, then with ResponseExceptionMapper&amp;lt;ClientException&amp;gt; (assuming it is CXF 2.7.0) the catch will work. However I also think that a catch expecting ClientException should also work, &lt;b&gt;irrespectively&lt;/b&gt; of whether one has ResponseExceptionMapper or not. &lt;/p&gt;</comment>
                            <comment id="13464579" author="sergey_beryozkin" created="Thu, 27 Sep 2012 09:33:41 +0000"  >&lt;p&gt;I meant ClientErrorException (in case of JAX-RS 2.0): &lt;a href=&quot;http://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/ClientErrorException.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/ClientErrorException.html&lt;/a&gt;, it has a constructor which accepts a status code and Throwable - the latter will be available at the RuntimeException catch block&lt;/p&gt;</comment>
                            <comment id="13465518" author="sergey_beryozkin" created="Fri, 28 Sep 2012 11:02:24 +0000"  >&lt;p&gt;in CXF 2.6.3 it is ServerWebApplicationException and in 2.7.0: WebApplicationException. ResponseExceptionMapper&amp;lt;WebApplicationException&amp;gt; will work in 2.6.3 and 2.7.0, and similarly - RuntimeException catch block will be executed&lt;/p&gt;</comment>
                            <comment id="13611644" author="parwiz" created="Sat, 23 Mar 2013 06:57:53 +0000"  >&lt;p&gt;actually the bigger issue is that it always picks the first exception mapper based on method signature.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4912&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-4912&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;what&apos;s happening right now is if you say have two different exception in your throws method&lt;br/&gt;
myMethod() throws Exception2, Exception1;  &lt;/p&gt;

&lt;p&gt;and mappers for both of those exceptions on server side and client side (maybe you are doing different&lt;br/&gt;
things.. so yes i know you can have one super class if they are both checked exceptions.. let&apos;s say &lt;br/&gt;
you have a legacy exception and you don&apos;t have source for it.. and a new exception you created for something else)&lt;/p&gt;

&lt;p&gt;now the client code is blind and picks the first mapper when a fault occurs so in this it will always&lt;br/&gt;
default to Exception2ResponeMapper on client side.. even if in the method you happen to throw Exception1&lt;br/&gt;
this is incorrect..&lt;/p&gt;

&lt;p&gt;please take a look again as this is a big issue if you have multiple mappers and a method that&lt;br/&gt;
throws more than one exception in its signature (be it checked or runtime or multiple checked exceptions)... &lt;br/&gt;
it will pick the first mapper for the first exception listed after throws keyword.. not &lt;br/&gt;
actually match based on actual exception type and mappers available.&lt;/p&gt;

&lt;p&gt;maybe allow the response to have a header of some sort that contains the exception name/class&lt;br/&gt;
and in the findExceptionMapper() use that header to know exactly what exception occurred and go&lt;br/&gt;
find a mapper based on that type instead of picking the first exception after the throws clause &lt;br/&gt;
aka         Class&amp;lt;?&amp;gt;[] exTypes = m.getExceptionTypes(); &amp;lt;-- the mapper is selected based on the order returned by this &lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00ui7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>