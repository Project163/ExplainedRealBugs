<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:02:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5194] SoapHeaderInterceptor fails to validate SOAP header</title>
                <link>https://issues.apache.org/jira/browse/CXF-5194</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Soap message includes a custom Header, let&apos;s call it &quot;RequestHeader&quot;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;xs:complexType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RequestHeader&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;xs:sequence&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;xs:element name=&lt;span class=&quot;code-quote&quot;&gt;&quot;TimeStamp&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;xs:dateTime&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/xs:sequence&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/xs:complexType&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A contract-first approach is done through wsdl2java.&lt;/p&gt;

&lt;p&gt;Service endpoint is created through:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;TestWsService.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
JaxWsServerFactoryBean factory = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JaxWsServerFactoryBean();

&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; wsdlLocation = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) properties.get(WSDL_LOCATION_PROPERTY);
URL url = getClass().getResource(wsdlLocation);

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (url == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;WSDL not found at bundle location &quot;&lt;/span&gt; + wsdlLocation); &lt;span class=&quot;code-comment&quot;&gt;//$NON-NLS-1$
&lt;/span&gt;}

factory.setWsdlLocation(url.toString());
factory.setAddress((&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) properties.get(WS_ADDRESS_PROPERTY));
factory.setServiceBean(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestPortImpl());
factory.setServiceClass(TestPortImpl.class);
factory.setEndpointName(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QName((&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) properties.get(WS_NAMESPACE_PROPERTY), &lt;span class=&quot;code-quote&quot;&gt;&quot;TestPort&quot;&lt;/span&gt;)); &lt;span class=&quot;code-comment&quot;&gt;//$NON-NLS-1$
&lt;/span&gt;factory.setServiceName(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QName((&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) properties.get(WS_NAMESPACE_PROPERTY), &lt;span class=&quot;code-quote&quot;&gt;&quot;TestService&quot;&lt;/span&gt;)); &lt;span class=&quot;code-comment&quot;&gt;//$NON-NLS-1$
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// turn up schema validation (executes inbound and outbound validations)
&lt;/span&gt;factory.getProperties(&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.TRUE).put(&lt;span class=&quot;code-quote&quot;&gt;&quot;schema-validation-enabled&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.TRUE); &lt;span class=&quot;code-comment&quot;&gt;//$NON-NLS-1$
&lt;/span&gt;
webService = factory.create();
webService.start();
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A SOAP request is made with an invalid timestamp. Validation doesn&apos;t occur and request traverses SoapHeaderInterceptor without even being validated.&lt;/p&gt;

&lt;p&gt;After doing some debug inside the interceptor, problem relies on &lt;em&gt;validateHeader()&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;When &lt;em&gt;findHeader()&lt;/em&gt; is called inside &lt;em&gt;validateHeader()&lt;/em&gt; it simply returns null, although the SoapMessage is correct and apparently the MessagePartInfo too.&lt;/p&gt;

&lt;p&gt;Inside &lt;em&gt;findHeader()&lt;/em&gt; the &lt;em&gt;mpi.getConcreteName()&lt;/em&gt; returns &quot;RequestHeaderElement&quot; as localPart where it should simply return &quot;RequestHeader&quot;.&lt;/p&gt;

&lt;p&gt;If &lt;em&gt;mpi.getConcreteName()&lt;/em&gt; return value is changed at runtime through live debug to &quot;RequestHeader&quot;, validation is done successfully, failing with soapfault:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;soap:Envelope &lt;span class=&quot;code-keyword&quot;&gt;xmlns:soap&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;soap:Body&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;soap:Fault&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;faultcode&amp;gt;&lt;/span&gt;soap:Client&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/faultcode&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;faultstring&amp;gt;&lt;/span&gt;Could not validate soapheader caused by: org.xml.sax.SAXParseException: cvc-datatype-valid.1.2.1: &lt;span class=&quot;code-quote&quot;&gt;&apos;2012-05-1T00:00:00&apos;&lt;/span&gt; is not a valid value for &lt;span class=&quot;code-quote&quot;&gt;&apos;dateTime&apos;&lt;/span&gt;..&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/faultstring&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/soap:Fault&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/soap:Body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/soap:Envelope&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If more detailed info is needed, please advise.&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows/Solaris, JBoss, JavaSE-1.6&lt;/p&gt;</environment>
        <key id="12662870">CXF-5194</key>
            <summary>SoapHeaderInterceptor fails to validate SOAP header</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="fjma79">Filipe Amaral</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Aug 2013 15:17:47 +0000</created>
                <updated>Thu, 5 Dec 2013 19:05:29 +0000</updated>
                            <resolved>Fri, 4 Oct 2013 21:50:27 +0000</resolved>
                                    <version>2.7</version>
                    <version>2.7.6</version>
                                    <fixVersion>Invalid</fixVersion>
                                    <component>Soap Binding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13739470" author="fjma79" created="Wed, 14 Aug 2013 10:01:25 +0000"  >&lt;p&gt;Tested with 2.7.6 and problem still remains.&lt;/p&gt;</comment>
                            <comment id="13739844" author="dkulp" created="Wed, 14 Aug 2013 16:33:34 +0000"  >
&lt;p&gt;I&apos;m not able to reproduce this.   I updated one of our schema validation test cases to test a soap header (wsdl first) and the test properly validates the header on the incoming side.  I&apos;ll likely need to see a full test case.&lt;/p&gt;

&lt;p&gt;HOWEVER: I did discover that we aren&apos;t validating soap headers on the OUTBOUND side at all.  When writing the headers, we should also be validating them but we aren&apos;t.   I&apos;m as part of committing a test for this.&lt;/p&gt;</comment>
                            <comment id="13786666" author="dkulp" created="Fri, 4 Oct 2013 21:50:27 +0000"  >&lt;p&gt;&lt;br/&gt;
Could not reproduce and no further information provided for over a month.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n4pj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343176</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>