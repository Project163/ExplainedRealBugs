<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:40:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-9065] StackOverflow Exception during execution of WebClient POST Request on SSLUtils class</title>
                <link>https://issues.apache.org/jira/browse/CXF-9065</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I am trying to make a POST call by using CXF with following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        MultivaluedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; map = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MultivaluedHashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();

        map.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;client_id&quot;&lt;/span&gt;, Arrays.asList(clientId));
        map.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;client_secret&quot;&lt;/span&gt;, Arrays.asList(clientSecret));
        map.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;token&quot;&lt;/span&gt;, Arrays.asList(token));

        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; result = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            Client client = getClientBuilder().build();
            WebTarget target = client.target(revocationEndpoint);
            Invocation.Builder tokenRequest = target.request(MediaType.APPLICATION_JSON);
            tokenRequest.cookie(cookie);

            Response response = tokenRequest.post(Entity.entity(map, MediaType.APPLICATION_FORM_URLENCODED_TYPE));
            result = response.getStatus() == 200;
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (RuntimeException e) {
            LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Token revocation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the logout has failed: &quot;&lt;/span&gt; + e.getMessage(), e);
        }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Then I get a Stack Overflow Exception on SSL Utils 301:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.io.IOException: IOException invoking https:&lt;span class=&quot;code-comment&quot;&gt;//some-server/realms/some-realm-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/protocol/openid-connect/revoke: java.lang.StackOverflowError
&lt;/span&gt;&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
&#160; &#160; at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1452)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1433)
&#160; &#160; at org.apache.cxf.io.AbstractWrappedOutputStream.close(AbstractWrappedOutputStream.java:77)
&#160; &#160; at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:717)
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit.close(HttpClientHTTPConduit.java:112)
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:63)
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.doRunInterceptorChain(AbstractClient.java:710)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1086)
&#160; &#160; ... 69 common frames omitted
Caused by: java.io.IOException: java.lang.StackOverflowError
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit$HttpClientWrappedOutputStream.getResponse(HttpClientHTTPConduit.java:590)
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit$HttpClientWrappedOutputStream.getResponseCode(HttpClientHTTPConduit.java:601)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.doProcessResponseCode(HTTPConduit.java:1653)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1684)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1626)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1420)
&#160; &#160; ... 77 common frames omitted
Caused by: java.lang.StackOverflowError: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&#160; &#160; at java.base/java.util.Collections$UnmodifiableCollection.size(Collections.java:1034)
&#160; &#160; at java.base/sun.security.ssl.ProtocolVersion.toStringArray(ProtocolVersion.java:250)
&#160; &#160; at java.base/sun.security.ssl.SSLConfiguration.getSSLParameters(SSLConfiguration.java:177)
&#160; &#160; at java.base/sun.security.ssl.SSLEngineImpl.getSSLParameters(SSLEngineImpl.java:867)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Another variant is on SSL Utils 307:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.io.IOException: IOException invoking https:&lt;span class=&quot;code-comment&quot;&gt;//some-server/realms/some-realm-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/protocol/openid-connect/revoke: java.lang.StackOverflowError
&lt;/span&gt;&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
&#160; &#160; at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1452)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1433)
&#160; &#160; at org.apache.cxf.io.AbstractWrappedOutputStream.close(AbstractWrappedOutputStream.java:77)
&#160; &#160; at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:717)
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit.close(HttpClientHTTPConduit.java:112)
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:63)
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.doRunInterceptorChain(AbstractClient.java:710)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1086)
&#160; &#160; ... 69 common frames omitted
Caused by: java.io.IOException: java.lang.StackOverflowError
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit$HttpClientWrappedOutputStream.getResponse(HttpClientHTTPConduit.java:590)
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit$HttpClientWrappedOutputStream.getResponseCode(HttpClientHTTPConduit.java:601)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.doProcessResponseCode(HTTPConduit.java:1653)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1684)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1626)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1420)
&#160; &#160; ... 77 common frames omitted
Caused by: java.lang.StackOverflowError: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getHandshakeSession(SSLUtils.java:307) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13595073">CXF-9065</key>
            <summary>StackOverflow Exception during execution of WebClient POST Request on SSLUtils class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="mcancomert">Mehmet Can C&#246;mert</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Oct 2024 10:54:50 +0000</created>
                <updated>Wed, 15 Jan 2025 15:53:03 +0000</updated>
                            <resolved>Wed, 15 Jan 2025 15:53:03 +0000</resolved>
                                    <version>3.6.4</version>
                                    <fixVersion>3.6.6</fixVersion>
                    <fixVersion>4.0.7</fixVersion>
                    <fixVersion>4.1.1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17888607" author="mcancomert" created="Fri, 11 Oct 2024 10:56:39 +0000"  >&lt;p&gt;It happens time to time, not always.&lt;/p&gt;

&lt;p&gt;Here is the full stack trace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2024-10-03T11:11:14.223Z ERROR [qtp1192018715-1399327|SysLog.....security.OpenIdTokenAuthenticator:898] Token revocation &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the logout has failed: java.io.IOException: IOException invoking https:&lt;span class=&quot;code-comment&quot;&gt;//some-server/realms/some-realm-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/protocol/openid-connect/revoke: java.lang.StackOverflowError
&lt;/span&gt;javax.ws.rs.ProcessingException: java.io.IOException: IOException invoking https:&lt;span class=&quot;code-comment&quot;&gt;//some-server/realms/some-realm-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/protocol/openid-connect/revoke: java.lang.StackOverflowError
&lt;/span&gt;&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.checkClientException(AbstractClient.java:638)
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.preProcessResult(AbstractClient.java:612)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doResponse(WebClient.java:1150)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1087)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:932)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:901)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:461)
&#160; &#160; at org.apache.cxf.jaxrs.client.SyncInvokerImpl.method(SyncInvokerImpl.java:150)
&#160; &#160; at org.apache.cxf.jaxrs.client.SyncInvokerImpl.method(SyncInvokerImpl.java:145)
&#160; &#160; at org.apache.cxf.jaxrs.client.SyncInvokerImpl.post(SyncInvokerImpl.java:85)
&#160; &#160; at org.apache.cxf.jaxrs.client.spec.InvocationBuilderImpl.post(InvocationBuilderImpl.java:153)
&#160; &#160; at ...security.OpenIdTokenAuthenticator.revokeToken(OpenIdTokenAuthenticator.java:895)
&#160; &#160; at ...security.OpenIdTokenAuthenticator.revokeTokens(OpenIdTokenAuthenticator.java:849)
&#160; &#160; at ...OpenIdSessionManager.refresh(OpenIdSessionManager.java:119)
&#160; &#160; at ...security.SessionManagementResource.refresh(SessionManagementResource.java:305)
&#160; &#160; at jdk.internal.reflect.GeneratedMethodAccessor584.invoke(Unknown Source)
&#160; &#160; at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
&#160; &#160; at java.base/java.lang.reflect.Method.invoke(Method.java:566)
&#160; &#160; at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)
&#160; &#160; at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)
&#160; &#160; at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:201)
&#160; &#160; at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:104)
&#160; &#160; at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)
&#160; &#160; at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
&#160; &#160; at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)
&#160; &#160; at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:265)
&#160; &#160; at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:234)
&#160; &#160; at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:208)
&#160; &#160; at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:160)
&#160; &#160; at org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:225)
&#160; &#160; at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:304)
&#160; &#160; at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doPost(AbstractHTTPServlet.java:217)
&#160; &#160; at javax.servlet.http.HttpServlet.service(HttpServlet.java:665)
&#160; &#160; at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:279)
&#160; &#160; at org.ops4j.pax.web.service.spi.servlet.OsgiInitializedServlet.service(OsgiInitializedServlet.java:102)
&#160; &#160; at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:764)
&#160; &#160; at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1665)
&#160; &#160; at org.ops4j.pax.web.service.spi.servlet.OsgiFilterChain.doFilter(OsgiFilterChain.java:113)
&#160; &#160; at org.ops4j.pax.web.service.jetty.internal.PaxWebServletHandler.doHandle(PaxWebServletHandler.java:363)
&#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:131)
&#160; &#160; at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:598)
&#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
&#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:223)
&#160; &#160; at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1570)
&#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:221)
&#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1384)
&#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:176)
&#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:484)
&#160; &#160; at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1543)
&#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:174)
&#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1306)
&#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129)
&#160; &#160; at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:149)
&#160; &#160; at org.ops4j.pax.web.service.jetty.internal.PrioritizedHandlerCollection.handle(PrioritizedHandlerCollection.java:96)
&#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
&#160; &#160; at org.eclipse.jetty.server.Server.handle(Server.java:563)
&#160; &#160; at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)
&#160; &#160; at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)
&#160; &#160; at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)
&#160; &#160; at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)
&#160; &#160; at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)
&#160; &#160; at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)
&#160; &#160; at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
&#160; &#160; at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)
&#160; &#160; at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)
&#160; &#160; at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)
&#160; &#160; at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)
&#160; &#160; at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)
&#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)
&#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)
&#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)
&#160; &#160; at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829)
Caused by: java.io.IOException: IOException invoking https:&lt;span class=&quot;code-comment&quot;&gt;//some-server/realms/some-realm-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/protocol/openid-connect/revoke: java.lang.StackOverflowError
&lt;/span&gt;&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
&#160; &#160; at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1452)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1433)
&#160; &#160; at org.apache.cxf.io.AbstractWrappedOutputStream.close(AbstractWrappedOutputStream.java:77)
&#160; &#160; at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:717)
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit.close(HttpClientHTTPConduit.java:112)
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:63)
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.doRunInterceptorChain(AbstractClient.java:710)
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1086)
&#160; &#160; ... 69 common frames omitted
Caused by: java.io.IOException: java.lang.StackOverflowError
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit$HttpClientWrappedOutputStream.getResponse(HttpClientHTTPConduit.java:590)
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit$HttpClientWrappedOutputStream.getResponseCode(HttpClientHTTPConduit.java:601)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.doProcessResponseCode(HTTPConduit.java:1653)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1684)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1626)
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1420)
&#160; &#160; ... 77 common frames omitted
Caused by: java.lang.StackOverflowError: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&#160; &#160; at java.base/java.util.Collections$UnmodifiableCollection.size(Collections.java:1034)
&#160; &#160; at java.base/sun.security.ssl.ProtocolVersion.toStringArray(ProtocolVersion.java:250)
&#160; &#160; at java.base/sun.security.ssl.SSLConfiguration.getSSLParameters(SSLConfiguration.java:177)
&#160; &#160; at java.base/sun.security.ssl.SSLEngineImpl.getSSLParameters(SSLEngineImpl.java:867)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
&#160; &#160; at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17889242" author="reta" created="Mon, 14 Oct 2024 14:26:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mcancomert&quot; class=&quot;user-hover&quot; rel=&quot;mcancomert&quot;&gt;mcancomert&lt;/a&gt; I have difficulties to reproduce (and in generally understand) how the SOE could possibly happen, could you please share the minimal client reproducer project (or a test case) so it would be possible to replicate the exact configuration where this issue happens? Thank you.&lt;/p&gt;</comment>
                            <comment id="17892823" author="mcancomert" created="Fri, 25 Oct 2024 14:17:11 +0000"  >&lt;p&gt;Sorry for late answer, unfortunately I do not have a small application that can reproduce the issue.&lt;br/&gt;
We have an OSGI Application where Apache CXF Server is running to provide REST API and for OpenID Session management we call the endpoints of an OpenID Provider (Keycloak) with CXF Web Client libraries.&lt;br/&gt;
As we call the token endpoint for revoking the existing tokens to process logout, time to time this error occurs.&lt;/p&gt;

&lt;p&gt;At first I toght it was an abnormality in one installation but it happened in different installations in different times therefore I wanted to report the issue.&lt;br/&gt;
In last 6 months it happened really rare, 2 or 3 times reported by users on different installations.&lt;/p&gt;

&lt;p&gt;How it is triggered is not clear to me, maybe a double click on logout causes multiple threads to call &quot;Client&quot; object at the same time.&lt;br/&gt;
As a workaround we re-implemented the same functionality with another Web Client instead of CXF Web Client libraries.&lt;/p&gt;

&lt;p&gt;Both of the places are a SSL delegate is calling a method with the same name from a proxy, somehow if delegate gets its own instance such as (this) as proxy this error can happen, but how a Wrapper gets itself, or a Wrapper that contains itself is also not clear to me.&lt;/p&gt;</comment>
                            <comment id="17912697" author="reta" created="Tue, 14 Jan 2025 01:57:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mcancomert&quot; class=&quot;user-hover&quot; rel=&quot;mcancomert&quot;&gt;mcancomert&lt;/a&gt; I was able to craft the test case to reproduce the problem:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    @Test
    public void testCXF9065() throws NoSuchAlgorithmException, InterruptedException {
        SSLEngineWrapper wrapper = new SSLEngineWrapper(engine);

        for (int i = 0; i &amp;lt; 15000; ++i) {
            wrapper = new SSLEngineWrapper(wrapper);
        }
    
        assertThat(wrapper.getSSLParameters(), is(not(nullValue())));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It leads to java.lang.StackOverflowError:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.StackOverflowError
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	at org.apache.cxf.transport.https.SSLUtils$SSLEngineWrapper.getSSLParameters(SSLUtils.java:301)
	...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am wondering if this is the case for you - basically, the nesting of wrappers does lead to it&lt;/p&gt;</comment>
                            <comment id="17912850" author="mcancomert" created="Tue, 14 Jan 2025 11:48:27 +0000"  >&lt;p&gt;Thank you very much, probably the reason behind was somehow nested wrappers as you reproduced &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_up.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
As I tried to debug it I was going over more wrappers.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rxdc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>