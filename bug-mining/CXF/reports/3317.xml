<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:32:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7759] Null pointer from the ThreadLocalServletContext class</title>
                <link>https://issues.apache.org/jira/browse/CXF-7759</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Hi ,&lt;/p&gt;

&lt;p&gt;We have developed some rest services using CXF3.1.5,When I try to invoke my rest service I get always NullPointerException.&lt;/p&gt;

&lt;p&gt;I debugged this class file somehow its not getting initialized after deployment.&lt;/p&gt;

&lt;p&gt;In both tomcat and jetty we get same exception.below is the exception trace.&lt;/p&gt;

&lt;p&gt;HTTP Status 500 &#8211; Internal Server Error&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException org.apache.cxf.jaxrs.impl.tl.ThreadLocalServletContext.getAttribute(ThreadLocalServletContext.java:46) org.springframework.web.context.support.WebApplicationContextUtils.getWebApplicationContext(WebApplicationContextUtils.java:109) org.springframework.web.context.support.WebApplicationContextUtils.getWebApplicationContext(WebApplicationContextUtils.java:98) org.springframework.web.context.support.WebApplicationContextUtils.getRequiredWebApplicationContext(WebApplicationContextUtils.java:81) com.emc.healthcare.xds.registry.commons.rest.AbstractResource.getProducerTemplate(AbstractResource.java:48) com.emc.healthcare.xds.registry.commons.rest.AbstractResource.routeThroughCamel(AbstractResource.java:66) com.emc.healthcare.xds.registry.commons.rest.AbstractResource.routeThroughCamel(AbstractResource.java:56) com.emc.healthcare.xds.registry.commons.rest.SubmissionSetResource.queryForSelf(SubmissionSetResource.java:50) com.emc.healthcare.xds.registry.commons.rest.SubmissionSetResource.getSelf(SubmissionSetResource.java:34) sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) java.lang.reflect.Method.invoke(Method.java:606) org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:180) org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96) org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:189) org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:260) org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:260) org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:99) org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59) org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96) org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308) org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121) org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:253) org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:234) org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:208) org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:160) org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:180) org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:298) org.apache.cxf.transport.servlet.AbstractHTTPServlet.doGet(AbstractHTTPServlet.java:222) javax.servlet.http.HttpServlet.service(HttpServlet.java:635) org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:273) org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:317) org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127) org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:114) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:170) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:158) org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:200) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:100) org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:66) org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56) org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:214) org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177) org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yagnya&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;server :Unit test JEtty 9&lt;/p&gt;

&lt;p&gt;server: deployement in Tomcal 8&lt;/p&gt;

&lt;p&gt;Spring :4.2.5 Release&lt;/p&gt;

&lt;p&gt;Before upgrading to cxf 3.1.5 it was working smoothly without any issue.&lt;/p&gt;

&lt;p&gt;Currently we are using cxf 3.1.5 core library,prior to this we had been using cxf-api 2.7.6&lt;/p&gt;

&lt;p&gt;Just for curiosity I have one question what is the difference between using cxf core library and cxf-api library,I could see in both libraries many places same class files are present like CXFservlet.&lt;/p&gt;</environment>
        <key id="13165540">CXF-7759</key>
            <summary>Null pointer from the ThreadLocalServletContext class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="yagnya">yagnya dutta dhal</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Jun 2018 11:05:08 +0000</created>
                <updated>Wed, 3 Oct 2018 06:06:23 +0000</updated>
                            <resolved>Wed, 11 Jul 2018 14:20:07 +0000</resolved>
                                                    <fixVersion>3.2.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16509707" author="coheigea" created="Tue, 12 Jun 2018 14:46:46 +0000"  >&lt;p&gt;Please try with a more recent CXF release (such as 3.2.4 or 3.1.15). Do you have a test-case to reproduce the issue?&lt;/p&gt;</comment>
                            <comment id="16510628" author="yagnya" created="Wed, 13 Jun 2018 05:12:36 +0000"  >&lt;p&gt;Thanks Colim for early reply as always,I will try with 3.2.4 version and let you know.&lt;/p&gt;

&lt;p&gt;could you tell me when to use cxf-api jar and cxf-core jar,isn&apos;t cxf-api is part of the cxf-core?The reason I&apos;m asking is&lt;/p&gt;

&lt;p&gt;recently I joined a new project and they have been using cxf-api instead cxf-core.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16510798" author="coheigea" created="Wed, 13 Jun 2018 08:48:34 +0000"  >&lt;p&gt;cxf-api was removed from CXF 3.0.0:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cxf.apache.org/docs/30-migration-guide.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/docs/30-migration-guide.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&quot;Combined api/core into just a cxf-core. &quot;&lt;/p&gt;</comment>
                            <comment id="16523290" author="yagnya" created="Tue, 26 Jun 2018 06:36:51 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;Sorry for delayed response,I tried to reproduce the issue by taking out small portion of my project with cxf 3.2.4 and I&apos;m getting same null pointer exception as mentioned in the exception posted earlier,caused by ThreadlocalServeletContext incorrect initialization.&lt;/p&gt;

&lt;p&gt;I&apos;ve published this POC project in git hub,please have a look and let me know if anything is missing.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;GIT HUB :&lt;a href=&quot;https://github.com/yagnyadutta/restcxfcamel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/yagnyadutta/restcxfcamel&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yagnya.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16523559" author="coheigea" created="Tue, 26 Jun 2018 10:58:18 +0000"  >&lt;p&gt;Thanks for the test-case. It appears the problem is that you are injecting the ServletContext via @Context into all of the resource classes. Instead if you remove @Context from AbstractResource and move it into RegistryResource everything works correctly. See the attached diff.&lt;/p&gt;</comment>
                            <comment id="16523646" author="coheigea" created="Tue, 26 Jun 2018 12:14:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt;, it looks like the part of the change for &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-5861&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-5861&lt;/a&gt; caused this issue. When I apply the following patch to master it works:&lt;/p&gt;

&lt;p&gt;diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java&lt;br/&gt;
index ede0eb9eb8..aa73e64d58 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java&lt;br/&gt;
@@ -158,8 +158,9 @@ public class JAXRSInvoker extends AbstractInvoker {&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; final ClassResourceInfo cri = ori.getClassResourceInfo();&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; final Message inMessage = exchange.getInMessage();&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; final ServerProviderFactory providerFactory = ServerProviderFactory.getInstance(inMessage);&lt;br/&gt;
+&#160;&#160;&#160;&#160;&#160;&#160;&#160; cri.injectContexts(resourceObject, ori, inMessage);&lt;br/&gt;
+&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (cri.isRoot()) {&lt;br/&gt;
-&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cri.injectContexts(resourceObject, ori, inMessage);&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ProviderInfo&amp;lt;Application&amp;gt; appProvider = providerFactory.getApplicationProvider();&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (appProvider != null) {&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InjectionUtils.injectContexts(appProvider.getProvider(),&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Should I apply this patch to master or is there a reason not to? All test pass with it.&lt;/p&gt;</comment>
                            <comment id="16539740" author="yagnya" created="Wed, 11 Jul 2018 08:48:01 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;Have you applied this patch? If yes should I download the latest of CXF to avail the fix?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yagnya&lt;/p&gt;</comment>
                            <comment id="16540156" author="coheigea" created="Wed, 11 Jul 2018 14:20:00 +0000"  >&lt;p&gt;The patch is now applied - you can grab the CXF 3.2.x-fixes branch and build it locally to test it out:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cxf/tree/3.2.x-fixes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/tree/3.2.x-fixes&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16541229" author="yagnya" created="Thu, 12 Jul 2018 06:56:34 +0000"  >&lt;p&gt;Thank you.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="12726109">CXF-5861</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12929181" name="CXF-7759.patch" size="2050" author="coheigea" created="Tue, 26 Jun 2018 10:59:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3urkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>