<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:13:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6166] Parsing Bug in org.apache.cxf.jaxrs.provider.json.JsonMapObjectReaderWriter</title>
                <link>https://issues.apache.org/jira/browse/CXF-6166</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Parsing Bug in org.apache.cxf.jaxrs.provider.json.JsonMapObjectReaderWriter.&lt;/p&gt;

&lt;p&gt;See Patch&lt;/p&gt;</description>
                <environment></environment>
        <key id="12762637">CXF-6166</key>
            <summary>Parsing Bug in org.apache.cxf.jaxrs.provider.json.JsonMapObjectReaderWriter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="dtorkian">Daniel Torkian</reporter>
                        <labels>
                            <label>JAXRS</label>
                            <label>JSON</label>
                            <label>Parsing</label>
                    </labels>
                <created>Thu, 18 Dec 2014 17:43:53 +0000</created>
                <updated>Mon, 16 Feb 2015 16:09:46 +0000</updated>
                            <resolved>Wed, 24 Dec 2014 17:22:48 +0000</resolved>
                                    <version>3.0.3</version>
                    <version>3.0.4</version>
                    <version>3.1</version>
                                    <fixVersion>3.0.4</fixVersion>
                    <fixVersion>3.1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14251936" author="dtorkian" created="Thu, 18 Dec 2014 17:45:57 +0000"  >&lt;p&gt;Patch to fix the bug&lt;/p&gt;</comment>
                            <comment id="14252348" author="sergey_beryozkin" created="Thu, 18 Dec 2014 21:50:31 +0000"  >&lt;p&gt;Hi Daniel,&lt;br/&gt;
I&apos;m doing&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; map = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonMapObjectReaderWriter().fromJson(&lt;span class=&quot;code-quote&quot;&gt;&quot;{\&quot;&lt;/span&gt;name\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;abc\&lt;span class=&quot;code-quote&quot;&gt;&quot;}&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and with your patch I have &apos;abc&quot;&apos; with the last double quote being added to it, without the patch I just get&lt;br/&gt;
&apos;abc&apos; added in which is correct.&lt;br/&gt;
Can you please prototype a sequence where the existing code does not work ?&lt;/p&gt;</comment>
                            <comment id="14252428" author="dtorkian" created="Thu, 18 Dec 2014 22:31:44 +0000"  >&lt;p&gt;Hi Sergey, &lt;/p&gt;

&lt;p&gt;this is right, if you have a JSON Object that begins with &apos; &lt;/p&gt;
{ &apos;and ends with &apos; }
&lt;p&gt; &apos;, but if you want to add an entry (no JSON Object) that will not work correctly.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JsonMapObjectReaderWriter jmo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonMapObjectReaderWriter();
Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, ?&amp;gt; data = jmo.fromJson(&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;test\&lt;span class=&quot;code-quote&quot;&gt;&quot;:24,\&quot;&lt;/span&gt;test2\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;value\&quot;&quot;);
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(data.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;));
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(data.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;test2&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I see that my patch is not quite right. JSON Object will not be processed correctly.&lt;br/&gt;
Perhaps it would make sense to make verification, it is a JSON Object or is JSON Entry, what would you think?&lt;/p&gt;</comment>
                            <comment id="14253130" author="dtorkian" created="Fri, 19 Dec 2014 08:09:10 +0000"  >&lt;p&gt;Hi again,&lt;br/&gt;
please look at the following code snippets:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JsonMapObjectReaderWriter jmo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonMapObjectReaderWriter();
Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; data = jmo.fromJson(&lt;span class=&quot;code-quote&quot;&gt;&quot;{\&quot;&lt;/span&gt;integer\&lt;span class=&quot;code-quote&quot;&gt;&quot;:24,\&quot;&lt;/span&gt;nullKey\&lt;span class=&quot;code-quote&quot;&gt;&quot;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}&quot;&lt;/span&gt;);
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(jmo.toJson(data));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the following is the output in the console:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;integer&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;24&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;nullKey&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Integer and null are converted to string. &lt;br/&gt;
The correct output should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;integer&quot;&lt;/span&gt;:24,&lt;span class=&quot;code-quote&quot;&gt;&quot;nullKey&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14253285" author="sergey_beryozkin" created="Fri, 19 Dec 2014 11:14:50 +0000"  >&lt;p&gt;Hi Daniel,&lt;br/&gt;
Re your first example, you&apos;d first work with a map and then do a toJson(Map) call.&lt;br/&gt;
Re the second one, this parser has not been meant, originally at least to act as a generic parser, it was used internally by the Jose code in the context where a class like JwtClaims would know the context (example, a given claim is an Integer or Date) and would convert the String accordingly but then I thought I&apos;d make it more open and public because it can be useful even without Jose.&lt;/p&gt;

&lt;p&gt;The auto-conversion into Integer/etc without the type info or the implicit knowledge of the type info is not easy to do right as the experience with Jettison shows. I think I can add one more method, fromJson(String json, boolean autoConvert), if autoConvert is true then the parser will try the best effort and convert into Integer or Long or even Date&lt;/p&gt;</comment>
                            <comment id="14253367" author="dtorkian" created="Fri, 19 Dec 2014 13:10:52 +0000"  >&lt;p&gt;Thanks Sergey,&lt;br/&gt;
it will be great.&lt;/p&gt;</comment>
                            <comment id="14258389" author="sergey_beryozkin" created="Wed, 24 Dec 2014 17:22:48 +0000"  >&lt;p&gt;Hi Daniel, I&apos;ve just updated the reader to convert non-String primitives to Long which should be sufficient. Big integer values used by JWK keys, etc, are all quoted as Strings. I&apos;d like to avoid dealing with null keys for now given that ConcurrentHashMap does not accept null values.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="14264485" author="dtorkian" created="Mon, 5 Jan 2015 10:59:37 +0000"  >&lt;p&gt;Dear Sergey,&lt;/p&gt;

&lt;p&gt;happy new year 2015.&lt;/p&gt;

&lt;p&gt;thank you for your effort. I have still doubts whether long is sufficient alone. what would you think of this proposal?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff --git a/rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/json/JsonMapObjectReaderWriter.java b/rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/json/JsonMapObjectReaderWriter.java
index 343bad5..623ace0 100644
--- a/rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/json/JsonMapObjectReaderWriter.java
+++ b/rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/json/JsonMapObjectReaderWriter.java
@@ -200,8 +200,14 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;JsonMapObjectReaderWriter {
             value = valueStr.substring(1, valueStr.length() - 1);
         } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;.equals(value) || &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;.equals(value)) {
             value = &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.valueOf(valueStr);
+        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;.equals(value)){
+            value = &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;;
         } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
-            value = &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.valueOf(valueStr);
+        	&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+				value = &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.parseLong(valueStr);
+			} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
+				value = &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;.valueOf(valueStr);
+			}
         }
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value;
     }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Daniel&lt;/p&gt;</comment>
                            <comment id="14265857" author="sergey_beryozkin" created="Tue, 6 Jan 2015 08:43:19 +0000"  >&lt;p&gt;Hi Daniel&lt;br/&gt;
Happy New Year to you too &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
You are right, I&apos;ve added a code retrying a conversion to Double&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12688070" name="bugJsonMapObjectReaderWriter.txt" size="954" author="dtorkian" created="Thu, 18 Dec 2014 17:45:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23l3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>