<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:35:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-1906] Unmarshalling Set to TreeSet instead of HashSet</title>
                <link>https://issues.apache.org/jira/browse/CXF-1906</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When using the Aegis databinding, if you are deserializing to a class that has a Set in it, Aegis is currently instantiating the set as a SortedSet.  This fails for cases where the objects being added to the set do not implement Comparable, and is undesired in any case.&lt;/p&gt;

&lt;p&gt;The error occurs in CollectionType.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; Collection&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; createCollection() {
        Collection values = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getTypeClass().isAssignableFrom(List.class)) {
            values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList();
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getTypeClass().isAssignableFrom(SortedSet.class)) {
            values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet();
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getTypeClass().isAssignableFrom(Set.class)) {
            values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet();
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getTypeClass().isAssignableFrom(Vector.class)) {
            values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector();
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getTypeClass().isInterface()) {
            values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList();
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the typeClass is Set, then the second &quot;if&quot; clause evaluates to true since Set is a superclass/superinterface of SortedSet.&lt;/p&gt;

&lt;p&gt;I&apos;ve got a patch I&apos;ll submit and I&apos;ll explain the fix.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408253">CXF-1906</key>
            <summary>Unmarshalling Set to TreeSet instead of HashSet</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="marcuschristie">Marcus Christie</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Nov 2008 15:37:07 +0000</created>
                <updated>Fri, 24 Apr 2009 21:17:03 +0000</updated>
                            <resolved>Sat, 15 Nov 2008 12:58:59 +0000</resolved>
                                    <version>2.1.3</version>
                                    <fixVersion>2.2</fixVersion>
                                    <component>Aegis Databinding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12646572" author="marcuschristie" created="Tue, 11 Nov 2008 15:41:00 +0000"  >&lt;p&gt;Patch to fix Set/SortedSet bug.&lt;/p&gt;</comment>
                            <comment id="12646576" author="marcuschristie" created="Tue, 11 Nov 2008 15:52:09 +0000"  >&lt;p&gt;This is meant to supersede the previous patch attachment.&lt;/p&gt;</comment>
                            <comment id="12646578" author="marcuschristie" created="Tue, 11 Nov 2008 15:58:42 +0000"  >&lt;p&gt;I submitted a patch to fix this bug (I actually submitted the patch twice, but I realized that the first attempt had a problem with it; please disregard it).  The bug in CollectionType.createCollection is that Set &quot;isAssignableFrom&quot; SortedSet because it is a supertype of SortedSet, so the SortedSet &quot;if&quot; clause should come after the Set &quot;if&quot; clause.  Here is how the code is in that method with the patch applied:&lt;/p&gt;

&lt;p&gt;        if (getTypeClass().isAssignableFrom(List.class)) &lt;/p&gt;
{
            values = new ArrayList();
        } else if (getTypeClass().isAssignableFrom(Set.class)) {
        	values = new HashSet();
        } else if (getTypeClass().isAssignableFrom(SortedSet.class)) {
            values = new TreeSet();
        } else if (getTypeClass().isAssignableFrom(Vector.class)) {
            values = new Vector();
        } else if (getTypeClass().isInterface()) {            values = new ArrayList();        }
&lt;p&gt; else {&lt;br/&gt;
....&lt;/p&gt;

&lt;p&gt;This way, if your class has a Set, Aegis will create a HashSet to add values to.  In the case that the typeClass if a SortedSet, it will fail the second &quot;if&quot; clause since SortedSet is not a supertype of Set, but will pass the third &quot;if&quot; clause since, obviously, SortedSet  &quot;is assignable from&quot; a SortedSet.  So the fix is really to just reorder the &quot;if&quot; clauses a bit so that not every Set is treated as a SortedSet.&lt;/p&gt;</comment>
                            <comment id="12646581" author="marcuschristie" created="Tue, 11 Nov 2008 16:10:07 +0000"  >&lt;p&gt;One other thing, as far as I can tell this bug was introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-1770&quot; title=&quot;org.apache.cxf.aegis.type.collection.CollectionType createCollection method returns ArrayList object for typeClass java.util.SortedSet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-1770&quot;&gt;&lt;del&gt;CXF-1770&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12647839" author="bmargulies" created="Sat, 15 Nov 2008 12:58:58 +0000"  >&lt;p&gt;Fix, and unit test extended to cover this as related classes.&lt;/p&gt;</comment>
                            <comment id="12648182" author="marcuschristie" created="Mon, 17 Nov 2008 16:09:55 +0000"  >&lt;p&gt;Benson,&lt;/p&gt;

&lt;p&gt;Thanks for getting on this and resolving it so quickly.  One question, will this bug fix make it into 2.1.4?  Thanks.&lt;/p&gt;</comment>
                            <comment id="12648184" author="bmargulies" created="Mon, 17 Nov 2008 16:15:03 +0000"  >&lt;p&gt;I expect that Willem will backport it.&lt;/p&gt;</comment>
                            <comment id="12648185" author="bmargulies" created="Mon, 17 Nov 2008 16:15:36 +0000"  >&lt;p&gt;Passing along to the current branch merger.&lt;/p&gt;</comment>
                            <comment id="12648526" author="njiang" created="Tue, 18 Nov 2008 08:13:27 +0000"  >&lt;p&gt;Merged the patch into 2.1.x-fix branch &lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=718512&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=718512&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393711" name="CXF-1906_patch.txt" size="1086" author="marcuschristie" created="Tue, 11 Nov 2008 15:52:09 +0000"/>
                            <attachment id="12393708" name="CXF-1906_patch.txt" size="1382" author="marcuschristie" created="Tue, 11 Nov 2008 15:41:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>112657</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uybz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178703</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>