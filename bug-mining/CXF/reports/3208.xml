<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:29:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7597] Suspicious calls to ClassLoader.findResource when resolving absolute base and actual URIs</title>
                <link>https://issues.apache.org/jira/browse/CXF-7597</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When &lt;tt&gt;URIResolver.resolve(..)&lt;/tt&gt; is called with both &lt;tt&gt;baseUriStr&lt;/tt&gt; and &lt;tt&gt;uriStr&lt;/tt&gt; containing absolute URIs, e.g.&lt;/p&gt;

&lt;blockquote&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;b&gt;baseUriStr&lt;/b&gt; = jar:&lt;a href=&quot;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world.wsdl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world.wsdl&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;uriStr&lt;/b&gt; = jar:&lt;a href=&quot;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;then it makes suspicious calls to a class loader, trying to find resources with names like&lt;/p&gt;

&lt;blockquote&gt;
&lt;ol&gt;
	&lt;li&gt;jar:&lt;a href=&quot;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;/jar:&lt;a href=&quot;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;jar:&lt;a href=&quot;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/midpoint/tgit/cxf/core/target/test-classes/org/apache/cxf/resource/resources/helloworld.bpr!/wsdl/hello_world_2.wsdl&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;In our case (when used as part of the &lt;a href=&quot;https://github.com/Evolveum/midpoint/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;midPoint&lt;/a&gt; product) the situation is like this:&lt;/p&gt;

&lt;p&gt;Resolving:&lt;/p&gt;

&lt;blockquote&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;b&gt;baseUriStr&lt;/b&gt; = jar:&lt;a href=&quot;file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/xml/ns/public/common/common-3.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/xml/ns/public/common/common-3.xsd&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;uriStr&lt;/b&gt; = jar:&lt;a href=&quot;file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/prism/xml/ns/public/types-3.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/prism/xml/ns/public/types-3.xsd&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;leads first to the resolution of obviously wrong URL:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;jar:&lt;a href=&quot;file:/C:/tmp/mp/lib/midpoint.war!jar:file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/prism/xml/ns/public/types-3.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/tmp/mp/lib/midpoint.war!jar:file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/prism/xml/ns/public/types-3.xsd&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;(note the two midpoint.war segments there)&lt;/p&gt;

&lt;p&gt;and then to the resolution of the following resource name (via class loader):&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;jar:&lt;a href=&quot;file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/prism/xml/ns/public/types-3.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/C:/tmp/mp/lib/midpoint.war!/WEB-INF/lib/schema-3.7.jar!/prism/xml/ns/public/types-3.xsd&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Note that as per ClassLoader javadocs, &quot;The name of a resource is a &apos;/&apos;-separated path name that identifies the resource.&quot; Although formally the above URIs match this definition, some class loader implementations, namely the one in Spring Boot which we use in midPoint, react to such requests in an unexpected way, returning wrong (unrelated) content. The result is that &lt;tt&gt;URIResolver.resolve(..)&lt;/tt&gt; returns the wrong content as well. See &lt;a href=&quot;https://github.com/spring-projects/spring-boot/issues/11367&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Spring Boot issue #11367&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Even when Spring Boot is eventually fixed, &lt;tt&gt;classLoader.findResource(..)&lt;/tt&gt; calls are unnecessary overhead.&lt;/p&gt;

&lt;p&gt;Please see &lt;tt&gt;&lt;a href=&quot;https://github.com/Evolveum/cxf/commit/44d99924db52f2a4b5bdacc41bd83b81bffb8cb4#diff-565a425d43d14b14b2dbb4a251b04697R92&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;URIResolverTest.testJARResolveBaseAndAbsolute&lt;/a&gt;&lt;/tt&gt; in the upcoming commit as well as the proposed &lt;a href=&quot;https://github.com/Evolveum/cxf/commit/44d99924db52f2a4b5bdacc41bd83b81bffb8cb4#diff-b7160a28d60b729a956bd1a5f5ffa351&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fix&lt;/a&gt; in &lt;tt&gt;URIResolver&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13126612">CXF-7597</key>
            <summary>Suspicious calls to ClassLoader.findResource when resolving absolute base and actual URIs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="mederly">Pavol Mederly</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Dec 2017 17:48:49 +0000</created>
                <updated>Sat, 13 Jan 2018 16:20:30 +0000</updated>
                            <resolved>Sat, 13 Jan 2018 11:07:58 +0000</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.1.15</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16303247" author="deki" created="Mon, 25 Dec 2017 11:34:20 +0000"  >&lt;p&gt;Thanks for the bug report. Can you create a pull request for it? &lt;a href=&quot;https://github.com/apache/cxf/pulls&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pulls&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16311262" author="githubbot" created="Thu, 4 Jan 2018 12:14:12 +0000"  >&lt;p&gt;mederly opened a new pull request #363: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7597&quot; title=&quot;Suspicious calls to ClassLoader.findResource when resolving absolute base and actual URIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7597&quot;&gt;&lt;del&gt;CXF-7597&lt;/del&gt;&lt;/a&gt; Fix suspicious class loader findResource calls&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/363&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16311264" author="mederly" created="Thu, 4 Jan 2018 12:15:25 +0000"  >&lt;p&gt;I do apologize for late reply, as I am (still) on vacation. The PR is available at &lt;a href=&quot;https://github.com/apache/cxf/pull/363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/363&lt;/a&gt;. Hope it&apos;s ok.&lt;/p&gt;</comment>
                            <comment id="16325056" author="githubbot" created="Sat, 13 Jan 2018 09:07:40 +0000"  >&lt;p&gt;ffang closed pull request #363: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7597&quot; title=&quot;Suspicious calls to ClassLoader.findResource when resolving absolute base and actual URIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7597&quot;&gt;&lt;del&gt;CXF-7597&lt;/del&gt;&lt;/a&gt; Fix suspicious class loader findResource calls&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/363&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/java/org/apache/cxf/resource/URIResolver.java b/core/src/main/java/org/apache/cxf/resource/URIResolver.java&lt;br/&gt;
index 019935865f4..5a9e43d7e55 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/java/org/apache/cxf/resource/URIResolver.java&lt;br/&gt;
+++ b/core/src/main/java/org/apache/cxf/resource/URIResolver.java&lt;br/&gt;
@@ -83,7 +83,8 @@ public URIResolver(String baseUriStr, String uriStr, Class&amp;lt;?&amp;gt; calling) throws IO&lt;br/&gt;
         } else if (baseUriStr != null&lt;br/&gt;
             &amp;amp;&amp;amp; (baseUriStr.startsWith(&quot;jar:&quot;)&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; baseUriStr.startsWith(&quot;zip:&quot;)
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; baseUriStr.startsWith(&quot;wsjar:&quot;))) {&lt;br/&gt;
+                &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; baseUriStr.startsWith(&quot;wsjar:&quot;))&lt;br/&gt;
+            &amp;amp;&amp;amp; !isAbsolute(uriStr)) 
{
             tryArchive(baseUriStr, uriStr);
         } else if (uriStr.startsWith(&quot;jar:&quot;)&lt;br/&gt;
             || uriStr.startsWith(&quot;zip:&quot;)&lt;br/&gt;
@@ -112,7 +113,8 @@ public void resolve(String baseUriStr, String uriStr, Class&amp;lt;?&amp;gt; callingCls) throw&lt;br/&gt;
         } else if (baseUriStr != null&lt;br/&gt;
             &amp;amp;&amp;amp; (baseUriStr.startsWith(&quot;jar:&quot;)&lt;br/&gt;
                 || baseUriStr.startsWith(&quot;zip:&quot;)&lt;br/&gt;
-                || baseUriStr.startsWith(&quot;wsjar:&quot;))) {&lt;br/&gt;
+                || baseUriStr.startsWith(&quot;wsjar:&quot;))&lt;br/&gt;
+            &amp;amp;&amp;amp; !isAbsolute(uriStr)) {             tryArchive(baseUriStr, uriStr);         }
&lt;p&gt; else if (uriStr.startsWith(&quot;jar:&quot;)&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; uriStr.startsWith(&quot;zip:&quot;)&lt;br/&gt;
@@ -123,7 +125,13 @@ public void resolve(String baseUriStr, String uriStr, Class&amp;lt;?&amp;gt; callingCls) throw&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;-&lt;br/&gt;
+    private boolean isAbsolute(String uriStr) {&lt;br/&gt;
+        try &lt;/p&gt;
{
+            return new URI(uriStr).isAbsolute();
+        }
&lt;p&gt; catch (URISyntaxException e) &lt;/p&gt;
{
+            return false;
+        }
&lt;p&gt;+    }&lt;/p&gt;

&lt;p&gt;     private void tryFileSystem(String baseUriStr, String uriStr) throws IOException, MalformedURLException {&lt;br/&gt;
         try {&lt;br/&gt;
diff --git a/core/src/test/java/org/apache/cxf/resource/URIResolverTest.java b/core/src/test/java/org/apache/cxf/resource/URIResolverTest.java&lt;br/&gt;
index 4ef6338fcb4..9efb8f00417 100644&lt;br/&gt;
&amp;#8212; a/core/src/test/java/org/apache/cxf/resource/URIResolverTest.java&lt;br/&gt;
+++ b/core/src/test/java/org/apache/cxf/resource/URIResolverTest.java&lt;br/&gt;
@@ -32,6 +32,7 @@&lt;/p&gt;

&lt;p&gt;     private URL resourceURL = getClass().getResource(&quot;resources/helloworld.bpr&quot;);&lt;/p&gt;

&lt;p&gt;+    private Throwable checkingThreadThrowable;      // assumes single-thread test execution&lt;/p&gt;

&lt;p&gt;     @Test&lt;br/&gt;
     public void testJARProtocol() throws Exception {&lt;br/&gt;
@@ -57,6 +58,9 @@ public void testJARProtocol() throws Exception &lt;/p&gt;
{
         is2.read(barray2);
         is2.close();
         assertEquals(IOUtils.newStringFromBytes(barray), IOUtils.newStringFromBytes(barray2));
+
+        resolveWithCheckingClassloader(uriResolver, &quot;baseUriStr&quot;, uriStr, null);
+        resolveWithCheckingClassloaderInConstructor(&quot;baseUriStr&quot;, uriStr, null);
     }

&lt;p&gt;     @Test&lt;br/&gt;
@@ -79,8 +83,30 @@ public void testJARResolver() throws Exception &lt;/p&gt;
{
 
         InputStream is3 = uriResolver.getInputStream();
         assertNotNull(is3);
+
+        resolveWithCheckingClassloader(uriResolver, uriStr, &quot;hello_world_2.wsdl&quot;, null);
+        resolveWithCheckingClassloaderInConstructor(uriStr, &quot;hello_world_2.wsdl&quot;, null);
     }

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testJARResolveBaseAndAbsolute() throws Exception &lt;/p&gt;
{
+        uriResolver = new URIResolver();
+
+        String baseUriStr = &quot;jar:&quot; + resourceURL.toString() + &quot;!/wsdl/hello_world.wsdl&quot;;
+
+        URL jarURL = new URL(baseUriStr);
+        InputStream is = jarURL.openStream();
+        assertNotNull(is);
+
+        String uriStr = &quot;jar:&quot; + resourceURL.toString() + &quot;!/wsdl/hello_world_2.wsdl&quot;;
+
+        URL jarURL2 = new URL(uriStr);
+        InputStream is2 = jarURL2.openStream();
+        assertNotNull(is2);
+
+        resolveWithCheckingClassloader(uriResolver, baseUriStr, uriStr, null);
+        resolveWithCheckingClassloaderInConstructor(baseUriStr, uriStr, null);
+    }

&lt;p&gt;     @Test&lt;br/&gt;
     public void testResolveRelativeFile() throws Exception {&lt;br/&gt;
@@ -98,12 +124,15 @@ public void testResolveRelativeFile() throws Exception &lt;/p&gt;
{
         URIResolver xsdResolver = new URIResolver();
         xsdResolver.resolve(baseUri, schemaLocation, this.getClass());
         assertNotNull(xsdResolver.getInputStream());
+        resolveWithCheckingClassloader(xsdResolver, baseUri, schemaLocation, this.getClass());
+        resolveWithCheckingClassloaderInConstructor(baseUri, schemaLocation, this.getClass());
 
         // resolve the schema using relative location with base uri fragment
         xsdResolver = new URIResolver();
         xsdResolver.resolve(baseUri + &quot;#type2&quot;, schemaLocation, this.getClass());
         assertNotNull(xsdResolver.getInputStream());
-
+        resolveWithCheckingClassloader(xsdResolver, baseUri + &quot;#type2&quot;, schemaLocation, this.getClass());
+        resolveWithCheckingClassloaderInConstructor(baseUri + &quot;#type2&quot;, schemaLocation, this.getClass());
     }&lt;br/&gt;
 &lt;br/&gt;
     @Test&lt;br/&gt;
@@ -122,12 +151,15 @@ public void testResolvePathWithSpace() throws Exception {         URIResolver xsdResolver = new URIResolver();         xsdResolver.resolve(baseUri, schemaLocation, this.getClass());         assertNotNull(xsdResolver.getInputStream());+        resolveWithCheckingClassloader(xsdResolver, baseUri, schemaLocation, this.getClass());+        resolveWithCheckingClassloaderInConstructor(baseUri, schemaLocation, this.getClass());          // resolve the schema using relative location with base uri fragment         xsdResolver = new URIResolver();         xsdResolver.resolve(baseUri + &quot;#type2&quot;, schemaLocation, this.getClass());         assertNotNull(xsdResolver.getInputStream());-+        resolveWithCheckingClassloader(xsdResolver, baseUri + &quot;#type2&quot;, schemaLocation, this.getClass());+        resolveWithCheckingClassloaderInConstructor(baseUri + &quot;#type2&quot;, schemaLocation, this.getClass());     }

&lt;p&gt;     @Test&lt;br/&gt;
@@ -136,6 +168,8 @@ public void testBasePathWithSpace() throws Exception &lt;/p&gt;
{
         // resolve the wsdl
         wsdlResolver.resolve(null, &quot;wsdl/folder with spaces/foo.wsdl&quot;, this.getClass());
         assertTrue(wsdlResolver.isResolved());
+        resolveWithCheckingClassloader(wsdlResolver, null, &quot;wsdl/folder with spaces/foo.wsdl&quot;, this.getClass());
+        resolveWithCheckingClassloaderInConstructor(null, &quot;wsdl/folder with spaces/foo.wsdl&quot;, this.getClass());
     }

&lt;p&gt;     @Test&lt;br/&gt;
@@ -144,5 +178,62 @@ public void testBasePathWithEncodedSpace() throws Exception &lt;/p&gt;
{
         // resolve the wsdl
         wsdlResolver.resolve(null, &quot;wsdl/folder%20with%20spaces/foo.wsdl&quot;, this.getClass());
         assertTrue(wsdlResolver.isResolved());
+        resolveWithCheckingClassloader(wsdlResolver, null, &quot;wsdl/folder%20with%20spaces/foo.wsdl&quot;, this.getClass());
+        resolveWithCheckingClassloaderInConstructor(null, &quot;wsdl/folder%20with%20spaces/foo.wsdl&quot;, this.getClass());
+    }
&lt;p&gt;+&lt;br/&gt;
+    private void resolveWithCheckingClassloader(URIResolver resolver, String baseUriStr, String uriStr,&lt;br/&gt;
+            Class&amp;lt;?&amp;gt; callingCls) throws InterruptedException {&lt;br/&gt;
+        checkingThreadThrowable = null;&lt;br/&gt;
+        Runnable operation = () -&amp;gt; {&lt;br/&gt;
+            try &lt;/p&gt;
{
+                resolver.resolve(baseUriStr, uriStr, callingCls);
+            }
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
+                checkingThreadThrowable = t;
+            }&lt;br/&gt;
+            assertNotNull(resolver.getInputStream());&lt;br/&gt;
+        };&lt;br/&gt;
+        Thread thread = new Thread(operation);&lt;br/&gt;
+        thread.setContextClassLoader(new CheckingClassLoader(this.getClass().getClassLoader()));&lt;br/&gt;
+        thread.start();&lt;br/&gt;
+        thread.join(10000);&lt;br/&gt;
+        assertFalse(&quot;resolve operation did not finish in time&quot;, thread.isAlive());&lt;br/&gt;
+        assertNull(checkingThreadThrowable);&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    private void resolveWithCheckingClassloaderInConstructor(String baseUriStr, String uriStr, Class&amp;lt;?&amp;gt; callingCls)&lt;br/&gt;
+            throws InterruptedException {&lt;br/&gt;
+        checkingThreadThrowable = null;&lt;br/&gt;
+        Runnable operation = () -&amp;gt; {&lt;br/&gt;
+            URIResolver resolver = null;&lt;br/&gt;
+            try {
+                resolver = new URIResolver(baseUriStr, uriStr, callingCls);
+            } catch (Throwable t) {+                checkingThreadThrowable = t;+            }
&lt;p&gt;+            if (resolver != null) &lt;/p&gt;
{
+                assertNotNull(resolver.getInputStream());
+            }
&lt;p&gt;+        };&lt;br/&gt;
+        Thread thread = new Thread(operation);&lt;br/&gt;
+        thread.setContextClassLoader(new CheckingClassLoader(this.getClass().getClassLoader()));&lt;br/&gt;
+        thread.start();&lt;br/&gt;
+        thread.join(10000);&lt;br/&gt;
+        assertFalse(&quot;resolve operation did not finish in time&quot;, thread.isAlive());&lt;br/&gt;
+        assertNull(checkingThreadThrowable);&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    static class CheckingClassLoader extends ClassLoader {&lt;br/&gt;
+        CheckingClassLoader(ClassLoader parent) &lt;/p&gt;
{
+            super(parent);
+        }
&lt;p&gt;+&lt;br/&gt;
+        @Override&lt;br/&gt;
+        protected URL findResource(String name) {&lt;br/&gt;
+            if (name != null &amp;amp;&amp;amp; name.startsWith(&quot;jar:file:&quot;)) &lt;/p&gt;
{
+                throw new AssertionError(&quot;Suspicious resource name: &quot; + name);
+            }
&lt;p&gt;+            return super.findResource(name);&lt;br/&gt;
+        }&lt;br/&gt;
     }&lt;br/&gt;
 }&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16325083" author="ffang" created="Sat, 13 Jan 2018 11:07:34 +0000"  >&lt;p&gt;patch applied on half of Pavol Mederly with thanks&lt;/p&gt;</comment>
                            <comment id="16325195" author="mederly" created="Sat, 13 Jan 2018 16:20:30 +0000"  >&lt;p&gt;Thank you as well!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 44 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3o6rb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>