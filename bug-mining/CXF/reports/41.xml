<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:33:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-1621] Memory Leak in WSDLManagerImpl - SchemaCacheMap</title>
                <link>https://issues.apache.org/jira/browse/CXF-1621</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The schemaCacheMap in WSDLManagerImpl has a weak key - WSDLDefinition and value ServiceSchemaInfo. A key,value pair is inserted into this map while building a service. The entry is never explicitly removed from this map. Since the map is a WeakHashMap, it is assumed that when the key WSDLDefinition is weakly referenced, the entry would be removed from the map. But it is seen that the value ServiceSchemaInfo(the value) holds on to a SchemaInfo which in turn holds on to the ServiceInfo, which holds the WSDLDefinition through the AbstractPropertiesHolder.&lt;br/&gt;
This would mean that the value of the CacheMap always strongly refers to the key, which would mean the entry would never be removed from the map.&lt;br/&gt;
&quot;The value objects in a WeakHashMap are held by ordinary strong references. Thus care should be taken to ensure that value objects do not strongly refer to their own keys, either directly or indirectly, since that will prevent the keys from being discarded&quot;&lt;/p&gt;

&lt;p&gt;This would mean ServiceInfo, OperationInfo, BindingInfo, WSDLDefinition would all stay in the VM even after the endpoint is stopped.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12397260">CXF-1621</key>
            <summary>Memory Leak in WSDLManagerImpl - SchemaCacheMap</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bharathganesh">Bharath Ganesh</assignee>
                                    <reporter username="bharathganesh">Bharath Ganesh</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Jun 2008 06:37:52 +0000</created>
                <updated>Thu, 3 Jul 2008 17:19:33 +0000</updated>
                            <resolved>Tue, 10 Jun 2008 12:22:32 +0000</resolved>
                                    <version>2.1</version>
                    <version>2.0.6</version>
                                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.0.7</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12603145" author="dkulp" created="Fri, 6 Jun 2008 19:22:09 +0000"  >
&lt;p&gt;Any updates to this?   It would definitely be great to get a fix in for the 2.0.7/2.1.1 builds next week.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="12603293" author="bharathganesh" created="Sat, 7 Jun 2008 06:42:46 +0000"  >&lt;p&gt;Sure will do that. On a vacation now. Will commit on monday..&lt;/p&gt;
</comment>
                            <comment id="12603847" author="bharathganesh" created="Tue, 10 Jun 2008 12:22:32 +0000"  >&lt;p&gt;&lt;a href=&quot;http://www.nabble.com/Memory-Leak-at-WSDLManagerImpl-td17579537.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/Memory-Leak-at-WSDLManagerImpl-td17579537.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The schemaCacheMap will now always have a weak value (This will be done by putting a WeakReference of the&lt;br/&gt;
ServiceSchemaInfo in the map). &lt;/p&gt;</comment>
                            <comment id="12604037" author="dkulp" created="Tue, 10 Jun 2008 20:57:02 +0000"  >
&lt;p&gt;Bharath,&lt;/p&gt;

&lt;p&gt;This caused a NPE when building the system tests on a couple a my machines.   Basically, the CORBA utils have the manager create a Definition and a builder then builds the schemas and stuff for it and add to the cache.  However, the builder is discarded so nothing at all was holding onto the Schemas strongly and they got garbage collected before the CORBA utils could grab them.  Not all machines, but it did on my Mac.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I flipped the schemaCache to using the same keys as the definitionsCache.   That fixed that.&lt;/p&gt;

&lt;p&gt;However, after I did that, I discovered the ServiceInfo in the SchemaInfo was never used at all.   It wasn&apos;t needed.  Thus, I yanked it.   That should also fix it.&lt;/p&gt;

&lt;p&gt;In anycase, I&apos;d appreciate a verification.  &lt;/p&gt;
</comment>
                            <comment id="12605366" author="bharathganesh" created="Mon, 16 Jun 2008 18:26:08 +0000"  >&lt;p&gt;Verified the memory leak fixes by profiling JAX-WS server and client runtime. Also the complete Java EE TCK (JAX-WS 2.0 on CXF 2.0.7 snapshot) runs in a single run with around 200M heap size. All looks OK.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>112410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0syj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>167071</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>