<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:26:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7459] JAX-RS WebClient.invoke() do not respect Content-Type setting in HTTP-Conduit</title>
                <link>https://issues.apache.org/jira/browse/CXF-7459</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;We got in some problem while using WebClient.invoke() to communicate external services.&lt;/p&gt;

&lt;p&gt;The message sent by WebClient.invoke() comes from other part of our product, which plays the role of an integrator basing on configuration. Thus during development, we can&apos;t know the real type of message and set all message type in the invoke method as inputStream. Other information of the connection for example Content-Type is set in http-conduit.&lt;/p&gt;

&lt;p&gt;The problem we found is that under our usage of WebClient.invoke(), Content-Type in http-conduit can&apos;t be set to application/x-www-form-urlencoded. It is set back to default value application/xml as is WebClient. But it is not true for other type of Content-Type setting in conduit. To set ourselves&apos; headers object to the WebClient before invoking it bypasses the issue as well.&lt;/p&gt;

&lt;p&gt;Another problem is logging feature lies on this issue. application/x-www-form-urlencoded is showed in log but if monitoring with third part tool it&apos;s application/xml.&lt;/p&gt;

&lt;p&gt;Related configuration xml:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;    &amp;lt;http:conduit name=&quot;*.http-conduit&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;http:client AutoRedirect=&quot;false&quot; AllowChunking=&quot;false&quot; Accept=&quot;&lt;b&gt;/&lt;/b&gt;&quot; ContentType=&quot;application/x-www-form-urlencoded&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/http:conduit&amp;gt;&lt;br/&gt;
    &amp;lt;cxf:bus&amp;gt;&lt;br/&gt;
        &amp;lt;cxf:features&amp;gt;&lt;br/&gt;
            &amp;lt;cxf:logging/&amp;gt;&lt;br/&gt;
        &amp;lt;/cxf:features&amp;gt;&lt;br/&gt;
    &amp;lt;/cxf:bus&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sample code of our product to call service.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;        if (webClientTemplate == null) {&lt;br/&gt;
            // create from the url and provider list&lt;br/&gt;
            webClientTemplate = WebClient.create(address, providerList);&lt;br/&gt;
            // copy the headers over&lt;br/&gt;
            MultivaluedMap&amp;lt;String, String&amp;gt; tempHeaders = webClientTemplate.getHeaders();&lt;br/&gt;
            for (String key : headers.keySet()) {&lt;br/&gt;
                String value = headers.get(key);&lt;br/&gt;
                tempHeaders.putSingle(key, value);&lt;br/&gt;
            }&lt;br/&gt;
            webClientTemplate.headers(tempHeaders);&lt;br/&gt;
        }&lt;br/&gt;
        // now we always have a template, copy it for best speed in creating a web client&lt;br/&gt;
        return WebClient.fromClient(webClientTemplate, true);&lt;br/&gt;
        ......&lt;br/&gt;
        responseStream = webClient.invoke(requestMethod, requestStream, InputStream.class);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Comparing logging we got between old version and 3.1.5 we are in use.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Working (2.7.8):&lt;/p&gt;

&lt;p&gt;INFO: Outbound Message&lt;br/&gt;
---------------------------&lt;br/&gt;
ID: 1&lt;br/&gt;
Address: &lt;a href=&quot;https://developer.tigertext.me/v2/message&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.tigertext.me/v2/message&lt;/a&gt;&lt;br/&gt;
Http-Method: POST&lt;br/&gt;
Content-Type: application/x-www-form-urlencoded&lt;br/&gt;
Headers: {Content-Type=[application/xml], Accept=[&lt;b&gt;/&lt;/b&gt;], Authorization=[Basic VFF3Y1ZUOXljaHpFVG93bkVTUVpxc3g2cm9oaE5yUDU6V1lUeGpDUzgwTEF6YWFTOWNyRFp3QlhTZnRjRmxmb1JBMDFHbW9MUFpwZUJxbG14], Connection=[Keep-Alive]}&lt;br/&gt;
Payload: recipient=%2B15739992640&amp;amp;ttl=1440&amp;amp;body=Patient Test, ADM (DOB: 19650414) has been admitted to Stamford Hospital and indicated you as their PCP.&lt;br/&gt;
--------------------------------------&lt;/p&gt;

&lt;p&gt;INFO: Inbound Message&lt;br/&gt;
----------------------------&lt;br/&gt;
ID: 1&lt;br/&gt;
Response-Code: 204&lt;br/&gt;
Encoding: ISO-8859-1&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {connection=[keep-alive], Content-Length=[0], content-type=[application/json], Date=[Wed, 26 Jul 2017 21:04:48 GMT], Server=[nginx], TT-X-Message-Id=[67e0fa88-4965-41a7-a37a-97ec0280d4ec], TT-X-Msg-Ttl=[1440], TT_Log_Account_Token=[d7d6b87c-1ccd-4ad1-bc2b-40f2d4d28e1d], TT_Log_API_Key=[16675b77-a1d7-4815-96e4-9802254cb3f3], TT_Log_HTTP_Verb=[POST], TT_Log_Message_ID=[67e0fa88-4965-41a7-a37a-97ec0280d4ec], TT_Log_Organization=[agbdTQbwmlqiasaI2zkPLFO2], TT_Log_Processed_By_Host=[prod-tigerconnect-xmpp-i-08fc29d0a5e5715a2], TT_Log_Product_Token=[consumer], TT_Log_Traffic_Type=[public], TT_Log_URI_Name=[/api/message/message_id]}&lt;br/&gt;
--------------------------------------&lt;/p&gt;


&lt;p&gt;Not working (3.1.5):&lt;/p&gt;

&lt;p&gt;INFO: Outbound Message&lt;br/&gt;
---------------------------&lt;br/&gt;
ID: 1&lt;br/&gt;
Address: &lt;a href=&quot;https://developer.tigertext.me/v2/message&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.tigertext.me/v2/message&lt;/a&gt;&lt;br/&gt;
Http-Method: POST&lt;br/&gt;
Content-Type: application/x-www-form-urlencoded&lt;br/&gt;
Headers: {Content-Type=[application/xml], Accept=[&lt;b&gt;/&lt;/b&gt;], Authorization=[Basic VFF3Y1ZUOXljaHpFVG93bkVTUVpxc3g2cm9oaE5yUDU6V1lUeGpDUzgwTEF6YWFTOWNyRFp3QlhTZnRjRmxmb1JBMDFHbW9MUFpwZUJxbG14], Connection=[Keep-Alive]}&lt;br/&gt;
Payload: recipient=%2B15739992640&amp;amp;ttl=1440&amp;amp;body=Patient Test, ADM (DOB: 19650414) has been admitted to Stamford Hospital and indicated you as their PCP.&lt;br/&gt;
--------------------------------------&lt;/p&gt;

&lt;p&gt;INFO: Inbound Message&lt;br/&gt;
----------------------------&lt;br/&gt;
ID: 1&lt;br/&gt;
Response-Code: 415&lt;br/&gt;
Encoding: ISO-8859-1&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {connection=[keep-alive], Content-Length=[0], content-type=[application/json], Date=[Wed, 26 Jul 2017 20:56:48 GMT], Server=[nginx], TT_Log_Account_Token=[d7d6b87c-1ccd-4ad1-bc2b-40f2d4d28e1d], TT_Log_API_Key=[16675b77-a1d7-4815-96e4-9802254cb3f3], TT_Log_HTTP_Verb=[POST], TT_Log_Organization=[agbdTQbwmlqiasaI2zkPLFO2], TT_Log_Processed_By_Host=[prod-tigerconnect-xmpp-i-08fc29d0a5e5715a2], TT_Log_Product_Token=[consumer], TT_Log_Traffic_Type=[public], TT_Log_URI_Name=[/api/message/message_id]}&lt;br/&gt;
--------------------------------------&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13091132">CXF-7459</key>
            <summary>JAX-RS WebClient.invoke() do not respect Content-Type setting in HTTP-Conduit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="lukexu">Luke Xu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Jul 2017 09:21:32 +0000</created>
                <updated>Tue, 28 Nov 2017 10:42:26 +0000</updated>
                            <resolved>Wed, 2 Aug 2017 11:14:37 +0000</resolved>
                                    <version>3.1.5</version>
                                    <fixVersion>3.1.13</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16110724" author="sergey_beryozkin" created="Wed, 2 Aug 2017 11:14:37 +0000"  >&lt;p&gt;Give 3.1.13-SNAPSHOT a try please&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 16 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3i70f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>