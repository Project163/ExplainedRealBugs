<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:40:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2286] CXF locking jars in Tomcat when undeployed preventing hot deployment / eating up permgen</title>
                <link>https://issues.apache.org/jira/browse/CXF-2286</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Create a simple webapp with the following in web.xml:&lt;/p&gt;

&lt;p&gt;	&amp;lt;servlet&amp;gt;&lt;br/&gt;
		&amp;lt;display-name&amp;gt;CXF Servlet&amp;lt;/display-name&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;CXFServlet&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-class&amp;gt;&lt;br/&gt;
			org.apache.cxf.transport.servlet.CXFServlet&lt;br/&gt;
		&amp;lt;/servlet-class&amp;gt;&lt;br/&gt;
		&amp;lt;load-on-startup&amp;gt;1&amp;lt;/load-on-startup&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;servlet-mapping&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;CXFServlet&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;url-pattern&amp;gt;/*&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet-mapping&amp;gt;&lt;/p&gt;

&lt;p&gt;No fancy code, no real web services, just plain starting of the servlet. Create a war and deploy it into a tomcat. Enjoy the startup of the servlet. Press &quot;undeploy&quot; in the tomcat application manager.&lt;/p&gt;

&lt;p&gt;Under windows you will notice that most of the cxf jars are &lt;b&gt;not&lt;/b&gt; deleted in the webapps directory, the application isn&apos;t completly undeployed. Tomcat seems to lock the jars preventing them from beeing deleted. Subsequent re-deployment of the webapp will fail because of the left-over jars. Hot re-deployment of the webapp is impossible.&lt;/p&gt;

&lt;p&gt;Under linux the webapp directory is gone, but this is because linux&apos; ext filesystem allow files beeing deleted that are still held open by an applicaton. When checking with the lsof tool you will see that under linux tomcat still has references to the old jar. Hot re-deployment is possible here, but you will soon run out of permgen memory because the old classes are not unloaded.&lt;/p&gt;

&lt;p&gt;It seems the servlet is still locking some kind of resource when undeployed (thus preventing tomcat from beeing able to close and delete the jars). Maybe the destroy method lacks some important cleanup.&lt;/p&gt;

&lt;p&gt;This bug is there at least since CXF 2.1.2 and still in 2.2.2.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tomcat 6, Java 1.6, Windows+Linux&lt;/p&gt;</environment>
        <key id="12427818">CXF-2286</key>
            <summary>CXF locking jars in Tomcat when undeployed preventing hot deployment / eating up permgen</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="schrom">Jerome Waibel</reporter>
                        <labels>
                    </labels>
                <created>Sat, 13 Jun 2009 18:23:56 +0000</created>
                <updated>Mon, 11 Oct 2010 14:57:30 +0000</updated>
                            <resolved>Wed, 23 Dec 2009 03:33:29 +0000</resolved>
                                    <version>2.2.2</version>
                                    <fixVersion>Invalid</fixVersion>
                                    <component>Integration</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12719760" author="schrom" created="Mon, 15 Jun 2009 20:37:35 +0000"  >&lt;p&gt;I did some further research on this:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;This problem is not related to tomcat, it happens also on jetty.&lt;/li&gt;
	&lt;li&gt;I did some inspection with Yourkit. After undeploying it shows several instances of cxf objects that are still alive. I attached a screenshot of the output. Maybe this can give someone some idea  what is going on here.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12793915" author="dkulp" created="Wed, 23 Dec 2009 03:33:29 +0000"  >&lt;p&gt;&lt;br/&gt;
Resolving as duplicate.   Comments and resolution will be in &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-1816&quot; title=&quot;Undeploying a CXF web app from tomcat on windows does not delete some CXF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-1816&quot;&gt;&lt;del&gt;CXF-1816&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12404993">CXF-1816</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12410708" name="ObjectAlive.png" size="18134" author="schrom" created="Mon, 15 Jun 2009 20:35:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>113721</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14dyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233725</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>