<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:36:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8281] Issue with  attachment Chinese file name</title>
                <link>https://issues.apache.org/jira/browse/CXF-8281</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;0&lt;br/&gt;
I&apos;m using apache CXF for exposing the webservice. While reading chinese file name from upstream (SOAP UI in local), unable to read exact chinese characters. It&apos;s giving file name as &apos;&#176;U&apos;&#176;U123.pdf . I have tried with all encodings but no luck. For other English name attachments no issues, able to read properly.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;From soap ui i&apos;m sending UTF-8 encoding , while reading in java I have used same.&lt;/p&gt;

&lt;p&gt; byte[] b = attachmentName.getBytes(StandardCharsets.UTF_8); &lt;br/&gt;
String attachName = new String(b, StandardCharsets.UTF_8.name());&lt;/p&gt;

&lt;p&gt;`Below is my interceptor code.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;public void handleMessage(SoapMessage message) throws Fault {&lt;br/&gt;
            logger.info(&quot;Handle Message for attachments &quot;);&lt;br/&gt;
            BindingOperationInfo bop = message.getExchange().getBindingOperationInfo();   &lt;br/&gt;
            if (bop == null) &lt;/p&gt;
{
                return;
            }&lt;br/&gt;
            logger.info(&quot;binding info &quot;+bop.getBinding());&lt;br/&gt;
&lt;br/&gt;
            if (bop.isUnwrapped()) {
                bop = bop.getWrappedOperation();

            }&lt;br/&gt;
            if (null == message.getAttachments() || message.getAttachments().isEmpty() ){
                return;
            }
&lt;p&gt;            Iterator&amp;lt;Attachment&amp;gt; iter = message.getAttachments().iterator();&lt;br/&gt;
            Collection&amp;lt;Attachment&amp;gt; attchments = message.getAttachments();&lt;/p&gt;

&lt;p&gt;            logger.info(&quot;message get attachments size   : &quot;+attchments.size());&lt;br/&gt;
             int attachmentCount=0;&lt;br/&gt;
             Map&amp;lt;String, DataHandler&amp;gt; attachmentMap=   AttachmentUtil.getDHMap(attchments);&lt;br/&gt;
             logger.info(&quot;Map&amp;lt;String, DataHandler&amp;gt; &quot;+attachmentMap.size());&lt;br/&gt;
            try{&lt;br/&gt;
                while (iter.hasNext())&lt;/p&gt;
{
                    Attachment attachment = iter.next();
                    attachmentCount++;
                    }
&lt;p&gt;                    }&lt;br/&gt;
                    }&lt;/p&gt;</description>
                <environment></environment>
        <key id="13303982">CXF-8281</key>
            <summary>Issue with  attachment Chinese file name</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="RajeshThokala">Rajesh</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 May 2020 02:10:02 +0000</created>
                <updated>Tue, 28 Jul 2020 06:02:26 +0000</updated>
                                            <version>3.2.4</version>
                                                    <component>Bus</component>
                    <component>JAX-WS Runtime</component>
                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17104324" author="coheigea" created="Mon, 11 May 2020 11:14:15 +0000"  >&lt;p&gt;Could you adapt one of the test-cases here to show the problem?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cxf/tree/master/core/src/test/java/org/apache/cxf/attachment&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/tree/master/core/src/test/java/org/apache/cxf/attachment&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17152036" author="rajeshthokala" created="Mon, 6 Jul 2020 13:56:43 +0000"  >&lt;p&gt;Hi , We incorporated test cases but due to custom implementation unable to test all test cases  . Here is the details description about issue.&lt;/p&gt;

&lt;p&gt;We are getting issue when we are getting attachment name  with &quot;&lt;b&gt;Non English characters , Chines characters&lt;/b&gt;&quot; .  Here ,I&apos;m testing with file name  with &quot;sample&#8470;tes+t.pdf&quot; , while receiving from interceptors in java its getting  as &quot;sample�tes t.pdf&quot;. Please find below screen shorts for debug  and code snippet for reference .&lt;/p&gt;


&lt;p&gt; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13007142/13007142_soapui.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13007141/13007141_screenshot-1.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt; Code Snippet :&lt;/p&gt;

&lt;p&gt;public class POAttachmentInterceptor extends  AbstractPhaseInterceptor&amp;lt;Message&amp;gt;  {&lt;/p&gt;

&lt;p&gt;	public static final Logger logger = Logger.getLogger(POAttachmentInterceptor.class);&lt;br/&gt;
	public static final String ATTACHMENT_PART_HEADERS = POAttachmentInterceptor.class.getName() + &quot;.headers&quot;;&lt;br/&gt;
    private static final List&amp;lt;String&amp;gt; TYPES = Collections.singletonList(&quot;multipart/related&quot;);&lt;br/&gt;
    private static final List&amp;lt;String&amp;gt; PART_TYPES = Collections.singletonList(&quot;application/octet-stream&quot;);&lt;br/&gt;
    public static final int DEFAULT_MAX_HEADER_SIZE = &lt;br/&gt;
            SystemPropertyAction.getInteger(&quot;org.apache.cxf.attachment-max-header-size&quot;, 300);&lt;/p&gt;

&lt;p&gt;    public POAttachmentInterceptor() &lt;/p&gt;
{
    	
        super(Phase.PRE_STREAM);
        logger.info(&quot;AttachmentInInterceptor constructor called &quot;);
        
    }

&lt;p&gt;    public void handleMessage(Message message) {&lt;br/&gt;
        if (isGET(message)) &lt;/p&gt;
{
            logger.info(&quot;AttachmentInInterceptor skipped in HTTP GET method&quot;);
            return;
        }
&lt;p&gt;        if (message.getContent(InputStream.class) == null) &lt;/p&gt;
{
            return;
        }

&lt;p&gt;        String contentType = (String) message.get(Message.CONTENT_TYPE);&lt;br/&gt;
        if (AttachmentUtil.isTypeSupported(contentType, getSupportedTypes())) {&lt;br/&gt;
            try {&lt;br/&gt;
            	message.getAttachments();&lt;br/&gt;
               if ( null!= message.getAttachments() &amp;amp;&amp;amp; !message.getAttachments().isEmpty())&lt;/p&gt;
{
            	   customHandleMessage(message); 
               }

&lt;p&gt;            } catch (Exception e) &lt;/p&gt;
{
                throw new Fault(e);
            }&lt;br/&gt;
        }&lt;br/&gt;
   }&lt;br/&gt;
 	     &lt;br/&gt;
   private void customHandleMessage(Message message) {&lt;br/&gt;
	    	&lt;br/&gt;
        try {&lt;br/&gt;
                List messList = new MessageContentsList();&lt;br/&gt;
            	messList.add(message.getContent(InputStream.class));&lt;br/&gt;
            	Iterator&amp;lt;Attachment&amp;gt; iter = message.getAttachments().iterator();&lt;br/&gt;
	            MimeMultipart mulitParts = null;&lt;br/&gt;
    	        while (iter.hasNext()){&lt;br/&gt;
      	        	Attachment attachmentIter = iter.next();&lt;br/&gt;
     	        	try {
     	        		//Type casting issue fix : 20/05/2019
     	        		Object obj =  attachmentIter.getDataHandler().getContent();
     	        		mulitParts = MimeMultipart.class.cast(obj);
    	        		BodyPart part = mulitParts.getBodyPart(0);
    	        		int partCount = mulitParts.getCount();
						logger.info( &quot;part fileName : &quot;+part.getFileName() );
						logger.info( &quot;partCount : &quot;+ partCount );
						
					}catch(ClassCastException cEx){ 
						return;
					}catch (MessagingException e) {
						logger.error(&quot;MessagingException in POAttachmentInterceptor:&quot; + e.getMessage());
					}&lt;br/&gt;
                }&lt;br/&gt;
    	        if ( null!= mulitParts ){&lt;br/&gt;
	    	        List&amp;lt;Attachment&amp;gt; attachmentList = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
	    	        for ( int partIndex=0; partIndex&amp;lt; mulitParts.getCount(); partIndex++){
	         		   
	    	        	attachmentList.add(createAttachment( mulitParts.getBodyPart(partIndex)) );   
	      	        }&lt;br/&gt;
	    	        message.setAttachments(attachmentList);&lt;br/&gt;
    	        }&lt;br/&gt;
                &lt;br/&gt;
        }catch (MessagingException me) {
                throw new Fault(me);
        }catch (IOException e) {
                throw new Fault(e);
        }&lt;br/&gt;
   }&lt;br/&gt;
	&lt;br/&gt;
   private Attachment createAttachment(BodyPart part){&lt;br/&gt;
	    DataHandler dh = null;&lt;br/&gt;
	    Object o;&lt;br/&gt;
	    try {&lt;br/&gt;
	    	    logger.info(&quot;part.getContentType()******&quot;+ part.getContentType());&lt;br/&gt;
	    	    String ct = &quot;application/octet-stream&quot;;&lt;br/&gt;
	    	    String name = part.getFileName();&lt;br/&gt;
	    	    o = part.getDataHandler().getInputStream();&lt;br/&gt;
			    if (ct.indexOf(&quot;text/xml&quot;) &lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (= -1 ) not found.&lt;/span&gt;=-1){
			        dh = (DataHandler) o;
			        ct = dh.getContentType();
			      	dh = new DataHandler(createDataSource((Source)dh.getContent(), ct));
			    }else if (ct.indexOf(&quot;application/octet-stream&quot;) != -1 || ct.indexOf(&quot;application/pdf&quot;) != -1){
			    	ByteDataSource dataSource = new ByteDataSource((byte[]) o.toString().getBytes(StandardCharsets.UTF_8), ct);
			    	dataSource.setName(name);
			    	dh = new DataHandler(dataSource);
			    }else if ( ct.indexOf(&quot;text/plain; charset=\&apos;UTF-8\&apos;&quot;) != -1 ){
			    	ByteDataSource dataSource = new ByteDataSource(((String)o).getBytes(StandardCharsets.UTF_8), ct);
			    	dataSource.setName(name);
			    	dh = new DataHandler(dataSource);
			    }&lt;br/&gt;
			    else if ( ct.indexOf(&quot;application/xop+xml; charset=\&apos;UTF-8\&apos;&quot;) != -1 ){
			    	ByteDataSource dataSource = new ByteDataSource(((String)o).getBytes(StandardCharsets.UTF_8), ct);
			    	dataSource.setName(name);
			    	dh = new DataHandler(dataSource);
			    }&lt;br/&gt;
			    else {
			    	logger.info(&quot;Unknow content type********************&quot;);
			    	dh = new DataHandler( ( part.getDataHandler()), ct);
			    }	   &lt;br/&gt;
			    AttachmentImpl costructedAttachment= new AttachmentImpl(name);&lt;br/&gt;
			    costructedAttachment.setDataHandler(dh);&lt;br/&gt;
			    costructedAttachment.setHeader(&quot;Content-Type&quot;, ct);&lt;br/&gt;
			    costructedAttachment.setHeader(&quot;Content-ID&quot;, &quot;&amp;lt;&quot; + name + &quot;&amp;gt;&quot;);&lt;br/&gt;
			    &lt;br/&gt;
			    return costructedAttachment;&lt;br/&gt;
			    &lt;br/&gt;
		}catch (MessagingException  | IOException e) {
			logger.error( e.getMessage());
			logger.error( e.getCause());
		}&lt;br/&gt;
	    &lt;br/&gt;
	    return null;&lt;br/&gt;
   }&lt;br/&gt;
   &lt;br/&gt;
   static String getHeader(Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt; headers, String h) {
       return getHeaderValue(headers.get(h));
   }   &lt;br/&gt;
   &lt;br/&gt;
   static String getHeader(Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt; headers, String h, String delim) {
       return getHeaderValue(headers.get(h), delim);
   }&lt;br/&gt;
   &lt;br/&gt;
   static String getHeaderValue(List&amp;lt;String&amp;gt; v) {&lt;br/&gt;
	   &lt;br/&gt;
       if (v != null &amp;amp;&amp;amp; !v.isEmpty()) {
           return v.get(0);
       }&lt;br/&gt;
       return null;&lt;br/&gt;
   }&lt;br/&gt;
   static String getHeaderValue(List&amp;lt;String&amp;gt; v, String delim) {&lt;br/&gt;
	   if (v != null &amp;amp;&amp;amp; !v.isEmpty()) {&lt;br/&gt;
           StringBuilder b = new StringBuilder();&lt;br/&gt;
           for (String s : v) {&lt;br/&gt;
               if (b.length() &amp;gt; 0) {
                   b.append(delim);
               }&lt;br/&gt;
               b.append(s);&lt;br/&gt;
           }&lt;br/&gt;
           return b.toString();&lt;br/&gt;
       }&lt;br/&gt;
       return null;&lt;br/&gt;
   }   &lt;br/&gt;
&lt;br/&gt;
 	&lt;br/&gt;
   private DataSource createDataSource(Source o, String ct) {&lt;br/&gt;
	    DataSource ds = null;&lt;br/&gt;
        if (o instanceof StreamSource) {&lt;br/&gt;
            StreamSource src = (StreamSource)o;&lt;br/&gt;
            try {&lt;br/&gt;
                if (src.getInputStream() != null) {&lt;br/&gt;
                    try (ByteArrayOutputStream bos = new ByteArrayOutputStream(2048)) {
                        IOUtils.copy(src.getInputStream(), bos, 1024);
                        ds = new ByteDataSource(bos.toByteArray(), ct);
                    }&lt;br/&gt;
                } else {
                    ds = new ByteDataSource(IOUtils.toString(src.getReader()).getBytes(StandardCharsets.UTF_8),
                                                 ct);
                }&lt;br/&gt;
            } catch (IOException e) {
                throw new Fault(e);
            }
&lt;p&gt;        } else {&lt;br/&gt;
            ByteArrayOutputStream bwriter = new ByteArrayOutputStream();&lt;br/&gt;
            XMLStreamWriter writer = null;&lt;br/&gt;
            try &lt;/p&gt;
{
                writer = StaxUtils.createXMLStreamWriter(bwriter);
                StaxUtils.copy(o, writer);
                writer.flush();
                ds = new ByteDataSource(bwriter.toByteArray(), ct);
            }
&lt;p&gt; catch (XMLStreamException e1) &lt;/p&gt;
{
                throw new Fault(e1);
            }
&lt;p&gt; finally &lt;/p&gt;
{
                StaxUtils.close(writer);
            }
&lt;p&gt;        }&lt;br/&gt;
        return ds;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    protected List&amp;lt;String&amp;gt; getSupportedTypes() &lt;/p&gt;
{
        return TYPES;
    }

&lt;p&gt;    protected List&amp;lt;String&amp;gt; getPartSupportedTypes() &lt;/p&gt;
{
        return PART_TYPES;
    }



&lt;p&gt;}&lt;/p&gt;

</comment>
                            <comment id="17152776" author="coheigea" created="Tue, 7 Jul 2020 14:15:45 +0000"  >&lt;p&gt;Can you attach the full message request so that I can see what CXF is parsing?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17152779" author="rajeshthokala" created="Tue, 7 Jul 2020 14:21:47 +0000"  >&lt;p&gt;Find the attachment for payload request   l &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007220/13007220_payloadRequest.txt&quot; title=&quot;payloadRequest.txt attached to CXF-8281&quot;&gt;payloadRequest.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;/p&gt;

&lt;p&gt;Below is the attachment for SOAP UI properties &lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13007221/13007221_soap+ui-+payload+and+properties+.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;
</comment>
                            <comment id="17153438" author="coheigea" created="Wed, 8 Jul 2020 09:40:57 +0000"  >&lt;p&gt;I think to help I will need to reproduce the issue. Could you attach the SOAP UI project and also a CXF service that includes your custom interceptor so that I can see what&apos;s going on?&lt;/p&gt;</comment>
                            <comment id="17153454" author="rajeshthokala" created="Wed, 8 Jul 2020 09:54:35 +0000"  >&lt;p&gt;Here code is restricted with VPN , from out side cant access the code. Do you have any references where custom interceptors being written for attachments handling (especially - non English attachment file name handling ). &lt;/p&gt;

&lt;p&gt;I have already shared soap request and if you want I will attach soap project and custom interceptor classes . &lt;/p&gt;
</comment>
                            <comment id="17153457" author="rajeshthokala" created="Wed, 8 Jul 2020 09:59:51 +0000"  >&lt;p&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007282/13007282_CustomDataHandler.java&quot; title=&quot;CustomDataHandler.java attached to CXF-8281&quot;&gt;CustomDataHandler.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007283/13007283_POAttachmentInterceptor.java&quot; title=&quot;POAttachmentInterceptor.java attached to CXF-8281&quot;&gt;POAttachmentInterceptor.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007284/13007284_POHeaderInterceptor.java&quot; title=&quot;POHeaderInterceptor.java attached to CXF-8281&quot;&gt;POHeaderInterceptor.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007285/13007285_POInvokeHandler.java&quot; title=&quot;POInvokeHandler.java attached to CXF-8281&quot;&gt;POInvokeHandler.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007286/13007286_POSwAInInterceptor.java&quot; title=&quot;POSwAInInterceptor.java attached to CXF-8281&quot;&gt;POSwAInInterceptor.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007287/13007287_attachment-soap.zip&quot; title=&quot;attachment-soap.zip attached to CXF-8281&quot;&gt;attachment-soap.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;Find the attachments for custom interceptors and soap project. &lt;/p&gt;

&lt;p&gt;Note: XML payload file names are coming properly even for non English . We are facing only issue for attachment names(Data handler file name)&lt;/p&gt;

&lt;p&gt;Let me know if you need any further clarifications &lt;/p&gt;</comment>
                            <comment id="17153463" author="rajeshthokala" created="Wed, 8 Jul 2020 10:07:08 +0000"  >&lt;p&gt;Below are the ways I tried to get original file name but no luck.&lt;/p&gt;

&lt;p&gt;String attachmentName=attachment.getDataHandler().getName();&lt;br/&gt;
 StringBuilder result = new StringBuilder(attachment.getId());&lt;br/&gt;
 logger.info(&quot;url encoded string &quot;+ URLEncoder.encode(attachment.getId(), StandardCharsets.UTF_8.name()));&lt;br/&gt;
 logger.info(&quot;url decoded string &quot;+ URLDecoder.decode(attachment.getId(), StandardCharsets.UTF_8.name()));&lt;br/&gt;
 logger.info(&quot;new char sting &quot;+getCharsFromStrings(attachment.getDataHandler().getName()));&lt;br/&gt;
 logger.info( &quot;name :&quot;+ attachment.getDataHandler().getName());&lt;br/&gt;
 logger.info(&quot;mime utility decoded name &quot;+MimeUtility.decodeText(attachmentName));&lt;br/&gt;
 String chinesname= new String(attachmentName.getBytes(StandardCharsets.ISO_8859_1), &quot;UTF-8&quot;);&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160; Right help&#160; much appreciated&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17154391" author="coheigea" created="Thu, 9 Jul 2020 09:33:47 +0000"  >&lt;p&gt;Could you put together a simple project using CXF to reproduce the issue with the custom interceptors you have developed?&lt;/p&gt;</comment>
                            <comment id="17154438" author="rajeshthokala" created="Thu, 9 Jul 2020 11:13:59 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007363/13007363_invoice-testing.rar&quot; title=&quot;invoice-testing.rar attached to CXF-8281&quot;&gt;invoice-testing.rar&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;attaching sample code. Its having issue while testing,&#160; All interceptor codes are there in attached project.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17154461" author="ffang" created="Thu, 9 Jul 2020 11:52:08 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RajeshThokala&quot; class=&quot;user-hover&quot; rel=&quot;RajeshThokala&quot;&gt;RajeshThokala&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I added a &lt;a href=&quot;https://github.com/apache/cxf/commit/247835a2a4babb280bead861f102450f2e62f6a4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testcase&lt;/a&gt; to demonstrate that how Chinese attachment file name can be used in CXF. Could you please take a look?&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="17155215" author="coheigea" created="Fri, 10 Jul 2020 07:02:11 +0000"  >&lt;p&gt;Please check the attached project, I get:&lt;/p&gt;

&lt;p&gt;&quot;Non-resolvable parent POM for com.cisco.ariba.invoice:invcreateariba-container:0.0.1-SNAPSHOT: Could not transfer artifact org.springframework.boot:spring-boot-starter-parent:pom:2.0.2.RELEASE from/to public-repository (&lt;a href=&quot;http://repo1.maven.org/maven2):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repo1.maven.org/maven2):&lt;/a&gt; Transfer failed for &lt;a href=&quot;http://repo1.maven.org/maven2/org/springframework/boot/spring-boot-starter-parent/2.0.2.RELEASE/spring-boot-starter-parent-2.0.2.RELEASE.pom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repo1.maven.org/maven2/org/springframework/boot/spring-boot-starter-parent/2.0.2.RELEASE/spring-boot-starter-parent-2.0.2.RELEASE.pom&lt;/a&gt; 501 HTTPS Required and &apos;parent.relativePath&apos; points at no local POM @ line 14, column 10 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 2&amp;#93;&lt;/span&gt;&quot;&lt;/p&gt;

&lt;p&gt;Also please give full instructions about how to start the project and use SOAP-UI with it.&lt;/p&gt;</comment>
                            <comment id="17159731" author="jpillela" created="Fri, 17 Jul 2020 07:04:04 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007840/13007840_invcreatearibaprod-container.zip&quot; title=&quot;invcreatearibaprod-container.zip attached to CXF-8281&quot;&gt;invcreatearibaprod-container.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007841/13007841_SoapRequest&quot; title=&quot;SoapRequest attached to CXF-8281&quot;&gt;SoapRequest&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007842/13007842_Test12%E9%80%81%E8%B4%A7%E8%AE%B0%E5%BD%95.pdf&quot; title=&quot;Test12&#36865;&#36135;&#35760;&#24405;.pdf attached to CXF-8281&quot;&gt;Test12&#36865;&#36135;&#35760;&#24405;.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;please find the above attachments for sample project ,soap request and attachment file&#160;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13007844/13007844_Capture.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17159734" author="rajeshthokala" created="Fri, 17 Jul 2020 07:12:53 +0000"  >&lt;p&gt;Hi Colm O hEigeartaigh,&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
 &#160;&lt;br/&gt;
 Please find the above&#160; sample project and follow below steps to test the application .&lt;br/&gt;
 1. check out the code and import to eclipse as maven project &lt;br/&gt;
 2. build the application : maven -&amp;gt; install&lt;br/&gt;
 3. run mail class file ( InvoiceApplication -&amp;gt; Environment variable (CISCO_LC=DEV) &lt;br/&gt;
 4. Once application started successfully it will expose as this URL (&lt;a href=&quot;http://localhost:8080/ariba/services/invoice&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8081/ariba/services/invoice&lt;/a&gt;)&lt;br/&gt;
 5. Test application from SOAP UI by pointing about URL with attached SOAP Request .&lt;br/&gt;
 &#160;steps to test in soap ui.&lt;br/&gt;
 &#160;5.1. Place provided request in soap request&lt;br/&gt;
 &#160;5.2. Go to attachments -&amp;gt;&#160; add attachment file which we provided .&lt;br/&gt;
 &#160;&lt;br/&gt;
 &#160;&lt;br/&gt;
 Debug File Name at POSwAInInterceptor:72 - name :Test12�&apos;&#176;U.pdf&lt;/p&gt;

&lt;p&gt;Let us know if you need any further details to test the application&lt;/p&gt;</comment>
                            <comment id="17161852" author="coheigea" created="Tue, 21 Jul 2020 08:13:20 +0000"  >&lt;p&gt;&quot;Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;purchaseOrderDao&apos;: Unsatisfied dependency expressed through field &apos;dataSource&apos;; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &apos;javax.sql.DataSource&apos; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Qualifier(value=customdatasource), @org.springframework.beans.factory.annotation.Autowired(required=true)}&quot;&lt;/p&gt;</comment>
                            <comment id="17161995" author="rajeshthokala" created="Tue, 21 Jul 2020 12:20:03 +0000"  >&lt;p&gt;Hi Colm,&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Did you perform maven clean install to download all required jars ( mvn clean install) ..??&#160;&lt;br/&gt;
We have tested , not getting any exceptions&#160;&lt;/p&gt;</comment>
                            <comment id="17162886" author="coheigea" created="Wed, 22 Jul 2020 15:30:09 +0000"  >&lt;p&gt;Sorry, it must have been a problem on my end, it&apos;s working now. Please see the attached screenshot - which is a snippet from wireshark of the SOAP-UI message. As you can see it is displaying the incorrect characters. So perhaps it is not a bug in CXF at all, but a problem with SOAP UI&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13008181/13008181_wireshark.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17166164" author="rajeshthokala" created="Tue, 28 Jul 2020 06:00:09 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Attaching the screen captures to send chines attachment from SOAP UI, by default its not showing original characters . If we select native look in SOAP UI it is showing original characters for file name.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Did you validated our custom interceptors which we have written&#160; ..??&#160;  &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13008538/13008538_SOAPUI_1.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13008539/13008539_SOAPUI_2.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13007282/13007282_CustomDataHandler.java&quot; title=&quot;CustomDataHandler.java attached to CXF-8281&quot;&gt;CustomDataHandler.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13008540/13008540_SOAPUI_3.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13008541/13008541_SOAPUI_ContentId.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17166165" author="rajeshthokala" created="Tue, 28 Jul 2020 06:02:26 +0000"  >&lt;p&gt;And also provide me any sample project which allows chines file name as attachments if you have .&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13316055">CXF-8316</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13007844" name="Capture.PNG" size="226236" author="jpillela" created="Fri, 17 Jul 2020 07:03:59 +0000"/>
                            <attachment id="13007843" name="Capture.PNG" size="226236" author="jpillela" created="Fri, 17 Jul 2020 07:02:02 +0000"/>
                            <attachment id="13007282" name="CustomDataHandler.java" size="372" author="RajeshThokala" created="Wed, 8 Jul 2020 09:57:35 +0000"/>
                            <attachment id="13007845" name="Freeman Yue Fang.url" size="91" author="RajeshThokala" created="Fri, 17 Jul 2020 07:10:19 +0000"/>
                            <attachment id="13007283" name="POAttachmentInterceptor.java" size="9029" author="RajeshThokala" created="Wed, 8 Jul 2020 09:57:35 +0000"/>
                            <attachment id="13007284" name="POHeaderInterceptor.java" size="7270" author="RajeshThokala" created="Wed, 8 Jul 2020 09:57:35 +0000"/>
                            <attachment id="13007285" name="POInvokeHandler.java" size="5457" author="RajeshThokala" created="Wed, 8 Jul 2020 09:57:35 +0000"/>
                            <attachment id="13007286" name="POSwAInInterceptor.java" size="8793" author="RajeshThokala" created="Wed, 8 Jul 2020 09:57:35 +0000"/>
                            <attachment id="13008538" name="SOAPUI_1.PNG" size="32547" author="RajeshThokala" created="Tue, 28 Jul 2020 05:59:27 +0000"/>
                            <attachment id="13008533" name="SOAPUI_1.PNG" size="32547" author="RajeshThokala" created="Tue, 28 Jul 2020 05:55:59 +0000"/>
                            <attachment id="13008539" name="SOAPUI_2.PNG" size="42736" author="RajeshThokala" created="Tue, 28 Jul 2020 05:59:37 +0000"/>
                            <attachment id="13008534" name="SOAPUI_2.PNG" size="42736" author="RajeshThokala" created="Tue, 28 Jul 2020 05:56:00 +0000"/>
                            <attachment id="13008540" name="SOAPUI_3.PNG" size="50338" author="RajeshThokala" created="Tue, 28 Jul 2020 05:59:49 +0000"/>
                            <attachment id="13008535" name="SOAPUI_3.PNG" size="50338" author="RajeshThokala" created="Tue, 28 Jul 2020 05:56:00 +0000"/>
                            <attachment id="13008541" name="SOAPUI_ContentId.PNG" size="71158" author="RajeshThokala" created="Tue, 28 Jul 2020 05:59:57 +0000"/>
                            <attachment id="13008536" name="SOAPUI_ContentId.PNG" size="71158" author="RajeshThokala" created="Tue, 28 Jul 2020 05:56:00 +0000"/>
                            <attachment id="13008537" name="SOAPUI_FileName.PNG" size="57117" author="RajeshThokala" created="Tue, 28 Jul 2020 05:56:00 +0000"/>
                            <attachment id="13007841" name="SoapRequest" size="59729" author="jpillela" created="Fri, 17 Jul 2020 06:56:55 +0000"/>
                            <attachment id="13007842" name="Test12&#36865;&#36135;&#35760;&#24405;.pdf" size="3028" author="jpillela" created="Fri, 17 Jul 2020 06:59:08 +0000"/>
                            <attachment id="13007287" name="attachment-soap.zip" size="16283" author="RajeshThokala" created="Wed, 8 Jul 2020 09:57:57 +0000"/>
                            <attachment id="13008223" name="image.png" size="39100" author="RajeshThokala" created="Thu, 23 Jul 2020 06:38:51 +0000"/>
                            <attachment id="13007840" name="invcreatearibaprod-container.zip" size="24577819" author="jpillela" created="Fri, 17 Jul 2020 06:54:24 +0000"/>
                            <attachment id="13007363" name="invoice-testing.rar" size="19646520" author="RajeshThokala" created="Thu, 9 Jul 2020 11:12:59 +0000"/>
                            <attachment id="13007220" name="payloadRequest.txt" size="59599" author="RajeshThokala" created="Tue, 7 Jul 2020 14:19:33 +0000"/>
                            <attachment id="13007141" name="screenshot-1.png" size="221990" author="RajeshThokala" created="Mon, 6 Jul 2020 13:51:05 +0000"/>
                            <attachment id="13007221" name="soap ui- payload and properties .png" size="166300" author="RajeshThokala" created="Tue, 7 Jul 2020 14:21:08 +0000"/>
                            <attachment id="13007142" name="soapui.png" size="184217" author="RajeshThokala" created="Mon, 6 Jul 2020 13:55:31 +0000"/>
                            <attachment id="13008181" name="wireshark.png" size="50157" author="coheigea" created="Wed, 22 Jul 2020 15:30:06 +0000"/>
                            <attachment id="13008224" name="wireshark[1].png" size="50157" author="RajeshThokala" created="Thu, 23 Jul 2020 06:38:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10063"><![CDATA[Advanced]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ekpc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>