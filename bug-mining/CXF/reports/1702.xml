<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:59:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4873] javax.management.RuntimeOperationsException when register performance mbean using cxf webclient with an operation&apos;s uri containing some query params</title>
                <link>https://issues.apache.org/jira/browse/CXF-4873</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I want to monitor my CXF REST service call, then i use the Performance MBean provided by CXF.  &lt;/p&gt;

&lt;p&gt;One of my operation use query params :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
        @GET
        @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/documents/{idDocument}&quot;&lt;/span&gt;)
        @Produces(MediaType.APPLICATION_OCTET_STREAM)
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Response loadDocument(
          @Context Request request, @HeaderParam(&lt;span class=&quot;code-quote&quot;&gt;&quot;If-Modified-Since&quot;&lt;/span&gt;) Date date,
          @PathParam(&lt;span class=&quot;code-quote&quot;&gt;&quot;idDocument&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; idDocument,
          @QueryParam(&lt;span class=&quot;code-quote&quot;&gt;&quot;loadingType&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; loadingType)...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When i call the service&apos;s operation like this :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    WebClient.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//host/DocumentService&quot;&lt;/span&gt;).path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/documents/{idDocument}&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;10&quot;&lt;/span&gt;).query(&lt;span class=&quot;code-quote&quot;&gt;&quot;loadingType&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;C&quot;&lt;/span&gt;).accept(&lt;span class=&quot;code-quote&quot;&gt;&quot;*/*&quot;&lt;/span&gt;).get(Response.class);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The operation works but in the log we have this stacktrace :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    WARN - Create Counter&apos;&apos;s ObjectName failed. {0}
    javax.management.RuntimeOperationsException
        at javax.management.ObjectInstance.&amp;lt;init&amp;gt;(ObjectInstance.java:97)
        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:985)
        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:938)
        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:330)
        at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:516)
        at org.apache.cxf.management.jmx.InstrumentationManagerImpl.registerMBeanWithServer(InstrumentationManagerImpl.java:331)
        at org.apache.cxf.management.jmx.InstrumentationManagerImpl.register(InstrumentationManagerImpl.java:229)
        at org.apache.cxf.management.jmx.InstrumentationManagerImpl.register(InstrumentationManagerImpl.java:246)
        at org.apache.cxf.management.jmx.InstrumentationManagerImpl.register(InstrumentationManagerImpl.java:239)
        at org.apache.cxf.management.counters.CounterRepository.createCounter(CounterRepository.java:117)
        at org.apache.cxf.management.counters.CounterRepository.increaseCounter(CounterRepository.java:93)
        at org.apache.cxf.management.interceptor.AbstractMessageResponseTimeInterceptor.increaseCounter(AbstractMessageResponseTimeInterceptor.java:142)
        at org.apache.cxf.management.interceptor.AbstractMessageResponseTimeInterceptor.endHandlingMessage(AbstractMessageResponseTimeInterceptor.java:74)
        at org.apache.cxf.management.interceptor.ResponseTimeMessageInInterceptor.handleMessage(ResponseTimeMessageInInterceptor.java:39)
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)
        at org.apache.cxf.jaxrs.client.ClientMessageObserver.onMessage(ClientMessageObserver.java:56)
        at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1627)
        at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1494)
        at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1402)
        at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
        at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:649)
        at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)
        at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:727)
        at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:678)
        at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:325)
        at org.apache.cxf.jaxrs.client.WebClient.get(WebClient.java:422)
        ...
    Caused by: java.lang.IllegalArgumentException: Invalid name-&amp;gt;org.apache.cxf:bus.id=cxf2071824233,type=Performance.Counter.Client,service=&lt;span class=&quot;code-quote&quot;&gt;&quot;{http:&lt;span class=&quot;code-comment&quot;&gt;//host/DocumentService}WebClient&quot;&lt;/span&gt;,port=&lt;span class=&quot;code-quote&quot;&gt;&quot;WebClient&quot;&lt;/span&gt;,operation=&lt;span class=&quot;code-quote&quot;&gt;&quot;GET:http://host/DocumentService/documents/10?loadingType=C&quot;&lt;/span&gt;
&lt;/span&gt;        at javax.management.ObjectInstance.&amp;lt;init&amp;gt;(ObjectInstance.java:94)...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I understand that the problem is when you use the WebClient to call your REST service. CXF use the URI to register the MBean to monitor the service call. In our case, the URI contains a question mark which is detected as a pattern style for an MBean and the Mbean server avoid creating an MBean with a pattern name.&lt;/p&gt;

&lt;p&gt;Maybe we could replace the question mark by another char.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12635314">CXF-4873</key>
            <summary>javax.management.RuntimeOperationsException when register performance mbean using cxf webclient with an operation&apos;s uri containing some query params</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="guillaumemary">Guillaume Mary</reporter>
                        <labels>
                            <label>jmx</label>
                    </labels>
                <created>Tue, 5 Mar 2013 10:35:26 +0000</created>
                <updated>Fri, 22 Nov 2013 03:05:13 +0000</updated>
                            <resolved>Fri, 8 Mar 2013 14:23:14 +0000</resolved>
                                    <version>2.5.2</version>
                    <version>2.7.2</version>
                                    <fixVersion>2.7.4</fixVersion>
                    <fixVersion>2.6.7</fixVersion>
                    <fixVersion>2.5.10</fixVersion>
                    <fixVersion>3.0.0-milestone1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13597162" author="sergey_beryozkin" created="Fri, 8 Mar 2013 14:23:14 +0000"  >&lt;p&gt;Thanks for reporting this issue; I&apos;ve updated the counter interceptor to escape &apos;?&apos;, this really affects only WebClient path as &apos;?&apos; is unlikely to/will not appear in WS client or indeed in RS proxy client operation names, so for now I&apos;ve just limited the escaping code.&lt;/p&gt;

&lt;p&gt;I wonder if the &apos;query&apos; should be part of the WebClient operation name, in principle, this can be reported as another MBean property, but probably makes sense to keep it as is for now as technically the query is part of the specific application URI. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12680672">CXF-5415</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ihu7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>