<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:13:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6160] AsyncResponse infinite loops</title>
                <link>https://issues.apache.org/jira/browse/CXF-6160</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I created a JAX-RS 2.0 service, then I used apache benchmark to create some load on the web application. After some tests ab failed.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Completed 18000 requests
apr_pollset_poll: The timeout specified has expired (70007)
Total of 19997 requests completed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While the test finished and no HTTP requests hit, the application container is still consuming all available CPU time, and it has some threads like this in the thread dump:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;qtp1386911411-56&quot; prio=10 tid=0x00007f5b3803d000 nid=0x56b8 runnable [0x00007f5b06fa8000]
   java.lang.Thread.State: RUNNABLE
	at java.util.HashMap.put(HashMap.java:498)
	at java.util.HashMap.putAll(HashMap.java:647)
	at org.apache.cxf.message.MessageImpl$1.putAll(MessageImpl.java:188)
	at org.apache.cxf.message.MessageImpl.calcContextCache(MessageImpl.java:212)
	at org.apache.cxf.message.MessageImpl.getContextualProperty(MessageImpl.java:174)
	at org.apache.cxf.transport.http.Headers.copyToResponse(Headers.java:430)
	at org.apache.cxf.transport.http.AbstractHTTPDestination.flushHeaders(AbstractHTTPDestination.java:617)
	at org.apache.cxf.transport.http.AbstractHTTPDestination$WrappedOutputStream.close(AbstractHTTPDestination.java:784)
	at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
	at org.apache.cxf.transport.http.AbstractHTTPDestination$BackChannelConduit.close(AbstractHTTPDestination.java:720)
	at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
	- locked &amp;lt;0x00000000fb20efd0&amp;gt; (a org.apache.cxf.phase.PhaseInterceptorChain)
	at org.apache.cxf.interceptor.OutgoingChainInterceptor.handleMessage(OutgoingChainInterceptor.java:83)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307)
	- locked &amp;lt;0x00000000fb20f8f8&amp;gt; (a org.apache.cxf.phase.PhaseInterceptorChain)
	at org.apache.cxf.phase.PhaseInterceptorChain.resume(PhaseInterceptorChain.java:277)
	- eliminated &amp;lt;0x00000000fb20f8f8&amp;gt; (a org.apache.cxf.phase.PhaseInterceptorChain)
	at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:78)
	- locked &amp;lt;0x00000000fb20f8f8&amp;gt; (a org.apache.cxf.phase.PhaseInterceptorChain)
	at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:251)
	at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:223)
	at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:197)
	at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:149)
	at org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:171)
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:290)
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doGet(AbstractHTTPServlet.java:214)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:265)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:769)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The ab command used:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ab -n 20000 -c 4 http://localhost:8080/asyncresttest/s/r/person/10215670-8466-11e4-b116-123b93f75cba
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;reproduced under both jetty and tomcat&lt;/p&gt;</environment>
        <key id="12762119">CXF-6160</key>
            <summary>AsyncResponse infinite loops</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="kocka">Laszlo Hornyak</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2014 21:14:34 +0000</created>
                <updated>Mon, 16 Feb 2015 16:09:19 +0000</updated>
                            <resolved>Wed, 17 Dec 2014 18:09:39 +0000</resolved>
                                    <version>3.0.3</version>
                                    <fixVersion>3.0.4</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14248955" author="kocka" created="Tue, 16 Dec 2014 21:19:41 +0000"  >&lt;p&gt;sample app&lt;/p&gt;</comment>
                            <comment id="14249970" author="sergey_beryozkin" created="Wed, 17 Dec 2014 15:19:40 +0000"  >&lt;p&gt;Hi - does the same occur if you have a single invocation only ?&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14249981" author="kocka" created="Wed, 17 Dec 2014 15:28:39 +0000"  >&lt;p&gt;Hi Sergey,&lt;/p&gt;

&lt;p&gt;I haven&apos;t experienced the problem with one request only. It does not always hit even with 20000, in fact I hammered the application with a series of requests until it died, but that always happened in the first 50000 requests. That some out of tens of thousands would certainly be a minor problem for most cases, but the server threads are stuck and consuming CPU time and in a few hundred thousand requests the application dies.&lt;/p&gt;

&lt;p&gt;Also, one does not have to send requests in parallel, ab with single thread concurrency does it.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Laszlo&lt;/p&gt;</comment>
                            <comment id="14250474" author="sergey_beryozkin" created="Wed, 17 Dec 2014 20:25:48 +0000"  >&lt;p&gt;Hi Dan, this is impressive, thanks for a quick fix&lt;/p&gt;</comment>
                            <comment id="14257144" author="kocka" created="Tue, 23 Dec 2014 16:06:17 +0000"  >&lt;p&gt;verified working wih 3.1.0-SNAPSHOT &lt;/p&gt;</comment>
                            <comment id="14257163" author="kocka" created="Tue, 23 Dec 2014 16:26:21 +0000"  >&lt;p&gt;verified with 3.0.4-SNAPSHOT as well&lt;/p&gt;

&lt;p&gt;Thank you for the fix, impressive indeed!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12687585" name="CXF-6160.tar.gz" size="5936" author="kocka" created="Tue, 16 Dec 2014 21:19:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 48 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23hxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>