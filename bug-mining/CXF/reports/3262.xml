<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:31:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7643] Ability to disable certain ContextResolved CDI Beans</title>
                <link>https://issues.apache.org/jira/browse/CXF-7643</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;ContextProducerBeans are added for all @Context fields.&lt;/p&gt;

&lt;p&gt;This is not in the spec so it must use a custom qualifier only and not leak @Default support for all context types.&lt;br/&gt;
Currently it fails with servlet beans which are supported by any CDI@servlet container and already provided as required by the spec which leads to 1. an inconsistent bean being deployed 2. an ambiguous resolution.&lt;/p&gt;

&lt;p&gt;Side note: this feature can stay as an activable thing but not as a default for the mentionned reasons.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13137882">CXF-7643</key>
            <summary>Ability to disable certain ContextResolved CDI Beans</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="romain.manni-bucau">Romain Manni-Bucau</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Feb 2018 14:57:29 +0000</created>
                <updated>Wed, 21 Mar 2018 16:40:27 +0000</updated>
                                            <version>3.2.2</version>
                                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16365429" author="johndament" created="Thu, 15 Feb 2018 11:42:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=romain.manni-bucau&quot; class=&quot;user-hover&quot; rel=&quot;romain.manni-bucau&quot;&gt;romain.manni-bucau&lt;/a&gt; the entire CDI feature is not per spec, since most of the integration is meant for the application server.&#160; AIUI the conflict is &lt;tt&gt;javax.servlet&lt;/tt&gt; only, so you could just observe that &lt;tt&gt;ProcessBean&lt;/tt&gt; event and rewrite it then.&lt;/p&gt;</comment>
                            <comment id="16365503" author="romain.manni-bucau" created="Thu, 15 Feb 2018 13:12:14 +0000"  >&lt;p&gt;Hi John, even meant for the app server it is an issue and will lock users in the future. But agree for now servlet part is blocking and a workaround for partial CDI environments so should be an activable toggle not on by default at the minimum. Now it is not ProcessBean but ProcessSyntheticBean. Issue is also it is added in AfterBeanDiscovery and therefore is not that portably rewrittable. Also it should just not be rewritten since in the order of precedence CXF should check if they already exist and if so not add them (ie CXF can customize servlet or CDI but not the opposite in terms of dependencies).&lt;/p&gt;</comment>
                            <comment id="16367552" author="struberg" created="Fri, 16 Feb 2018 16:36:44 +0000"  >&lt;p&gt;I fell over this as well.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-3&quot; title=&quot;Get the SAAJ/SOAP handlers working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-3&quot;&gt;&lt;del&gt;CXF-3&lt;/del&gt;&lt;/a&gt;.2.2 out of the box collides with CDI-2 containers, giving AmbiguousResolutionException on each of them.&lt;/p&gt;

&lt;p&gt;There are also other smallish flaws.&lt;/p&gt;

&lt;p&gt;E.g. implementing getName() is intended to be a for @Named EL name. Having spaces in there contradicts the EL spec.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Let&apos;s start the other way around: I&apos;m shure there was a reason why this class got added. So what is the use case to be solved?&lt;/p&gt;</comment>
                            <comment id="16367555" author="struberg" created="Fri, 16 Feb 2018 16:38:28 +0000"  >&lt;p&gt;PS: in DeltaSpike we create CDI producers for certain types as well. But we use an own @DeltaSpike qualifier for each of them.&lt;/p&gt;</comment>
                            <comment id="16367566" author="struberg" created="Fri, 16 Feb 2018 16:43:41 +0000"  >&lt;p&gt;btw this affects 3.2.2 not 3.2.1.&lt;/p&gt;</comment>
                            <comment id="16368085" author="johndament" created="Sat, 17 Feb 2018 03:08:59 +0000"  >&lt;p&gt;So, it&apos;s on purpose that &lt;tt&gt;@Default&lt;/tt&gt; is in the qualifiers, so that a user doesn&apos;t need to use a qualifier.&#160; However, I also added &lt;tt&gt;@ContextResolved&lt;/tt&gt; to the qualifiers, to avoid being the only one to produce it.&#160; As I understand it though, the issue really comes in when trying to product the &lt;tt&gt;javax.servlet&lt;/tt&gt; beans, since those may come from other specs (e.g. on a full app server its provided by the container, and I suspect OWB servlet module is also producing them).&#160; If I had to guess, neither of those are adding a qualifier, so really your issue is that multiple components are all trying to produce the same bean.&#160; I think where we were leaning on list was to introduce a config property on what to turn on or off, which could come from the Bus.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;As far as &lt;tt&gt;getName()&lt;/tt&gt; goes, I&apos;m not sure I understand your point.&#160; AIUI &lt;tt&gt;getName()&lt;/tt&gt; is for &lt;tt&gt;BeanManager.getBeans(String)&lt;/tt&gt; and has nothing to do with &lt;tt&gt;@Named&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="16368148" author="romain.manni-bucau" created="Sat, 17 Feb 2018 08:38:13 +0000"  >&lt;p&gt;John, there is no concurrent registration since servlet ones are standard and must not be part of cxf. For these beans use the servlet integration of your cdi container (weld or owb).&lt;/p&gt;

&lt;p&gt;For the name: getname and @named lead to the same do you added named qualifier without willing it. Cxf should probably remove all names - even on the bus - and use @cxf but it is another issue for the bus.&lt;/p&gt;

&lt;p&gt;More generally, never use default in a lib for a standard type which will conflict with user or container code - a user can produce all beans you added and you make him fail &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;Having all beans without default qualifier and names by default sounds fine as a fix.&lt;/p&gt;</comment>
                            <comment id="16368341" author="struberg" created="Sat, 17 Feb 2018 19:51:41 +0000"  >&lt;p&gt;Agree.&lt;/p&gt;

&lt;p&gt;Regarding the names: getName is for setting the EL name via programmatic Bean&amp;lt;T&amp;gt;. So it must follow EL rules.&lt;/p&gt;

&lt;p&gt;Another point: do you really want to expose the CXF Bus and other internals via EL? Could easily become a security issue as a target for EL-injection hacks... So I usually only expose beans to EL if I&apos;m 100% certain that I will use them.&lt;/p&gt;</comment>
                            <comment id="16404157" author="githubbot" created="Sun, 18 Mar 2018 20:04:21 +0000"  >&lt;p&gt;rmannibucau opened a new pull request #393: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7643&quot; title=&quot;Ability to disable certain ContextResolved CDI Beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7643&quot;&gt;CXF-7643&lt;/a&gt; ensure CDI extension defaults are CDI compliant&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/393&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/393&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This PR tries to make defaults of the CDI extension better, here are the changes:&lt;/p&gt;

&lt;p&gt;   1. if it detects OWB-web or weld-web it deactivate default context beans for HttpServletRequest and ServletContext&lt;br/&gt;
   2. it observes beans to detect the types conflicting with &quot;auto&quot; context beans&lt;br/&gt;
   3. it fires the extension and exposes the list of exclusion to let integration layers configure it properly if 1/2 defaults are not enough &lt;br/&gt;
   4. when it adds context beans it removes @Default from the ones which are found with 1/2/3 - but it keeps it with the cxf specific qualifier if needed (best practise being to use this classifier for internal/extensions needs)&lt;/p&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16404245" author="githubbot" created="Sun, 18 Mar 2018 23:30:48 +0000"  >&lt;p&gt;johnament commented on issue #393: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7643&quot; title=&quot;Ability to disable certain ContextResolved CDI Beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7643&quot;&gt;CXF-7643&lt;/a&gt; ensure CDI extension defaults are CDI compliant&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/393#issuecomment-374066579&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/393#issuecomment-374066579&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Can you update one of the existing systests to confirm that the various injection points are available, with the needed dependencies on the classpath?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16404500" author="githubbot" created="Mon, 19 Mar 2018 08:35:52 +0000"  >&lt;p&gt;rmannibucau commented on issue #393: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7643&quot; title=&quot;Ability to disable certain ContextResolved CDI Beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7643&quot;&gt;CXF-7643&lt;/a&gt; ensure CDI extension defaults are CDI compliant&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/393#issuecomment-374136301&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/393#issuecomment-374136301&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @johnament done&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16408207" author="githubbot" created="Wed, 21 Mar 2018 16:40:27 +0000"  >&lt;p&gt;dkulp closed pull request #393: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7643&quot; title=&quot;Ability to disable certain ContextResolved CDI Beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7643&quot;&gt;CXF-7643&lt;/a&gt; ensure CDI extension defaults are CDI compliant&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/393&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/393&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/integration/cdi/src/main/java/org/apache/cxf/cdi/ContextProducerBean.java b/integration/cdi/src/main/java/org/apache/cxf/cdi/ContextProducerBean.java&lt;br/&gt;
index 7fab97782d7..98bcca69ee6 100644&lt;br/&gt;
&amp;#8212; a/integration/cdi/src/main/java/org/apache/cxf/cdi/ContextProducerBean.java&lt;br/&gt;
+++ b/integration/cdi/src/main/java/org/apache/cxf/cdi/ContextProducerBean.java&lt;br/&gt;
@@ -34,16 +34,19 @@&lt;/p&gt;

&lt;p&gt; public class ContextProducerBean extends AbstractCXFBean&amp;lt;Object&amp;gt; implements PassivationCapable {&lt;br/&gt;
     private final Type type;&lt;br/&gt;
+    private final Set&amp;lt;Annotation&amp;gt; qualifiers;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ContextProducerBean(Type type) {&lt;br/&gt;
+    ContextProducerBean(Type type, boolean defaultQualifier) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {         this.type = type;+        this.qualifiers = new HashSet&amp;lt;&amp;gt;(defaultQualifier ? 2 }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Override&lt;br/&gt;
     public Set&amp;lt;Annotation&amp;gt; getQualifiers() &lt;/p&gt;
{
-        Set&amp;lt;Annotation&amp;gt; qualifiers = new HashSet&amp;lt;&amp;gt;(2);
-        qualifiers.add(ContextResolved.LITERAL);
-        qualifiers.add(DEFAULT);
         return qualifiers;
     }

&lt;p&gt;diff --git a/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java b/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java&lt;br/&gt;
index bc7a251cbb3..d2b76dbd5cd 100644&lt;br/&gt;
&amp;#8212; a/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java&lt;br/&gt;
+++ b/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java&lt;br/&gt;
@@ -22,6 +22,7 @@&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Collection;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
+import java.util.HashSet;&lt;br/&gt;
 import java.util.LinkedHashSet;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
 import java.util.Objects;&lt;br/&gt;
@@ -35,6 +36,7 @@&lt;br/&gt;
 import javax.enterprise.inject.spi.AnnotatedType;&lt;br/&gt;
 import javax.enterprise.inject.spi.Bean;&lt;br/&gt;
 import javax.enterprise.inject.spi.BeanManager;&lt;br/&gt;
+import javax.enterprise.inject.spi.BeforeBeanDiscovery;&lt;br/&gt;
 import javax.enterprise.inject.spi.BeforeShutdown;&lt;br/&gt;
 import javax.enterprise.inject.spi.Extension;&lt;br/&gt;
 import javax.enterprise.inject.spi.InjectionTarget;&lt;br/&gt;
@@ -63,6 +65,10 @@&lt;br/&gt;
 import org.apache.cxf.jaxrs.utils.JAXRSServerFactoryCustomizationUtils;&lt;br/&gt;
 import org.apache.cxf.jaxrs.utils.ResourceUtils;&lt;/p&gt;

&lt;p&gt;+import static java.util.Arrays.asList;&lt;br/&gt;
+import static java.util.Optional.ofNullable;&lt;br/&gt;
+import static org.apache.cxf.cdi.AbstractCXFBean.DEFAULT;&lt;br/&gt;
+&lt;br/&gt;
 /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Apache CXF portable CDI extension to support initialization of JAX-RS resources.&lt;br/&gt;
  */&lt;br/&gt;
@@ -78,6 +84,8 @@&lt;br/&gt;
         new ArrayList&amp;lt; CreationalContext&amp;lt; ? &amp;gt; &amp;gt;();&lt;br/&gt;
     private final Set&amp;lt; Type &amp;gt; contextTypes = new LinkedHashSet&amp;lt;&amp;gt;();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    private final Collection&amp;lt; String &amp;gt; existingStandardClasses = new HashSet&amp;lt;&amp;gt;();&lt;br/&gt;
+&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Holder of the classified resource classes, converted to appropriate instance&lt;/li&gt;
	&lt;li&gt;representations.&lt;br/&gt;
@@ -112,6 +120,46 @@ public void addResourceProvider(final CdiResourceProvider other) {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    // observing JAXRSCdiResourceExtension a &quot;container&quot; can customize that value to prevent some instances&lt;br/&gt;
+    // to be added with the default qualifier&lt;br/&gt;
+    public Collection&amp;lt;String&amp;gt; getExistingStandardClasses() &lt;/p&gt;
{
+        return existingStandardClasses;
+    }
&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Fires itsels, allows other extensions to modify this one.&lt;br/&gt;
+     * Typical example can be to modify existingStandardClasses to prevent CXF&lt;br/&gt;
+     * to own some beans it shouldn&apos;t create with default classifier.&lt;br/&gt;
+     *&lt;br/&gt;
+     * @param beforeBeanDiscovery the corresponding cdi event.&lt;br/&gt;
+     * @param beanManager the cdi bean manager.&lt;br/&gt;
+     */&lt;br/&gt;
+    void onStartup(@Observes final BeforeBeanDiscovery beforeBeanDiscovery, final BeanManager beanManager) {&lt;br/&gt;
+        final ClassLoader loader = ofNullable(Thread.currentThread().getContextClassLoader())&lt;br/&gt;
+                .orElseGet(ClassLoader::getSystemClassLoader);&lt;br/&gt;
+        boolean webHandled = false;&lt;br/&gt;
+        try &lt;/p&gt;
{ // OWB
+            loader.loadClass(&quot;org.apache.webbeans.web.lifecycle.WebContainerLifecycle&quot;);
+            webHandled = true;
+        }
&lt;p&gt; catch (final NoClassDefFoundError | ClassNotFoundException e) &lt;/p&gt;
{
+            // ok to keep them all
+        }
&lt;p&gt;+        if (!webHandled) {&lt;br/&gt;
+            try &lt;/p&gt;
{ // Weld
+                loader.loadClass(&quot;org.jboss.weld.module.web.WeldWebModule&quot;);
+                webHandled = true;
+            }
&lt;p&gt; catch (final NoClassDefFoundError | ClassNotFoundException e) &lt;/p&gt;
{
+                // ok to keep them all
+            }
&lt;p&gt;+        }&lt;br/&gt;
+        if (webHandled) &lt;/p&gt;
{
+            existingStandardClasses.addAll(asList(
+                &quot;javax.servlet.http.HttpServletRequest&quot;,
+                &quot;javax.servlet.ServletContext&quot;));
+        }
&lt;p&gt;+        beanManager.fireEvent(this);&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;For any 
{@link AnnotatedType}
&lt;p&gt; that includes a &lt;/p&gt;
{@link Context}
&lt;p&gt; injection point, this method replaces&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;the field with the following code:&lt;br/&gt;
@@ -149,6 +197,11 @@ public void addResourceProvider(final CdiResourceProvider other) {&lt;br/&gt;
         } else if (CdiBusBean.CXF.equals(event.getBean().getName())&lt;br/&gt;
                 &amp;amp;&amp;amp; Bus.class.isAssignableFrom(event.getBean().getBeanClass())) 
{
             hasBus = true;
+        }
&lt;p&gt; else if (event.getBean().getQualifiers().contains(DEFAULT)) &lt;/p&gt;
{
+            event.getBean().getTypes().stream()
+                .filter(e -&amp;gt; Object.class != e &amp;amp;&amp;amp; InjectionUtils.STANDARD_CONTEXT_CLASSES.contains(e.getTypeName()))
+                .findFirst()
+                .ifPresent(type -&amp;gt; existingStandardClasses.add(type.getTypeName()));
         }
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -211,11 +264,16 @@ public void injectBus(@Observes final AfterBeanDiscovery event, final BeanManage&lt;br/&gt;
                 beanManager.createInjectionTarget(busAnnotatedType);&lt;br/&gt;
             event.addBean(new CdiBusBean(busInjectionTarget));&lt;br/&gt;
         }&lt;br/&gt;
+&lt;br/&gt;
         if (applicationBeans.isEmpty() &amp;amp;&amp;amp; !serviceBeans.isEmpty()) &lt;/p&gt;
{
             final DefaultApplicationBean applicationBean = new DefaultApplicationBean();
             applicationBeans.add(applicationBean);
             event.addBean(applicationBean);
+        }
&lt;p&gt; else &lt;/p&gt;
{
+            // otherwise will be ambiguous since we scanned it with default qualifier already
+            existingStandardClasses.add(Application.class.getName());
         }
&lt;p&gt;+&lt;br/&gt;
         // always add the standard context classes&lt;br/&gt;
         InjectionUtils.STANDARD_CONTEXT_CLASSES.stream()&lt;br/&gt;
                 .map(this::toClass)&lt;br/&gt;
@@ -224,7 +282,8 @@ public void injectBus(@Observes final AfterBeanDiscovery event, final BeanManage&lt;br/&gt;
         // add custom contexts&lt;br/&gt;
         contextTypes.addAll(getCustomContextClasses());&lt;br/&gt;
         // register all of the context types&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;contextTypes.forEach(t -&amp;gt; event.addBean(new ContextProducerBean(t)));&lt;br/&gt;
+        contextTypes.forEach(&lt;br/&gt;
+            t -&amp;gt; event.addBean(new ContextProducerBean(t, !existingStandardClasses.contains(t.getTypeName()))));&lt;br/&gt;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     /**&lt;br/&gt;
@@ -281,8 +340,7 @@ private JAXRSServerFactoryBean createFactoryInstance(final Application applicati&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@return JAXRSServerFactoryBean instance&lt;br/&gt;
      */&lt;br/&gt;
     private JAXRSServerFactoryBean createFactoryInstance(final Application application, final BeanManager beanManager) {&lt;br/&gt;
-&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;final JAXRSServerFactoryBean instance =&lt;br/&gt;
+        final JAXRSServerFactoryBean instance =&lt;br/&gt;
             ResourceUtils.createApplication(application, false, false, false, bus);&lt;br/&gt;
         final ClassifiedClasses classified = classes2singletons(application, beanManager);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/AbstractCdiSingleAppTest.java b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/AbstractCdiSingleAppTest.java&lt;br/&gt;
index 36eb0dce14a..edc0c5467a8 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/AbstractCdiSingleAppTest.java&lt;br/&gt;
+++ b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/AbstractCdiSingleAppTest.java&lt;br/&gt;
@@ -35,6 +35,35 @@&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt; public abstract class AbstractCdiSingleAppTest extends AbstractBusClientServerTestBase {&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testAvailableInjections() &lt;/p&gt;
{
+        assertEquals(&quot;configuration=Configuration/&quot;
+            + &quot;contextResolver=ContextResolver/&quot;
+            + &quot;cxfApplication=Application/&quot;
+            + &quot;cxfConfiguration=Configuration/&quot;
+            + &quot;cxfContextResolver=ContextResolver/&quot;
+            + &quot;cxfHttpHeaders=HttpHeaders/&quot;
+            + &quot;cxfHttpServletRequest=HttpServletRequest/&quot;
+            + &quot;cxfProviders=Providers/&quot;
+            + &quot;cxfRequest=Request/&quot;
+            + &quot;cxfResourceContext=ResourceContext/&quot;
+            + &quot;cxfResourceInfo=ResourceInfo/&quot;
+            + &quot;cxfSecurityContext=SecurityContext/&quot;
+            + &quot;cxfServletContext=ServletContext/&quot;
+            + &quot;cxfUriInfo=UriInfo/&quot;
+            + &quot;cxfhttpServletResponse=HttpServletRequest/&quot;
+            + &quot;httpHeaders=HttpHeaders/&quot;
+            + &quot;httpServletRequest=HttpServletRequest/&quot;
+            + &quot;httpServletResponse=HttpServletResponse/&quot;
+            + &quot;providers=Providers/request=Request/&quot;
+            + &quot;resourceContext=ResourceContext/&quot;
+            + &quot;resourceInfo=ResourceInfo/&quot;
+            + &quot;securityContext=SecurityContext/&quot;
+            + &quot;servletContext=ServletContext/&quot;
+            + &quot;uriInfo=UriInfo&quot;,
+            createWebClient(getBasePath() + &quot;/injections&quot;, MediaType.TEXT_PLAIN).get(String.class).trim());
+    }
&lt;p&gt;+&lt;br/&gt;
     @Test&lt;br/&gt;
     public void testInjectedVersionIsProperlyReturned() {&lt;br/&gt;
         Response r = createWebClient(getBasePath() + &quot;/version&quot;, MediaType.TEXT_PLAIN).get();&lt;br/&gt;
diff --git a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStore.java b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStore.java&lt;br/&gt;
index bb458af7e4e..63cbc3ad615 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStore.java&lt;br/&gt;
+++ b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStore.java&lt;br/&gt;
@@ -39,15 +39,24 @@&lt;br/&gt;
     private BookStoreService service;&lt;br/&gt;
     private BookStoreVersion bookStoreVersion;&lt;br/&gt;
     private UriInfo uriInfo;&lt;br/&gt;
+    private Injections injections;&lt;/p&gt;

&lt;p&gt;     public BookStore() {&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     @Inject&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public BookStore(BookStoreService service, BookStoreVersion bookStoreVersion, UriInfo uriInfo) {&lt;br/&gt;
+    public BookStore(BookStoreService service, BookStoreVersion bookStoreVersion, UriInfo uriInfo,&lt;br/&gt;
+                     Injections injections) 
{
         this.service = service;
         this.bookStoreVersion = bookStoreVersion;
         this.uriInfo = uriInfo;
+        this.injections = injections;
+    }
&lt;p&gt;+&lt;br/&gt;
+    @GET&lt;br/&gt;
+    @Path(&quot;injections&quot;)&lt;br/&gt;
+    public String injections() &lt;/p&gt;
{
+        return injections.state();
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Path(&quot;/version&quot;)&lt;br/&gt;
diff --git a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/Injections.java b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/Injections.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..7e2391cd789&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/Injections.java&lt;br/&gt;
@@ -0,0 +1,154 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+package org.apache.cxf.systests.cdi.base;&lt;br/&gt;
+&lt;br/&gt;
+import java.util.stream.Collectors;&lt;br/&gt;
+import java.util.stream.Stream;&lt;br/&gt;
+&lt;br/&gt;
+import javax.enterprise.context.ApplicationScoped;&lt;br/&gt;
+import javax.inject.Inject;&lt;br/&gt;
+import javax.servlet.ServletContext;&lt;br/&gt;
+import javax.servlet.http.HttpServletRequest;&lt;br/&gt;
+import javax.servlet.http.HttpServletResponse;&lt;br/&gt;
+import javax.ws.rs.container.ResourceContext;&lt;br/&gt;
+import javax.ws.rs.container.ResourceInfo;&lt;br/&gt;
+import javax.ws.rs.core.Application;&lt;br/&gt;
+import javax.ws.rs.core.Configuration;&lt;br/&gt;
+import javax.ws.rs.core.HttpHeaders;&lt;br/&gt;
+import javax.ws.rs.core.Request;&lt;br/&gt;
+import javax.ws.rs.core.SecurityContext;&lt;br/&gt;
+import javax.ws.rs.core.UriInfo;&lt;br/&gt;
+import javax.ws.rs.ext.ContextResolver;&lt;br/&gt;
+import javax.ws.rs.ext.Providers;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.cdi.ContextResolved;&lt;br/&gt;
+&lt;br/&gt;
+@ApplicationScoped&lt;br/&gt;
+public class Injections {&lt;br/&gt;
+    /* this one is not supposed to work in the systests&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private Application application;&lt;br/&gt;
+    */&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private Application cxfApplication; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private UriInfo uriInfo; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private UriInfo cxfUriInfo; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private HttpHeaders httpHeaders; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private HttpHeaders cxfHttpHeaders; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private Request request; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private Request cxfRequest; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private SecurityContext securityContext; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private SecurityContext cxfSecurityContext; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private Providers providers; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private Providers cxfProviders; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private ContextResolver contextResolver; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private ContextResolver cxfContextResolver; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private HttpServletRequest httpServletRequest; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private HttpServletRequest cxfHttpServletRequest; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private HttpServletResponse httpServletResponse; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private HttpServletRequest cxfhttpServletResponse; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private ServletContext servletContext; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private ServletContext cxfServletContext; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private ResourceContext resourceContext; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private ResourceContext cxfResourceContext; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private ResourceInfo resourceInfo; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private ResourceInfo cxfResourceInfo; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    private Configuration configuration; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    @Inject&lt;br/&gt;
+    @ContextResolved&lt;br/&gt;
+    private Configuration cxfConfiguration; //NOPMD&lt;br/&gt;
+&lt;br/&gt;
+    public String state() {&lt;br/&gt;
+        return Stream.of(Injections.class.getDeclaredFields())&lt;br/&gt;
+                .filter(f -&amp;gt; f.isAnnotationPresent(Inject.class))&lt;br/&gt;
+                .map(f -&amp;gt; {&lt;br/&gt;
+                    if (!f.isAccessible()) &lt;/p&gt;
{
+                        f.setAccessible(true);
+                    }
&lt;p&gt;+                    try &lt;/p&gt;
{
+                        // the standard name otherwise not portable
+                        return f.get(Injections.this) != null ? f.getName() + &quot;=&quot; + f.getType().getSimpleName() : &quot;&quot;;
+                    }
&lt;p&gt; catch (final IllegalAccessException e) &lt;/p&gt;
{
+                        return &quot;&quot;;
+                    }
&lt;p&gt;+                })&lt;br/&gt;
+                .sorted() // be deterministic in the test, java reflection is no more since java7&lt;br/&gt;
+                .collect(Collectors.joining(&quot;/&quot;));&lt;br/&gt;
+    }&lt;br/&gt;
+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3q2pb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>