<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:08:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5609] Won&apos;t pass verification of explicit WSS Policy AsymmetricBinding -&gt; Layout -&gt; Policy -&gt; Lax</title>
                <link>https://issues.apache.org/jira/browse/CXF-5609</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I can&apos;t seem to get CXF WS-* validator to accept a message for service which has &amp;lt;sp:Layout&amp;gt; &amp;lt;wsp:Policy&amp;gt; &amp;lt;sp:Lax /&amp;gt; policy explicitly defined in the WSDL. Maybe I&apos;m missing something, but all I get is:&lt;/p&gt;

&lt;p&gt;&amp;lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;soap:Body&amp;gt;&lt;br/&gt;
      &amp;lt;soap:Fault&amp;gt;&lt;br/&gt;
         &amp;lt;faultcode&amp;gt;soap:Server&amp;lt;/faultcode&amp;gt;&lt;br/&gt;
         &amp;lt;faultstring&amp;gt;These policy alternatives can not be satisfied: &lt;/p&gt;
{http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}
&lt;p&gt;Layout&amp;lt;/faultstring&amp;gt;&lt;br/&gt;
      &amp;lt;/soap:Fault&amp;gt;&lt;br/&gt;
   &amp;lt;/soap:Body&amp;gt;&lt;br/&gt;
&amp;lt;/soap:Envelope&amp;gt;&lt;/p&gt;

&lt;p&gt;I did some debugging on the issue and it appears that both org.apache.cxf.ws.security.policy.builders.LayoutBuilder and org.apache.cxf.ws.security.policy.model.AsymmetricBinding add org.apache.cxf.ws.security.policy.model.Layout assertions to the expected policy. However org.apache.cxf.ws.security.wss4j.policyvalidators.AbstractBindingPolicyValidator.checkProperties(SymmetricAsymmetricBindingBase, AssertionInfo, AssertionInfoMap, List&amp;lt;WSSecurityEngineResult&amp;gt;, List&amp;lt;WSSecurityEngineResult&amp;gt;, Message) successfully asserts only one of Layout instances while another one remains untouched and causes the failure to occur. If I comment out sp:Layout from WSDL, validation passes since LayoutBuilder never adds its Layout instance.&lt;/p&gt;

&lt;p&gt;I guess that removing LayoutBuilder would fix the problem but I&apos;m not sure if this is the right thing to do.&lt;/p&gt;

&lt;p&gt;Relevant excerpt from WSDL:&lt;/p&gt;

&lt;p&gt;&amp;lt;wsp:Policy wsu:Id=&quot;SignAndEncrypt&quot;&lt;br/&gt;
		xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;&lt;br/&gt;
		xmlns:wsp=&quot;http://www.w3.org/ns/ws-policy&quot; xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot;&lt;br/&gt;
		wsdl:required=&quot;true&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;wsp:ExactlyOne&amp;gt;&lt;br/&gt;
			&amp;lt;wsp:All&amp;gt;&lt;br/&gt;
				&amp;lt;sp:AsymmetricBinding&amp;gt;&lt;br/&gt;
					&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
						&amp;lt;sp:InitiatorToken&amp;gt;&lt;br/&gt;
							&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
								&amp;lt;sp:X509Token&lt;br/&gt;
									sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never&quot;&amp;gt;&lt;br/&gt;
									&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
										&amp;lt;sp:WssX509V3Token10 /&amp;gt;&lt;br/&gt;
									&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
								&amp;lt;/sp:X509Token&amp;gt;&lt;br/&gt;
							&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
						&amp;lt;/sp:InitiatorToken&amp;gt;&lt;br/&gt;
						&amp;lt;sp:RecipientToken&amp;gt;&lt;br/&gt;
							&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
								&amp;lt;sp:X509Token&lt;br/&gt;
									sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never&quot;&amp;gt;&lt;br/&gt;
									&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
										&amp;lt;sp:WssX509V3Token10 /&amp;gt;&lt;br/&gt;
									&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
								&amp;lt;/sp:X509Token&amp;gt;&lt;br/&gt;
							&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
						&amp;lt;/sp:RecipientToken&amp;gt;&lt;br/&gt;
						&amp;lt;sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
							&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
								&amp;lt;sp:Basic256Rsa15 /&amp;gt;&lt;br/&gt;
								&amp;lt;sp:TripleDesRsa15 /&amp;gt;&lt;br/&gt;
								&amp;lt;sp:Basic128Rsa15 /&amp;gt;&lt;br/&gt;
							&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
						&amp;lt;/sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
						&amp;lt;sp:IncludeTimestamp /&amp;gt;&lt;br/&gt;
						&amp;lt;sp:EncryptSignature /&amp;gt;&lt;br/&gt;
						&amp;lt;sp:OnlySignEntireHeadersAndBody /&amp;gt;&lt;br/&gt;
					&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
				&amp;lt;/sp:AsymmetricBinding&amp;gt;&lt;br/&gt;
				&amp;lt;sp:Wss10&amp;gt;&lt;br/&gt;
					&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
						&amp;lt;sp:MustSupportRefIssuerSerial /&amp;gt;&lt;br/&gt;
						&amp;lt;sp:MustSupportRefEmbeddedToken /&amp;gt;&lt;br/&gt;
					&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
				&amp;lt;/sp:Wss10&amp;gt;&lt;br/&gt;
				&amp;lt;sp:Layout&amp;gt;&lt;br/&gt;
					&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
						&amp;lt;sp:Lax /&amp;gt;&lt;br/&gt;
					&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
				&amp;lt;/sp:Layout&amp;gt;&lt;br/&gt;
				&amp;lt;sp:SignedParts&amp;gt;&lt;br/&gt;
					&amp;lt;sp:Body /&amp;gt;&lt;br/&gt;
					&amp;lt;sp:Header Namespace=&quot;http://schemas.xmlsoap.org/ws/2004/08/addressing&quot; /&amp;gt;&lt;br/&gt;
					&amp;lt;sp:Header Namespace=&quot;http://www.w3.org/2005/08/addressing&quot; /&amp;gt;&lt;br/&gt;
				&amp;lt;/sp:SignedParts&amp;gt;&lt;br/&gt;
				&amp;lt;sp:EncryptedParts&amp;gt;&lt;br/&gt;
					&amp;lt;sp:Body /&amp;gt;&lt;br/&gt;
				&amp;lt;/sp:EncryptedParts&amp;gt;&lt;br/&gt;
			&amp;lt;/wsp:All&amp;gt;&lt;br/&gt;
		&amp;lt;/wsp:ExactlyOne&amp;gt;&lt;br/&gt;
	&amp;lt;/wsp:Policy&amp;gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12701059">CXF-5609</key>
            <summary>Won&apos;t pass verification of explicit WSS Policy AsymmetricBinding -&gt; Layout -&gt; Policy -&gt; Lax</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="modax">Modestas Vainius</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Mar 2014 18:43:47 +0000</created>
                <updated>Fri, 11 Jul 2014 12:50:36 +0000</updated>
                            <resolved>Thu, 13 Mar 2014 16:49:01 +0000</resolved>
                                    <version>2.6.13</version>
                    <version>2.7.10</version>
                                    <fixVersion>2.7.11</fixVersion>
                    <fixVersion>2.6.14</fixVersion>
                    <fixVersion>3.0</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13933057" author="coheigea" created="Thu, 13 Mar 2014 09:52:30 +0000"  >
&lt;p&gt;The Layout policy should be a child element of the Binding policy. I&apos;ve never seen it presented as a separate policy - it is a property of the security binding that is used.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="13933143" author="modax" created="Thu, 13 Mar 2014 11:57:39 +0000"  >&lt;p&gt;Yes, that&apos;s exactly how it is in my case as well. Therefore I see no point of separate LayoutBuilder (registered at org.apache.cxf.ws.security.policy.WSSecurityPolicyLoader.registerBuilders())? Maybe it&apos;s some leftover from the past?&lt;/p&gt;</comment>
                            <comment id="13933146" author="coheigea" created="Thu, 13 Mar 2014 12:03:02 +0000"  >
&lt;p&gt;There is probably no need for a separate LayoutBuilder - I will remove it. However, the problem fundamentally is that your security policy is incorrect, in that the Layout policy is in the wrong place.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="13933159" author="modax" created="Thu, 13 Mar 2014 12:18:31 +0000"  >&lt;p&gt;Hmm, Now I took another look at the spec and it says:&lt;/p&gt;

&lt;p&gt;&quot;This assertion indicates a requirement for a particular security header layout as defined under the &lt;span class=&quot;error&quot;&gt;&amp;#91;Security Header Layout&amp;#93;&lt;/span&gt; property described in Section 6.7. The scope of this assertion is defined by its containing assertion.&quot;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/ws-securitypolicy-1.2-spec-os.html#_Layout_Assertion&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/ws-securitypolicy-1.2-spec-os.html#_Layout_Assertion&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So maybe Layout is valid outside binding after all.&lt;/p&gt;</comment>
                            <comment id="13933335" author="coheigea" created="Thu, 13 Mar 2014 14:53:35 +0000"  >
&lt;p&gt;It may be valid, but that doesn&apos;t mean that it needs to be supported &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Having said that it&apos;s straightforward enough to support, so will fix it.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="13938868" author="modax" created="Tue, 18 Mar 2014 06:13:27 +0000"  >&lt;p&gt;Is there any chance you could backport the fix to 2.6.x as well?&lt;/p&gt;</comment>
                            <comment id="13939038" author="coheigea" created="Tue, 18 Mar 2014 10:30:58 +0000"  >
&lt;p&gt;Yes, done.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379405</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tdh3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379696</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>