<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:14:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6221] CDI integration extension does not detect annotations on Karaf</title>
                <link>https://issues.apache.org/jira/browse/CXF-6221</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I am trying to use portable extension to get working CDI 1.2 and CXF 3.0.2 on Apache Karaf. I wrapped it into OSGi bundle. I installed to my container also:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;weld 2.1.1&lt;/li&gt;
	&lt;li&gt;pax-cdi-1.2&lt;/li&gt;
	&lt;li&gt;pax-cdi-1.2-web&lt;/li&gt;
	&lt;li&gt;pax-cdi-web-weld&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;My JAXRS resources are not found by extension because some line from class *&lt;b&gt;JAXRSCdiResourceExtension&lt;/b&gt;* returns false even annotated element contains proper annotation but as a proxy (see attachment image / screenshot from debugger).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (event.getAnnotated().isAnnotationPresent(ApplicationPath.class)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It would be nice,  to tell me how to get it working. I also tested CDI-1.1. Same situation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12769796">CXF-6221</key>
            <summary>CDI integration extension does not detect annotations on Karaf</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="ciapunek">Krystian Panek</reporter>
                        <labels>
                            <label>cdi</label>
                            <label>extension</label>
                            <label>integration</label>
                            <label>karaf</label>
                    </labels>
                <created>Sat, 24 Jan 2015 01:26:56 +0000</created>
                <updated>Mon, 10 Apr 2017 19:07:03 +0000</updated>
                            <resolved>Fri, 10 Apr 2015 11:46:13 +0000</resolved>
                                                                    <component>Integration</component>
                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14292136" author="sergey_beryozkin" created="Mon, 26 Jan 2015 17:38:39 +0000"  >&lt;p&gt;I&apos;ve updated the module&apos;s pom.xml, OSGI metadata will be created. Please check the snapshots&lt;/p&gt;</comment>
                            <comment id="14293932" author="ciapunek" created="Tue, 27 Jan 2015 18:34:30 +0000"  >&lt;p&gt;However your improvement does not fix the problem. First of all, I cannot see any bundle instructions, &apos;Provide-Capability&apos; is missing so pax cdi extender cannot use extension. What is more, integration does not work because of proxies instead of real annotations which are checked in JaxRsCdiResourceExtension like in attached screenshot. I am still investigating it. My supposition is that maybe I just have to disable that proxies by hand (in later versions of Weld, maybe it is working without any changes &lt;a href=&quot;https://issues.jboss.org/browse/WELD-1789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.jboss.org/browse/WELD-1789&lt;/a&gt;). It would be great if you provide some instruction how to get that integration working on Apache Karaf 3.0 and CDI 1.2 / Weld 2.2.4.&lt;/p&gt;</comment>
                            <comment id="14294211" author="sergey_beryozkin" created="Tue, 27 Jan 2015 21:24:26 +0000"  >&lt;p&gt;Hi, &lt;br/&gt;
I&apos;ve actually no idea at all how to make it work in Karaf though I know it has to be a bundle at the very least.&lt;br/&gt;
Are you sure you have downloaded the latest snapshot ? There has to be an Import-Package instruction in the manifest, I did check it yesterday after a local build and confirmed it was there. So get that one and try, the pom of this module should have a &apos;bundle&apos; artifact type.&lt;br/&gt;
Now, as far as Provide-Capability is concerned, should it be set  to &quot;CDI&quot; ? When you get the latest snapshot with Import-Package generated, can you please modify the module jar, update Manifest with a Provide-Capability instruction and see if it makes a difference ?  I guess try with an Import-package only first and then add Provide-Capability next if needed.&lt;/p&gt;

&lt;p&gt;Let me know the results and  I&apos;ll add a Provide-Capability instruction to cdi/pom.xml &lt;/p&gt;
</comment>
                            <comment id="14294251" author="ciapunek" created="Tue, 27 Jan 2015 21:48:51 +0000"  >&lt;p&gt;OK, thanks for response. Yes I checked snapshot. I realize that my issue is not directly connected with CXF - it is some edge case probably more related with Weld CDI implementation. Going further I discovered more which I described here: &lt;a href=&quot;https://developer.jboss.org/message/917124#917124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.jboss.org/message/917124#917124&lt;/a&gt; . If I get a valid response or fix I will post it back here. Regards.&lt;/p&gt;</comment>
                            <comment id="14294951" author="ciapunek" created="Wed, 28 Jan 2015 10:02:53 +0000"  >&lt;p&gt;Its an issue related with classloaders. Extension should use same JaxRS API exposed as shared bundle, for example: org.apache.servicemix.specs.jsr339-api-2.0&lt;/p&gt;</comment>
                            <comment id="14294986" author="sergey_beryozkin" created="Wed, 28 Jan 2015 10:51:36 +0000"  >&lt;p&gt;Well, the code is expected to work in non-OSGI environments too. Can you please point to the extension code that may need to be tuned ?&lt;/p&gt;</comment>
                            <comment id="14295674" author="ciapunek" created="Wed, 28 Jan 2015 19:27:43 +0000"  >&lt;p&gt;Maybe it will be hard or even impossible to get that extension working on both OSGi and non-OSGi environments so I suggest to release just 2 versions of that integration.&lt;/p&gt;

&lt;p&gt;I copied source code from your extension, and put in under a project with pom.xml like above and everything now works properly:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;project xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//maven.apache.org/POM/4.0.0&quot;&lt;/span&gt; xmlns:xsi=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
&lt;/span&gt;         xsi:schemaLocation=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&lt;/span&gt;&amp;gt;
&lt;/span&gt;    &amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;
    &amp;lt;packaging&amp;gt;bundle&amp;lt;/packaging&amp;gt;

    &amp;lt;parent&amp;gt;
        &amp;lt;groupId&amp;gt;com.neva.osgi&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;parent&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;1.0.0-SNAPSHOT&amp;lt;/version&amp;gt;
    &amp;lt;/parent&amp;gt;

    &amp;lt;artifactId&amp;gt;cdicxfbridge&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;3.0.2-SNAPSHOT&amp;lt;/version&amp;gt;

    &amp;lt;name&amp;gt;Neva OSGi | CDI CXF Bridge (JAX-RS support)&amp;lt;/name&amp;gt;
    &amp;lt;description&amp;gt;CDI portable extension &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; JaxRS (CXF). Sources copied from:
        https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/apache/cxf/tree/master/integration/cdi
&lt;/span&gt;    &amp;lt;/description&amp;gt;

    &amp;lt;properties&amp;gt;
        &amp;lt;maven-bundle-plugin.version&amp;gt;2.4.0&amp;lt;/maven-bundle-plugin.version&amp;gt;
        &amp;lt;osgi.version&amp;gt;5.0.0&amp;lt;/osgi.version&amp;gt;
        &amp;lt;pax.cdi.version&amp;gt;0.8.0&amp;lt;/pax.cdi.version&amp;gt;
        &amp;lt;cxf.version&amp;gt;3.0.2&amp;lt;/cxf.version&amp;gt;
    &amp;lt;/properties&amp;gt;

    &amp;lt;build&amp;gt;
        &amp;lt;plugins&amp;gt;
            &amp;lt;plugin&amp;gt;
                &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;
                &amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;
                &amp;lt;version&amp;gt;${maven-bundle-plugin.version}&amp;lt;/version&amp;gt;
                &amp;lt;extensions&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/extensions&amp;gt;
                &amp;lt;configuration&amp;gt;
                    &amp;lt;instructions&amp;gt;
                        &amp;lt;Bundle-SymbolicName&amp;gt;${project.groupId}.${project.artifactId}&amp;lt;/Bundle-SymbolicName&amp;gt;
                        &amp;lt;Import-Package&amp;gt;
                            org.apache.cxf.interceptor,
                            *
                        &amp;lt;/Import-Package&amp;gt;
                        &amp;lt;Export-Package&amp;gt;
                            com.neva.osgi.cdicxfbridge*;version=${project.version},
                            org.apache.cxf.cdi*
                        &amp;lt;/Export-Package&amp;gt;
                        &amp;lt;Require-Capability&amp;gt;
                            osgi.extender;filter:=&lt;span class=&quot;code-quote&quot;&gt;&quot;(osgi.extender=pax.cdi)&quot;&lt;/span&gt;
                        &amp;lt;/Require-Capability&amp;gt;
                        &amp;lt;Provide-Capability&amp;gt;
                            org.ops4j.pax.cdi.extension; extension=&lt;span class=&quot;code-quote&quot;&gt;&quot;jaxrs-cdi&quot;&lt;/span&gt;
                        &amp;lt;/Provide-Capability&amp;gt;
                    &amp;lt;/instructions&amp;gt;
                &amp;lt;/configuration&amp;gt;
            &amp;lt;/plugin&amp;gt;
            &amp;lt;plugin&amp;gt;
                &amp;lt;artifactId&amp;gt;maven-compiler-plugin&amp;lt;/artifactId&amp;gt;
                &amp;lt;version&amp;gt;3.1&amp;lt;/version&amp;gt;
                &amp;lt;configuration&amp;gt;
                    &amp;lt;source&amp;gt;1.8&amp;lt;/source&amp;gt;
                    &amp;lt;target&amp;gt;1.8&amp;lt;/target&amp;gt;
                &amp;lt;/configuration&amp;gt;
            &amp;lt;/plugin&amp;gt;
        &amp;lt;/plugins&amp;gt;
    &amp;lt;/build&amp;gt;

    &amp;lt;dependencies&amp;gt;
        &amp;lt;!-- OSGi --&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.osgi&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;org.osgi.core&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${osgi.version}&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;!-- CDI --&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;javax.enterprise&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;cdi-api&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;1.1-20130918&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.ops4j.pax.cdi&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;pax-cdi-api&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${pax.cdi.version}&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.ops4j.pax.cdi&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;pax-cdi-web-weld&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${pax.cdi.version}&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.apache.geronimo.specs&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;geronimo-atinject_1.0_spec&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;1.0&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;!-- CXF --&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.apache.cxf&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;cxf-rt-rs-extension-providers&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${cxf.version}&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.apache.cxf&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;cxf-rt-frontend-jaxrs&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${cxf.version}&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.apache.cxf&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;cxf-core&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${cxf.version}&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;!-- Other --&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.apache.geronimo.specs&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;geronimo-servlet_3.0_spec&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;1.0&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.ops4j.pax.logging&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;pax-logging-api&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;1.7.4&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;com.google.guava&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;guava&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;13.0&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;javax.interceptor&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;javax.interceptor-api&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;1.2&amp;lt;/version&amp;gt;
            &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
        &amp;lt;/dependency&amp;gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;commons-lang&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;commons-lang&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;2.6&amp;lt;/version&amp;gt;
        &amp;lt;/dependency&amp;gt;

    &amp;lt;/dependencies&amp;gt;
&amp;lt;/project&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14295916" author="sergey_beryozkin" created="Wed, 28 Jan 2015 21:50:09 +0000"  >&lt;p&gt;Well, the good news it can work in OSGI after all, thanks for experimenting.&lt;br/&gt;
Ideally we&apos;d find a way to add the required instructions to the integration/cdi/pom.xml while still trying to keep it portable.&lt;/p&gt;

&lt;p&gt;Would only adding Export-Package &quot;org.apache.cxf.cdi*&quot; help ? &lt;br/&gt;
Or Export-Package and Require-Capability ?&lt;/p&gt;

&lt;p&gt;Can you modify the manifest of the snapshot cdi bundle and experiment ?&lt;br/&gt;
Cheers, Sergey &lt;/p&gt;

</comment>
                            <comment id="14302873" author="ciapunek" created="Tue, 3 Feb 2015 07:11:48 +0000"  >&lt;p&gt;I am still fighting with it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Now I have a problem with request-scoped annotation. Whenever I annotate my JAX-RS resource using @RequestScoped I am getting:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.jboss.weld.context.ContextNotActiveException: WELD-001303: No active contexts &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; scope type javax.enterprise.context.RequestScoped
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maybe you have some idea, how can I fix it? Maybe it is a issue related with pax-cdi-web-weld ... maybe I have to initialize context manually, I am new in CDI so any suggestions are welcome.&lt;/p&gt;</comment>
                            <comment id="14303082" author="sergey_beryozkin" created="Tue, 3 Feb 2015 11:05:35 +0000"  >&lt;p&gt;Is it the only issue remaining now ? &lt;br/&gt;
I think supporting CDI RequestScoped would probably require enhancing the CXF code but the higher priority is to ensure the module works in OSGI without having to create a custom POM. Have you had a chance to investigate what extra changes have to be done to integration/cdi/pom.xml ?&lt;br/&gt;
Andriy Redko who wrote the extension may have some time later on to look into this issue &lt;/p&gt;

&lt;p&gt;Sergey&lt;/p&gt;
</comment>
                            <comment id="14303230" author="ciapunek" created="Tue, 3 Feb 2015 13:11:41 +0000"  >&lt;p&gt;Already, yes. After few days I willl push to some github repo what I did to get it work. I am afraid that it will be hard to have only one pom for that integration. It would be great if Andriy will help. Thank you very much.&lt;/p&gt;</comment>
                            <comment id="14314822" author="ciapunek" created="Tue, 10 Feb 2015 20:14:23 +0000"  >&lt;p&gt;As I have promised I pushed some code what I am working with. This bundle works for me on Karaf 3.0.3 but I am still investigating how to get @RequestScoped working... maybe Andriy has an idea?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/neva-dev/osgi/blob/master/cdi-cxf-bridge/pom.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/neva-dev/osgi/blob/master/cdi-cxf-bridge/pom.xml&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14314882" author="sergey_beryozkin" created="Tue, 10 Feb 2015 20:42:25 +0000"  >&lt;p&gt;IMHO it is important that we have this module working in OSGI out of the box first&lt;br/&gt;
Cheers, Sergey &lt;/p&gt;</comment>
                            <comment id="14315132" author="reta" created="Tue, 10 Feb 2015 22:59:41 +0000"  >&lt;p&gt;Thank you Sergey and Krysian. I already started looking into this issue, will try to come up with the solution as soon as possible. &lt;br/&gt;
Thanks a lot for help and valuable details!&lt;/p&gt;</comment>
                            <comment id="14320115" author="reta" created="Fri, 13 Feb 2015 14:14:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; I have done some initial commit to include OSGi required metadata into cxf-integration-cdi bundle. I know it won&apos;t solve your issue but I cannot reproduce the proxies use case. Could you please share the small OSGi bundle to show off how you are using CXF + CDI so I can reproduce the issue and work on that? Thank you!&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="14322149" author="ciapunek" created="Sun, 15 Feb 2015 19:06:06 +0000"  >&lt;p&gt;Yes of course. I am a little bit busy right now and tomorrow, so I will try to send it for you on Tuesday. Btw proxies were not a problem but different class loaders &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;CXF-CDI-extension bundle and your custom bundle must both use same classloader which are providing javax.rs.ws.Application to get all working . In my case, without changing original dependencies, cxf-cdi-extension was using own embed version of javax.rs.ws.Application and that was a real problem, according to source code, comparing same class but from different classloader gives false.&lt;/p&gt;</comment>
                            <comment id="14322162" author="reta" created="Sun, 15 Feb 2015 19:45:07 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks a lot, yes, this is another issue we have to address. I have run into it as well and it is on my list. &lt;br/&gt;
However I prepared the simpler version of the bundle which has Application class with singletons defined. I see that everything is discovered, instantiated and wired up properly. The only issue I have right now is that CXF endpoints are not published (but bus instance is), trying to figure out what is missed here.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="14322233" author="ciapunek" created="Sun, 15 Feb 2015 23:09:40 +0000"  >&lt;p&gt;Maybe try to do not define singletons directly,  singletons should be auto-discovered according to docs / with empty Application class implementation. In a CDI&apos;s way,  everything should be annotation-driven. How about scopes support?  I mean @RequestScoped, @SessionScoped? Did you investigate this also? &lt;/p&gt;</comment>
                            <comment id="14322259" author="reta" created="Sun, 15 Feb 2015 23:47:41 +0000"  >&lt;p&gt;Yes, I am definitely agree with you that everything should be auto-discovered (and it is in fact). However, I run into classloader issue you have mentioned and decided to tackle issues one by one (that is where singletons came up, reasonable simplification to make sure it is working). No, I haven&apos;t looked into scopes yet (but I definitely should and will). &lt;/p&gt;

&lt;p&gt;To wrap up: there are couple of different issues we have to solve. The approach I have taken is just to make simplest deployment model working, then address classloader issues, followed by scopes. I hope it makes sense to you, what do you think?&lt;/p&gt;</comment>
                            <comment id="14322426" author="ciapunek" created="Mon, 16 Feb 2015 06:33:36 +0000"  >&lt;p&gt;Indeed. Keep up the good work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14325281" author="reta" created="Wed, 18 Feb 2015 01:45:03 +0000"  >&lt;p&gt;Good news &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I have got the CXF CDI feature working properly on Karaf 3.0.3 (in the simplest scenario right now). I can access JAX-RS services and CDI injections works just fine (deployed using pax-web and pax-cdi). Not sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; if you are using same deployment model but I hope you are.&lt;/p&gt;

&lt;p&gt;So I am moving on to auto-discovery and classpath issues.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="14325733" author="sergey_beryozkin" created="Wed, 18 Feb 2015 11:34:33 +0000"  >&lt;p&gt;Hi, I&apos;ve asked for a clarification re RequestScoped. &lt;br/&gt;
If it were to be supported then it would definitely be a more advanced and IMHO a different issue as supporting it would affect both OSGI and non OSGI deployments. &lt;/p&gt;

&lt;p&gt;We&apos;d most likely have to ensure that these RequestScoped beans are associated with CDI aware org.apache.cxf.jaxrs.lifecycle.ResourceProvider implementations that would delegate to CDI to create an instance per every request (Similarly to SpringResourceFactory class that can be used to support advanced Spring scopes).&lt;br/&gt;
I agree with Andriy that we need to make sure first it just works as expected in simpler cases (the resource bean is a singleton) &lt;/p&gt;

&lt;p&gt;Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="14326011" author="ciapunek" created="Wed, 18 Feb 2015 15:21:44 +0000"  >&lt;p&gt;ok, so maybe... will you have scopes on your roadmap? It would be great when you post here about estimated delivery time. &lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="14326074" author="reta" created="Wed, 18 Feb 2015 15:54:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; I think it would be clear once we get the understanding what it takes to support scopes. We will get back to this shortly.&lt;/p&gt;</comment>
                            <comment id="14326262" author="ciapunek" created="Wed, 18 Feb 2015 17:55:58 +0000"  >&lt;p&gt;I investigated that events of type ServletContextEvent for WeldInitialListener are not fired when request is handled by JAX-RS resource. But for @WebServlet works properly...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://grepcode.com/file/repo1.maven.org/maven2/org.jboss.weld/weld-core/2.2.4.Final/org/jboss/weld/servlet/WeldInitialListener.java/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://grepcode.com/file/repo1.maven.org/maven2/org.jboss.weld/weld-core/2.2.4.Final/org/jboss/weld/servlet/WeldInitialListener.java/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14331955" author="reta" created="Sun, 22 Feb 2015 00:02:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; Ok, so I fixed cxf-integration-cdi OSGi manifest metadata and the classloader issues are gone now. I also switched the example you have attached to use cxf-integration-cdi and it works perfectly (no need for a bridge anymore). Please give it a try (3.1.0-SNAPSHOT). The auto-discovery turns out to be an issue: PAX requires specific &apos;osgi.extender=pax.cdi&apos; declaration to be included into the bundle manifest (I looked into BeanScanner source code). Without it, PAX does not consider bundle to be a &quot;beans bundle&quot; and does not scan it. I am not sure we can workaround it unless the complete Application class is provided (however, if there are no external providers required, everything works fine, the autodiscovery works in the own bundle).  Thoughts?&lt;/p&gt;

&lt;p&gt;I am going to look into scopes right now to understand the problems there.&lt;br/&gt;
Thanks!&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="14332072" author="ciapunek" created="Sun, 22 Feb 2015 07:44:57 +0000"  >&lt;p&gt;Code looks fine. I will check it when I come back to home. But now, scopes. Most powerful feature of CDI for me. I haven&apos;t any proposal for you, what is a real problem or maybe even I am deploying my resources in a bad way. Scopes.support will keep my project simple but without them aghh. To be honest... I am blocked.&lt;/p&gt;</comment>
                            <comment id="14341552" author="ciapunek" created="Sat, 28 Feb 2015 14:30:38 +0000"  >&lt;p&gt;I noticed a problem with using 3.1.0-snapshot version of cxf-integration-cdi:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-02-28 15:20:55,892 | WARN  | pache.cxf.osgi]) | ServletExporter                  | 139 - org.apache.cxf.cxf-rt-transports-http - 3.1.0.SNAPSHOT | Error registering CXF OSGi servlet alias is already in use in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; or another context
org.osgi.service.http.NamespaceException: alias is already in use in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; or another context
	at org.ops4j.pax.web.service.spi.model.ServerModel.addServletModel(ServerModel.java:128)[58:org.ops4j.pax.web.pax-web-spi:3.1.4]
	at org.ops4j.pax.web.service.internal.HttpServiceStarted.registerServlet(HttpServiceStarted.java:206)[59:org.ops4j.pax.web.pax-web-runtime:3.1.4]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In my Karaf assembly,CXF non-spring servlet is registered at &quot;/cxf&quot; after installing feature &apos;cxf-jaxrs&apos;, so we have a collision. Even I have never observed that &apos;CxfCdiServet&apos; is registered but &apos;CxfNonSpringServlet&apos; always.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &amp;lt;plugin&amp;gt;
                &amp;lt;groupId&amp;gt;org.apache.karaf.tooling&amp;lt;/groupId&amp;gt;
                &amp;lt;artifactId&amp;gt;karaf-maven-plugin&amp;lt;/artifactId&amp;gt;
                &amp;lt;configuration&amp;gt;
                    &amp;lt;bootFeatures&amp;gt;
                        &amp;lt;! [...] --&amp;gt;
                        &amp;lt;feature&amp;gt;cxf-jaxrs&amp;lt;/feature&amp;gt;
                    &amp;lt;/bootFeatures&amp;gt;
                &amp;lt;/configuration&amp;gt;
            &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Did you investigated what is an effort to get working CDI scopes with CXF? I think that CXF dispatcher servlet should be listened by &lt;a href=&quot;http://grepcode.com/file/repo1.maven.org/maven2/org.jboss.weld/weld-core/2.2.5.Final/org/jboss/weld/servlet/WeldInitialListener.java#WeldInitialListener&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://grepcode.com/file/repo1.maven.org/maven2/org.jboss.weld/weld-core/2.2.5.Final/org/jboss/weld/servlet/WeldInitialListener.java#WeldInitialListener&lt;/a&gt;&lt;br/&gt;
and scopes should start work.&lt;/p&gt;

&lt;p&gt;I also tried with OpenWebBeans but:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;is uses CDI 1.0&lt;/li&gt;
	&lt;li&gt;when I downgrade CDI to 1.0 in cxf-cdi-bridge/cxf-integration-cdi I am getting stuck on:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-02-28 19:22:44,405 | ERROR | FelixStartLevel  | extender                         | 98 - org.ops4j.pax.cdi.extender 
- 0.11.0 | [CdiExtender(6)] The activate method has thrown an exception                                                 
org.apache.webbeans.proxy.ProxyGenerationException: java.lang.reflect.InvocationTargetException                         
       at org.apache.webbeans.proxy.AbstractProxyFactory.defineAndLoadClass(AbstractProxyFactory.java:275)              
       at org.apache.webbeans.proxy.AbstractProxyFactory.createProxyClass(AbstractProxyFactory.java:185)                
       at org.apache.webbeans.proxy.NormalScopeProxyFactory.createProxyClass(NormalScopeProxyFactory.java:268)          
       at org.apache.webbeans.proxy.NormalScopeProxyFactory.createProxyClass(NormalScopeProxyFactory.java:199)          
       at org.apache.webbeans.proxy.NormalScopeProxyFactory.createNormalScopeProxy(NormalScopeProxyFactory.java:148)    
       at org.apache.webbeans.container.BeanManagerImpl.getReference(BeanManagerImpl.java:727)                          
       at org.apache.webbeans.container.InjectableBeanManager.getReference(InjectableBeanManager.java:153)              
       at com.neva.osgi.cdicxfbridge.JAXRSCdiResourceExtension.load(JAXRSCdiResourceExtension.java:63)                  
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.8.0_31]                                        
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)[:1.8.0_31]                      
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)[:1.8.0_31]              
       at java.lang.reflect.Method.invoke(Method.java:483)[:1.8.0_31]                                                   
       at org.apache.webbeans.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:266)                              
       at org.apache.webbeans.event.NotificationManager.fireEvent(NotificationManager.java:482)                         
       at org.apache.webbeans.container.BeanManagerImpl.fireEvent(BeanManagerImpl.java:446)                             
       at org.apache.webbeans.container.BeanManagerImpl.fireLifecycleEvent(BeanManagerImpl.java:436)                    
       at org.apache.webbeans.config.BeansDeployer.fireAfterDeploymentValidationEvent(BeansDeployer.java:374)           
       at org.apache.webbeans.config.BeansDeployer.deploy(BeansDeployer.java:205)                                       
       at org.apache.webbeans.lifecycle.AbstractLifeCycle.bootstrapApplication(AbstractLifeCycle.java:141)              
       at org.apache.webbeans.lifecycle.AbstractLifeCycle.startApplication(AbstractLifeCycle.java:107)                  
       at org.ops4j.pax.cdi.openwebbeans.impl.OpenWebBeansCdiContainer$1.call(OpenWebBeansCdiContainer.java:106)        
       at org.ops4j.pax.cdi.openwebbeans.impl.OpenWebBeansCdiContainer$1.call(OpenWebBeansCdiContainer.java:100)        
       at org.ops4j.pax.swissbox.core.ContextClassLoaderUtils.doWithClassLoader(ContextClassLoaderUtils.java:60)        
       at org.ops4j.pax.cdi.openwebbeans.impl.OpenWebBeansCdiContainer.createWebBeansContext(OpenWebBeansCdiContainer.ja
va:100)                                                                                                                 
       at org.ops4j.pax.cdi.openwebbeans.impl.OpenWebBeansCdiContainer.doStart(OpenWebBeansCdiContainer.java:146)       
       at org.ops4j.pax.cdi.spi.AbstractCdiContainer.start(AbstractCdiContainer.java:89)                                
       at org.ops4j.pax.cdi.extender.impl.CdiExtender.createContainer(CdiExtender.java:132)[98:org.ops4j.pax.cdi.extende
r:0.11.0]                                                                                                               
       at org.ops4j.pax.cdi.extender.impl.CdiExtender.addingBundle(CdiExtender.java:86)[98:org.ops4j.pax.cdi.extender:0.
11.0]                                                                                                                   
       at org.ops4j.pax.cdi.extender.impl.CdiExtender.addingBundle(CdiExtender.java:44)[98:org.ops4j.pax.cdi.extender:0.
11.0]                                                                                                                   
       at org.osgi.util.tracker.BundleTracker$Tracked.customizerAdding(BundleTracker.java:467)[karaf-org.osgi.core.jar:]
       at org.osgi.util.tracker.BundleTracker$Tracked.customizerAdding(BundleTracker.java:414)[karaf-org.osgi.core.jar:]
       at org.osgi.util.tracker.AbstractTracked.trackAdding(AbstractTracked.java:256)[karaf-org.osgi.core.jar:]         
       at org.osgi.util.tracker.AbstractTracked.trackInitial(AbstractTracked.java:183)[karaf-org.osgi.core.jar:]        
       at org.osgi.util.tracker.BundleTracker.open(BundleTracker.java:156)[karaf-org.osgi.core.jar:]                    
       at org.ops4j.pax.cdi.extender.impl.CdiExtender.activate(CdiExtender.java:64)[98:org.ops4j.pax.cdi.extender:0.11.0
]                                                                                                                       
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.8.0_31]                                        
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)[:1.8.0_31]                      
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)[:1.8.0_31]              
       at java.lang.reflect.Method.invoke(Method.java:483)[:1.8.0_31]                                                   
       at org.apache.felix.scr.impl.helper.BaseMethod.invokeMethod(BaseMethod.java:231)                                 
       at org.apache.felix.scr.impl.helper.BaseMethod.access$500(BaseMethod.java:39)                                    
       at org.apache.felix.scr.impl.helper.BaseMethod$Resolved.invoke(BaseMethod.java:624)                              
       at org.apache.felix.scr.impl.helper.BaseMethod.invoke(BaseMethod.java:508)                                       
       at org.apache.felix.scr.impl.helper.ActivateMethod.invoke(ActivateMethod.java:149)                               
       at org.apache.felix.scr.impl.manager.SingleComponentManager.createImplementationObject(SingleComponentManager.jav
a:315)                                                                                                                  
       at org.apache.felix.scr.impl.manager.SingleComponentManager.createComponent(SingleComponentManager.java:127)     
       at org.apache.felix.scr.impl.manager.SingleComponentManager.getService(SingleComponentManager.java:871)          
       at org.apache.felix.scr.impl.manager.SingleComponentManager.getServiceInternal(SingleComponentManager.java:838)  
       at org.apache.felix.scr.impl.manager.AbstractComponentManager.activateInternal(AbstractComponentManager.java:850)
       at org.apache.felix.scr.impl.manager.AbstractComponentManager.enable(AbstractComponentManager.java:419)          
       at org.apache.felix.scr.impl.config.ConfigurableComponentHolder.enableComponents(ConfigurableComponentHolder.java
:376)                                                                                                                   
       at org.apache.felix.scr.impl.BundleComponentActivator.initialize(BundleComponentActivator.java:172)              
       at org.apache.felix.scr.impl.BundleComponentActivator.&amp;lt;init&amp;gt;(BundleComponentActivator.java:120)                  
       at org.apache.felix.scr.impl.Activator.loadComponents(Activator.java:258)                                        
       at org.apache.felix.scr.impl.Activator.access$000(Activator.java:45)                                             
       at org.apache.felix.scr.impl.Activator$ScrExtension.start(Activator.java:185)                                    
       at org.apache.felix.utils.extender.AbstractExtender.createExtension(AbstractExtender.java:259)                   
       at org.apache.felix.utils.extender.AbstractExtender.modifiedBundle(AbstractExtender.java:232)                    
       at org.osgi.util.tracker.BundleTracker$Tracked.customizerModified(BundleTracker.java:479)[karaf-org.osgi.core.jar
:]                                                                                                                      
       at org.osgi.util.tracker.BundleTracker$Tracked.customizerModified(BundleTracker.java:414)[karaf-org.osgi.core.jar
:]                                                                                                                      
       at org.osgi.util.tracker.AbstractTracked.track(AbstractTracked.java:232)[karaf-org.osgi.core.jar:]               
       at org.osgi.util.tracker.BundleTracker$Tracked.bundleChanged(BundleTracker.java:443)[karaf-org.osgi.core.jar:]   
       at org.apache.felix.framework.util.EventDispatcher.invokeBundleListenerCallback(EventDispatcher.java:868)[org.apa
che.felix.framework-4.2.1.jar:]                                                                                         
       at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:789)[org.apache.feli
x.framework-4.2.1.jar:]                                                                                                 
       at org.apache.felix.framework.util.EventDispatcher.fireBundleEvent(EventDispatcher.java:514)[org.apache.felix.fra
mework-4.2.1.jar:]                                                                                                      
       at org.apache.felix.framework.Felix.fireBundleEvent(Felix.java:4403)[org.apache.felix.framework-4.2.1.jar:]      
       at org.apache.felix.framework.Felix.startBundle(Felix.java:2092)[org.apache.felix.framework-4.2.1.jar:]          
       at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:955)                                              
       at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:942)                                              
       at org.apache.karaf.features.internal.FeaturesServiceImpl.cleanUpOnFailure(FeaturesServiceImpl.java:531)         
       at org.apache.karaf.features.internal.FeaturesServiceImpl.installFeatures(FeaturesServiceImpl.java:478)          
       at org.apache.karaf.features.internal.BootFeaturesInstaller.installBootFeatures(BootFeaturesInstaller.java:92)   
       at org.apache.karaf.features.internal.BootFeaturesInstaller.start(BootFeaturesInstaller.java:76)                 
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.8.0_31]                                        
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)[:1.8.0_31]                      
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)[:1.8.0_31]              
       at java.lang.reflect.Method.invoke(Method.java:483)[:1.8.0_31]                                                   
       at org.apache.aries.blueprint.utils.ReflectionUtils.invoke(ReflectionUtils.java:297)[20:org.apache.aries.blueprin
t.core:1.4.2]                                                                                                           
       at org.apache.aries.blueprint.container.BeanRecipe.invoke(BeanRecipe.java:958)[20:org.apache.aries.blueprint.core
:1.4.2]                                                                                                                 
       at org.apache.aries.blueprint.container.BeanRecipe.runBeanProcInit(BeanRecipe.java:712)[20:org.apache.aries.bluep
rint.core:1.4.2]                                                                                                        
       at org.apache.aries.blueprint.container.BeanRecipe.internalCreate2(BeanRecipe.java:824)[20:org.apache.aries.bluep
rint.core:1.4.2]                                                                                                        
       at org.apache.aries.blueprint.container.BeanRecipe.internalCreate(BeanRecipe.java:787)[20:org.apache.aries.bluepr
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.core:1.4.2]                                                                                                         
       at org.apache.aries.blueprint.di.AbstractRecipe$1.call(AbstractRecipe.java:79)[20:org.apache.aries.blueprint.core
:1.4.2]                                                                                                                 
       at java.util.concurrent.FutureTask.run(FutureTask.java:266)[:1.8.0_31]                                           
       at org.apache.aries.blueprint.di.AbstractRecipe.create(AbstractRecipe.java:88)[20:org.apache.aries.blueprint.core
:1.4.2]                                                                                                                 
       at org.apache.aries.blueprint.container.BlueprintRepository.createInstances(BlueprintRepository.java:245)[20:org.
apache.aries.blueprint.core:1.4.2]                                                                                      
       at org.apache.aries.blueprint.container.BlueprintRepository.createAll(BlueprintRepository.java:183)[20:org.apache
.aries.blueprint.core:1.4.2]                                                                                            
       at org.apache.aries.blueprint.container.BlueprintContainerImpl.instantiateEagerComponents(BlueprintContainerImpl.
java:682)[20:org.apache.aries.blueprint.core:1.4.2]                                                                     
       at org.apache.aries.blueprint.container.BlueprintContainerImpl.doRun(BlueprintContainerImpl.java:377)[20:org.apac
he.aries.blueprint.core:1.4.2]                                                                                          
       at org.apache.aries.blueprint.container.BlueprintContainerImpl.run(BlueprintContainerImpl.java:269)[20:org.apache
.aries.blueprint.core:1.4.2]                                                                                            
       at org.apache.aries.blueprint.container.BlueprintExtender.createContainer(BlueprintExtender.java:294)[20:org.apac
he.aries.blueprint.core:1.4.2]                                                                                          
       at org.apache.aries.blueprint.container.BlueprintExtender.createContainer(BlueprintExtender.java:263)[20:org.apac
he.aries.blueprint.core:1.4.2]                                                                                          
       at org.apache.aries.blueprint.container.BlueprintExtender.modifiedBundle(BlueprintExtender.java:253)[20:org.apach
e.aries.blueprint.core:1.4.2]                                                                                           
       at org.apache.aries.util.tracker.hook.BundleHookBundleTracker$Tracked.customizerModified(BundleHookBundleTracker.
java:500)[14:org.apache.aries.util:1.1.0]                                                                               
       at org.apache.aries.util.tracker.hook.BundleHookBundleTracker$Tracked.customizerModified(BundleHookBundleTracker.
java:433)[14:org.apache.aries.util:1.1.0]                                                                               
       at org.apache.aries.util.tracker.hook.BundleHookBundleTracker$AbstractTracked.track(BundleHookBundleTracker.java:
725)[14:org.apache.aries.util:1.1.0]                                                                                    
       at org.apache.aries.util.tracker.hook.BundleHookBundleTracker$Tracked.bundleChanged(BundleHookBundleTracker.java:
463)[14:org.apache.aries.util:1.1.0]                                                                                    
       at org.apache.aries.util.tracker.hook.BundleHookBundleTracker$BundleEventHook.event(BundleHookBundleTracker.java:
422)[14:org.apache.aries.util:1.1.0]                                                                                    
       at org.apache.felix.framework.util.SecureAction.invokeBundleEventHook(SecureAction.java:1103)[org.apache.felix.fr
amework-4.2.1.jar:]                                                                                                     
       at org.apache.felix.framework.util.EventDispatcher.createWhitelistFromHooks(EventDispatcher.java:695)[org.apache.
felix.framework-4.2.1.jar:]                                                                                             
       at org.apache.felix.framework.util.EventDispatcher.fireBundleEvent(EventDispatcher.java:483)[org.apache.felix.fra
mework-4.2.1.jar:]                                                                                                      
       at org.apache.felix.framework.Felix.fireBundleEvent(Felix.java:4403)[org.apache.felix.framework-4.2.1.jar:]      
       at org.apache.felix.framework.Felix.startBundle(Felix.java:2092)[org.apache.felix.framework-4.2.1.jar:]          
       at org.apache.felix.framework.Felix.setActiveStartLevel(Felix.java:1291)[org.apache.felix.framework-4.2.1.jar:]  
       at org.apache.felix.framework.FrameworkStartLevelImpl.run(FrameworkStartLevelImpl.java:304)[org.apache.felix.fram
ework-4.2.1.jar:]                                                                                                       
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)[:1.8.0_31]                                                              
Caused by: java.lang.reflect.InvocationTargetException                                                                  
       at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)                                                   
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)[:1.8.0_31]              
       at java.lang.reflect.Method.invoke(Method.java:483)[:1.8.0_31]                                                   
       at org.apache.webbeans.proxy.AbstractProxyFactory.defineAndLoadClass(AbstractProxyFactory.java:268)              
       ... 105 more                                                                                                     
Caused by: java.lang.NoClassDefFoundError: org/apache/webbeans/proxy/OwbNormalScopeProxy                                
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass1(Native Method)[:1.8.0_31]                                                  
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:760)[:1.8.0_31]                                            
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:642)[:1.8.0_31]                                            
       ... 109 more                                                                                                     
Caused by: java.lang.ClassNotFoundException: org.apache.webbeans.proxy.OwbNormalScopeProxy not found by org.apache.cxf.c
xf-core [125]                                                                                                           
       at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1532)       
       at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:75)                              
       at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1955)           
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:357)[:1.8.0_31]                                              
       ... 112 more                                                                                                     
2015-02-28 19:22:44,439 | ERROR | FelixStartLevel  | extender                         | 98 - org.ops4j.pax.cdi.extender 
- 0.11.0 | [CdiExtender(6)] Failed creating the component instance; see log &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; reason                                  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; &lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I have no idea how to go forward... &lt;/p&gt;</comment>
                            <comment id="14341751" author="reta" created="Sat, 28 Feb 2015 19:49:05 +0000"  >&lt;p&gt;Thanks a lot for the feedback, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt;. Yes, I can reproduce &quot;alias is already in use in this or another context&quot;  exception as well, I am going to fix it. I am looking into scopes now, trying to understand why everything works fine in regular CDI containers but not when running inside OSGi one. I don&apos;t think we have to introduce any Weld-specific code into the CDI extension, it is supposed to work transparently in any CDI 1.x container. I am trying to figure out what the cause is. Thanks a lot for you investigations, very helpful  and much appreciated.&lt;/p&gt;

&lt;p&gt;I will update you as soon as I have any breakthrough with that.&lt;br/&gt;
Thank you!&lt;/p&gt;</comment>
                            <comment id="14341777" author="ciapunek" created="Sat, 28 Feb 2015 21:01:50 +0000"  >&lt;p&gt;Scopes in servlets which are registered via annotation @WebServlet are working properly (they are registered via pax-web-extender).&lt;br/&gt;
But CxfNonSpringServlet is registered via HttpService by hand and this is a main reason that scopes does not work.&lt;/p&gt;</comment>
                            <comment id="14341796" author="ciapunek" created="Sat, 28 Feb 2015 21:47:42 +0000"  >&lt;p&gt;After discovering pax-web-extender, I am convinced that the only way to get CXF integrated with pax-cdi / pax-web is to rewrite CXFNonSpringServlet to be registered automatically via annotation (instead of in org/apache/cxf/transport/http/osgi/ServletExporter.java).&lt;/p&gt;

&lt;p&gt;We only need something like following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@WebServlet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/app&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AppServlet &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CxfNonSpringServlet {
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I tried to test it but it is conflicting with built-in servlet registered at &apos;/cxf&apos; (and there is no way to disable it).&lt;/p&gt;</comment>
                            <comment id="14342415" author="ciapunek" created="Sun, 1 Mar 2015 19:46:46 +0000"  >&lt;p&gt;I also checked @Provider support. Seems to work but I have a question.&lt;br/&gt;
I wrote a global exception handler:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Provider
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;GlobalExceptionMapper &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ExceptionMapper&amp;lt;Exception&amp;gt; {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Response toResponse(Exception exception) {
         &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Assume that I have a resource with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @GET
    @Produces(&lt;span class=&quot;code-quote&quot;&gt;&quot;text/html&quot;&lt;/span&gt;)
    @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/dashboard&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getDashboard() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ResourceException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Test!&quot;&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; exception is not catched by exceptionmapper
&lt;/span&gt;        }

        myService.doSomeStuff(); &lt;span class=&quot;code-comment&quot;&gt;// but exception thrown in some deeper place is catched&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I suppose it is related with some interceptor (&lt;a href=&quot;http://cxf.apache.org/docs/jax-rs-basics.html#JAX-RSBasics-MappingexceptionsthrownfromCXFinterceptors&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/docs/jax-rs-basics.html#JAX-RSBasics-MappingexceptionsthrownfromCXFinterceptors&lt;/a&gt;). &quot;add org.apache.cxf.jaxrs.interceptor.JAXRSOutExceptionMapperInterceptor to the list of out interceptors.&quot; I am not sure if it is actual solution for my case (because this class is now deprecated?). &lt;/p&gt;

&lt;p&gt;To sum up, how to catch all exceptions properly and setup interceptors configuration using integration extension? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14357695" author="reta" created="Wed, 11 Mar 2015 22:05:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; I haven&apos;t looked into exception mappers yet, but the issue with @RequestScoped became apparent now. You basically identified the cause: CXF ServletExporter conflicts with the way pax-cdi-web-weld exports HTTP endpoints. Because of this conflict, Weld doesn&apos;t understand when request has been started and finished, leaving  context for @RequestScoped inactive. The duplicate alias issue is also caused by ServletExporter. It is possible to resolve the alias conflicts with &amp;lt;Web-ContextPath&amp;gt;/&amp;lt;path&amp;gt;&amp;lt;/Web-ContextPath&amp;gt; instruction, however the CXF endpoints obviously are not going to work after that. At this moment, I am not sure how this conflict could be sorted out but I am continuing to work on the solution.&lt;/p&gt;</comment>
                            <comment id="14357704" author="ciapunek" created="Wed, 11 Mar 2015 22:13:22 +0000"  >&lt;p&gt;So I am glad that I could help &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; For me, any working solution that will integrate this 3 libs all together is appreciated. &lt;/p&gt;</comment>
                            <comment id="14357710" author="reta" created="Wed, 11 Mar 2015 22:17:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; Thank you a lot. Yes, this is the goal we aim for as well. &lt;/p&gt;</comment>
                            <comment id="14358763" author="reta" created="Thu, 12 Mar 2015 14:52:04 +0000"  >&lt;p&gt;Ok, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt;, I have two solutions for you. For both of them, you need web.xml in src/main/webapp&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;web-app version=&lt;span class=&quot;code-quote&quot;&gt;&quot;3.0&quot;&lt;/span&gt; xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://java.sun.com/xml/ns/javaee&quot;&lt;/span&gt;
	&lt;span class=&quot;code-keyword&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;&amp;gt;

	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;CXFServlet&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;display-name&amp;gt;&lt;/span&gt;CXF Servlet&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/display-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;org.apache.cxf.cdi.CXFCdiServlet&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;    
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;load-on-startup&amp;gt;&lt;/span&gt;1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/load-on-startup&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;CXFServlet&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/*&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/web-app&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Next, you have to include _wab directive into your bundle manifest:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Web-ContextPath&amp;gt;&lt;/span&gt;/cxf&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Web-ContextPath&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;_wab&amp;gt;&lt;/span&gt;src/main/webapp&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/_wab&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, if you would like to use /cxf as a context path, you have to disable CXF servlet registration by adding org.apache.cxf.osgi.http.transport.disable=true to Karaf&apos;s system.properties file. However, it is not really necessary if you could use different context path, f.e.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Web-ContextPath&amp;gt;&lt;/span&gt;/cdi&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Web-ContextPath&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;_wab&amp;gt;&lt;/span&gt;src/main/webapp&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/_wab&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With that, @RequestScoped JAX-RS resources are working just fine. Please let me know if it works for you.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="14358807" author="ciapunek" created="Thu, 12 Mar 2015 15:16:15 +0000"  >&lt;p&gt;Sounds awesome. I will test it in the evening. It would  be great that after our discovery official docs for integration will be also updated. &lt;/p&gt;

&lt;p&gt;The last thing. How to catch all exceptions in jaxrs resources? / according to previous comment. &lt;/p&gt;</comment>
                            <comment id="14358819" author="reta" created="Thu, 12 Mar 2015 15:25:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; Definitely, the docs will be updated once I get your &quot;it works&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I will look into exception mapper later today / tomorrow, will get back to you with that. Thanks.&lt;/p&gt;</comment>
                            <comment id="14359457" author="ciapunek" created="Thu, 12 Mar 2015 21:27:54 +0000"  >&lt;p&gt;I cannot deploy it correctly. Could you pack your working sample to ZIP and share it with me? :&amp;gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-03-12 22:35:25,171 | ERROR | FelixStartLevel  | WebAppPublisher                  | 62 - org.ops4j.pax.web.pax-web-e
xtender-war - 3.1.4 | Error deploying web application                                                                   
org.ops4j.lang.Ops4jException: org.jboss.weld.exceptions.DeploymentException: WELD-001408: Unsatisfied dependencies &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 
type Bus with qualifiers @Default                                                                                       
  at injection point [BackedAnnotatedParameter] Parameter 1 of [BackedAnnotatedMethod] @Inject &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; org.apache.cxf.cdi
.CXFCdiServlet.setBus(Bus)                                                                                              
  at org.apache.cxf.cdi.CXFCdiServlet.setBus(CXFCdiServlet.java:0)                                                      
                                                                                                                        
       at org.ops4j.pax.cdi.weld.impl.WeldCdiContainer.doStart(WeldCdiContainer.java:99)                                
       at org.ops4j.pax.cdi.spi.AbstractCdiContainer.start(AbstractCdiContainer.java:89)                                
       at org.ops4j.pax.cdi.web.weld.impl.WeldServletContextListener.contextInitialized(WeldServletContextListener.java:
53)                                                                                                                     
       at org.ops4j.pax.web.service.jetty.internal.HttpServiceContext$3.call(HttpServiceContext.java:293) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14359504" author="reta" created="Thu, 12 Mar 2015 21:57:50 +0000"  >&lt;p&gt;Yeah, sure, please take a look on module-jax-rs.zip (attachment). Installed features for Apache CXF is 3.1.0-SNAPSHOT, PAX are:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;pax-cdi-1.2              | 0.11.0           | x         | org.ops4j.pax.cdi-0.11.0 | Provide CDI 1.2 support
pax-cdi-1.2-weld         | 0.11.0           | x         | org.ops4j.pax.cdi-0.11.0 | Weld CDI 1.2 support
pax-cdi-1.2-web          | 0.11.0           | x         | org.ops4j.pax.cdi-0.11.0 | Web CDI 1.2 support
pax-cdi-1.2-web-weld     | 0.11.0           | x         | org.ops4j.pax.cdi-0.11.0 | Weld Web CDI 1.2 support
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14359510" author="ciapunek" created="Thu, 12 Mar 2015 22:01:49 +0000"  >&lt;p&gt;Thanks a lot, a topic for tomorrow. It&apos;s quite late in PL. Good night &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14361007" author="reta" created="Fri, 13 Mar 2015 19:49:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; With respect to exception mapper, you are doing everything correctly. I am sure, once you get the CXFCdiServlet properly configured, it is going to work. I have tested it and exception mapper is being called every time when exception is being thrown.&lt;/p&gt;</comment>
                            <comment id="14370366" author="reta" created="Thu, 19 Mar 2015 23:42:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; Did you have a chance to validate the servlet approach? Thanks.&lt;/p&gt;</comment>
                            <comment id="14371508" author="ciapunek" created="Fri, 20 Mar 2015 15:46:30 +0000"  >&lt;p&gt;I tried with result as above. I also compared it with your sample but we have quite different project structure and I have to spend more time to investigate what is wrong. Actually I do not have such time. I will back to topic in a week, I think.&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="14482108" author="reta" created="Mon, 6 Apr 2015 22:43:11 +0000"  >&lt;p&gt;Added documentation: &lt;a href=&quot;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=55153391&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=55153391&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14483616" author="ciapunek" created="Tue, 7 Apr 2015 17:54:10 +0000"  >&lt;p&gt;TESTED! Works great. Thank you very much for ready to go karaf feature. As a workaround I built locally CXF 3.1.0 snapshot. When will it release?&lt;/p&gt;

&lt;p&gt;However @RequestScoped still not work due to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.jboss.weld.context.ContextNotActiveException: WELD-001303: No active contexts &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; scope type javax.enterprise.context.RequestScoped
	at org.jboss.weld.manager.BeanManagerImpl.getContext(BeanManagerImpl.java:687)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/system&quot;&lt;/span&gt;)
@RequestScoped
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SystemController {
    @GET
    @Produces(&lt;span class=&quot;code-quote&quot;&gt;&quot;text/html&quot;&lt;/span&gt;)
    @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Response getHome() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; URISyntaxException {
       &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yes, dispatcher / CxfCdiServlet is deployed via web.xml . &lt;/p&gt;</comment>
                            <comment id="14484207" author="reta" created="Tue, 7 Apr 2015 22:20:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; Thanks a lot for feedback. We hope that 3.1 is going to be released very soon. The @RequestScoped should work with CxfCdiServlet and context path (PAX CDI is responsible for that). Could you please reattach the sample project with your latest changes? I can take a look on why it does not find the context.&lt;/p&gt;</comment>
                            <comment id="14484864" author="ciapunek" created="Wed, 8 Apr 2015 07:07:50 +0000"  >&lt;p&gt;Project attached. Then try to add @RequestScoped to some resource in adm module, for instance to SystemController. &lt;/p&gt;

&lt;p&gt;(to build all you will also require &lt;a href=&quot;https://github.com/neva-dev/osgi&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/neva-dev/osgi&lt;/a&gt;) &lt;br/&gt;
Thanks for support. Too &#9786;&lt;/p&gt;</comment>
                            <comment id="14487228" author="reta" created="Thu, 9 Apr 2015 11:50:37 +0000"  >&lt;p&gt;Thanks a lot for the project &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt;. I am able to reproduce the same issue with @RequestScoped, working on fixing that.&lt;/p&gt;</comment>
                            <comment id="14488525" author="ciapunek" created="Thu, 9 Apr 2015 23:46:32 +0000"  >&lt;p&gt;No problem. Waiting for report. &lt;/p&gt;</comment>
                            <comment id="14488655" author="reta" created="Fri, 10 Apr 2015 00:48:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; It seems I figured out what is going on here. There are basically two issues:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;all your services should be accessed by this URL pattern: http://&amp;lt;host&amp;gt;:8181/&amp;lt;Web-ContextPath&amp;gt;/..., please notice no &lt;b&gt;cxf&lt;/b&gt; there, for example: &lt;a href=&quot;http://localhost:8181/adm/adm/system/dashboard&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8181/adm/adm/system/dashboard&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;you need to add webapp (the same you have with REST servlet) and &lt;b&gt;_wab&lt;/b&gt; instruction to your services (com.neva.hydra.platform.adm f.e., I attached this module as adm-with-webxml.zip for reference)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With that, everything CDI/CXF related is going to work. Please, do not use &lt;b&gt;cxf&lt;/b&gt; context path, I know it is confusing but you can disable it if you wish. Please let me know if you succeeded.&lt;/p&gt;</comment>
                            <comment id="14488966" author="ciapunek" created="Fri, 10 Apr 2015 05:45:19 +0000"  >&lt;p&gt;So I am forced to copy same cxfcdiservlet servlet registration for each module? Quite annoying isn&apos;t it? My approach almost worked, only scopes were a defect. Now I am thinking about manual bundle scanning for jaxrs resources and then putting them into one @WebApplication in rest module. It will be easier and I achieve shorter URLs&lt;/p&gt;</comment>
                            <comment id="14489243" author="sergey_beryozkin" created="Fri, 10 Apr 2015 09:25:19 +0000"  >&lt;p&gt;CXFCDIServlet is what enables a CXF CDI integration for a given module hence is is needed if CXF CDI integration is required.&lt;/p&gt;

&lt;p&gt;Andriy, IMHO you&apos;ve done a massive work here, thanks. &lt;/p&gt;
</comment>
                            <comment id="14489369" author="sergey_beryozkin" created="Fri, 10 Apr 2015 10:52:23 +0000"  >&lt;p&gt;Hi Andriy, re your last comment, why there has to be a duplicate &quot;/adm&quot; segment, &quot;http://localhost:8181/adm/adm/system/dashboard&quot; ?&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14489389" author="reta" created="Fri, 10 Apr 2015 11:16:23 +0000"  >&lt;p&gt;Hi Sergey,&lt;/p&gt;

&lt;p&gt;The duplicate segment comes from application configuration itself. The root web context is set to /adm plus the JAX-RS application also is configured with application path /adm, so it gives /adm/adm.&lt;br/&gt;
It could be simplified but it has been done this way by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="14489391" author="ciapunek" created="Fri, 10 Apr 2015 11:16:40 +0000"  >&lt;p&gt;first prefix is from &quot;Web-ContextPath&quot;, second is from @WebApplication annotation. So to achieve just &quot;/adm&quot; prefix.. I should change only @WebApplication(&quot;/&quot;) and thats all? :&amp;gt;&lt;/p&gt;

&lt;p&gt;sounds cool. thx&lt;/p&gt;</comment>
                            <comment id="14489402" author="reta" created="Fri, 10 Apr 2015 11:26:14 +0000"  >&lt;p&gt;It sounds like a good feedback and yet another area to improve. However, I would be very careful with &quot;My approach almost worked&quot;, because the issue with @RequestScoped gives you an impression that it is mostly working. The core different here is that &lt;b&gt;/cxf&lt;/b&gt; endpoint is bootstrapped by Apache CXF itself, but web endpoints are managed by PAX Web which also in this case includes PAX CDI. The &lt;b&gt;/cxf&lt;/b&gt; context path does not trigger many contex/request/session related events and happens to work by the fact that @ApplicationScoped beans are initialized globally and always present. &lt;/p&gt;

&lt;p&gt;But if you look on that closely, it is not much changes (and no code changes), just configuration (web.xml). Nonetheless, you should be able to use all CDI capabilities.&lt;br/&gt;
Does it make sense?&lt;/p&gt;</comment>
                            <comment id="14489404" author="reta" created="Fri, 10 Apr 2015 11:26:39 +0000"  >&lt;p&gt;Yep &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; As simple as that &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14489410" author="ciapunek" created="Fri, 10 Apr 2015 11:29:27 +0000"  >&lt;p&gt;Of course I will test it, but guys maybe it&apos;s time for ending this ticket? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;br/&gt;
To sum up, big thank you.&lt;/p&gt;</comment>
                            <comment id="14489467" author="reta" created="Fri, 10 Apr 2015 11:46:04 +0000"  >&lt;p&gt;Thank you! Closing ....&lt;/p&gt;</comment>
                            <comment id="14489521" author="sergey_beryozkin" created="Fri, 10 Apr 2015 12:27:35 +0000"  >&lt;p&gt;I wonder if Krystian has a good point about having a default CXF servlet CDI-aware if a CDI runtime is available. It can be very difficult to do though. A default servlet with &quot;/cxf&quot; is created at a CXF Http Transport initialization time so at that point of time we do not know if it will be JAX-WS or JAX-RS, etc. Might be worth investigating in a longer term if a servlet with CDI capabilities can be created by default without being JAX-RS or JAX-WS specific but may be it is out of CXF scope (TomEE and other higher-level containers might be a better alternative)&lt;/p&gt;</comment>
                            <comment id="14489897" author="ciapunek" created="Fri, 10 Apr 2015 16:37:40 +0000"  >&lt;p&gt;Hmmm &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Now I have endpoint uniqueness problem:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: org.apache.cxf.service.factory.ServiceConstructionException: There is an endpoint already running on /.
	at org.apache.cxf.jaxrs.JAXRSBindingFactory.addListener(JAXRSBindingFactory.java:85)
	at org.apache.cxf.endpoint.ServerImpl.start(ServerImpl.java:123)
	at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:206)
	... 81 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because I have:&lt;/p&gt;

&lt;p&gt;1) module adm&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Web-ContextPath: /adm&lt;/li&gt;
	&lt;li&gt;@WebApplication(&quot;/&quot;)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;2) module core&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Web-ContextPath: /core&lt;/li&gt;
	&lt;li&gt;@WebApplication(&quot;/&quot;) &amp;lt;- here we have a problem..&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I have to have &quot;/adm/adm&quot; and &quot;/core/core&quot; ? ;(&lt;/p&gt;</comment>
                            <comment id="14490537" author="reta" created="Fri, 10 Apr 2015 23:26:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ciapunek&quot; class=&quot;user-hover&quot; rel=&quot;ciapunek&quot;&gt;ciapunek&lt;/a&gt; The time has come &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; As &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; suggested, please disable Apache CXF HTTP service by adding to Karaf&apos;s etc/system.properties following setting: &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.cxf.osgi.http.transport.disable=true&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14490550" author="reta" created="Fri, 10 Apr 2015 23:39:46 +0000"  >&lt;p&gt;Absolutely. As his right next comment shows off, we should rethink a bit the way standard Apache CXF HTTP service registration works, I agree with you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12724417" name="adm-with-webxml.zip" size="82659" author="reta" created="Fri, 10 Apr 2015 00:48:55 +0000"/>
                            <attachment id="12723862" name="appcia-hydra-fcf9ff603e4a.zip" size="137328" author="ciapunek" created="Wed, 8 Apr 2015 07:07:50 +0000"/>
                            <attachment id="12699426" name="hydra.tar.gz" size="2668722" author="ciapunek" created="Wed, 18 Feb 2015 05:55:48 +0000"/>
                            <attachment id="12704269" name="module-jax-rs.zip" size="26023" author="reta" created="Thu, 12 Mar 2015 21:55:49 +0000"/>
                            <attachment id="12694319" name="screenshot-1.png" size="66319" author="ciapunek" created="Sat, 24 Jan 2015 01:27:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24r07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>