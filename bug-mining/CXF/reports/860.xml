<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:45:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-3367] SOAPAction value not extracted in the inbound processing if the header name does not match exactly &quot;SOAPAction&quot;</title>
                <link>https://issues.apache.org/jira/browse/CXF-3367</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The inbound processing uses org.apache.cxf.binding.soap.interceptor.SoapActionInInterceptor to extract the SOAPAction header from the protocol header and put it in the message&apos;s property.The extraction code looks for the exact string &quot;SOAPAction&quot; in the protocol header instead of looking for the soap action header in the case-insenstive way.&lt;/p&gt;

&lt;p&gt;The inbound processing initially converts the names of the transport headers from the web container using HttpHeaderHelper. Later, the converted names are stored in a plain map which is passed as the PROTOCOL_HEADERS property. So, if the soap action header is provided as &quot;SOAPAction&quot; or &quot;soapaction&quot; from the web container, this header is stored with key &quot;SOAPAction&quot; and it can be retrieved later. However, if the name is provided using different mixed casing, it is stored with that name and it can only be retrieved using this exact key.&lt;/p&gt;

&lt;p&gt;Initially, I thought we could change SOAPActionInInterceptor locally to look for the soapaction header. But this will not solve other potential problems with the current map.&lt;/p&gt;

&lt;p&gt;So, instead of just changing the SOAPActionInInterceptor, I am in favor of changing the implementation of the PROTOCOL_HEADERS map to support the case-insensitive lookup while preserving the original keys in the map.&lt;/p&gt;

&lt;p&gt;Another reason favoring this approach is that the current case-sensitive map can have a few other problems. For example,  the map currently contains two Content-Type headers after it is created by AbstractHTTPDestination (over Jetty): one with &quot;content-type&quot; and the other with &quot;Content-Type&quot;. And this is confusing and may lead to some conflicts. Another problem is the extraction problem for other headers when they are spelled in different mixed casing when they are passed.&lt;/p&gt;

&lt;p&gt;So, I think we should use a specific map class that matches the current interface but supports the case-insensitive lookup while preserving the original case sensitive keys. The attached ProtocolHeaders class satisfies this requirement. Its unit test class ProtocolHeadersTest is also attached.&lt;/p&gt;

&lt;p&gt;This class can be used in AbstractHTTPDestination to create the correct protocol headers map. I added a test case AbstractHTTPDestinationTest to check the extraction of the headers into the protocol headers map. The svn diff of 2.3.2 are attached.&lt;/p&gt;

&lt;p&gt;Please take a look at the files and let me know how you think.&lt;br/&gt;
Thanks.&lt;/p&gt;

&lt;p&gt;Regards, aki&lt;/p&gt;</description>
                <environment></environment>
        <key id="12499761">CXF-3367</key>
            <summary>SOAPAction value not extracted in the inbound processing if the header name does not match exactly &quot;SOAPAction&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="ay">Akitoshi Yoshida</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Feb 2011 21:07:56 +0000</created>
                <updated>Mon, 18 Apr 2011 12:42:22 +0000</updated>
                            <resolved>Tue, 1 Mar 2011 15:49:24 +0000</resolved>
                                    <version>2.3.2</version>
                                    <fixVersion>2.4</fixVersion>
                    <fixVersion>2.3.4</fixVersion>
                                    <component>Soap Binding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="14400">4h</timeoriginalestimate>
                            <timeestimate seconds="14400">4h</timeestimate>
                                        <comments>
                            <comment id="12999571" author="ay" created="Fri, 25 Feb 2011 21:09:44 +0000"  >&lt;p&gt;forgot to make a back reference to the mail thread&lt;br/&gt;
&lt;a href=&quot;http://cxf.547215.n5.nabble.com/SOAP-header-wsdl2java-issue-td3399058.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.547215.n5.nabble.com/SOAP-header-wsdl2java-issue-td3399058.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13000188" author="ay" created="Mon, 28 Feb 2011 09:41:21 +0000"  >&lt;p&gt;diff_rt_transports.txt - svn diff of 2.3.2 rt/transports to add a new unit test&lt;/p&gt;

&lt;p&gt;ProtocolHeaders.tar - ProtocolHeaders.java and ProtocolHeadersTest.java&lt;/p&gt;</comment>
                            <comment id="13000676" author="dkulp" created="Tue, 1 Mar 2011 03:08:21 +0000"  >
&lt;p&gt;I just made a commit to trunk that goes a slightly different route than this.   I&apos;ve pretty much gone through the entire code and made sure the PROTOCOL_HEADERS are always set to a TreeMap that is set for case insensitive compares.   That should completely solve this.&lt;/p&gt;

&lt;p&gt;That said, due to refactoring on trunk, it may take a little time to port it to the 2.3 branch.   I&apos;ll do that tomorrow.&lt;/p&gt;</comment>
                            <comment id="13000924" author="dkulp" created="Tue, 1 Mar 2011 15:49:24 +0000"  >&lt;p&gt;&lt;br/&gt;
This should now be fixed.   I&apos;d appreciate testing with the 2.3.4-SNAPSHOT after tomorrow&apos;s builds (or from your own SVN checkout) just to make sure.   The merge from trunk -&amp;gt; 2.3.x was bit complicated and I may have missed something.&lt;/p&gt;</comment>
                            <comment id="13002554" author="sapakiy@googlemail.com" created="Fri, 4 Mar 2011 11:55:37 +0000"  >&lt;p&gt;Hi Daniel,&lt;br/&gt;
thanks for this change. I agree that the tree set is a better approach&lt;br/&gt;
as we don&apos;t have so many entries and the binary search is cheaper than&lt;br/&gt;
the cost of maintaining two hashmaps and running string conversions.&lt;/p&gt;

&lt;p&gt;I tested 2.3.x-fixed (2.3.4-SNAPSHOT) today. I needed to change my&lt;br/&gt;
AbstractHTTPDestinationTest that I attached to the ticket.&lt;br/&gt;
That one was failing in 2.3.4-SNAPSHOT because the mocked&lt;br/&gt;
ServletRequest class was expecting a method call which was no longer&lt;br/&gt;
called in the 2.3.4 code. So I needed to adjust this mock class.&lt;/p&gt;

&lt;p&gt;I haven&apos;t tried the trunk code. This test class for 2.3.x doesn&apos;t&lt;br/&gt;
match the signature of 2.4.0-SNAPSHOT and I can&apos;t directly use it to&lt;br/&gt;
test it. I can create a test case.&lt;/p&gt;

&lt;p&gt;Should I attach them to this resolved ticket or send them to you by mail?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;Regards, aki&lt;/p&gt;
</comment>
                            <comment id="13002570" author="ay" created="Fri, 4 Mar 2011 12:43:25 +0000"  >&lt;p&gt;Hi Daniel,&lt;br/&gt;
I also tested the trunk 2.4.0-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching test_patches.tar.gz containing the test classes for 2.3.x and trunk &lt;br/&gt;
   branches/2.3.x-fixes - AbstractHTTPDestinationTest.java&lt;br/&gt;
   trunk                - HeadersTest.java&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;</comment>
                            <comment id="13002830" author="dkulp" created="Fri, 4 Mar 2011 21:40:16 +0000"  >&lt;p&gt;&lt;br/&gt;
Testcase patches applied to both branches.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12472158" name="ProtocolHeaders.tar.gz" size="1893" author="ay" created="Mon, 28 Feb 2011 09:41:21 +0000"/>
                            <attachment id="12472157" name="diff_rt.transports.txt.gz" size="1992" author="ay" created="Mon, 28 Feb 2011 09:41:21 +0000"/>
                            <attachment id="12472661" name="test_patches.tar.gz" size="2062" author="ay" created="Fri, 4 Mar 2011 12:43:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46859</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i145f3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>