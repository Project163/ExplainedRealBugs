<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:38:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8556] Null AbstractEndpointFactory Properties Interferes with Class-Level PathParam When Creating Proxies with Defined ClientState</title>
                <link>https://issues.apache.org/jira/browse/CXF-8556</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;A service in question needs to be reachable via multiple paths. The &lt;tt&gt;@Path&lt;/tt&gt;&#160;param allows for regex matching on a class-level like the following: &lt;tt&gt;@Path(&quot;/{a:cat|dog}&quot;)&lt;/tt&gt;. The class in which this annotation is used will correctly take requests at either &lt;tt&gt;/cat&lt;/tt&gt;&#160;or &lt;tt&gt;/dog&lt;/tt&gt;. A class-level &lt;tt&gt;@PathParam&lt;/tt&gt;&#160;is created by the name of &lt;tt&gt;a&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The issue comes when creating a proxy for this service through the &lt;tt&gt;JAXRSClientFactoryBean.java&lt;/tt&gt;&#160;create method shown below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// @param varValues optional list of values which will be used to substitute
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//                  template variables specified in the &lt;span class=&quot;code-keyword&quot;&gt;class-&lt;/span&gt;level JAX-RS Path annotations
&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; T create(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;T&amp;gt; cls, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;... varValues)
{ &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; cls.&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(createWithValues(varValues)); }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;To define the value of the &lt;tt&gt;@PathParam a&lt;/tt&gt;&#160;that this proxy should use, it appears as if the &lt;tt&gt;Object... varValues&lt;/tt&gt;&#160;needs to be populated. The &lt;tt&gt;ClientProxyImpl&lt;/tt&gt;&#160;is created with the following, after the &lt;tt&gt;ClientState&lt;/tt&gt;&#160;is retrieved:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; ClientProxyImpl createClientProxy(ClassResourceInfo cri, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isRoot,
                                            ClientState actualState, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] varValues) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (actualState == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClientProxyImpl(URI.create(getAddress()), proxyLoader, cri, isRoot,
                                inheritHeaders, getProperties(), varValues);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ClientProxyImpl(actualState, proxyLoader, cri, isRoot,
                                inheritHeaders, getProperties(), varValues);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In this scenario, &lt;tt&gt;actualState&lt;/tt&gt;&#160;is defined, and &lt;tt&gt;getProperties()&lt;/tt&gt;&#160;returns &lt;tt&gt;null&lt;/tt&gt;. &lt;tt&gt;varValues&lt;/tt&gt;&#160;is populated with one entry, &quot;dog&quot;. The constructor for the &lt;tt&gt;ClientProxyImpl&lt;/tt&gt;&#160;in this situation is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ClientProxyImpl(ClientState initialState,
 &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt; loader,
 ClassResourceInfo cri,
 &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isRoot,
 &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; inheritHeaders,
 &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;... varValues) { ... }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The key here is that the result of &lt;tt&gt;getProperties()&lt;/tt&gt;&#160;will be the first entry in the &lt;tt&gt;Object[]&lt;/tt&gt;&#160;created by the var args.&lt;/p&gt;

&lt;p&gt;After the &lt;tt&gt;initValuesMap(Object... varValues)&lt;/tt&gt;&#160;is called, I would expect the &lt;tt&gt;valuesMap&lt;/tt&gt;&#160;to have one entry, a mapping of &quot;a&quot; to &quot;dog&quot; so that when the proxy is used, it will populate the &lt;tt&gt;@PathParam a&lt;/tt&gt;&#160;with &quot;dog&quot; automatically. What ends up happening is because the &lt;tt&gt;null&#160;&lt;/tt&gt;&lt;tt&gt;properties&lt;/tt&gt;&#160;is being passed as part of the &lt;tt&gt;Object... varValues&lt;/tt&gt;&#160;to the &lt;tt&gt;ClientProxyImpl&lt;/tt&gt;&#160;constructor, the &lt;tt&gt;varValues&lt;/tt&gt;&#160;turns into an array of &lt;span class=&quot;error&quot;&gt;&amp;#91;null, &amp;quot;dog&amp;quot;&amp;#93;&lt;/span&gt; instead of the expected &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;dog&amp;quot;&amp;#93;&lt;/span&gt;. The proxy creates successfully but does not work because the &lt;tt&gt;valuesMap&lt;/tt&gt;&#160;ends up mapping &quot;a&quot; to &lt;tt&gt;null&lt;/tt&gt;. This breaks the URI builder implementation with an &lt;tt&gt;IllegalArgumentException&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; URI doBuild(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; fromEncoded, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; encodePathSlash, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;... values) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (values == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Template parameter values are set to &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; values.length; i++) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (values[i] == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Template parameter value at position &quot;&lt;/span&gt; + i + &lt;span class=&quot;code-quote&quot;&gt;&quot; is set to &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;);
        }
    }

    ...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This change to the &lt;tt&gt;createClientProxy&lt;/tt&gt;&#160;method was made here: &lt;a href=&quot;https://github.com/apache/cxf/pull/572.&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/572&lt;/a&gt;&#160;and maybe needs to be addressed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13385034">CXF-8556</key>
            <summary>Null AbstractEndpointFactory Properties Interferes with Class-Level PathParam When Creating Proxies with Defined ClientState</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="nrickles3">Noah Rickles</reporter>
                        <labels>
                            <label>Bug</label>
                    </labels>
                <created>Mon, 21 Jun 2021 23:20:32 +0000</created>
                <updated>Wed, 22 Dec 2021 20:41:41 +0000</updated>
                            <resolved>Wed, 23 Jun 2021 02:45:58 +0000</resolved>
                                    <version>3.4.4</version>
                    <version>3.3.11</version>
                                    <fixVersion>3.5.0</fixVersion>
                    <fixVersion>3.3.12</fixVersion>
                    <fixVersion>3.4.5</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17366920" author="reta" created="Tue, 22 Jun 2021 01:01:51 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nrickles3&quot; class=&quot;user-hover&quot; rel=&quot;nrickles3&quot;&gt;nrickles3&lt;/a&gt; , indeed the unfortunate issue sneaked in, should be fixed in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, thank you very much. Would you be open to try out latest snapshots to confirm the issue is gone? It will be much appreciated, thank you.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/cxf/pull/818&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/818&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17367378" author="nrickles3" created="Tue, 22 Jun 2021 14:20:48 +0000"  >&lt;p&gt;Thank you for the quick response Andriy, I will pull your changes and test them out. From what I was testing locally, that seems like it should be the fix. Appreciate it!&lt;/p&gt;</comment>
                            <comment id="17367662" author="nrickles3" created="Tue, 22 Jun 2021 20:27:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, your pull request has fixed the issue, although I think I may have found something else behaving incorrectly as a result. I will create a new issue for that.&lt;/p&gt;</comment>
                            <comment id="17367709" author="reta" created="Tue, 22 Jun 2021 21:54:22 +0000"  >&lt;p&gt;Thanks a lot for confirming, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nrickles3&quot; class=&quot;user-hover&quot; rel=&quot;nrickles3&quot;&gt;nrickles3&lt;/a&gt; , really appreciate it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0s5qg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>