<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:19:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6787] not sufficient WadlGenerator presence detection</title>
                <link>https://issues.apache.org/jira/browse/CXF-6787</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;org.apache.cxf.jaxrs.provider.ServerProviderFactory#createWadlGenerator do a loadClass to check WadlGenerator is there but if it is there in a upper classloader and cxf in a lower classloader then it will get instantiated but will not work (cause JAXRSUtil.currentmessage() will be loaded in both classloaders and will not be shared if the lower classloader is a webapp one).&lt;/p&gt;

&lt;p&gt;Would be great to check once loaded the instance is actually usable before adding it.&lt;/p&gt;

&lt;p&gt;This pattern is used in few other places - I suspect management part as well since I got the issue too - but this one broke archiva in tomee for instance.&lt;/p&gt;

&lt;p&gt;Side note: reported the versions I tested with but I guess most of CXF versions are affected&lt;/p&gt;</description>
                <environment></environment>
        <key id="12940153">CXF-6787</key>
            <summary>not sufficient WadlGenerator presence detection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="romain.manni-bucau">Romain Manni-Bucau</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Feb 2016 13:46:14 +0000</created>
                <updated>Fri, 14 Oct 2016 14:13:24 +0000</updated>
                            <resolved>Mon, 22 Feb 2016 13:03:42 +0000</resolved>
                                    <version>3.0.3</version>
                    <version>3.1.4</version>
                                    <fixVersion>3.1.6</fixVersion>
                    <fixVersion>3.0.9</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15152553" author="sergey_beryozkin" created="Thu, 18 Feb 2016 16:24:52 +0000"  >&lt;p&gt;Hi Romain&lt;/p&gt;

&lt;p&gt;I do not understand. If cxf-rt-rs-services-description is on the classpath then the assumption is it is usable if it can loaded.&lt;br/&gt;
Why don&apos;t you exclude this module from the classpath ? &lt;/p&gt;

&lt;p&gt;Cheers, Sergey &lt;/p&gt;</comment>
                            <comment id="15152561" author="sergey_beryozkin" created="Thu, 18 Feb 2016 16:30:09 +0000"  >&lt;p&gt;Or is it because you are trying the Swagger Feature ? Yes, we will need to split Swagger into a separate module &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15152657" author="romain.manni-bucau" created="Thu, 18 Feb 2016 17:24:16 +0000"  >&lt;p&gt;if you have:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;common.loader
   |          |
web1   web2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;if common loader has CXF and web1/WEB-INF/lib has cxf but the description module then web1 will be able to load the class but its classloader will be upper the web1 where cxf bus and rs modules for instance will be loaded so the wadlgenerator will not work.&lt;/p&gt;

&lt;p&gt;A quick fix for my case (tomcat/tomee) is to check wadlgenerator.getClassLoader() != JAXRSUtils.getClassLoader().getParent() but I guess it would be easier to check it trying to call it or anything else.&lt;/p&gt;

&lt;p&gt;Side note: a workaround is to add to web1 the description jar but this is not a real solution, more a workaround&lt;/p&gt;</comment>
                            <comment id="15156703" author="sergey_beryozkin" created="Mon, 22 Feb 2016 09:52:29 +0000"  >&lt;p&gt;Hi Romain, I&apos;m honestly not keen to start getting into checking various class loaders, I think if one does not need WADL supported then the WADL dependency should not be included - however if one wants to use Swagger then it is currently not possible to exclude WADL, so fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6760&quot; title=&quot;extract swagger2 feature in its own module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6760&quot;&gt;&lt;del&gt;CXF-6760&lt;/del&gt;&lt;/a&gt; will fix this issue too&lt;/p&gt;</comment>
                            <comment id="15156718" author="romain.manni-bucau" created="Mon, 22 Feb 2016 10:09:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; there is actually no link with swagger and the check is more about the usability of the loaded class (just check you can set/get the current message in the thread local through the wadl generator for instance). The deployment is valid in a plain tomcat and cxf fails with a NPE cause the current message is null cause the wadl generator is loaded with tomcat classloader and cxf with webapp classloader.&lt;/p&gt;</comment>
                            <comment id="15156751" author="sergey_beryozkin" created="Mon, 22 Feb 2016 10:39:34 +0000"  >&lt;p&gt;But why WADLgenerator is loaded in the 1st place if it is not needed ? I.e, why start checking the class loaders if one can simply not include a cxf-rt-rs-service-description ?&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="15156804" author="romain.manni-bucau" created="Mon, 22 Feb 2016 11:44:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; cause it is in tomcat common.loader. As a user you control WEB-INF/lib but not tomcat/lib. However main issue IMHO is CXF creates a runtime which doesn&apos;t work implicitely in such a case and you get the surprise at runtime. The workaround is to &lt;b&gt;add&lt;/b&gt; cxf-rt-rs-service-description in the webapp to still load WadlGenerator but from the right classloader but would have been better to have validated it at startup (and if CXf validates it then it can skip WadlGenerator &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).&lt;/p&gt;</comment>
                            <comment id="15156815" author="sergey_beryozkin" created="Mon, 22 Feb 2016 12:03:39 +0000"  >&lt;p&gt;We can&apos;t test WADLgenerator at startup - because we do not have a request message either at that point, hence we don&apos;t have UriInfo, and emulating it all to get some WADL generated only to check if this provider is usable seems wrong to me to be honest.&lt;/p&gt;

&lt;p&gt;IMHO the right solution is not to include it in common but recommend the users who expect WADL be supported to include it in their web apps, as opposed to CXF trying to fix various CL-related container issues at the code level.&lt;/p&gt;

&lt;p&gt;That said, I&apos;m also going to update the code - if the current message is null then simply &apos;return&apos;.&lt;/p&gt;</comment>
                            <comment id="15156833" author="sergey_beryozkin" created="Mon, 22 Feb 2016 12:29:36 +0000"  >&lt;p&gt;Done, I think checking for a null message is a good compromise and a reasonable check guarding against some surprises too. I&apos;m concerned that a &apos;checking the CL&apos; might fix it in one case but will block &apos;good&apos; WADL providers in other container set ups , etc...&lt;/p&gt;</comment>
                            <comment id="15156838" author="romain.manni-bucau" created="Mon, 22 Feb 2016 12:32:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; checking null is ok for me. Thanks!&lt;/p&gt;</comment>
                            <comment id="15156867" author="sergey_beryozkin" created="Mon, 22 Feb 2016 13:03:52 +0000"  >&lt;p&gt;thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2t03z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>