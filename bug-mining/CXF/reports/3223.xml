<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:30:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7625] JAX-RS 2.1 TCK: UriBuilder doesn&apos;t handle case where &quot;port&quot; is not an integer</title>
                <link>https://issues.apache.org/jira/browse/CXF-7625</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The JAX-RS 2.1 TCK (which isn&apos;t public in EE4J yet, but once it is, I&apos;ll post a link) has a test that checks the String content of a call to URI.toString(). &#160;The URI contains what looks like an HTTP URL, but does not specify an integer for the port - it uses a string instead. &#160;While debugging this, the &quot;host&quot; and &quot;port&quot; portion of the URI is passed in as scheme specific part, and the host field is null and the port field is -1. &#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;The UriBuilderImpl creates the URI object, this scheme specific part is lost, so when the user (test) calls uri.toString(), they do not see that info. &#160;Here is an example:&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;String uriString = &quot;myscheme://not.really.a.host:fakePort/&quot;;&lt;/tt&gt;&lt;tt&gt;URI uri = UriBuilder.fromUri(uriString).build();&lt;/tt&gt;&lt;tt&gt;assertEquals(uriString, uri.toString());&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13133877">CXF-7625</key>
            <summary>JAX-RS 2.1 TCK: UriBuilder doesn&apos;t handle case where &quot;port&quot; is not an integer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andymc">Andrew J McMurry</assignee>
                                    <reporter username="andymc">Andrew J McMurry</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Jan 2018 23:06:32 +0000</created>
                <updated>Mon, 5 Mar 2018 11:57:39 +0000</updated>
                            <resolved>Wed, 31 Jan 2018 19:04:06 +0000</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>3.2.2</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16340262" author="githubbot" created="Thu, 25 Jan 2018 23:11:14 +0000"  >&lt;p&gt;andymc12 opened a new pull request #370: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7625&quot; title=&quot;JAX-RS 2.1 TCK: UriBuilder doesn&amp;#39;t handle case where &amp;quot;port&amp;quot; is not an integer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7625&quot;&gt;&lt;del&gt;CXF-7625&lt;/del&gt;&lt;/a&gt; Handle schemeSpecificPart that looks like host:port&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/370&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The JAX-RS 2.1 TCK checks that a URI that has a non-integer port - i.e.&lt;br/&gt;
   a scheme specific part that looks like host:port. They expect that the&lt;br/&gt;
   string returned from UriBuilder.fromUri(uri).build().toString() should&lt;br/&gt;
   include the scheme and the scheme-specific part, but CXF currently drops&lt;br/&gt;
   the scheme-specific part.  This change helps to ensure that we preserve&lt;br/&gt;
   it, and adds a test similar to the TCK.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16347330" author="githubbot" created="Wed, 31 Jan 2018 18:27:02 +0000"  >&lt;p&gt;andymc12 closed pull request #370: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7625&quot; title=&quot;JAX-RS 2.1 TCK: UriBuilder doesn&amp;#39;t handle case where &amp;quot;port&amp;quot; is not an integer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7625&quot;&gt;&lt;del&gt;CXF-7625&lt;/del&gt;&lt;/a&gt; Handle schemeSpecificPart that looks like host:port&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/370&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/UriBuilderImpl.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/UriBuilderImpl.java&lt;br/&gt;
index 4e80a09c2e6..9eda94398d9 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/UriBuilderImpl.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/UriBuilderImpl.java&lt;br/&gt;
@@ -639,6 +639,10 @@ private void setUriParts(URI uri) {&lt;br/&gt;
         } else &lt;/p&gt;
{
             schemeSpecificPart = uri.getSchemeSpecificPart();
         }
&lt;p&gt;+        if (scheme != null &amp;amp;&amp;amp; host == null &amp;amp;&amp;amp; (query == null || query.isEmpty()) &amp;amp;&amp;amp; userInfo == null &lt;br/&gt;
+            &amp;amp;&amp;amp; uri.getSchemeSpecificPart() != null) &lt;/p&gt;
{
+            schemeSpecificPart = uri.getSchemeSpecificPart();
+        }
&lt;p&gt;         String theFragment = uri.getFragment();&lt;br/&gt;
         if (theFragment != null) {&lt;br/&gt;
             fragment = theFragment;&lt;br/&gt;
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/UriBuilderImplTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/UriBuilderImplTest.java&lt;br/&gt;
index a50e111b953..2ed7dec0aaf 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/UriBuilderImplTest.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/UriBuilderImplTest.java&lt;br/&gt;
@@ -1606,6 +1606,37 @@ public void testFromMethod() &lt;/p&gt;
{
         assertEquals(uri.toString(), &quot;/sub&quot;);
     }

&lt;p&gt;+    @Test&lt;br/&gt;
+    public void testURItoStringMatchesOriginalURI() {&lt;br/&gt;
+        String[] uriStrings = new String[]&lt;/p&gt;
{&quot;mailto:bob@apache.org&quot;,
+                                           &quot;news:comp.lang.java&quot;,
+                                           &quot;urn:isbn:096139210x&quot;,
+                                           &quot;docs/guide/collections/designfaq.html#28&quot;,
+                                           &quot;../../../demo/jfc/SwingSet2/src/SwingSet2.java&quot;,
+                                           &quot;file:///~/calendar&quot;,
+                                           &quot;bob@somehost.com&quot;,
+                                           &quot;http://localhost/somePath&quot;,
+                                           &quot;http://localhost:1234/someOtherPath&quot;,
+                                           &quot;http://127.0.0.1&quot;,
+                                           &quot;http://127.0.0.1/&quot;,
+                                           &quot;http://127.0.0.1/index.html&quot;,
+                                           &quot;myscheme://a.host:7575/&quot;,
+                                           &quot;myscheme://not.really.a.host:fakePort/&quot;
+        }
&lt;p&gt;;&lt;br/&gt;
+        for (String uriString :uriStrings) &lt;/p&gt;
{
+            URI uri = UriBuilder.fromUri(uriString).build();
+            assertEquals(uriString, uri.toString());
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testURIWithNonIntegerPort() &lt;/p&gt;
{
+        String url = &quot;myscheme://not.really.a.host:port/&quot;;
+        UriBuilder builder = UriBuilder.fromUri(url);
+        URI uri = builder.build();
+        assertEquals(url, uri.toString());
+    }
&lt;p&gt;+&lt;br/&gt;
     @Path(value = &quot;/TestPath&quot;)&lt;br/&gt;
     public static class TestPath {&lt;/p&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16385987" author="amarkevich" created="Mon, 5 Mar 2018 11:57:39 +0000"  >&lt;p&gt;Test failed in case query present: &quot;myscheme://not.really.a.host:fakePort/?q=v&quot;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 37 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3pe1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>