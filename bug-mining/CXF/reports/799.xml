<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:44:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-3233] JAXB xsd validation working on incoming messages but not outgoing messages</title>
                <link>https://issues.apache.org/jira/browse/CXF-3233</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Using CXF 2.3.1.&lt;/p&gt;

&lt;p&gt;Generated Java from WSDLs using JAXB.&lt;/p&gt;

&lt;p&gt;Using &lt;/p&gt;

&lt;p&gt;    &amp;lt;jaxws:properties&amp;gt;&lt;br/&gt;
        &amp;lt;entry key=&quot;schema-validation-enabled&quot; value=&quot;true&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/jaxws:properties&amp;gt;&lt;/p&gt;

&lt;p&gt;in the client configuration.&lt;/p&gt;

&lt;p&gt;My test creates an object that fails this particular requirement of the WSDL:&lt;/p&gt;

&lt;p&gt;    &amp;lt;xsd:simpleType name=&quot;UUID.Content&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;xsd:annotation&amp;gt;&lt;br/&gt;
            &amp;lt;xsd:documentation xml:lang=&quot;EN&quot;&amp;gt;&lt;br/&gt;
                Universally Unique Identifier&lt;br/&gt;
                &amp;lt;/xsd:documentation&amp;gt;&lt;br/&gt;
        &amp;lt;/xsd:annotation&amp;gt;&lt;br/&gt;
        &amp;lt;xsd:restriction base=&quot;xsd:token&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;xsd:length value=&quot;36&quot; /&amp;gt;&lt;br/&gt;
            &amp;lt;xsd:pattern&lt;br/&gt;
                value=&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9a-fA-F&amp;#93;&lt;/span&gt;&lt;/p&gt;
{8}
&lt;p&gt;-&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9a-fA-F&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}-&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9a-fA-F&amp;#93;&lt;/span&gt;{4}
&lt;p&gt;-&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9a-fA-F&amp;#93;&lt;/span&gt;&lt;/p&gt;
{4}
&lt;p&gt;-&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9a-fA-F&amp;#93;&lt;/span&gt;&lt;/p&gt;
{12}
&lt;p&gt;&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;/xsd:restriction&amp;gt;&lt;br/&gt;
    &amp;lt;/xsd:simpleType&amp;gt;&lt;/p&gt;

&lt;p&gt;However, the message is marshalled and makes it all the way through the outgoing interceptor chain.&lt;/p&gt;

&lt;p&gt;The WSDL is one-way: input-only.&lt;/p&gt;

&lt;p&gt;wsdlLocation is specified in an annotation in the Impls.&lt;/p&gt;

&lt;p&gt;Interestingly, incoming messages that fail validation of this same constraint are blocked by the interceptor chain during unmarshalling.&lt;/p&gt;

&lt;p&gt;I&apos;m testing on WebLogic.  I could also test on WebSphere is needed.&lt;/p&gt;

&lt;p&gt;Other XSD validation failures (such as a missing required element) are being caught by the outgoing marshaller.&lt;/p&gt;

&lt;p&gt;The reason that we upgraded to 2.3.1 from 2.2.6 was that we were seeing similar issues on the inbound messages.  In 2.3.1, complete XSD validation occurs for inbound messages but not for outbound ones.&lt;/p&gt;</description>
                <environment>&lt;p&gt;WebLogic 10.0, WebSphere 6.1&lt;/p&gt;</environment>
        <key id="12494860">CXF-3233</key>
            <summary>JAXB xsd validation working on incoming messages but not outgoing messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="benjishults">Benjamin Shults</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jan 2011 17:07:34 +0000</created>
                <updated>Fri, 21 Jan 2011 18:18:50 +0000</updated>
                            <resolved>Fri, 21 Jan 2011 01:22:32 +0000</resolved>
                                    <version>2.3.1</version>
                                    <fixVersion>Invalid</fixVersion>
                                    <component>Bus</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12978463" author="benjishults" created="Thu, 6 Jan 2011 19:12:44 +0000"  >&lt;p&gt;I remember there being a problem in prior versions of CXF that may be related to this.  I can&apos;t find a JIRA for it but if memory serves, certain types in schemas would make CXF use an unmarshaller that didn&apos;t do validation even when schema-validation was enabled.&lt;/p&gt;

&lt;p&gt;This JIRA may be related except on the outgoing (marshalling) side.&lt;/p&gt;</comment>
                            <comment id="12978618" author="ffang" created="Fri, 7 Jan 2011 02:35:52 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;What the exact value you set for UUID.Content?&lt;/p&gt;

&lt;p&gt;I just did a quick test and the outgoing messages validation works for me.&lt;br/&gt;
My schema restriction looks like&lt;br/&gt;
      &amp;lt;xsd:simpleType name=&quot;MyType&quot;&amp;gt;&lt;br/&gt;
                &amp;lt;xsd:restriction base=&quot;xsd:string&quot;&amp;gt;&lt;br/&gt;
                     &amp;lt;xsd:maxLength value=&quot;10&quot; /&amp;gt;&lt;br/&gt;
                &amp;lt;/xsd:restriction&amp;gt;&lt;br/&gt;
        &amp;lt;/xsd:simpleType&amp;gt;&lt;br/&gt;
Then when I set a string with length 11, then I can see the exception like&lt;/p&gt;

&lt;p&gt;WARNING: Interceptor for &lt;/p&gt;
{http://cxf.apache.org/jaxws/schemavalidation}
&lt;p&gt;service#&lt;/p&gt;
{http://cxf.apache.org/jaxws/schemavalidation}
&lt;p&gt;ckR has thrown exception, unwinding now&lt;br/&gt;
org.apache.cxf.interceptor.Fault: Marshalling Error: cvc-maxLength-valid: Value &apos;thisisffang&apos; with length = &apos;11&apos; is not facet-valid with respect to maxLength &apos;10&apos; for type &apos;GUIDType&apos;.&lt;br/&gt;
	at org.apache.cxf.jaxb.JAXBEncoderDecoder.marshall(JAXBEncoderDecoder.java:252)&lt;br/&gt;
	at org.apache.cxf.jaxb.io.DataWriterImpl.write(DataWriterImpl.java:169)&lt;br/&gt;
	at org.apache.cxf.interceptor.AbstractOutDatabindingInterceptor.writeParts(AbstractOutDatabindingInterceptor.java:110)&lt;br/&gt;
	at org.apache.cxf.interceptor.BareOutInterceptor.handleMessage(BareOutInterceptor.java:68)&lt;br/&gt;
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:255)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:516)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:313)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:265)&lt;br/&gt;
	at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:73)&lt;br/&gt;
	at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:124)&lt;/p&gt;

&lt;p&gt;So you can see the outgoing message validation works as expected.&lt;/p&gt;

&lt;p&gt;Would you please append a whole testcase which I can reproduce the problem?&lt;br/&gt;
As the problem you mentioned is on the client side, so you can just append your whole client side code(with configuration)?&lt;br/&gt;
Btw, I guess your server is deployed in weblogic, but your client is standalone, is it correct?&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="12978812" author="benjishults" created="Fri, 7 Jan 2011 15:28:15 +0000"  >&lt;p&gt;I took an automatically generated UUID and added the &apos;z&apos; character to the end.  This broke it in two ways: it made it too long and it added an illegal character.  (&apos;z&apos; is not allowed anywhere in the value.)&lt;/p&gt;

&lt;p&gt;I have traced this all the way into com.sun.xml.bind.v2.runtime.MarshallerImpl.  That class doesn&apos;t seem to be doing validation closely enough.  It is called from org.apache.cxf.jaxb.JAXBEncoderDecoder.&lt;/p&gt;
</comment>
                            <comment id="12978835" author="benjishults" created="Fri, 7 Jan 2011 15:59:29 +0000"  >&lt;p&gt;The server application is both a client and a server.  The WSDLs are similar on both sides in that they share most of their non-top-level types.  So, I am testing both inbound and outbound services on the same server.&lt;/p&gt;

&lt;p&gt;I haven&apos;t gotten around to testing on WebSphere but I might get to it today.  So far, all of my testing of this particular issue has been on WebLogic.&lt;/p&gt;</comment>
                            <comment id="12979667" author="benjishults" created="Mon, 10 Jan 2011 18:03:41 +0000"  >&lt;p&gt;I discovered that weblogic uses weblogic.apache.xerces.parsers.SAXParser instead of org.apache.xerces.parsers.SAXParser.  I&apos;ll test whether forcing weblogic to use the apache class fixes this.&lt;/p&gt;

&lt;p&gt;EDIT: it did not fix this issue.  However, forcing weblogic to use org.apache.xerces.parsers.SAXParser does fix validation using Spring Framework classes... not relevant to this bug, though.&lt;/p&gt;</comment>
                            <comment id="12979684" author="benjishults" created="Mon, 10 Jan 2011 18:57:42 +0000"  >&lt;p&gt;I have confirmed that this is occurring on WebSphere as well.&lt;/p&gt;</comment>
                            <comment id="12981652" author="ffang" created="Fri, 14 Jan 2011 07:20:10 +0000"  >&lt;p&gt;testcase to verify schemavalidation works for outgoing message&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1058867&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1058867&amp;amp;view=rev&lt;/a&gt; for trunk&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1058872&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1058872&amp;amp;view=rev&lt;/a&gt; for 2.3 branch&lt;/p&gt;</comment>
                            <comment id="12981654" author="ffang" created="Fri, 14 Jan 2011 07:26:58 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I think the problem you encounter is that your client side somehow build service model from class, but not from the wsdl file, so no chance to load the schema xsds to do the schema validation on client side.&lt;/p&gt;

&lt;p&gt;I don&apos;t know how you create client, could you ensure that you specify wsdlLocation for client side? You  may need take a look at &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; to get more details.&lt;br/&gt;
You should be able to see some log like &lt;br/&gt;
org.apache.cxf.service.factory.ReflectionServiceFactoryBean buildServiceFromWSDL&lt;br/&gt;
or &lt;br/&gt;
org.apache.cxf.service.factory.ReflectionServiceFactoryBean buildServiceFromClass&lt;br/&gt;
which indication how the service model is build from&lt;/p&gt;

&lt;p&gt;If it still doesn&apos;t work for you, I do need you provide a whole runnable testcase which I can reproduce it.&lt;/p&gt;

&lt;p&gt;Btw, I just commit a testcase(exactly same restriction as you use) which demostrate the schemavalidation works for outgoing message on client side.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;http://cxf.apache.org/docs/jax-ws-configuration.html&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="12982137" author="benjishults" created="Sat, 15 Jan 2011 17:20:51 +0000"  >&lt;p&gt;Thanks for looking into this.&lt;/p&gt;

&lt;p&gt;We generated our Java code from the WSDLs.  We have the wsdlLocation annotation in the client impls.&lt;/p&gt;

&lt;p&gt;It does partial validation: e.g. if any required element is missing, that is caught.  This makes me believe that it is finding the WSDLs.&lt;/p&gt;

&lt;p&gt;It is only if one of these trickier validation errors is present it is not caught.&lt;/p&gt;

&lt;p&gt;Did you test on WebLogic 10.0 or WebSphere 6.1?&lt;/p&gt;</comment>
                            <comment id="12982194" author="ffang" created="Sun, 16 Jan 2011 01:17:07 +0000"  >&lt;p&gt;Generate java code from wsdl is build time action, it doesn&apos;t mean will build servicemodule from wsdl during runtime.&lt;br/&gt;
Did you check logs for your client side?&lt;br/&gt;
You should see the output like&lt;br/&gt;
org.apache.cxf.service.factory.ReflectionServiceFactoryBean buildServiceFromWSDL&lt;br/&gt;
or&lt;br/&gt;
org.apache.cxf.service.factory.ReflectionServiceFactoryBean buildServiceFromClass&lt;br/&gt;
which will tell you how the servicemodel build.&lt;/p&gt;

&lt;p&gt;No, I didn&apos;t test it on WebLogic 10.0 or WebSphere 6.1, I don&apos;t have those j2ee container at hand and I don&apos;t think it&apos;s a j2ee container specific  problem.&lt;/p&gt;

&lt;p&gt;How you use client side code? And how you specify wsdlLocation annotation? &lt;br/&gt;
If you can append a runnable testcase, I believe it would be very helpful  to figure things out.&lt;/p&gt;</comment>
                            <comment id="12982207" author="benjishults" created="Sun, 16 Jan 2011 03:10:54 +0000"  >&lt;p&gt;It reports that it is built from WSDL.&lt;/p&gt;</comment>
                            <comment id="12982212" author="ffang" created="Sun, 16 Jan 2011 03:40:08 +0000"  >&lt;p&gt;Any chance you append a runnable testcase?&lt;/p&gt;

&lt;p&gt;You can remove your business logic and just as small as we can reproduce the issue.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12982217" author="benjishults" created="Sun, 16 Jan 2011 04:05:27 +0000"  >&lt;p&gt;I have had several validation-related problems with CXF going back to 2.2.  They have all turned out to be server-specific.  Even this one had it&apos;s behavior change when I forced WebLogic to use Apache&apos;s implementation of a Xerces class instead of its own.  I&apos;m surprised that you are so confident that this is not server-specific.&lt;/p&gt;

&lt;p&gt;Can you check your test-case on one of the environments I mentioned?  WebLogic is the one I have tested against the most.&lt;/p&gt;</comment>
                            <comment id="12984243" author="dkulp" created="Thu, 20 Jan 2011 15:59:25 +0000"  >
&lt;p&gt;Since JAXB just uses the javax.xml.validation.* API&apos;s that are provided by the JDK, it likely is dependent on the JDK and other libraries that are part of the app server and not something that is within CXF&apos;s control.   All CXF can do is create the Schema from the validation API&apos;s and pass it to JAXB.   The tests show that we ARE doing that properly.  Beyond that, it&apos;s either a bug in JAXB (not calling the API&apos;s when needed) or in the validator implementation provided by the app server.   &lt;/p&gt;

&lt;p&gt;Since this is outside of CXF&apos;s scope, can this be closed?&lt;/p&gt;</comment>
                            <comment id="12984520" author="ffang" created="Fri, 21 Jan 2011 01:19:46 +0000"  >&lt;p&gt;Hi Dan,&lt;/p&gt;

&lt;p&gt;Yeah, I agree with you.&lt;/p&gt;

&lt;p&gt;And as user just see schema validation only doesn&apos;t work on client side, I suspect there MIGHT be something wrong when they configure the client, that&apos;s why I ask for the user testcase and hopefully I can find something there....&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;ll go ahead to close this issue now.&lt;/p&gt;

&lt;p&gt;Regards&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="12984523" author="ffang" created="Fri, 21 Jan 2011 01:22:32 +0000"  >&lt;p&gt;added testcase to prove that CXF ARE doing that properly&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46985</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 44 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1afjj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>268984</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>