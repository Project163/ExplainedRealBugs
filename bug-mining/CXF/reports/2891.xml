<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:21:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6216] No output sanitizing in FormattedServiceListWriter </title>
                <link>https://issues.apache.org/jira/browse/CXF-6216</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;No output sanitizing is done, which makes the code vulnerable for injection. I do not have a specific use case, but it is good habit to do. Maybe you can use the OWASP Sanitizer: &lt;a href=&quot;https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;One example from the file: &lt;br/&gt;
        writer.write(&quot;&amp;lt;span class=\&quot;field\&quot;&amp;gt;Endpoint address:&amp;lt;/span&amp;gt; &quot; + &quot;&amp;lt;span class=\&quot;value\&quot;&amp;gt;&quot;&lt;br/&gt;
                     + absoluteURL + &quot;&amp;lt;/span&amp;gt;&quot;);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12769300">CXF-6216</key>
            <summary>No output sanitizing in FormattedServiceListWriter </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="dkwakkel">Donald Kwakkel</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Jan 2015 13:31:02 +0000</created>
                <updated>Wed, 22 Mar 2017 17:24:54 +0000</updated>
                            <resolved>Fri, 4 Nov 2016 16:13:44 +0000</resolved>
                                    <version>3.0.1</version>
                                    <fixVersion>3.1.9</fixVersion>
                    <fixVersion>3.0.12</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14287458" author="dkwakkel" created="Thu, 22 Jan 2015 14:06:43 +0000"  >&lt;p&gt;Same issue in UnformattedServiceListWriter.&lt;/p&gt;</comment>
                            <comment id="14287651" author="sergey_beryozkin" created="Thu, 22 Jan 2015 16:06:47 +0000"  >&lt;p&gt;Can you educate me please and explain what is wrong with the above code, with some example ?&lt;br/&gt;
Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="14288148" author="dkwakkel" created="Thu, 22 Jan 2015 20:12:23 +0000"  >&lt;p&gt;The OWASP site has a good explanation: &lt;a href=&quot;https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting&lt;/a&gt;. The kind which occur in this code is Reflected XSS. How to handle it is explained here: &lt;a href=&quot;https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14288234" author="sergey_beryozkin" created="Thu, 22 Jan 2015 21:14:23 +0000"  >&lt;p&gt;Can you explain how the CXF code above can be exploited. The fact that it can be exploited in theory is not a good enough reason for keeping this JIRA open. The code you quoted uses a property calculated from a request URI and the local relative endpoint address. The class of the span attribute is value. No user provided data is included. Where is the space for the attack ? Can you be concrete please ?&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="14290845" author="dkwakkel" created="Sat, 24 Jan 2015 22:04:17 +0000"  >&lt;p&gt;This link describes and gives examples how requestURL can be used for xss attacks: &lt;a href=&quot;https://www.superevr.com/blog/2011/three-semicolon-vulnerabilities&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.superevr.com/blog/2011/three-semicolon-vulnerabilities&lt;/a&gt;.&lt;br/&gt;
For getRequestURI it is more difficult, because it is encoded. So e.g. this attack will not work: view-source:&lt;a href=&quot;https://www.eigenhuis.nl/api/v2;&amp;#39;;alert(&amp;#39;xss1&amp;#39;)-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.eigenhuis.nl/api/v2;&apos;;alert(&apos;xss1&apos;)-&lt;/a&gt;&apos;&lt;br/&gt;
I do not know how to generate the WADL html code with requestURL (from BaseUrlHelper.getBaseURL) as input, so not sure if this is an issue. Maybe with the current code base it goes right. Still it seems preferable to me to sanitize output. &lt;/p&gt;</comment>
                            <comment id="14292045" author="sergey_beryozkin" created="Mon, 26 Jan 2015 16:40:41 +0000"  >&lt;p&gt;I guess in theory at least if a path matrix is used, there might be some scope for an attack.&lt;br/&gt;
We do not use getRequestUri() to build an endpoint address as pointed out in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. It is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;URI uri = URI.create(reqPrefix);
 sb.append(uri.getScheme()).append(&lt;span class=&quot;code-quote&quot;&gt;&quot;:&lt;span class=&quot;code-comment&quot;&gt;//&quot;&lt;/span&gt;).append(uri.getRawAuthority());
&lt;/span&gt; sb.append(request.getContextPath()).append(request.getServletPath());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think it is safe.&lt;/p&gt;

&lt;p&gt;It is interesting all right, thanks for sharing the links.&lt;/p&gt;

&lt;p&gt;But if we do not see that the code is open for such an injection attack then IMHO it is not an issue, definitely not a Bug.&lt;br/&gt;
IMHO we should re-qualify it it as Wish and do a resolution &quot;Later&quot;. Unless Colm, Dan have other ideas. I&apos;ll keep it open for a while.&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://www.superevr.com/blog/2011/three-semicolon-vulnerabilities&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.superevr.com/blog/2011/three-semicolon-vulnerabilities&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14292259" author="dkwakkel" created="Mon, 26 Jan 2015 19:14:05 +0000"  >&lt;p&gt;Thanks for taking this serious.&lt;/p&gt;

&lt;p&gt;In BaseUrlHelper.getBaseURL there is an option that the result of getRequestURL is returned, in case the if condition is false:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getBaseURL(HttpServletRequest request) {
		&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; reqPrefix = request.getRequestURL().toString();
		&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; pathInfo = (request.getPathInfo() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) ? &quot;&quot; : request.getPathInfo();

		&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;.equals(pathInfo)) || reqPrefix.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)) {
..
		}
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; reqPrefix;
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Did you consider this?&lt;/p&gt;</comment>
                            <comment id="14292457" author="sergey_beryozkin" created="Mon, 26 Jan 2015 21:43:19 +0000"  >&lt;p&gt;I did. If the &quot;if&quot; condition is true then it is a safe path and it is always holds true when a path info is either empty or longer than just &quot;/&quot; (the 2nd part of the if condition appears to be redundant). If path info is &quot;/&quot; then the reqPrefix is returned as is but in this case it is a host + port + context path + servlet path only.&lt;/p&gt;

&lt;p&gt;Cheers. Sergey  &lt;/p&gt;</comment>
                            <comment id="15286435" author="miken" created="Tue, 17 May 2016 11:42:15 +0000"  >&lt;p&gt;A security scan pointed out an actual XSS issue with this. By including a matrix parameter it is possible to include arbitrary code in the page. Something like this is enough to include an onmouseover (with javascript):&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;GET /api/;&quot;onmouseover=&apos;nwsh(9102)&apos;bad=&quot; HTTP/1.1&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Note that you should send the &quot; unescaped (browsers usually escape this, try a telnet session).&lt;/p&gt;

&lt;p&gt;Example conversation, using CXF 3.1.5, Tomcat 7.0.69, Java 8u92: &lt;a href=&quot;https://gist.github.com/MikeN123/f35a0d63ff8484b123ff76d14ad8e1c9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/MikeN123/f35a0d63ff8484b123ff76d14ad8e1c9&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15286467" author="miken" created="Tue, 17 May 2016 12:05:10 +0000"  >&lt;p&gt;FYI, &lt;tt&gt;request.getPathInfo()&lt;/tt&gt; returns &lt;tt&gt;/&lt;/tt&gt; in this case, hence the if condition is not triggered.&lt;/p&gt;</comment>
                            <comment id="15581652" author="sergey_beryozkin" created="Mon, 17 Oct 2016 09:05:56 +0000"  >&lt;p&gt;Prioritizing for 3.1.9&lt;/p&gt;</comment>
                            <comment id="15636852" author="sergey_beryozkin" created="Fri, 4 Nov 2016 16:13:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7128&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-7128&lt;/a&gt; has been created to review the possibility of using OWASP sanitizers.&lt;/p&gt;

&lt;p&gt;The &apos;matrix param&apos; attack has been fixed by removing all the matrix parameters from the absolute URL which is built by ServletController with the help of BaseUrlHelper. This constitutes a concrete form of sanitizing the URI.  &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13018158">CXF-7128</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24o1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>