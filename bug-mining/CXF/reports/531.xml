<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:41:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2652] UriInfo.getAbsolutePath throws &quot;java.net.URISyntaxException: Illegal character in path&quot; when there is an encoded space in the request URI</title>
                <link>https://issues.apache.org/jira/browse/CXF-2652</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I tried this simple code :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; mypackage;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.ws.rs.GET;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.ws.rs.Path;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.ws.rs.PathParam;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.ws.rs.core.Context;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.ws.rs.core.UriInfo;

@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;uri&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;UriService {
    @GET
    @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;something/{id}&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void addSomething(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; string, @Context UriInfo uriInfo, @PathParam(&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id) {
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;getPath -&amp;gt; &quot;&lt;/span&gt; + uriInfo.getPath());
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;getBasePath -&amp;gt; &quot;&lt;/span&gt; + uriInfo.getBaseUri());
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;getAbsolutePath -&amp;gt; &quot;&lt;/span&gt; + uriInfo.getBaseUri().resolve(uriInfo.getPath(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)));
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;getAbsolutePath -&amp;gt; &quot;&lt;/span&gt; + uriInfo.getAbsolutePath());
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With a Spring-based setup and default beans.xml taken from the user guide.&lt;/p&gt;

&lt;p&gt;Then we can use a normal browser .&lt;/p&gt;

&lt;p&gt;With &quot;http://localhost:9080/Uritest/rest/uri/something/3&quot;, we get in stdout :&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;getPath -&amp;gt; /uri/something/3&lt;br/&gt;
getBasePath -&amp;gt; &lt;a href=&quot;http://localhost:9080/Uritest/rest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9080/Uritest/rest&lt;/a&gt;&lt;br/&gt;
getAbsolutePath -&amp;gt; &lt;a href=&quot;http://localhost:9080/uri/something/3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9080/uri/something/3&lt;/a&gt;&lt;br/&gt;
getAbsolutePath -&amp;gt; &lt;a href=&quot;http://localhost:9080/Uritest/rest/uri/something/3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9080/Uritest/rest/uri/something/3&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But with &quot;http://localhost:9080/Uritest/rest/uri/something/3 4&quot;, we get an exception :&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.net.URISyntaxException: Illegal character in path at index 50: http://localhost:9080/Uritest/rest/uri/something/3 4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And in stdout :&lt;/p&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;getPath -&amp;gt; /uri/something/3 4&lt;br/&gt;
getBasePath -&amp;gt; &lt;a href=&quot;http://localhost:9080/Uritest/rest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9080/Uritest/rest&lt;/a&gt;&lt;br/&gt;
getAbsolutePath -&amp;gt; &lt;a href=&quot;http://localhost:9080/uri/something/3%204&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9080/uri/something/3%204&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NB : in JAX-RS javadoc, it&apos;s said that &quot;getAbsolutePath()&quot; is a shortcut to uriInfo.getBase().resolve(uriInfo.getPath())&quot;, which is plain wrong, because :&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;getBase doesn&apos;t exist, that&apos;s getBaseUri&lt;/li&gt;
	&lt;li&gt;getPath as returned by CXF begins with a slash (&quot;/&quot;) so &quot;resolve&quot; doesn&apos;t do what we want here. (maybe another bug ? tell me and I&apos;ll create another issue)&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment>&lt;p&gt;Used with Spring&lt;/p&gt;</environment>
        <key id="12455314">CXF-2652</key>
            <summary>UriInfo.getAbsolutePath throws &quot;java.net.URISyntaxException: Illegal character in path&quot; when there is an encoded space in the request URI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="flashfr">Julien Wajsberg</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Feb 2010 14:32:00 +0000</created>
                <updated>Tue, 23 Mar 2010 02:59:17 +0000</updated>
                            <resolved>Fri, 5 Feb 2010 12:04:44 +0000</resolved>
                                    <version>2.2.6</version>
                                    <fixVersion>2.2.7</fixVersion>
                    <fixVersion>2.3</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12829611" author="flashfr" created="Thu, 4 Feb 2010 14:47:00 +0000"  >&lt;p&gt;(sorry for spamming)&lt;/p&gt;

&lt;p&gt;A code which gives the correct value is :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; URI getAbsolutePathUri(UriInfo uriInfo) {
	&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; path = uriInfo.getPath(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (path.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)) {
		path = path.replaceFirst(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\/+&quot;&lt;/span&gt;, &quot;&quot;);
	}
	URI baseUri = uriInfo.getBaseUri();
	&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; base = baseUri.toString();
	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (! base.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)) {
		base += &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;;
		baseUri = URI.create(base);
	}
	URI location = baseUri.resolve(path);
	&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; location;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12829619" author="sergey_beryozkin" created="Thu, 4 Feb 2010 15:17:55 +0000"  >&lt;p&gt;thanks, after looking at the code I can see UriInfo.getRequestURI will fail too if encoded chars are included....Will fix it shortly.&lt;/p&gt;
</comment>
                            <comment id="12829651" author="flashfr" created="Thu, 4 Feb 2010 17:10:14 +0000"  >&lt;p&gt;Plese note that if getPath doesn&apos;t start with &quot;/&quot; and if getBaseUri ends with &quot;/&quot;, we just need to do a &quot;resolve&quot;. I&apos;m not sure of what the spec says.&lt;/p&gt;

&lt;p&gt;Though the easiest way could be to just use good old string concatenation ?&lt;/p&gt;</comment>
                            <comment id="12830075" author="sergey_beryozkin" created="Fri, 5 Feb 2010 12:04:44 +0000"  >&lt;p&gt;It has been fixed. There&apos;s a couple of things to note :&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;UriInfo.getPath() will return &quot;/&quot; only if the actual path value (the one to be returned from getPath()) is empty, no leading slash will be there otherwise. This is consistent with what is returned for the list of PathSegments. I remember asking a question on the jaxrs list  about the value of PathSegment.getPath() for a value &apos;/&apos; and the answer was &apos;/&apos;.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;UriInfo has getBaseUriBuilder() - please use this builder one instead of Uri.resolve(). The reason UriBuilder was introduced was to let users not to worry about ensuring the concatenation works well and to hide some of limitations of URI. There&apos;s really nothing we can do if baseUri ends with &apos;/&apos; for URI.resolve to work... So you can do&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;URI uri = uriInfo.getBaseUriBuilder().path(uriInfo.getPath()).build()&lt;/p&gt;

&lt;p&gt;and this will work irrespectively of various variations with leading/trailing slashes&lt;/p&gt;

&lt;p&gt;thanks, Sergey&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114049</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a5zb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57242</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>