<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:10:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5795] Reading the entity from a Response with 202 - Accepted causes NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/CXF-5795</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The entity of a Response with HTTP status code 202 - Accepted is null. This causes a NullPointerException when calling response.readEntity(). Furthermore, this bug seems to only occur when using the JAXRSClientFactory, and it was introduced in CXF 2.7.11.&lt;/p&gt;

&lt;p&gt;The stacktrace is of the NullPointerException:&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.cxf.jaxrs.impl.ResponseImpl.doReadEntity(ResponseImpl.java:345)&lt;br/&gt;
	at org.apache.cxf.jaxrs.impl.ResponseImpl.readEntity(ResponseImpl.java:286)&lt;br/&gt;
	at org.apache.cxf.jaxrs.impl.ResponseImpl.readEntity(ResponseImpl.java:276)&lt;/p&gt;


&lt;p&gt;To recreate the bug do the following:&lt;br/&gt;
Create a REST service that returns a 202 - Accepted with a non-null entity. In our case, the service was for HTTP POST.&lt;br/&gt;
Create a unit test that tests the service by creating a client with the JAXRSClientFactory and then reads the entity from the response. &lt;/p&gt;

&lt;p&gt;Both return Response.accepted(entity).build(); and return Response.status(Response.Status.ACCEPTED).entity(entity).build(); causes the bug.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Apache CXF 2.7.11&lt;/p&gt;</environment>
        <key id="12720320">CXF-5795</key>
            <summary>Reading the entity from a Response with 202 - Accepted causes NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="danielpd">Daniel Peder Dahlsveen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jun 2014 11:07:03 +0000</created>
                <updated>Mon, 16 Feb 2015 16:09:24 +0000</updated>
                            <resolved>Thu, 14 Aug 2014 13:02:04 +0000</resolved>
                                    <version>2.7.11</version>
                                    <fixVersion>2.7.13</fixVersion>
                    <fixVersion>3.0.2</fixVersion>
                    <fixVersion>3.1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14027643" author="sergey_beryozkin" created="Wed, 11 Jun 2014 11:26:55 +0000"  >&lt;p&gt;This NPE was coming from a buggy code creating IllegalStateException about to be thrown due to the entity stream not available. &lt;br/&gt;
Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14051956" author="jsamarziya" created="Thu, 3 Jul 2014 21:58:07 +0000"  >&lt;p&gt;FWIW, I am seeing this same error in CXF 3.0.0:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NullPointerException: null
	at org.apache.cxf.jaxrs.impl.ResponseImpl.doReadEntity(ResponseImpl.java:387)
	at org.apache.cxf.jaxrs.impl.ResponseImpl.readEntity(ResponseImpl.java:319)
	at org.apache.cxf.jaxrs.impl.ResponseImpl.readEntity(ResponseImpl.java:309)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14052293" author="sergey_beryozkin" created="Fri, 4 Jul 2014 09:25:58 +0000"  >&lt;p&gt;Response.readEntity requires that IllegalStateException is thrown if InputStream is not available which is the case with 202.&lt;br/&gt;
So what happens is Response implementation does throw IllegalStateException, but there was a bug which was causing NPE while ISE was being constructed. So I fixed it and now, with 3.0.1-SNAPSHOT you will see IllegalStateException&lt;/p&gt;</comment>
                            <comment id="14053901" author="jsamarziya" created="Mon, 7 Jul 2014 17:36:33 +0000"  >&lt;p&gt;I&apos;m sorry, I don&apos;t understand the assumptions here. You seem to be saying that a 202 response should not contain an entity, but I find that contradicts the HTTP 1.1 specification.&lt;/p&gt;

&lt;p&gt;Section 10.2.3 states in part, &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The entity returned with this response SHOULD include an indication of the request&apos;s current status...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;which implies that a 202 response may in fact contain an entity.&lt;/p&gt;

&lt;p&gt;Reference: &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14056149" author="sergey_beryozkin" created="Wed, 9 Jul 2014 12:02:27 +0000"  >&lt;p&gt;No, I&apos;m not doubting that 202 responses may have entities, what I&apos;m saying is that CXF HttpConduit gets a null InputStream.&lt;/p&gt;

&lt;p&gt;See&lt;br/&gt;
&lt;a href=&quot;https://fisheye6.atlassian.com/browse/cxf/rt/transports/http/src/main/java/org/apache/cxf/transport/http/ChunkedUtil.java?r=876e532549f5ae1038947344f1a0431e5339bd4c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://fisheye6.atlassian.com/browse/cxf/rt/transports/http/src/main/java/org/apache/cxf/transport/http/ChunkedUtil.java?r=876e532549f5ae1038947344f1a0431e5339bd4c&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;getPartialResponse().&lt;/p&gt;

&lt;p&gt;Can you confirm a 202 response actually does return an entity in your case ? Please use a tcp trace to check what is actually returned and let me know&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14060766" author="sergey_beryozkin" created="Mon, 14 Jul 2014 15:34:15 +0000"  >&lt;p&gt;Actual NPE is fixed, ISE will be thrown if no input stream is available.&lt;br/&gt;
Please feel free to reopen the issue if you can attach a captured tcp trace confirming the response entity exists&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="14094086" author="plarouche" created="Tue, 12 Aug 2014 14:21:12 +0000"  >&lt;p&gt;Hi guys!&lt;/p&gt;

&lt;p&gt;I confirm that the bug still exists in version 3.0.1.  I reproduced the exact same scenario described initialy and Here is the trace I got:&lt;/p&gt;

&lt;p&gt;HTTP/1.1 202 Accepted&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Date: Tue, 12 Aug 2014 14:03:43 GMT&lt;br/&gt;
Transfer-Encoding: chunked&lt;br/&gt;
Server: Jetty(8.1.15.v20140411)&lt;/p&gt;

&lt;p&gt;body:&lt;/p&gt;
{&quot;identifiantCorrelation&quot;:&quot;ddb4b52b-797e-457a-a4f2-9c84bf7b9f20&quot;,&quot;cause&quot;:null,&quot;identifiantTransaction&quot;:null,&quot;messages&quot;:null,&quot;statut&quot;:&quot;ACCEPTE&quot;}

&lt;p&gt;I would expect the response to be casted in my specific class, but it is not.  I receive the following exception:&lt;/p&gt;

&lt;p&gt;javax.ws.rs.ProcessingException: java.lang.IllegalStateException: The entity is not backed by an input stream, entity class is : null&lt;br/&gt;
	at org.apache.cxf.jaxrs.impl.ResponseImpl.doReadEntity(ResponseImpl.java:387)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.AbstractClient.readBody(AbstractClient.java:495)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.handleResponse(WebClient.java:1169)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doResponse(WebClient.java:1152)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1089)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:883)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:854)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:417)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.post(WebClient.java:447)&lt;/p&gt;


&lt;p&gt;When I change the response status to SUCCESS, everything&apos;s fine.  This exception occurs with CXF version 3.0.1.  If I try the version 3.0.0, I receive the following exception instead:&lt;/p&gt;

&lt;p&gt;javax.ws.rs.ProcessingException: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.cxf.jaxrs.impl.ResponseImpl.doReadEntity(ResponseImpl.java:387)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.AbstractClient.readBody(AbstractClient.java:496)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.handleResponse(WebClient.java:1168)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doResponse(WebClient.java:1151)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1088)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:882)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:853)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:417)&lt;br/&gt;
	at org.apache.cxf.jaxrs.client.WebClient.post(WebClient.java:447)&lt;/p&gt;

&lt;p&gt;Thanks to reopen the bug and keep us posted on it.  &lt;br/&gt;
Phil&lt;/p&gt;</comment>
                            <comment id="14094607" author="sergey_beryozkin" created="Tue, 12 Aug 2014 20:20:09 +0000"  >&lt;p&gt;Hi Phil, can you please do the following:&lt;/p&gt;

&lt;p&gt;Use HTTPURlConnection directly against the server returning 202 with the entity data and see if you can read the data.&lt;br/&gt;
Let me know please how it goes&lt;br/&gt;
Sergey&lt;/p&gt;</comment>
                            <comment id="14095477" author="plarouche" created="Wed, 13 Aug 2014 13:51:38 +0000"  >&lt;p&gt;Hi Sergey,&lt;/p&gt;

&lt;p&gt;I confirm I can read the data with the HttpURLConnection.  Here is how I called the WS, please note that I&apos;m using a post call (I think it&apos;s not working neither when using get):&lt;/p&gt;

&lt;p&gt;            ObjectMapper mapper = new ObjectMapper();&lt;br/&gt;
	    String jsonLot = mapper.writeValueAsString(lot);&lt;/p&gt;

&lt;p&gt;	    // Connect to google.com&lt;br/&gt;
	    URL url = new URL(&quot;http://localhost:9000/api/encaissement/1.0/creerlot&quot;);&lt;br/&gt;
	    HttpURLConnection connection = (HttpURLConnection) url.openConnection();&lt;br/&gt;
	    connection.setDoOutput(true);&lt;br/&gt;
	    connection.setRequestMethod(&quot;POST&quot;);&lt;br/&gt;
	    connection.setRequestProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);&lt;br/&gt;
	    connection.setRequestProperty(&quot;Content-Length&quot;,  String.valueOf(jsonLot.length()));&lt;/p&gt;

&lt;p&gt;	    // Write data&lt;br/&gt;
	    OutputStream os = connection.getOutputStream();&lt;br/&gt;
	    os.write(jsonLot.getBytes());&lt;/p&gt;

&lt;p&gt;	    // Read response&lt;br/&gt;
	    StringBuilder responseSB = new StringBuilder();&lt;br/&gt;
	    BufferedReader br = new BufferedReader(new InputStreamReader(connection.getInputStream()));&lt;/p&gt;

&lt;p&gt;	    String line;&lt;br/&gt;
	    while ( (line = br.readLine()) != null)&lt;br/&gt;
	        responseSB.append(line);&lt;/p&gt;

&lt;p&gt;	    // Close streams&lt;br/&gt;
	    br.close(); &lt;br/&gt;
	    os.close();&lt;/p&gt;

&lt;p&gt;At the end, responseSB contains the expected json string.&lt;/p&gt;</comment>
                            <comment id="14095514" author="mdurand" created="Wed, 13 Aug 2014 14:15:47 +0000"  >&lt;p&gt;Hi guys,&lt;/p&gt;

&lt;p&gt;I started from a tutorial project I found and was able to reproduce the problem in a simple test case.&lt;br/&gt;
The tutorial project was originally setup with CXF 2.7.6 and I was not able to reproduce the problem with this version. However, after updating to 3.0.1, I was able to reproduce it. I also went back to 3.0.0 and I have the same NullPointer described by Philippe. &lt;span class=&quot;error&quot;&gt;&amp;#91;Demo project attached cxf-demo.zip&amp;#93;&lt;/span&gt;. &lt;br/&gt;
Start the demo project with mvn tomcat:run and execute the Tester1 test.&lt;/p&gt;</comment>
                            <comment id="14096879" author="sergey_beryozkin" created="Thu, 14 Aug 2014 11:39:49 +0000"  >&lt;p&gt;I&apos;ve added a test confirming it works:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/cxf/commit/91f89e48&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/cxf/commit/91f89e48&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;but only if a WebClient sets a contextual property &quot;org.apache.cxf.transport.processOneWayResponse&quot; to true.&lt;/p&gt;

&lt;p&gt;At the moment it is disabled by default and HttpConduit resets InputStream to null. I believe it is the &lt;b&gt;optimization&lt;/b&gt; related to the use of WS-RM in scope of working with SOAP services but it would make sense even for HTTP clients thinking they post one way requests.&lt;/p&gt;

&lt;p&gt;202 is very often associated with one way requests, it&apos;s a bit unusual to have the entity returned as part of the regular HTTP responses. &lt;/p&gt;

&lt;p&gt;I&apos;ve reopened this JIRA because may be I can set this property to true by default if the client does not set a oneway  exchange property.&lt;/p&gt;</comment>
                            <comment id="14096934" author="sergey_beryozkin" created="Thu, 14 Aug 2014 13:02:05 +0000"  >&lt;p&gt;The current workaround is to use the  contextual property as shown in the the commit message. It will be set by default in 2.7.13, etc unless a client explicitly requests a one way invocation &lt;/p&gt;</comment>
                            <comment id="14097195" author="plarouche" created="Thu, 14 Aug 2014 16:48:33 +0000"  >&lt;p&gt;Thx a lot for your quick fix and workaround, really appreciated!&lt;/p&gt;</comment>
                            <comment id="14097213" author="sergey_beryozkin" created="Thu, 14 Aug 2014 17:02:38 +0000"  >&lt;p&gt;Np. It was a quick fix because it was easy, but it took some time for me to see where the problem might be, as 202 would be typically used for &apos;oneway&apos; requests. Thanks for getting the message across to me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12661456" name="cxf-demo.zip" size="7444" author="mdurand" created="Wed, 13 Aug 2014 14:16:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>398519</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 14 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wlyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>398644</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>