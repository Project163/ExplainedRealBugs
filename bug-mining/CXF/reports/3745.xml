<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:40:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8629] AsyncHTTPConduit (hc5) should support chunked request / response</title>
                <link>https://issues.apache.org/jira/browse/CXF-8629</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description></description>
                <environment></environment>
        <key id="13417834">CXF-8629</key>
            <summary>AsyncHTTPConduit (hc5) should support chunked request / response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="reta">Andriy Redko</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Dec 2021 23:55:58 +0000</created>
                <updated>Fri, 7 Feb 2025 19:47:12 +0000</updated>
                            <resolved>Fri, 7 Feb 2025 19:47:12 +0000</resolved>
                                    <version>3.5.0</version>
                    <version>3.4.5</version>
                                    <fixVersion>3.5.11</fixVersion>
                    <fixVersion>3.6.6</fixVersion>
                    <fixVersion>4.0.7</fixVersion>
                    <fixVersion>4.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17866837" author="bocamel" created="Wed, 17 Jul 2024 19:31:36 +0000"  >&lt;p&gt;I run into a similar problem but not sure whether it is caused by the same thing.&#160; Here is the information about mine and please let me know if it is not related to this issue.&#160; I am using CXF 4.0.4 - HTTP Client 5.&#160; In the conduit, AllowChunking=&quot;false&quot;.&lt;/p&gt;

&lt;p&gt;In the simple app, it uses Camel to call CXF:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;from(&quot;direct:foo&quot;)&lt;br/&gt;
.to(&quot;cxfrs:bean:rsClientForCustomer?headerFilterStrategy=#ebaFilterStrategy&quot;)&lt;br/&gt;
.log(&quot;in foo after calling CXF&quot;)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This generated the following log.&#160; The entries for ID: 1 were recorded by my test client.&#160; The entries for ID: 2 were recorded by my test server.&#160; As you can see, the server responded once, but the client processed the response twice, once with payload, once without the payload.&#160; It is also interesting to note that the two client log entries of the response contain &lt;b&gt;Transfer-Encoding=&lt;span class=&quot;error&quot;&gt;&amp;#91;chunked&amp;#93;&lt;/span&gt;,&lt;/b&gt;&#160;even though the chunking is not allowed in conduit.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I noticed that Jira somehow replaced some text below with &quot;Unknown macro&quot;.&#160; I do not know how to stop Jira from doing it.&#160; Sorry.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;2024-07-17 15:11:14.358 &lt;span class=&quot;error&quot;&gt;&amp;#91;Camel (camel-1) thread #31 - timer://testRoute&amp;#93;&lt;/span&gt; LoggingOutInterceptor - Outbound Message&lt;br/&gt;
---------------------------&lt;br/&gt;
&lt;b&gt;ID: 1&#160; &#160; &#160;(client sent request)&lt;/b&gt;&lt;br/&gt;
Address: &lt;a href=&quot;http://localhost:9105/customer/listener&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9105/customer/listener&lt;/a&gt;&lt;br/&gt;
Http-Method: POST&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers:&lt;br/&gt;
Unknown macro: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;Keep-Alive&amp;#93;&lt;/span&gt;}&lt;br/&gt;
Payload:&#160;&lt;br/&gt;
Unknown macro: { &#160; &#160; &quot;test&quot;}&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-07-17 15:11:14.601 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp89784984-111&amp;#93;&lt;/span&gt; LoggingInInterceptor - Inbound Message&lt;br/&gt;
----------------------------&lt;br/&gt;
&lt;b&gt;ID: 2&#160; &#160; &#160;(server received request)&lt;/b&gt;&lt;br/&gt;
Address: &lt;a href=&quot;http://localhost:9105/customer/listener&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9105/customer/listener&lt;/a&gt;&lt;br/&gt;
Encoding: UTF-8&lt;br/&gt;
Http-Method: POST&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers:&lt;br/&gt;
Unknown macro: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;keep-alive&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Length=&lt;span class=&quot;error&quot;&gt;&amp;#91;48&amp;#93;&lt;/span&gt;, content-type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Host=[localhost}&lt;br/&gt;
Payload:&#160;&lt;br/&gt;
Unknown macro: { &#160; &#160; &quot;test&quot;}&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;&lt;br/&gt;
2024-07-17 15:11:14.649 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp89784984-111&amp;#93;&lt;/span&gt; LoggingOutInterceptor - Outbound Message&lt;br/&gt;
---------------------------&lt;br/&gt;
&lt;b&gt;ID: 2&#160; &#160; &#160; (server sent response)&lt;/b&gt;&lt;br/&gt;
Response-Code: 200&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers:&lt;br/&gt;
Unknown macro: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, User-Agent=&lt;span class=&quot;error&quot;&gt;&amp;#91;Apache CXF 4.0.4&amp;#93;&lt;/span&gt;, connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;keep-alive&amp;#93;&lt;/span&gt;, Host=[localhost}&lt;br/&gt;
Payload: {&quot;result&quot;:&quot;Ok&quot;}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-07-17 15:11:14.667 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-1&amp;#93;&lt;/span&gt; LoggingInInterceptor - Inbound Message&lt;br/&gt;
----------------------------&lt;br/&gt;
&lt;b&gt;ID: 1&#160; &#160; &#160; (client processed response with payload)&lt;/b&gt;&lt;br/&gt;
Response-Code: 200&lt;br/&gt;
Encoding: ISO-8859-1&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers:&lt;br/&gt;
Unknown macro: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;keep-alive&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Date=[Wed, 17 Jul 2024 19}&lt;br/&gt;
Payload: {&quot;result&quot;:&quot;Ok&quot;}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-07-17 15:11:14.667 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-2&amp;#93;&lt;/span&gt; LoggingInInterceptor - Inbound Message&lt;br/&gt;
----------------------------&lt;br/&gt;
&lt;b&gt;ID: 1&#160; &#160; &#160; (client processed response again, without payload)&lt;/b&gt;&lt;br/&gt;
Response-Code: 200&lt;br/&gt;
Encoding: ISO-8859-1&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers:&lt;br/&gt;
Unknown macro: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;keep-alive&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Date=[Wed, 17 Jul 2024 19}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-07-17 15:11:14.669 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-2&amp;#93;&lt;/span&gt; route19 - in foo after calling CXF&lt;br/&gt;
2024-07-17 15:11:14.669 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-1&amp;#93;&lt;/span&gt; route19 - in foo after calling CXF&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17866861" author="reta" created="Wed, 17 Jul 2024 21:39:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; I think this very related problem: it seems like the client sends non-chunked request (this is expected) but the server replies with chunked response (I believe `AllowChunking` has no effect here since this is driven by server). The Apache HttpClient5 conduit does not support the response chunking yet.&lt;/p&gt;</comment>
                            <comment id="17876439" author="reta" created="Sat, 24 Aug 2024 19:04:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; I have working on this issue but I cannot reproduce this double logging (for response) problem you&apos;ve been running into. Would you be able to supply a reproducer (project or test case, whatever is easier for you). Thank you.&lt;/p&gt;</comment>
                            <comment id="17895584" author="reta" created="Tue, 5 Nov 2024 12:45:29 +0000"  >&lt;p&gt;Added test cases, not able to reproduce the double logging issue&lt;/p&gt;</comment>
                            <comment id="17906472" author="bocamel" created="Tue, 17 Dec 2024 17:07:59 +0000"  >&lt;p&gt;I tested this with the latest 4.1.0 release.&#160; &#160;After varying different factors, I think the duplicate response issue occurs when 1) the hc5 jar is in the classpath, and 2) when AutoRedirect=&quot;true&quot; is specified in the conduit (even when the server did not suggest to redirect).&#160; Since I only use CXF from Camel, here is my test script (groovy) using Camel:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;from(&quot;timer://testRoute2?repeatCount=1&quot;)&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;// send a http POST to server, and print out the response&lt;br/&gt;
.process(&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
it.in.setBody(&amp;#39;{&amp;quot;name&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&apos;)&lt;br/&gt;
it.in.setHeader(&apos;cache-control&apos;, &apos;no-cache&apos;)&lt;br/&gt;
it.in.setHeader(&apos;Content-Type&apos;, &apos;application/json&apos;)&lt;br/&gt;
it.in.setHeader(&apos;CamelHttpMethod&apos;, &apos;POST&apos;)&lt;br/&gt;
})&lt;br/&gt;
.setExchangePattern(ExchangePattern.InOut)&lt;br/&gt;
.to(&quot;cxfrs:bean:rsClientTest&quot;)&lt;br/&gt;
.log(&apos;response received: $simple{body}&apos;)&lt;br/&gt;
&#160;&lt;br/&gt;
from(&quot;cxfrs:bean:rsServerTest?bindingStyle=SimpleConsumer&quot;)&#160; &#160;// receive HTTP request, printout the request, and send back a response&lt;br/&gt;
.log(&apos;request received: $simple{body}&apos;)&lt;br/&gt;
.process (&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
it.in.setHeader(&amp;#39;Content-Type&amp;#39;, &amp;#39;application/json&amp;#39;)
it.in.setBody(&amp;#39;{&amp;quot;result&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&apos;)&lt;br/&gt;
})&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;br/&gt;
This will produce the following output (when hc5 is used and AutoRedirect=&quot;true&quot; is specified in the conduit.&#160; The response from server is received or processed twice by the client, one had payload, one did not.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;2024-12-17 11:18:35.496 &lt;span class=&quot;error&quot;&gt;&amp;#91;Camel (camel-1) thread #32 - timer://testRoute2&amp;#93;&lt;/span&gt; LoggingOutInterceptor - Outbound Message - &lt;b&gt;by client&lt;/b&gt;&lt;br/&gt;
---------------------------&lt;br/&gt;
ID: 1&lt;br/&gt;
Address: &lt;a href=&quot;http://localhost:8081/test/url&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8081/test/url&lt;/a&gt;&lt;br/&gt;
Http-Method: POST&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {cache-control=&lt;span class=&quot;error&quot;&gt;&amp;#91;no-cache&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;Keep-Alive&amp;#93;&lt;/span&gt;, Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;}&lt;br/&gt;
Payload: {&quot;name&quot;:&quot;john&quot;}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-12-17 11:18:35.612 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp2019773797-116&amp;#93;&lt;/span&gt; LoggingInInterceptor - Inbound Message - &lt;b&gt;by server&lt;/b&gt;&lt;br/&gt;
----------------------------&lt;br/&gt;
ID: 2&lt;br/&gt;
Address: &lt;a href=&quot;http://localhost:8081/test/url&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8081/test/url&lt;/a&gt;&lt;br/&gt;
Encoding: UTF-8&lt;br/&gt;
Http-Method: POST&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Cache-Control=&lt;span class=&quot;error&quot;&gt;&amp;#91;no-cache&amp;#93;&lt;/span&gt;, connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;keep-alive&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Length=&lt;span class=&quot;error&quot;&gt;&amp;#91;15&amp;#93;&lt;/span&gt;, content-type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Host=&lt;span class=&quot;error&quot;&gt;&amp;#91;localhost:8081&amp;#93;&lt;/span&gt;, User-Agent=&lt;span class=&quot;error&quot;&gt;&amp;#91;Apache CXF 4.1.0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
Payload: {&quot;name&quot;:&quot;john&quot;}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-12-17 11:18:35.630 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp2019773797-116&amp;#93;&lt;/span&gt; route16 - request received: {&quot;name&quot;:&quot;john&quot;}&lt;br/&gt;
2024-12-17 11:18:35.645 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp2019773797-116&amp;#93;&lt;/span&gt; LoggingOutInterceptor - Outbound Message - &lt;b&gt;by server&lt;/b&gt;&lt;br/&gt;
---------------------------&lt;br/&gt;
ID: 2&lt;br/&gt;
Response-Code: 200&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Cache-Control=&lt;span class=&quot;error&quot;&gt;&amp;#91;no-cache&amp;#93;&lt;/span&gt;, User-Agent=&lt;span class=&quot;error&quot;&gt;&amp;#91;Apache CXF 4.1.0&amp;#93;&lt;/span&gt;, connection=&lt;span class=&quot;error&quot;&gt;&amp;#91;keep-alive&amp;#93;&lt;/span&gt;, Host=&lt;span class=&quot;error&quot;&gt;&amp;#91;localhost:8081&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Date=&lt;span class=&quot;error&quot;&gt;&amp;#91;Tue, 17 Dec 2024 16:18:35 GMT&amp;#93;&lt;/span&gt;}&lt;br/&gt;
Payload: {&quot;result&quot;:&quot;ok&quot;}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-12-17 11:18:35.658 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-1&amp;#93;&lt;/span&gt; LoggingInInterceptor - Inbound Message - &lt;b&gt;by client&lt;/b&gt;&lt;br/&gt;
----------------------------&lt;br/&gt;
&lt;b&gt;ID: 1&lt;/b&gt;&lt;br/&gt;
Response-Code: 200&lt;br/&gt;
Encoding: ISO-8859-1&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Cache-Control=&lt;span class=&quot;error&quot;&gt;&amp;#91;no-cache&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Date=&lt;span class=&quot;error&quot;&gt;&amp;#91;Tue, 17 Dec 2024 16:18:35 GMT&amp;#93;&lt;/span&gt;, Host=&lt;span class=&quot;error&quot;&gt;&amp;#91;localhost:8081&amp;#93;&lt;/span&gt;, Server=&lt;span class=&quot;error&quot;&gt;&amp;#91;Jetty(12.0.15)&amp;#93;&lt;/span&gt;, Transfer-Encoding=&lt;span class=&quot;error&quot;&gt;&amp;#91;chunked&amp;#93;&lt;/span&gt;, User-Agent=&lt;span class=&quot;error&quot;&gt;&amp;#91;Apache CXF 4.1.0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
Payload: *&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;quot;result&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;*&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-12-17 11:18:35.660 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-2&amp;#93;&lt;/span&gt; LoggingInInterceptor - Inbound Message&#160; -&lt;b&gt;by client but no payload&lt;/b&gt;&lt;br/&gt;
----------------------------&lt;br/&gt;
&lt;b&gt;ID: 1&lt;/b&gt;&lt;br/&gt;
Response-Code: 200&lt;br/&gt;
Encoding: ISO-8859-1&lt;br/&gt;
Content-Type: application/json&lt;br/&gt;
Headers: {Accept=&lt;span class=&quot;error&quot;&gt;&amp;#91;*/*&amp;#93;&lt;/span&gt;, Cache-Control=&lt;span class=&quot;error&quot;&gt;&amp;#91;no-cache&amp;#93;&lt;/span&gt;, Content-Language=&lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;, Content-Type=&lt;span class=&quot;error&quot;&gt;&amp;#91;application/json&amp;#93;&lt;/span&gt;, Date=&lt;span class=&quot;error&quot;&gt;&amp;#91;Tue, 17 Dec 2024 16:18:35 GMT&amp;#93;&lt;/span&gt;, Host=&lt;span class=&quot;error&quot;&gt;&amp;#91;localhost:8081&amp;#93;&lt;/span&gt;, Server=&lt;span class=&quot;error&quot;&gt;&amp;#91;Jetty(12.0.15)&amp;#93;&lt;/span&gt;, Transfer-Encoding=&lt;span class=&quot;error&quot;&gt;&amp;#91;chunked&amp;#93;&lt;/span&gt;, User-Agent=&lt;span class=&quot;error&quot;&gt;&amp;#91;Apache CXF 4.1.0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
--------------------------------------&lt;br/&gt;
2024-12-17 11:18:35.665 &lt;span class=&quot;error&quot;&gt;&amp;#91;default-workqueue-1&amp;#93;&lt;/span&gt; route17 - response received:&#160;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;br/&gt;
If AutoRedirect is removed or set to false, everything would work as expected:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;lt;http:conduit name=&quot;.*&quot;&amp;gt;&lt;br/&gt;
&#160; &#160;&amp;lt;http:client AllowChunking=&quot;false&quot;&lt;br/&gt;
&#160; &#160; &#160; &#160;&lt;b&gt;AutoRedirect=&quot;true&quot;&lt;/b&gt;&lt;br/&gt;
&#160; &#160; &#160; &#160;ProxyServer=&quot;&quot;&lt;br/&gt;
&#160; &#160; &#160; &#160;ProxyServerPort=&quot;0&quot;&lt;br/&gt;
&#160; &#160; &#160; &#160;ConnectionTimeout=&quot;30&quot;&lt;br/&gt;
&#160; &#160; &#160; &#160;ReceiveTimeout=&quot;90&quot;&lt;br/&gt;
&#160; &#160; &#160; &#160;Connection=&quot;Keep-Alive&quot;&lt;br/&gt;
&#160; &#160;/&amp;gt;&lt;br/&gt;
&amp;lt;/http:conduit&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17907113" author="reta" created="Thu, 19 Dec 2024 16:31:03 +0000"  >&lt;p&gt;Thanks for the details &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; , I will try to reproduce it shortly&lt;/p&gt;</comment>
                            <comment id="17907652" author="bocamel" created="Sun, 22 Dec 2024 01:41:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, thanks for looking into the above report.&lt;/p&gt;

&lt;p&gt;I noticed another strange issue.&#160; My application sends rest messages to another server (which belongs to another company, therefore, I do not have access to it except through the API).&#160; After using the hc5 jar, the client got &lt;b&gt;org.apache.hc.core5.http.ConnectionClosedException: Connection closed by peer&lt;/b&gt; (exactly 1 minute after it sent the message) for certain messages (even with retries), while no problem with other messages.&#160; The only difference between the succeeded messages and failed messages is that the failed messages are a little longer (with length &amp;gt; 2000 bytes).&#160; But if I shorten the failed message payload from its original 2000+ bytes to 1000+ bytes, they would succeed.&#160; The issue happens regardless whether AllowChunking (on the conduit) is set to true or false.&#160; If hc5 jar is removed from classpath, the problem goes away.&lt;/p&gt;

&lt;p&gt;I tried but could not reproduce the issue by sending messages from my client to my server in the same application (both sides use hc5, of course).&lt;/p&gt;

&lt;p&gt;Here is the stacktrace:&lt;/p&gt;

&lt;p&gt;2024-12-21 20:17:34.754 &lt;span class=&quot;error&quot;&gt;&amp;#91;Camel (camel-1) thread #27 - seda://messageRouter&amp;#93;&lt;/span&gt; PhaseInterceptorChain - Interceptor for {&lt;a href=&quot;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident&lt;/a&gt;}WebClient has thrown exception, unwinding now&lt;br/&gt;
org.apache.cxf.interceptor.Fault: Could not send Message.&lt;br/&gt;
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:67) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.doRunInterceptorChain(AbstractClient.java:717) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1085) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:931) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:900) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:363) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.cxf.jaxrs.CxfRsProducer.invokeHttpClient(CxfRsProducer.java:339) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-cxf-rest-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.cxf.jaxrs.CxfRsProducer.process(CxfRsProducer.java:103) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-cxf-rest-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.support.SynchronousDelegateProducer.process(SynchronousDelegateProducer.java:48) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-support-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:65) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-support-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:208) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:323) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:95) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:323) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:115) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.doRun(DefaultReactiveExecutor.java:199) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.executeReactiveWork(DefaultReactiveExecutor.java:189) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.tryExecuteReactiveWork(DefaultReactiveExecutor.java:166) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.Pipeline.process(Pipeline.java:163) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:323) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.seda.SedaConsumer.sendToConsumers(SedaConsumer.java:291) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-seda-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.seda.SedaConsumer.doRun(SedaConsumer.java:191) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-seda-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.seda.SedaConsumer.run(SedaConsumer.java:129) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-seda-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.Thread.run(Thread.java:840) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;b&gt;Caused by: org.apache.hc.core5.http.ConnectionClosedException: ConnectionClosedException invoking &lt;a href=&quot;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident/INC41805995:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident/INC41805995:&lt;/a&gt; Connection closed by peer&lt;/b&gt;&lt;br/&gt;
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1452) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1433) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.asyncclient.hc5.AsyncHTTPConduit$AsyncWrappedOutputStream.close(AsyncHTTPConduit.java:440) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-hc5-4.1.0.jar!/:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.io.AbstractWrappedOutputStream.close(AbstractWrappedOutputStream.java:77) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.io.CacheAndWriteOutputStream.postClose(CacheAndWriteOutputStream.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.io.CachedOutputStream.close(CachedOutputStream.java:232) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:717) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit.close(HttpClientHTTPConduit.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:63) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; ... 31 more&lt;br/&gt;
&lt;b&gt;Caused by: org.apache.hc.core5.http.ConnectionClosedException: Connection closed by peer&lt;/b&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1StreamDuplexer.onInput(AbstractHttp1StreamDuplexer.java:353) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1IOEventHandler.inputReady(AbstractHttp1IOEventHandler.java:64) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.ClientHttp1IOEventHandler.inputReady(ClientHttp1IOEventHandler.java:41) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.client5.http.impl.async.LoggingIOSession$1.inputReady(LoggingIOSession.java:238) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient5-5.4.1.jar:5.4.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession.decryptData(SSLIOSession.java:641) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession.access$200(SSLIOSession.java:74) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession$1.inputReady(SSLIOSession.java:202) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.InternalDataChannel.onIOEvent(InternalDataChannel.java:143) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.InternalChannel.handleIOEvent(InternalChannel.java:51) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.processEvents(SingleCoreIOReactor.java:176) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.doExecute(SingleCoreIOReactor.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.AbstractSingleCoreIOReactor.execute(AbstractSingleCoreIOReactor.java:92) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.IOReactorWorker.run(IOReactorWorker.java:44) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; ... 1 more&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Any suggestion will be greatly appreciated.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="17907700" author="reta" created="Sun, 22 Dec 2024 17:55:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; no luck so far with just client changes, add test cases here&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; , will try explore server side changes (may be adding redirect?). Regarding the &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Caused by: org.apache.hc.core5.http.ConnectionClosedException: ConnectionClosedException invoking &lt;a href=&quot;https://siemensfuturenowprod.service-now.com/api/sieag/siam/incident/INC41805995:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident/INC41805995:&lt;/a&gt; Connection closed by peer&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;This is really coming from the server (which may have limits or constraints on payload / protocol / etc), the client just merely acknowledges the fact the connection was closed. &lt;/p&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/cxf/pull/2202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/2202&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17907723" author="bocamel" created="Sun, 22 Dec 2024 21:51:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, thanks for looking into both of these matters.&lt;/p&gt;

&lt;p&gt;By the way, is -Dorg.apache.cxf.transport.http.forceVersion=1.1 still supported in CXF 4.1?&#160; We use that in our application.&#160; I&#160; wonder whether the connectionClosedException could be related to it.&lt;/p&gt;

&lt;p&gt;Thanks again!&lt;/p&gt;</comment>
                            <comment id="17907744" author="reta" created="Mon, 23 Dec 2024 03:11:31 +0000"  >&lt;p&gt;No luck with reproduction of the issue so far &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; , if you could help me tailor the test cases &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, would be great.&lt;/p&gt;

&lt;p&gt;&amp;gt; By the way, is -Dorg.apache.cxf.transport.http.forceVersion=1.1 still supported in CXF 4.1?&#160;&lt;/p&gt;

&lt;p&gt;Yes, it is supported but only by default HTTP conduit (JDK&apos;s HttpClient based), AFAIK, hc5 client conduit does not take this property into consideration.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/cxf/pull/2202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/2202&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17907909" author="bocamel" created="Mon, 23 Dec 2024 16:13:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, I added a test project to &lt;a href=&quot;https://github.com/apache/cxf/pull/2202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/2202&lt;/a&gt; to reproduce the issue.&lt;/p&gt;

&lt;p&gt;As of the connectionClosedException matter, I think the ignoring -Dorg.apache.cxf.transport.http.forceVersion=1.1 by hc5 might be the cause.&#160; We have had problems with running http2 against some servers (e.g. getting intermittent IOException GO AWAY), so we force it to http 1.1.&#160; With hc5, is there a way to force to use http 1.1?&#160; Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13417549">CXF-8626</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0xrc0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>