<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:13:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6149] ContainerRequestContextImpl hasEntity() always returns true for non-GET requests. Similar for ClientResponseContextImpl</title>
                <link>https://issues.apache.org/jira/browse/CXF-6149</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;According to &lt;a href=&quot;https://jax-rs-spec.java.net/nonav/2.0-rev-a/apidocs/javax/ws/rs/container/ContainerRequestContext.html#hasEntity()&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAX-RS API 2.0 documentation&lt;/a&gt; the &lt;tt&gt;ContainerRequestContext.hasEntity()&lt;/tt&gt; should return &lt;tt&gt;true&lt;/tt&gt; only, when there is &lt;b&gt;non-empty&lt;/b&gt; entity input stream available.&lt;/p&gt;

&lt;p&gt;But &lt;tt&gt;ContainerRequestContextImpl&lt;/tt&gt; always returns &lt;tt&gt;true&lt;/tt&gt; for any non-GET request even if there is &lt;b&gt;no&lt;/b&gt; entity passed with request - check &lt;a href=&quot;https://github.com/apache/cxf/blob/cxf-3.0.3/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/ContainerRequestContextImpl.java#L70&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ContainerRequestContextImpl.java:70&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasEntity() {
        InputStream is = getEntityStream();
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; is != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !HttpMethod.GET.equals(getMethod());
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This happens due to the fact that &lt;tt&gt;getEntityStream()&lt;/tt&gt; is never &lt;tt&gt;null&lt;/tt&gt;. It always returns a &lt;tt&gt;DelegatingInputStream&lt;/tt&gt; wrapper around &lt;tt&gt;javax.servlet.ServletInputStream&lt;/tt&gt; put in message in &lt;tt&gt;AbstractHTTPDestination&lt;/tt&gt; - check &lt;a href=&quot;https://github.com/apache/cxf/blob/cxf-3.0.3/rt/transports/http/src/main/java/org/apache/cxf/transport/http/AbstractHTTPDestination.java#L298&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;AbstractHTTPDestination.java:298&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        DelegatingInputStream in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DelegatingInputStream(req.getInputStream()) {

                     ... &lt;span class=&quot;code-comment&quot;&gt;// skipped
&lt;/span&gt;
        };
        
        inMessage.setContent(DelegatingInputStream.class, in);
        inMessage.setContent(InputStream.class, in);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thus method contract is not satisfied. Presence of input stream doesn&apos;t mean that this stream has content. Implementation should check that there is indeed non-empty entity stream, e.g. via checking EOF using &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html#read()&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;read()&lt;/a&gt; (obviously caching results for actual consumer).&lt;/p&gt;

&lt;p&gt;&lt;b&gt;N.B.&lt;/b&gt;: I believe the same issue affects &lt;tt&gt;ClientResponseContextImpl&lt;/tt&gt; - check &lt;a href=&quot;https://github.com/apache/cxf/blob/cxf-3.0.3/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientResponseContextImpl.java#L62&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ClientResponseContextImpl.java:62&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasEntity() { 
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; getEntityStream() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12760608">CXF-6149</key>
            <summary>ContainerRequestContextImpl hasEntity() always returns true for non-GET requests. Similar for ClientResponseContextImpl</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="kozlovda">Dmitry Kozlov</reporter>
                        <labels>
                            <label>jax-rs</label>
                            <label>jaxrs</label>
                    </labels>
                <created>Wed, 10 Dec 2014 00:34:17 +0000</created>
                <updated>Mon, 16 Feb 2015 16:08:54 +0000</updated>
                            <resolved>Fri, 12 Dec 2014 12:15:41 +0000</resolved>
                                    <version>3.0.3</version>
                                    <fixVersion>3.0.4</fixVersion>
                    <fixVersion>3.1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14245743" author="kozlovda" created="Sun, 14 Dec 2014 00:10:45 +0000"  >&lt;p&gt;Cool! Thanks Sergey!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 49 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2396n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>