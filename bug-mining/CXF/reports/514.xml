<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:40:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2620] CXFServlet fails to init with NPE at line 125 (updateContext) when run with embedded Jetty and Spring3 - works with Spring 2.5.6</title>
                <link>https://issues.apache.org/jira/browse/CXF-2620</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have been using CXF 2.2.3 (also tested with 2.2.5) with Spring 2.5.6 and an embedded Jetty instance successfully for several months. After the release of Spring 3.0, I have tried migrating to the new Spring version. Now the CXF Servlet is failing with a nullpointerexception on the &apos;updateContext&apos; method:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.cxf.transport.servlet.CXFServlet.updateContext(CXFServlet.java:125)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.CXFServlet.onApplicationEvent(CXFServlet.java:182)&lt;br/&gt;
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:97)&lt;br/&gt;
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:294)&lt;br/&gt;
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:296)&lt;br/&gt;
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:858)&lt;br/&gt;
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:419)&lt;/p&gt;

&lt;p&gt;The line that is failing is:&lt;/p&gt;

&lt;p&gt;   resourceManager.addResourceResolver(new ServletContextResourceResolver(servletConfig.getServletContext()));&lt;/p&gt;

&lt;p&gt;I can only reproduce this issue using an &apos;embedded&apos; jetty instance, I have attached a test case. By switching between spring 2.5.6 and spring 3.0, you can see from the log output that the servlet successfully initialized under 2.5.6, but fails under 3.0.&lt;/p&gt;

&lt;p&gt;I understand this may be a very narrow case involving only this method of loading the servlet, so if no fix is required in CXF, some advice as to a workaround would be very welcome. Thank you.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Spring 3.0.0.RELEASE / Jetty 6.1.8 (embedded)&lt;/p&gt;</environment>
        <key id="12445675">CXF-2620</key>
            <summary>CXFServlet fails to init with NPE at line 125 (updateContext) when run with embedded Jetty and Spring3 - works with Spring 2.5.6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="wjblackburn@me.com">William (BJ) Blackburn</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jan 2010 20:49:12 +0000</created>
                <updated>Mon, 1 Feb 2010 19:02:27 +0000</updated>
                            <resolved>Tue, 19 Jan 2010 18:36:01 +0000</resolved>
                                    <version>2.2.5</version>
                                    <fixVersion>2.1.9</fixVersion>
                    <fixVersion>2.2.6</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12800903" author="wjblackburn@me.com" created="Fri, 15 Jan 2010 20:50:55 +0000"  >&lt;p&gt;switch between spring 3.0 and 2.5.6 and note output&lt;/p&gt;</comment>
                            <comment id="12801931" author="wjblackburn@me.com" created="Mon, 18 Jan 2010 20:25:27 +0000"  >&lt;p&gt;I&apos;ve been working on this more - and it now appears to me to have more to do with some mysterious change in Spring between 2.5.6 and 3.0 - I do not think CXF is involved and this issue can probably be closed (although any additional info anyone has is appreciated).&lt;/p&gt;

&lt;p&gt;The code that fails in CXFServlet under Spring 3.0 is at line 125:&lt;/p&gt;

&lt;p&gt;    resourceManager.addResourceResolver(new ServletContextResourceResolver(&lt;br/&gt;
                                               servletConfig.getServletContext()));&lt;/p&gt;

&lt;p&gt;specifically &apos;servletConfig&apos; is null when the sample code is run under Spring 3.0 and is valid when run with 2.5.6. I have been unable to determine what Spring would even have to do with the servlet config.&lt;/p&gt;</comment>
                            <comment id="12801952" author="wjblackburn@me.com" created="Mon, 18 Jan 2010 21:03:34 +0000"  >&lt;p&gt;Please forgive this piecemeal narrative. It now appears that something could be done in CXFServlet to insulate against this issue. I have discovered that the problem is with the implementation of &apos;onApplicationEvent&apos; in CXFServlet. &lt;/p&gt;

&lt;p&gt;I added some tracing to this code. Under Spring 2.5.6 - I saw no evidence that this method was ever called at all. When running under Spring 3.0 this method was called multiple times - the first call happening BEFORE  servletConfig was actually available, and subsequently two more times, resulting in unnecessary context updates that resulted in this information log entry:&lt;/p&gt;

&lt;p&gt;    INFO: Servlet transport factory already registered&lt;/p&gt;

&lt;p&gt;It seems that at minimum, the execution of updateContext should only happen if the ServletConfig is non-null. It also appears that the use of the &apos;inRefresh&apos; flag is insufficient to guard against rapid fire repeat events as seem to be raised in Spring 3.0.&lt;/p&gt;</comment>
                            <comment id="12802408" author="dkulp" created="Tue, 19 Jan 2010 18:36:01 +0000"  >&lt;p&gt;&lt;br/&gt;
Added some NPE guards and &quot;inRefresh&quot; guards to guard against this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12430435" name="embedded-jetty-tests.zip" size="7301" author="wjblackburn@me.com" created="Fri, 15 Jan 2010 20:50:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114019</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14e5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233755</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>