<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:38:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8557] Incorrect Proxy Path Segmenting when @Path Annotation Regex Expression Contains &quot;/&quot;</title>
                <link>https://issues.apache.org/jira/browse/CXF-8557</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Follow up to &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-8556&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-8556&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A service in question needs to be reachable via multiple paths. The&#160;&lt;tt&gt;@Path&lt;/tt&gt;&#160;param allows for regex matching on a class-level like the following:&#160;&lt;tt&gt;@Path(&quot;/{a: regexExpression}&quot;)&lt;/tt&gt;.&#160;A class-level&#160;&lt;tt&gt;@PathParam&lt;/tt&gt;&#160;is created by the name of&#160;&lt;tt&gt;a&lt;/tt&gt;. The following annotations both correctly receive requests at &lt;tt&gt;/foo/bar&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : foo/bar}&quot;&lt;/span&gt;)
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : foo\\/bar}&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When the proxy implementation is invoked, these paths are segmented as an ArrayList with two entries: {&lt;tt&gt;a : foo&lt;/tt&gt; and &lt;tt&gt;bar&lt;/tt&gt;}&#160;and {a : foo\ and &lt;tt&gt;bar&lt;/tt&gt;}&#160;respectively. The expected behavior is for there to be one segment corresponding to this path,&#160;{a : foo/bar}, so that when variables are replaced later (&lt;tt&gt;substituteVarargs&lt;/tt&gt; method in &lt;tt&gt;UriBuilderImpl.java&lt;/tt&gt;), the path parameter&#160;&lt;tt&gt;a&lt;/tt&gt; can be recognized as a vararg and replaced by a phrase matching the regex expression.&lt;/p&gt;

&lt;p&gt;The flow that results in the fragmented segments begins here in the &lt;tt&gt;invoke&lt;/tt&gt; method of the &lt;tt&gt;ClientProxyImpl.java&lt;/tt&gt; class:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.isRoot) {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.addNonEmptyPath(builder, ori.getClassResourceInfo().getURITemplate().getValue());
}

&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.addNonEmptyPath(builder, ori.getURITemplate().getValue());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This leads to the &lt;tt&gt;doPath&lt;/tt&gt; method in the &lt;tt&gt;UriBuilderImpl.java&lt;/tt&gt; class, which calls the following with &lt;tt&gt;checkSegments&lt;/tt&gt; equal to &lt;tt&gt;true&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
List&amp;lt;PathSegment&amp;gt; segments;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (checkSegments) {
    segments = JAXRSUtils.getPathSegments(path, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
    segments = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();
    path = path.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;%2F&quot;&lt;/span&gt;);
    segments.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathSegmentImpl(path, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt&gt;getPathSegments&lt;/tt&gt; method is as follows and is where the &lt;tt&gt;ArrayList&lt;/tt&gt; mentioned above gets populated:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;PathSegment&amp;gt; getPathSegments(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; thePath, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; decode,
                                                &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; ignoreLastSlash) {
    List&amp;lt;PathSegment&amp;gt; theList =
        Arrays.asList(thePath.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;)).stream()
        .filter(StringUtils.notEmpty())
        .map(p -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathSegmentImpl(p, decode))
        .collect(Collectors.toList());

    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; len = thePath.length();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (len &amp;gt; 0 &amp;amp;&amp;amp; thePath.charAt(len - 1) == &lt;span class=&quot;code-quote&quot;&gt;&apos;/&apos;&lt;/span&gt;) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value = ignoreLastSlash ? &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot; : &quot;&lt;/span&gt;/&quot;;
        theList.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathSegmentImpl(value, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;));
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; theList;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The path is split based on the presence of &quot;/&quot;, without regard for if the path segment is defined as a path parameter regex expression.&lt;/p&gt;

&lt;p&gt;The same behavior applies on paths not at a class-level also. For example, the path denoted by a&#160;&lt;tt&gt;@Path(&quot;/{a : foo/bar}/{id}&quot;)&lt;/tt&gt;&#160;on a lower level resource segments the path into the following:&#160;{&lt;tt&gt;a : foo&lt;/tt&gt;,&#160;&lt;tt&gt;bar&lt;/tt&gt;}, and&#160;{id}, when it would be expected to segment into two segments,&#160;{a : foo/bar}&#160;and&#160;{id}. The only difference here being when the path is segmented. Since it is not a root path, it happens after the &lt;tt&gt;isRoot&lt;/tt&gt; check, with the same &lt;tt&gt;addNonEmptyPath&lt;/tt&gt; method.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13385263">CXF-8557</key>
            <summary>Incorrect Proxy Path Segmenting when @Path Annotation Regex Expression Contains &quot;/&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="nrickles3">Noah Rickles</reporter>
                        <labels>
                            <label>Bug</label>
                    </labels>
                <created>Tue, 22 Jun 2021 21:09:58 +0000</created>
                <updated>Wed, 22 Dec 2021 20:41:42 +0000</updated>
                            <resolved>Thu, 8 Jul 2021 17:48:06 +0000</resolved>
                                    <version>3.4.4</version>
                    <version>3.3.11</version>
                                    <fixVersion>3.5.0</fixVersion>
                    <fixVersion>3.3.12</fixVersion>
                    <fixVersion>3.4.5</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17367687" author="nrickles3" created="Tue, 22 Jun 2021 21:19:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;. If you are interested, this is the problem I mentioned I would make an issue about on the other post.&lt;/p&gt;

&lt;p&gt;Not exactly sure at the moment how we would go about solving this, if it is truly an issue. But I would be happy to contribute if necessary.&lt;/p&gt;</comment>
                            <comment id="17367802" author="reta" created="Wed, 23 Jun 2021 01:53:02 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nrickles3&quot; class=&quot;user-hover&quot; rel=&quot;nrickles3&quot;&gt;nrickles3&lt;/a&gt; , this interesting use case. To be honest, I am not sure this an issue with segments, let me try to share my point of view and we could conclude if this is an issue or not:&lt;/p&gt;

&lt;p&gt;&amp;gt; The path is split based on the presence of &quot;/&quot;, without regard for if the path segment is defined as a path parameter regex expression.&lt;/p&gt;

&lt;p&gt;The per RFC-3986 &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, &quot;A path consists of a sequence of path segments separated by a slash (&quot;/&quot;) character.&quot;, so I think it does not matter how URI was constructed (path parameter or segments), the end result consists of segments separated by a slash (&quot;/&quot;) .&lt;/p&gt;

&lt;p&gt;What I am wondering about is actually why the parameter regex&#160; expression was not encoded, I would expect the value&lt;br/&gt;
foo/bar&lt;br/&gt;
to be encoded as&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
foo%2Fbar &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which basically would lead to what you would have expected: a single path segment (`foo/bar`) encoded as (`foo%2Fbar`).&#160; To give a concrete example, considering the URI snippet&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
UriBuilder
    .fromUri(&lt;span class=&quot;code-quote&quot;&gt;&quot;my/path/{a}&quot;&lt;/span&gt;)
    .build(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo/bar&quot;&lt;/span&gt;) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It produces&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
my/path/foo%2Fbar &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is what I would probably expect in your case as well however with regex expressions it may be difficult to support. Does it make sense or confuses even more? Thank you.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3986&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://datatracker.ietf.org/doc/html/rfc3986&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17367828" author="nrickles3" created="Wed, 23 Jun 2021 02:50:33 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, I had a feeling the specification would include the paths being separated by &quot;/&quot;. Are you implying that the code in its current state should be encoding my regex? Or that is a gap in the implementation?&lt;/p&gt;</comment>
                            <comment id="17367887" author="nrickles3" created="Wed, 23 Jun 2021 06:24:48 +0000"  >&lt;p&gt;Another thing to note (off topic, we can deal with this after the &quot;/&quot; situation), on a path at a sub-resource level, let&apos;s say hypothetically the regex expression did not contain &quot;/&quot; and was just something like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@GET
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : (.+)z}/{id}&quot;&lt;/span&gt;)
ResponseData get(@BeanParam &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; id)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In this scenario, if the class path is &lt;tt&gt;/class/path&lt;/tt&gt;,&#160;a request could be received through &lt;tt&gt;/class/path/abcz/123&lt;/tt&gt;&#160;and should be caught by this method. In the path segmentation, it is correctly split up so that there are two variables, &lt;tt&gt;a&lt;/tt&gt;&#160;and &lt;tt&gt;id&lt;/tt&gt;. How does the proxy implementation get the value for &lt;tt&gt;a&lt;/tt&gt; in this situation? The &lt;tt&gt;varValues&lt;/tt&gt; varargs only applies to class level template variables.&lt;/p&gt;

&lt;p&gt;In the invocation of the proxy ( &lt;tt&gt;proxy.get(123)&lt;/tt&gt;&#160;), the only path parameter retrieved is the value of the bean param, 123, from the call to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; pathParams = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getPathParamValues(m, params, types, beanParamsList, ori, bodyIndex);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When the URI is built via&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
URI uri = builder.buildFromEncoded(pathParams.toArray()).normalize();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it throws an exception here in &lt;tt&gt;substituteVarArgs&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; uniqueVars = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedHashSet&amp;lt;&amp;gt;(templ.getVariables());
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!allowUnresolved &amp;amp;&amp;amp; values.length + alreadyResolvedTs.size() + alreadyResolvedTsEnc.size()
    + alreadyResolvedTsPathEnc.size() &amp;lt; uniqueVars.size()) {
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unresolved variables; only &quot;&lt;/span&gt; + values.length
                                       + &lt;span class=&quot;code-quote&quot;&gt;&quot; value(s) given &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; + uniqueVars.size()
                                       + &lt;span class=&quot;code-quote&quot;&gt;&quot; unique variable(s)&quot;&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&quot;Unresolved variables; only 1 value(s) given for 2 unique variable(s)&quot;&lt;/p&gt;

&lt;p&gt;The template has two variables, &lt;tt&gt;a&lt;/tt&gt; and &lt;tt&gt;id&lt;/tt&gt; but only has one value to replace them with, the 123 passed in and retrieved as a path parameter.&lt;/p&gt;

&lt;p&gt;On the other hand, if the class level path is&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : (.+)z}&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and the resource-level path is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{id}&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the &lt;tt&gt;getPathParamValues&lt;/tt&gt; retrieves both the value from the &lt;tt&gt;varValues&lt;/tt&gt; determined in the proxy&apos;s creation (&lt;tt&gt;abcz&lt;/tt&gt;), along with the bean parameter (123), so the URI is built correctly.&lt;/p&gt;

&lt;p&gt;This is slightly off topic from the point of this issue, so I can post it in a separate ticket if this is deemed a problem. I haven&apos;t read the specification, but I would think this is a valid scenario?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17369160" author="reta" created="Thu, 24 Jun 2021 23:34:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nrickles3&quot; class=&quot;user-hover&quot; rel=&quot;nrickles3&quot;&gt;nrickles3&lt;/a&gt; my apologies, I misunderstood the problem at first, getting back to the original issue&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : foo/bar}&quot;&lt;/span&gt;)
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : foo\\/bar}&quot;&lt;/span&gt;)  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Indeed, the presence of the `/` breaks the template recognition. The one thing which confuses me now, you mentioned that the following is working for you.&lt;/p&gt;

&lt;p&gt;&amp;gt; A class-level&#160;&lt;tt&gt;@PathParam&lt;/tt&gt;&#160;is created by the name of&#160;&lt;tt&gt;a&lt;/tt&gt;. The following annotations both correctly receive requests at &lt;tt&gt;/foo/bar&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : foo/bar}&quot;&lt;/span&gt;)
@Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{a : foo\\/bar}&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Indeed, the server side parses the template fine, but does it work when you use &lt;tt&gt;ClientProxyImpl: bean.create(.., &quot;foo/bar&quot;)&lt;/tt&gt;? The issue (at least as I see it) is incorrect URI template parsing inside &lt;b&gt;UriBuilderImpl&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;PS: I have not looked at the subresources yet, just want to fully understand / confirm the initial problem.&lt;/p&gt;

&lt;p&gt;Thank you&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17369244" author="nrickles3" created="Fri, 25 Jun 2021 05:33:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, when I said that&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt; A class-level&#160;&lt;tt&gt;@PathParam&lt;/tt&gt;&#160;is created by the name of&#160;&lt;tt&gt;a&lt;/tt&gt;. The following annotations both correctly receive requests at&#160;&lt;tt&gt;/foo/bar&lt;/tt&gt;:&lt;/p&gt;

&lt;p&gt;I strictly meant on the server side. I can receive requests at that address and it correctly hits my service. The only issues are when a proxy implementation is created.&lt;/p&gt;

&lt;p&gt;The scenario I outlined in the post is in the situation where the &lt;tt&gt;ClientProxyImpl&lt;/tt&gt; is created with &lt;tt&gt;bean.create(..., &quot;foo/bar&quot;)&lt;/tt&gt;. The creation works fine (the &lt;tt&gt;varValues&lt;/tt&gt;&#160;list is set up correctly due to the fix in the previous issue). It is on the invocation of that proxy that the flow begins that fragments the template in the path segmentation.&#160;&lt;/p&gt;

&lt;p&gt;From what I understand, the path segments are generated incorrectly like so:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
segments = JAXRSUtils.getPathSegments(path, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);

&lt;span class=&quot;code-comment&quot;&gt;// segments = [ &lt;span class=&quot;code-quote&quot;&gt;&quot;{a : foo\&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;bar}&quot;&lt;/span&gt; ]&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So when the&#160;&lt;tt&gt;substituteVarargs&lt;/tt&gt;&#160;method in&#160;&lt;tt&gt;UriBuilderImpl.java&lt;/tt&gt; runs, there is nothing to substitute the &lt;tt&gt;&quot;foo/bar&quot;&lt;/tt&gt; &lt;tt&gt;varValue&lt;/tt&gt;&#160;into because the path segments do not contain a template. Please let me know if I need to clarify more.&lt;/p&gt;</comment>
                            <comment id="17369589" author="reta" created="Fri, 25 Jun 2021 17:00:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nrickles3&quot; class=&quot;user-hover&quot; rel=&quot;nrickles3&quot;&gt;nrickles3&lt;/a&gt;&#160;thank you for clarification, it matches exactly my observations, confirming the issue here.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0s75c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>