<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:22:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7148] Race Condition while handling symmetric key in SymmetricBindingHandler</title>
                <link>https://issues.apache.org/jira/browse/CXF-7148</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;when using an asymmetricBinding, when requested in parallel, quite a few requests fail, where the client could not associate a symmetric key with the response.&lt;/p&gt;

&lt;p&gt;As it turned out, the symmetric key was stored temporarily in a cache using an id that is not unique at all.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;SymmetricBindingHandler.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// line 985 via 162
&lt;/span&gt;tokenStore.add(tempTok);

&lt;span class=&quot;code-comment&quot;&gt;// line 182
&lt;/span&gt;tok = tokenStore.getToken(tokenId);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This leads to a race condition if another thread reaches line 162 before the key is retrieved in 182 and the same id is used.&lt;/p&gt;

&lt;p&gt;In my case, the id was &quot;_5002&quot; consistently.&lt;/p&gt;

&lt;p&gt;We implemented a hack using a ThreadLocal based TokenStore, but I think the symmetric key should actually not be cached at all.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13022551">CXF-7148</key>
            <summary>Race Condition while handling symmetric key in SymmetricBindingHandler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="MaxFichtelmann">Max Fichtelmann</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Nov 2016 17:10:20 +0000</created>
                <updated>Wed, 22 Mar 2017 17:24:56 +0000</updated>
                            <resolved>Wed, 23 Nov 2016 12:45:31 +0000</resolved>
                                    <version>3.1.7</version>
                    <version>3.1.8</version>
                                    <fixVersion>3.1.9</fixVersion>
                    <fixVersion>3.0.12</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15687380" author="coheigea" created="Tue, 22 Nov 2016 17:43:25 +0000"  >&lt;p&gt;We need to cache SecurityTokens to make sure that we have access to the symmetric key when processing the response. I think the problem here is that the key used to cache the tokens is dependent on the request. CXF uses random wsu:Ids, but other stacks do not. I&apos;ll take a look at this tomorrow.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="15687395" author="maxfichtelmann" created="Tue, 22 Nov 2016 17:46:43 +0000"  >&lt;p&gt;the insertion into the cache happens during response processing. The key itself is held in some context. But that may be specific to this use-case.&lt;/p&gt;</comment>
                            <comment id="15689763" author="coheigea" created="Wed, 23 Nov 2016 11:02:09 +0000"  >&lt;p&gt;OK I&apos;ve merged a fix, which is to avoid caching SecurityTokens in this case on the receiving side. They only need to be cached on the requesting side, so that we can process the response. Please confirm that this fix works for you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36n3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>