<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:02:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5188] Leaks in ServiceImpl when stopping/restarting bundles</title>
                <link>https://issues.apache.org/jira/browse/CXF-5188</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I&apos;ve been looking at VisualVM heap dumps after restarting some custom bundles in Karaf and noticed the stopped services (exported via DOSGi) linger in memory and are never garbage collected (screenshot attached, StoreServiceImpl being the lingering custom service). Browsing through the instance hierarchy from the snapshot I found something suspicious - org.apache.cxf.endpoint.ServiceImpl registers the ManagedEndpoint with the ServerLifeCycleManager, but doesn&apos;t seem to unregister it when the instance is destroyed. Could this be the memory leak preventing the old bundles from being collected?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Karaf 2.3.2, DOSGi 1.6.0-SNAPSHOT&lt;/p&gt;</environment>
        <key id="12662586">CXF-5188</key>
            <summary>Leaks in ServiceImpl when stopping/restarting bundles</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amichai">Amichai Rothman</assignee>
                                    <reporter username="amichai">Amichai Rothman</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Aug 2013 10:34:23 +0000</created>
                <updated>Fri, 27 Sep 2013 18:18:09 +0000</updated>
                            <resolved>Wed, 14 Aug 2013 14:27:16 +0000</resolved>
                                    <version>2.7.2</version>
                                    <fixVersion>2.7.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13733989" author="amichai" created="Thu, 8 Aug 2013 21:09:53 +0000"  >&lt;p&gt;In addition, ServiceImpl adds a listener to the bindingFactory, but never removes it. That might explain exceptions that appear when restarting bundles. I&apos;m not familiar with these mechanisms, so if someone in the know could have a look at ServiceImpl and make sure all the resources/listeners are properly managed, that would be great!&lt;/p&gt;

&lt;p&gt;java.lang.RuntimeException: Soap 1.1 endpoint already registered on address &lt;a href=&quot;http://192.168.1.100:9000/com/example/MyService&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://192.168.1.100:9000/com/example/MyService&lt;/a&gt;&lt;br/&gt;
        at org.apache.cxf.binding.soap.SoapBindingFactory.addListener(SoapBindingFactory.java:921)&lt;br/&gt;
        at org.apache.cxf.endpoint.ServerImpl.start(ServerImpl.java:131)&lt;span class=&quot;error&quot;&gt;&amp;#91;142:org.apache.cxf.cxf-api:2.7.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.frontend.ServerFactoryBean.create(ServerFactoryBean.java:204)&lt;span class=&quot;error&quot;&gt;&amp;#91;150:org.apache.cxf.cxf-rt-frontend-simple:2.7.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.handlers.AbstractPojoConfigurationTypeHandler.createServerFromFactory(AbstractPojoConfigurationTypeHandler.java:191)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.handlers.PojoConfigurationTypeHandler.createServer(PojoConfigurationTypeHandler.java:119)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.service.RemoteServiceAdminCore.exportInterfaces(RemoteServiceAdminCore.java:184)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.service.RemoteServiceAdminCore.exportService(RemoteServiceAdminCore.java:140)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.service.RemoteServiceAdminInstance$1.run(RemoteServiceAdminInstance.java:59)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.service.RemoteServiceAdminInstance$1.run(RemoteServiceAdminInstance.java:57)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.security.AccessController.doPrivileged(Native Method)&lt;span class=&quot;error&quot;&gt;&amp;#91;:1.7.0_25&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.service.RemoteServiceAdminInstance.exportService(RemoteServiceAdminInstance.java:57)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.dsw.service.RemoteServiceAdminInstance.exportService(RemoteServiceAdminInstance.java:41)&lt;span class=&quot;error&quot;&gt;&amp;#91;161:cxf-dosgi-ri-dsw-cxf:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.topologymanager.exporter.TopologyManagerExport.exportServiceUsingRemoteServiceAdmin(TopologyManagerExport.java:185)&lt;span class=&quot;error&quot;&gt;&amp;#91;160:cxf-dosgi-ri-topology-manager:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.topologymanager.exporter.TopologyManagerExport.doExportService(TopologyManagerExport.java:168)&lt;span class=&quot;error&quot;&gt;&amp;#91;160:cxf-dosgi-ri-topology-manager:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cxf.dosgi.topologymanager.exporter.TopologyManagerExport$3.run(TopologyManagerExport.java:143)&lt;span class=&quot;error&quot;&gt;&amp;#91;160:cxf-dosgi-ri-topology-manager:1.6.0.SNAPSHOT&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;span class=&quot;error&quot;&gt;&amp;#91;:1.7.0_25&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;span class=&quot;error&quot;&gt;&amp;#91;:1.7.0_25&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:724)&lt;span class=&quot;error&quot;&gt;&amp;#91;:1.7.0_25&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="13739474" author="amichai" created="Wed, 14 Aug 2013 10:06:39 +0000"  >&lt;p&gt;The main leak turns out to be higher up the stack in ServerFactoryBean - when a server is initialized successfully but then throws an exception when started (such as the one above), the exception is propagated and the server is not properly disposed of. I fixed it to first destroy the server before propagating the exception.&lt;/p&gt;

&lt;p&gt;After this fix the main leak (which was easily recreated on almost every restart) is closed, but there&apos;s still another leak somewhere that&apos;s harder to recreate, I&apos;ve seen it a couple of times and haven&apos;t tracked it down yet - I&apos;ll open a separate issue when I have more details.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12596818" name="ServiceImpl_leak_snapshot.png" size="59581" author="amichai" created="Thu, 8 Aug 2013 10:36:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342589</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n2z3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>