<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:57:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4629] Security issue with GET methods: WSS4JInInterceptor always allows HTTP Get requests from browser</title>
                <link>https://issues.apache.org/jira/browse/CXF-4629</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Hello All,&lt;/p&gt;

&lt;p&gt;We are running CFX web services with the following configuration:&lt;/p&gt;

&lt;p&gt;web.xml&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    &amp;lt;servlet&amp;gt;
        &amp;lt;servlet-name&amp;gt;cxf&amp;lt;/servlet-name&amp;gt;
        &amp;lt;servlet-class&amp;gt;org.apache.cxf.transport.servlet.CXFServlet&amp;lt;/servlet-class&amp;gt;
        &amp;lt;load-on-startup&amp;gt;1&amp;lt;/load-on-startup&amp;gt;
    &amp;lt;/servlet&amp;gt;

    &amp;lt;servlet-mapping&amp;gt;
        &amp;lt;servlet-name&amp;gt;cxf&amp;lt;/servlet-name&amp;gt;
        &amp;lt;url-pattern&amp;gt;/ls/*&amp;lt;/url-pattern&amp;gt;
    &amp;lt;/servlet-mapping&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;spring config:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    &amp;lt;!-- ######################################### --&amp;gt;
    &amp;lt;beans:import resource=&quot;classpath:META-INF/cxf/cxf.xml&quot; /&amp;gt;
    &amp;lt;beans:import resource=&quot;classpath:META-INF/cxf/cxf-servlet.xml&quot; /&amp;gt;
    &amp;lt;beans:import resource=&quot;classpath:META-INF/cxf/cxf-extension-soap.xml&quot; /&amp;gt;

    &amp;lt;jaxws:endpoint id=&quot;lsWebEndpoint&quot;
        implementor=&quot;${our endpoint class}&quot;
        address=&quot;/api&quot; &amp;gt;

        &amp;lt;jaxws:inInterceptors&amp;gt;
            &amp;lt;bean class=&quot;org.apache.cxf.binding.soap.saaj.SAAJInInterceptor&quot; /&amp;gt;
            &amp;lt;bean class=&quot;org.apache.cxf.ws.security.wss4j.WSS4JInInterceptor&quot;&amp;gt;
                &amp;lt;constructor-arg&amp;gt;
                    &amp;lt;map&amp;gt;
                        &amp;lt;entry key=&quot;action&quot; value=&quot;UsernameToken&quot;/&amp;gt;
                        &amp;lt;entry key=&quot;passwordType&quot; value=&quot;PasswordText&quot;/&amp;gt;
                        &amp;lt;entry key=&quot;passwordCallbackClass&quot; value=&quot;${our password callback impl}&quot;/&amp;gt;
                    &amp;lt;/map&amp;gt;
                &amp;lt;/constructor-arg&amp;gt;
            &amp;lt;/bean&amp;gt;
        &amp;lt;/jaxws:inInterceptors&amp;gt;

    &amp;lt;/jaxws:endpoint&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And we discovered that all our web services are accessible via browser (HTTP Get) without any authentication. &lt;br/&gt;
For instance:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;http://localhost:8181/ls/api/test?a=10&amp;amp;b=20
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;@WebService
public class WSEndpoint {

    @WebMethod
    public int test(@WebParam(name = &quot;a&quot;) int a,
                    @WebParam(name = &quot;b&quot;) int b) {
        return a + b;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;returns&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;
&amp;lt;soap:Body&amp;gt;
&amp;lt;ns2:testResponse xmlns:ns2=&quot;${our namespace}&quot;&amp;gt;
&amp;lt;return&amp;gt;30&amp;lt;/return&amp;gt;
&amp;lt;/ns2:testResponse&amp;gt;
&amp;lt;/soap:Body&amp;gt;
&amp;lt;/soap:Envelope&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The reason is the following code in WSS4JInInterceptor:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    public final boolean isGET(SoapMessage message) {
        String method = (String)message.get(SoapMessage.HTTP_REQUEST_METHOD);
        return &quot;GET&quot;.equals(method) &amp;amp;&amp;amp; message.getContent(XMLStreamReader.class) == null;
    }
    
    public void handleMessage(SoapMessage msg) throws Fault {
        if (msg.containsKey(SECURITY_PROCESSED) || isGET(msg)) {
            return;
        }:
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I was not able to find anything specific on google why GET methods are always allowed.&lt;/p&gt;

&lt;p&gt;However it&apos;s somehow related to &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-3170&quot; title=&quot;NullPointerException in StaxUtils.java:961&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-3170&quot;&gt;&lt;del&gt;CXF-3170&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
Please see &lt;a href=&quot;http://cxf.547215.n5.nabble.com/svn-commit-r1062014-in-cxf-branches-2-3-x-fixes-rt-ws-security-src-main-java-org-apache-cxf-ws-secura-tt3352201.html#none&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.547215.n5.nabble.com/svn-commit-r1062014-in-cxf-branches-2-3-x-fixes-rt-ws-security-src-main-java-org-apache-cxf-ws-secura-tt3352201.html#none&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also i found the following thread on StackOverflow without answer:&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/7933293/why-does-apache-cxf-ws-security-implementation-ignore-get-requests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/7933293/why-does-apache-cxf-ws-security-implementation-ignore-get-requests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please advice on this this issue.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Oleh.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12615806">CXF-4629</key>
            <summary>Security issue with GET methods: WSS4JInInterceptor always allows HTTP Get requests from browser</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="soulkeeper">Oleh Faizulin</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Nov 2012 21:47:41 +0000</created>
                <updated>Wed, 19 Dec 2012 14:38:41 +0000</updated>
                            <resolved>Mon, 26 Nov 2012 18:04:38 +0000</resolved>
                                    <version>2.6.3</version>
                    <version>2.7</version>
                                    <fixVersion>2.5.7</fixVersion>
                    <fixVersion>2.6.4</fixVersion>
                    <fixVersion>2.7.1</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13495816" author="ffang" created="Tue, 13 Nov 2012 01:22:23 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;WSS4JInInterceptor is used for ws-security, and ws-security is based on soap message. IIRC, all soap message is carried via POST, but not GET. Honestly I&apos;m  a little bit surprised this GET request could pass through all other interceptors and invoke the method, could you please post the on-wire request message?&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="13496475" author="soulkeeper" created="Tue, 13 Nov 2012 19:40:58 +0000"  >&lt;p&gt;Freeman,&lt;/p&gt;

&lt;p&gt;I don&apos;t get what do you mean by &lt;b&gt;the on-wire request message&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;I just start browser, write&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;http://localhost:8181/ls/api/test?a=10&amp;amp;b=20&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;press enter and get result from web service.&lt;/p&gt;

&lt;p&gt;Anyway, to fix the problem we introduced our custom interceptor.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;jaxws:inInterceptors&amp;gt;
            &amp;lt;bean class=&quot;com.ourpackage.RequestFilterInterceptor&quot; /&amp;gt;         &amp;lt;---- This one
            &amp;lt;bean class=&quot;org.apache.cxf.binding.soap.saaj.SAAJInInterceptor&quot; /&amp;gt;
            &amp;lt;bean class=&quot;org.apache.cxf.ws.security.wss4j.WSS4JInInterceptor&quot;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;/**
 * @author Aquanox
 * @date 13.11.2012 14:46
 */
public class RequestFilterInterceptor extends AbstractWSS4JInterceptor {

    public RequestFilterInterceptor() {
        super();
        setPhase(Phase.PRE_PROTOCOL);
    }

    @Override
    public void handleMessage(SoapMessage message) throws Fault {
        if (message.getContent(SOAPMessage.class) == null) {
            throw createSoapFault(message.getVersion(), new WSSecurityException(WSSecurityException.INVALID_SECURITY));
        }
    }

    /**
     * Create a SoapFault from a WSSecurityException, following the SOAP Message Security
     * 1.1 specification, chapter 12 &quot;Error Handling&quot;.
     *
     * When the Soap version is 1.1 then set the Fault/Code/Value from the fault code
     * specified in the WSSecurityException (if it exists).
     *
     * Otherwise set the Fault/Code/Value to env:Sender and the Fault/Code/Subcode/Value
     * as the fault code from the WSSecurityException.
     */
    private SoapFault createSoapFault(SoapVersion version, WSSecurityException e) {
        SoapFault fault;
        javax.xml.namespace.QName faultCode = e.getFaultCode();
        if (version.getVersion() == 1.1 &amp;amp;&amp;amp; faultCode != null) {
            fault = new SoapFault(e.getMessage(), e, faultCode);
        } else {
            fault = new SoapFault(e.getMessage(), e, version.getSender());
            if (version.getVersion() != 1.1 &amp;amp;&amp;amp; faultCode != null) {
                fault.setSubCode(faultCode);
            }
        }
        return fault;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13496513" author="dkulp" created="Tue, 13 Nov 2012 20:31:05 +0000"  >
&lt;p&gt;This is due to the URIMappingInterceptor.  &lt;/p&gt;

&lt;p&gt;As a bit of history: this interceptor was added a very very long time ago to enable some basic &quot;rest style&quot; access to various SOAP services.   This pretty much predates all the &quot;real&quot; attempts of rest within CXF, even the old http-binding that has now been removed.  With JAX-RS, there is less value of this interceptor.  That said, I know it&apos;s used as we did provide fixes to it last year. &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-3499&quot; title=&quot;URIMappingInterceptor and ArrayIndexOutOfBoundsException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-3499&quot;&gt;&lt;del&gt;CXF-3499&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-3480&quot; title=&quot;URIMappingInterceptor and ArrayIndexOutOfBounds Error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-3480&quot;&gt;&lt;del&gt;CXF-3480&lt;/del&gt;&lt;/a&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-2697&quot; title=&quot;REST and web methods taking arguments called without argument leads to IllegalArgumentException: wrong number of arguments exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-2697&quot;&gt;&lt;del&gt;CXF-2697&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;What I&apos;d like to do to fix this is:&lt;/p&gt;

&lt;p&gt;1) In WSS4JInInterceptor, set a flag to make sure the URIInInterceptor is bypassed (or remove the URIInInterceptor off the chain).   Port this back to 2.5/2.6&lt;/p&gt;

&lt;p&gt;2) For 2.7.1/trunk, remove the URIInInterceptor off the default chain.  Leave the class in the codebase so a user could configure it in if they require it, marked @Deprecated.&lt;/p&gt;

&lt;p&gt;3) At some point in the future, completely remove it.  With the JAX-RS support, we now have MUCH MUCH better ways of handling REST, even in conjunction with the SOAP endpoints.&lt;/p&gt;

&lt;p&gt;Any concerns or other ideas?&lt;/p&gt;</comment>
                            <comment id="13496654" author="ffang" created="Tue, 13 Nov 2012 23:10:43 +0000"  >&lt;p&gt;Thanks Dan for this clarification, I think you mean the URIMappingInterceptor.&lt;br/&gt;
And +1 for your suggestion.&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12492575">CXF-3170</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>257285</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0jxin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114360</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>