<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:16:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6217] JmsPullPoint does not protect against external entities</title>
                <link>https://issues.apache.org/jira/browse/CXF-6217</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I am not sure if this is by design, but the unmarshell below does not prevent nor limit external entities resolution. This can expose the parser to an XML External Entities attack.&lt;/p&gt;

&lt;p&gt;JmsPullPoint:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; List&amp;lt;NotificationMessageHolderType&amp;gt; getMessages(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; max) 
        &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ResourceUnknownFault, UnableToGetMessagesFault {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (max == 0) {
                max = 256;
            }
            initSession();
            List&amp;lt;NotificationMessageHolderType&amp;gt; messages = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;NotificationMessageHolderType&amp;gt;();
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; max; i++) {
                Message msg = consumer.receiveNoWait();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (msg == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }
                TextMessage txtMsg = (TextMessage) msg;
                StringReader reader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringReader(txtMsg.getText());
                Notify notify = (Notify) jaxbContext.createUnmarshaller().unmarshal(reader);
                messages.addAll(notify.getNotificationMessage());
            }
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; messages;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12769316">CXF-6217</key>
            <summary>JmsPullPoint does not protect against external entities</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="dkwakkel">Donald Kwakkel</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Jan 2015 14:42:37 +0000</created>
                <updated>Fri, 31 Mar 2017 19:38:49 +0000</updated>
                            <resolved>Thu, 23 Mar 2017 17:01:31 +0000</resolved>
                                    <version>3.0.1</version>
                                    <fixVersion>3.0.4</fixVersion>
                    <fixVersion>2.7.15</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14287615" author="dkwakkel" created="Thu, 22 Jan 2015 15:35:24 +0000"  >&lt;p&gt;Found more unmarshall occurences which seems not to be protected against external entity injection. e.g. in JmsSubscription and AtomPojoProvider.&lt;/p&gt;</comment>
                            <comment id="14290797" author="dkwakkel" created="Sat, 24 Jan 2015 19:51:14 +0000"  >&lt;p&gt;Thanks for the quick fix!&lt;/p&gt;

&lt;p&gt;I saw in AtomPojoProvider the reader is cleaned up in a try-finally, but this is not used on the other places. Any reason for this?&lt;br/&gt;
And I think in JmsPullPoint accidently reader iso xreader is closed, can you check this?&lt;/p&gt;</comment>
                            <comment id="14607679" author="dkwakkel" created="Tue, 30 Jun 2015 07:18:19 +0000"  >&lt;p&gt;Can you answer my previous comment?&lt;/p&gt;

&lt;p&gt;Also found some more occurences (CXF 3.1.1):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;1. org.apache.cxf.jaxrs.ext.xml.XmlSource:    XPath xpath = XPathFactory.newInstance().newXPath();
2. org.apache.cxf.jaxrs.provider.XSLTJaxbProvider:   factory = (SAXTransformerFactory)TransformerFactory.newInstance();
3. org.apache.cxf.tools.validator.internal.ValidatorUtil : DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();
4. org.apache.cxf.tools.common.toolspec.ToolSpec : Transformer trans = TransformerFactory.newInstance().newTransformer(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamSource(stylesheet));
5. org.apache.cxf.management.web.browser.bootstrapping.SimpleXMLSettingsStorage: entries = (Entries) unmarshaller.unmarshal(file);
6. org.apache.cxf.tools.validator.internal.SchemaValidator:   SAXSource saxSource = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SAXSource(saxParser.getXMLReader(), wsdlsource);
7. org.apache.cxf.tools.wsdlto.core.PluginLoader: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (Plugin) ((JAXBElement&amp;lt;?&amp;gt;)unmarshaller.unmarshal(is)).getValue();
8. org.apache.cxf.transport.http.netty.server.blueprint.NettyHttpServerEngineFactoryHolder:  Element element = docFactory.newDocumentBuilder().parse(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(parsedElement.getBytes())).getDocumentElement();
9. org.apache.cxf.transport.http_jetty.blueprint.JettyHTTPServerEngineFactoryHolder: Element element = docFactory.newDocumentBuilder().parse(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(parsedElement.getBytes())).getDocumentElement();
10. org.apache.cxf.tools.wsdlto.databinding.jaxb.NamespaceContextImpl: document = docFact.newDocumentBuilder().parse(file);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Do you want a new ticket for this?&lt;/p&gt;</comment>
                            <comment id="14607869" author="dkwakkel" created="Tue, 30 Jun 2015 07:28:13 +0000"  >&lt;p&gt;Most are vulnerable for both XML External Entity Injection and XML Entity Expansion Injection.&lt;/p&gt;</comment>
                            <comment id="14610078" author="dkulp" created="Wed, 1 Jul 2015 13:03:28 +0000"  >&lt;p&gt;#1 has a workaround (enable buffering), but does need to be fixed.&lt;/p&gt;

&lt;p&gt;Is #2 an actual problem? (have a testcase?)  We never pass in an InputStream or similar.  It&apos;s always a StaxSource which goes through StaxUtils for the parsing.&lt;/p&gt;

&lt;p&gt;#5 is only hit at application startup time and would require shell access to the file system to change the file and ability to restart the app.&lt;/p&gt;

&lt;p&gt;3/4/6/7/10 are only for the command line tools. Low priority, but probably should be fixed.&lt;/p&gt;

&lt;p&gt;8/9 aren&apos;t problems.   The byte[] (parsedElement.getBytes()) that is passed in is created from already parsed XML DOM.   &lt;/p&gt;</comment>
                            <comment id="14610227" author="dkwakkel" created="Wed, 1 Jul 2015 13:23:16 +0000"  >&lt;p&gt;I would fix all locations, just to be sure that in case flow changes not accidently a security issue is introduced.&lt;/p&gt;</comment>
                            <comment id="14610229" author="dkwakkel" created="Wed, 1 Jul 2015 13:23:47 +0000"  >&lt;p&gt;Can you also answer my previous comment?:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I saw in AtomPojoProvider the reader is cleaned up in a try-finally, but this is not used on the other places. Any reason for this?&lt;br/&gt;
And I think in JmsPullPoint accidently reader iso xreader is closed, can you check this?&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14610409" author="dkulp" created="Wed, 1 Jul 2015 14:58:10 +0000"  >&lt;p&gt;10 is definitely not a problem.  Class is never even used/created.   git rm&lt;/p&gt;</comment>
                            <comment id="15938767" author="dkulp" created="Thu, 23 Mar 2017 17:01:31 +0000"  >&lt;p&gt;Marking resolved as the initial issue is fixed along with the additional items marked important.  If additional issues persist, new issues should be raised.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24o4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>