<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:11:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5388] Can&apos;t register two similar callbacks to different services</title>
                <link>https://issues.apache.org/jira/browse/CXF-5388</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Hi,&lt;br/&gt;
our client application we need to register multiple similar callbacks to different similar services.&lt;/p&gt;

&lt;p&gt;This is done by using this code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;		    JaxWsServerFactoryBean svrFactory = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JaxWsServerFactoryBean();
		    svrFactory.setServiceClass(CallbackImpl.class);
		    
		    &lt;span class=&quot;code-comment&quot;&gt;//Attention: It is necessary that thre is at least one character after the IOR:. Doesn&apos;t matter which character(s). 
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;//Whithout &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; it&apos;s not a legal URL
&lt;/span&gt;		    svrFactory.setAddress(&lt;span class=&quot;code-quote&quot;&gt;&quot;IOR:callback&quot;&lt;/span&gt;);
		    svrFactory.setEndpointName( &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QName( http:&lt;span class=&quot;code-comment&quot;&gt;//zst.heuboe.de&quot;, 
&lt;/span&gt;		            &lt;span class=&quot;code-quote&quot;&gt;&quot;CallbackCORBAPort&quot;&lt;/span&gt; ) );
		    svrFactory.setServiceName(  &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QName( &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//zst.heuboe.de&quot;&lt;/span&gt;, 
&lt;/span&gt;		            &lt;span class=&quot;code-quote&quot;&gt;&quot;CallbackCORBAService&quot;&lt;/span&gt; ) ); 
		    svrFactory.setServiceBean(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CallbackImpl());
		    svrFactory.setWsdlLocation(&lt;span class=&quot;code-quote&quot;&gt;&quot;classpath:guiService.wsdl&quot;&lt;/span&gt;);
		    svrFactory.getInInterceptors().add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LoggingInInterceptor());
		    svrFactory.getOutInterceptors().add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LoggingOutInterceptor());
		    Server s = svrFactory.create();

		    EndpointReferenceType epr = s.getDestination().getAddress();
		    Source src = EndpointReferenceUtils.convertToXML(epr);
		    W3CEndpointReference ref = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; W3CEndpointReference(src);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you call this code a second time you get an exception in CorbaDestination at this point:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;CorbaDestination-Snipplet&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-comment&quot;&gt;// When using object references, we can run into a situation where
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// we are implementing
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// multiple instances of the same port type such that we would end
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// up using the same
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// poaname &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; each when persistance is used. Handle &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; by
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// not throwing an
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// exception at &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; point during the activation, we should see an
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// exception &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// an activate two objects with the same servant ID instead.
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (bindingPOA != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !isPersistent &amp;amp;&amp;amp; serviceId == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CorbaBindingException(
                        &lt;span class=&quot;code-quote&quot;&gt;&quot;Corba Port activation failed because the poa &quot;&lt;/span&gt;
                                + poaName + &lt;span class=&quot;code-quote&quot;&gt;&quot; already exists&quot;&lt;/span&gt;);
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (bindingPOA == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                bindingPOA = createPOA(poaName, rootPOA, poaManager);
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In my opinion it should be possible to register multiple callbacks of the same &apos;type&apos;.&lt;/p&gt;

&lt;p&gt;Thx&lt;/p&gt;

&lt;p&gt;J&#252;rgen&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows / JAVA 7/ CXF 2.7.8-SNAPSHOT&lt;/p&gt;</environment>
        <key id="12679384">CXF-5388</key>
            <summary>Can&apos;t register two similar callbacks to different services</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jaybee">J&#252;rgen Bockhorn</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Nov 2013 12:29:20 +0000</created>
                <updated>Fri, 11 Jul 2014 12:50:34 +0000</updated>
                            <resolved>Fri, 11 Apr 2014 17:34:04 +0000</resolved>
                                    <version>2.7.8</version>
                                    <fixVersion>Invalid</fixVersion>
                                    <component>CORBA Binding</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13826518" author="gzres" created="Tue, 19 Nov 2013 13:48:25 +0000"  >&lt;p&gt;After some research (thank you J&#252;rgen for help!), Here&apos;s the solution.&lt;/p&gt;

&lt;p&gt;First - there &lt;b&gt;is&lt;/b&gt; a need to be able to create more than one Server (and underneath: POA, Servant, CorbaDestination) for the same set of inputs:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;WSDL (with single &lt;tt&gt;wsdl:service/wsdl:port&lt;/tt&gt;)&lt;/li&gt;
	&lt;li&gt;implementation class (the instances are different)&lt;/li&gt;
	&lt;li&gt;service name&lt;/li&gt;
	&lt;li&gt;endpoint (port) name&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The goal is to be able to publish different Corba objects (different IORs) wrapped inside W3CEndpointReference.&lt;/p&gt;

&lt;p&gt;The existing code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            poaName = CorbaUtils.getUniquePOAName(getEndPointInfo()
                    .getService().getName(), getEndPointInfo().getName()
                    .getLocalPart(), poaName).replace(&lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;_&apos;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;doesn&apos;t have anything to distinguish between consecutive invocations. Anything except initial &lt;tt&gt;poaName&lt;/tt&gt; - which may be customized by &lt;tt&gt;corba:policy&lt;/tt&gt; extension of &lt;tt&gt;wsdl:service/wsdl:port&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;So my solution is to create a listener which would allow to dynamically add the &lt;tt&gt;org.apache.cxf.binding.corba.wsdl.PolicyType&lt;/tt&gt; to just created endpoint:&lt;/p&gt;

&lt;p&gt;1. The listener (not thread safe!)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;PoaNameCustomizer &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; FactoryBeanListener {
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; poaName;

        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void handleEvent(Event ev, AbstractServiceFactoryBean factory, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; ... args) {
            &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (ev) {
                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; ENDPOINT_CREATED: {
                    EndpointInfo ei = (EndpointInfo)args[0];
                    PolicyType pt = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PolicyType();
                    pt.setPoaname(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.poaName);
                    ei.addExtensor(pt);
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }
                &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;:
                    &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; nothing
&lt;/span&gt;            }
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setPoaName(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; poaName) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.poaName = poaName;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2. Bus configuration (before any service creation)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        Bus bus = BusFactory.getDefaultBus();
        FactoryBeanListenerManager m = bus.getExtension(FactoryBeanListenerManager.class);
        PoaNameCustomizer poaNameCustomizer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PoaNameCustomizer();
        m.addListener(poaNameCustomizer);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3. Now, after creating JaxWsServerFactoryBean, a little bit of customization (setting customized bus):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        svrFactory.setBus(bus);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4. And just before svrFactory.create(); A configuration of the bus&apos; Poa Name listener:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            ...
            svrFactory.getOutInterceptors().add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LoggingOutInterceptor());
            poaNameCustomizer.setPoaName(&lt;span class=&quot;code-quote&quot;&gt;&quot;poa1&quot;&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// different value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; next service creation
&lt;/span&gt;            Server s = svrFactory.create();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After this, J&#252;rgen&apos;s code works fine.&lt;/p&gt;

&lt;p&gt;regards&lt;br/&gt;
Grzegorz Grzybek&lt;/p&gt;</comment>
                            <comment id="13961649" author="gzres" created="Mon, 7 Apr 2014 05:38:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jaybee&quot; class=&quot;user-hover&quot; rel=&quot;jaybee&quot;&gt;jaybee&lt;/a&gt; hello - could you confirm that this workaround works for you? I don&apos;t think it could be &lt;em&gt;fixed&lt;/em&gt; in CXF anyway...&lt;/p&gt;

&lt;p&gt;regards&lt;br/&gt;
Grzegorz Grzybek&lt;/p&gt;</comment>
                            <comment id="13961661" author="jaybee" created="Mon, 7 Apr 2014 06:43:59 +0000"  >&lt;p&gt;Hello Grzegorz,&lt;/p&gt;

&lt;p&gt;I can confirm that the workaround works for us. &lt;/p&gt;

&lt;p&gt;Thx for your work.&lt;/p&gt;

&lt;p&gt;J&#252;rgen&lt;/p&gt;</comment>
                            <comment id="13966846" author="dkulp" created="Fri, 11 Apr 2014 17:34:04 +0000"  >&lt;p&gt;Workaround is provided and isn&apos;t really something that is &quot;fixable&quot; as noted.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358745</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pucf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>359035</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>