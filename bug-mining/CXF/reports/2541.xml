<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:15:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6274] NullPointerException in DestinationSequence because of RMCaptureInInterceptor not in interceptor chain</title>
                <link>https://issues.apache.org/jira/browse/CXF-6274</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I&apos;m building a prototype webservice using one-way WS-RM (in combination with SAML sender vouches).&lt;br/&gt;
It works well as long as there&apos;s no persistence store configured.&lt;/p&gt;

&lt;p&gt;When using a jdbcStore (Oracle DB) I get this NullPointerException:&lt;/p&gt;

&lt;p&gt;11:19:27,214 WARNING &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.cxf.phase.PhaseInterceptorChain&amp;#93;&lt;/span&gt; (http-/0.0.0.0:8080-1) Interceptor for &lt;/p&gt;
{...}CMLResponseManagerAsyncWSService#{...}
&lt;p&gt;respondGetInfo has thrown exception, unwinding now: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.cxf.ws.rm.DestinationSequence.acknowledge(DestinationSequence.java:171)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12779761">CXF-6274</key>
            <summary>NullPointerException in DestinationSequence because of RMCaptureInInterceptor not in interceptor chain</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ay">Akitoshi Yoshida</assignee>
                                    <reporter username="j_ri">Jochen Riedlinger</reporter>
                        <labels>
                            <label>WS-RM</label>
                            <label>WS-ReliableMessaging</label>
                    </labels>
                <created>Thu, 5 Mar 2015 10:30:34 +0000</created>
                <updated>Fri, 14 Oct 2016 14:23:48 +0000</updated>
                            <resolved>Thu, 30 Apr 2015 15:14:49 +0000</resolved>
                                    <version>2.7.14</version>
                    <version>3.0.4</version>
                                    <fixVersion>3.1</fixVersion>
                    <fixVersion>2.7.16</fixVersion>
                    <fixVersion>3.0.5</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14358235" author="j_ri" created="Thu, 12 Mar 2015 07:51:06 +0000"  >&lt;p&gt;After some debugging sessions I found out that the &quot;RMCaptureInInterceptor&quot; was not added to the chain.&lt;/p&gt;

&lt;p&gt;The logfile on my server shows this:&lt;br/&gt;
08:29:39,655 FINE  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.cxf.phase.PhaseInterceptorChain&amp;#93;&lt;/span&gt; (http-/0.0.0.0:8080-1) Chain org.apache.cxf.phase.PhaseInterceptorChain@3a17df00 was modified. Current flow:&lt;br/&gt;
  receive &lt;span class=&quot;error&quot;&gt;&amp;#91;PolicyInInterceptor, AttachmentInInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  pre-stream &lt;span class=&quot;error&quot;&gt;&amp;#91;CertConstraintsInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  post-stream &lt;span class=&quot;error&quot;&gt;&amp;#91;StaxInInterceptor, PolicyBasedWSS4JStaxInInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  read &lt;span class=&quot;error&quot;&gt;&amp;#91;WSDLGetInterceptor, ReadHeadersInterceptor, SoapActionInInterceptor, StartBodyInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  pre-protocol &lt;span class=&quot;error&quot;&gt;&amp;#91;MustUnderstandInterceptor, MAPCodec, RMSoapInInterceptor, PolicyBasedWSS4JInInterceptor, SamlTokenInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  post-protocol &lt;span class=&quot;error&quot;&gt;&amp;#91;CheckFaultInterceptor, JAXBAttachmentSchemaValidationHack&amp;#93;&lt;/span&gt;&lt;br/&gt;
  unmarshal &lt;span class=&quot;error&quot;&gt;&amp;#91;DocLiteralInInterceptor, BareInInterceptor, SoapHeaderInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  pre-logical &lt;span class=&quot;error&quot;&gt;&amp;#91;RMInInterceptor, MAPAggregatorImpl, OneWayProcessorInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  post-logical &lt;span class=&quot;error&quot;&gt;&amp;#91;WrapperClassInInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  pre-invoke &lt;span class=&quot;error&quot;&gt;&amp;#91;StaxInEndingInterceptor, SwAInInterceptor, HolderInInterceptor, SubjectCreatingSAMLPolicyInterceptor, PolicyVerificationInInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  invoke &lt;span class=&quot;error&quot;&gt;&amp;#91;ServiceInvokerInterceptor, UltimateReceiverMustUnderstandInterceptor&amp;#93;&lt;/span&gt;&lt;br/&gt;
  post-invoke &lt;span class=&quot;error&quot;&gt;&amp;#91;RMDeliveryInterceptor, OutgoingChainInterceptor, SubjectCreatingSAMLPolicyCleanUpInterceptor&amp;#93;&lt;/span&gt;&lt;/p&gt;


&lt;p&gt;If &quot;RMCaptureInInterceptor&quot; is not executed&lt;br/&gt;
    message.put(RMMessageConstants.SAVED_CONTENT, ris);&lt;br/&gt;
there&apos;s no SAVED_CONTENT in the message.&lt;br/&gt;
That causes my NullPointerException.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach my &quot;cxf-servlet.xml&quot;, so that you can see my configuration.&lt;br/&gt;
Since other RM*INterceptos are added to the chain, I&apos;m quite convinced that there&apos;s a bug.&lt;/p&gt;</comment>
                            <comment id="14358502" author="j_ri" created="Thu, 12 Mar 2015 11:11:19 +0000"  >&lt;p&gt;Found Workaround:&lt;br/&gt;
Configuring the capture interceptors myself on the endpoint, it works:&lt;/p&gt;

&lt;p&gt;&amp;lt;jaxws:endpoint id=&quot;CMLResponseManagerAsyncWS&quot; address=&quot;/cmlresponsemanagerasyncws&quot;&lt;br/&gt;
		implementor=&quot;de.lbank.ws_saml.ws.CMLResponseManagerAsyncWSImpl&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;jaxws:inInterceptors&amp;gt;&lt;br/&gt;
    		&amp;lt;ref bean=&quot;rmCapIn&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmLogicalIn&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmCodecIn&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/jaxws:inInterceptors&amp;gt;&lt;br/&gt;
    &amp;lt;jaxws:inFaultInterceptors&amp;gt;&lt;br/&gt;
    		&amp;lt;ref bean=&quot;rmCapIn&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmLogicalIn&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmCodecIn&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/jaxws:inFaultInterceptors&amp;gt;&lt;br/&gt;
    &amp;lt;jaxws:outInterceptors&amp;gt;&lt;br/&gt;
    		&amp;lt;ref bean=&quot;rmCapOut&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmLogicalOut&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmCodecOut&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/jaxws:outInterceptors&amp;gt;&lt;br/&gt;
    &amp;lt;jaxws:outFaultInterceptors&amp;gt;&lt;br/&gt;
    		&amp;lt;ref bean=&quot;rmCapOut&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmLogicalOut&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;ref bean=&quot;rmCodecOut&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/jaxws:outFaultInterceptors&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;jaxws:properties&amp;gt;&lt;br/&gt;
			&amp;lt;entry key=&quot;ws-security.signature.properties&quot; value=&quot;samlKeystore.properties&quot; /&amp;gt;&lt;br/&gt;
			&amp;lt;entry key=&quot;ws-security.callback-handler&quot; value=&quot;de.lbank.framework.ws.server.security.saml.ServiceKeystoreCallbackHandler&quot; /&amp;gt;&lt;br/&gt;
			&amp;lt;entry key=&quot;ws-security.enable.streaming&quot; value=&quot;false&quot; /&amp;gt;&lt;br/&gt;
		&amp;lt;/jaxws:properties&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;/jaxws:endpoint&amp;gt;&lt;/p&gt;



&lt;p&gt;		&amp;lt;bean id=&quot;rmCapIn&quot; class=&quot;org.apache.cxf.ws.rm.RMCaptureInInterceptor&quot;&amp;gt;&lt;br/&gt;
				&amp;lt;property name=&quot;bus&quot; ref=&quot;cxf&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;/bean&amp;gt;&lt;br/&gt;
		&amp;lt;bean id=&quot;rmCapOut&quot; class=&quot;org.apache.cxf.ws.rm.RMCaptureOutInterceptor&quot;&amp;gt;&lt;br/&gt;
				&amp;lt;property name=&quot;bus&quot; ref=&quot;cxf&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;/bean&amp;gt;&lt;br/&gt;
		&amp;lt;bean id=&quot;rmLogicalOut&quot; class=&quot;org.apache.cxf.ws.rm.RMOutInterceptor&quot;&amp;gt;&lt;br/&gt;
		    &amp;lt;property name=&quot;bus&quot; ref=&quot;cxf&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;/bean&amp;gt;&lt;br/&gt;
		&amp;lt;bean id=&quot;rmLogicalIn&quot; class=&quot;org.apache.cxf.ws.rm.RMInInterceptor&quot;&amp;gt;&lt;br/&gt;
		    &amp;lt;property name=&quot;bus&quot; ref=&quot;cxf&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;/bean&amp;gt;&lt;br/&gt;
		&amp;lt;bean id=&quot;rmCodecOut&quot; class=&quot;org.apache.cxf.ws.rm.soap.RMSoapOutInterceptor&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;bean id=&quot;rmCodecIn&quot; class=&quot;org.apache.cxf.ws.rm.soap.RMSoapInInterceptor&quot;/&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14381870" author="ay" created="Thu, 26 Mar 2015 13:34:57 +0000"  >&lt;p&gt;Hi Jochen,&lt;br/&gt;
As you already found it out, this is not an issue and I am closing this ticket.&lt;/p&gt;

&lt;p&gt;To get the correct configuration, you should be using the WSRM feature or the WSRM policy to configure your WSRM endpoint. In that way, the necessary intercepters are automatically inserted in the interceptor chain.&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;</comment>
                            <comment id="14381872" author="ay" created="Thu, 26 Mar 2015 13:36:10 +0000"  >&lt;p&gt;the only thing that we can improve is that we should guard against this NPE.&lt;/p&gt;</comment>
                            <comment id="14386662" author="j_ri" created="Mon, 30 Mar 2015 12:55:51 +0000"  >&lt;p&gt;no, that&apos;s not the thing you should/can improve! The NullPOinterException just points out that something went terribly wrong before....&lt;/p&gt;

&lt;p&gt;What you should improve is that the RMCaptureInInterceptor always has to be activated together with all other WS-RM interceptors. At least it has to be activated when the persistent store is present an not only the unreliable &quot;in-memory persistence&quot;.&lt;/p&gt;

&lt;p&gt;This is definitive a bug. (Or you write in the documentation that using WS-RM is only possible when doing the interceptor-chain configuration completety manually and not by just configuring &quot;&amp;lt;wsrm-mgr:rmManager .......&quot;&lt;br/&gt;
At this point &lt;a href=&quot;http://cxf.apache.org/docs/wsrmconfiguration.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/docs/wsrmconfiguration.html&lt;/a&gt; is incomplete/wrong)&lt;/p&gt;</comment>
                            <comment id="14386675" author="j_ri" created="Mon, 30 Mar 2015 13:11:37 +0000"  >&lt;p&gt;Hi Aki,&lt;/p&gt;

&lt;p&gt;no that&apos;s the point. By using the WSRM feature or the WSRM policy to configure WSRM the mentioned interceptor is not in the chain. I think the &quot;auto-configuration&quot; part misses to put the capture interceptor in the chain and so the data is not there in the later execution. I have to put in the chain (and don&apos;t like to do that) to make it work.&lt;/p&gt;

&lt;p&gt;Best regards,&lt;br/&gt;
Jochen&lt;/p&gt;

&lt;p&gt;P.S.: Meanwhile we found out that WSRM is not reliable at all in the current implementation (tested with 3.0.4 and 2.7.14). See &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6323&quot; title=&quot;WS-RM redelivery not implemented&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6323&quot;&gt;&lt;del&gt;CXF-6323&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14518843" author="ema" created="Wed, 29 Apr 2015 06:48:02 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ay&quot; class=&quot;user-hover&quot; rel=&quot;ay&quot;&gt;ay&lt;/a&gt;, it looks that RMPolicyInterceptorProvider doesn&apos;t add this RMCaptureInInterceptor by default like RMFeature does. Can we simply add this when RM is triggered by policy assertion ?  Do you know the reason we didn&apos;t add there before?&lt;br/&gt;
Thanks,&lt;br/&gt;
Jim&lt;/p&gt;</comment>
                            <comment id="14519003" author="ay" created="Wed, 29 Apr 2015 09:13:10 +0000"  >&lt;p&gt;Hi Jim,&lt;br/&gt;
you are right. Thanks a lot. I didn&apos;t notice it earlier and I don&apos;t know why we were not seeing any test errors. I will look into why this happened and will add the missing interceptor.&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;
</comment>
                            <comment id="14519340" author="ay" created="Wed, 29 Apr 2015 13:24:26 +0000"  >&lt;p&gt;Hi Jochen,&lt;br/&gt;
I am really sorry about not finding out the root cause earlier.&lt;br/&gt;
I just pushed the fix to 3.0.5-SNAPSHOT et al.&lt;/p&gt;

&lt;p&gt;And thank you and Jim for analyzing this issue.&lt;/p&gt;

&lt;p&gt;Regards, aki&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12704114" name="cxf-servlet.xml" size="3755" author="j_ri" created="Thu, 12 Mar 2015 07:55:25 +0000"/>
                            <attachment id="12702782" name="ws-rm_saml.wsdl" size="11011" author="j_ri" created="Thu, 5 Mar 2015 10:43:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26eb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>