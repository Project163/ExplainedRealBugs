<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:33:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7979] Issues when an operation&apos;s input and output should have different policies</title>
                <link>https://issues.apache.org/jira/browse/CXF-7979</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;We think we might have found an issue in the way WSDL-Embedded WebService Security Policies are interpreted at runtime.&lt;/p&gt;

&lt;p&gt;We are in contract-first mode, but don&apos;t use generated JAXB bindings. We use a &lt;tt&gt;@WebServiceProvider&lt;/tt&gt; implementation as a dynamic server and use &lt;tt&gt;javax.xml.ws.Dispatch&lt;/tt&gt; to build a dynamic client.&lt;/p&gt;

&lt;p&gt;The issue happens when we try to apply different WSS-Policies to an operation&apos;s &lt;tt&gt;wsdl:input&lt;/tt&gt; and &lt;tt&gt;wsdl:output&lt;/tt&gt;, so e.g. having the request secured but the response non-secured.&lt;/p&gt;

&lt;p&gt;We see different behavior depending on where we put the &lt;tt&gt;wsp:PolicyReference&lt;/tt&gt; within the WSDL, but we didn&apos;t manage to make it work: either the client doesn&apos;t encrypt the request at all, or the server encrypts the response as well.&lt;/p&gt;

&lt;p&gt;I created a small but fully functional project on GitHub that contains a unit test which demonstrates the behavior (be sure to check the project&apos;s README).&lt;/p&gt;

&lt;p&gt;Please have a look at: &lt;a href=&quot;https://github.com/netmikey/cxf-security-test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/netmikey/cxf-security-test&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tested with CXF 3.3.0, a reproducing example and unit test can be found here: &lt;a href=&quot;https://github.com/netmikey/cxf-security-test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/netmikey/cxf-security-test&lt;/a&gt;&lt;/p&gt;</environment>
        <key id="13217224">CXF-7979</key>
            <summary>Issues when an operation&apos;s input and output should have different policies</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="netmikey">Mike M.</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Feb 2019 14:51:57 +0000</created>
                <updated>Mon, 18 Sep 2023 18:49:44 +0000</updated>
                            <resolved>Fri, 22 Mar 2019 16:25:24 +0000</resolved>
                                    <version>3.3.0</version>
                                                    <component>JAX-WS Runtime</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16792414" author="netmikey" created="Thu, 14 Mar 2019 07:10:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=coheigea&quot; class=&quot;user-hover&quot; rel=&quot;coheigea&quot;&gt;coheigea&lt;/a&gt;: (Sorry for pinging you, but this bug is really a blocker for us...). Have you had the chance to look at the example project I created? It should make the bug easy to reproduce. Let me know if there&apos;s anything I can do to help.&lt;/p&gt;</comment>
                            <comment id="16799158" author="coheigea" created="Fri, 22 Mar 2019 16:25:14 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=netmikey&quot; class=&quot;user-hover&quot; rel=&quot;netmikey&quot;&gt;netmikey&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Firstly, thanks for the test-case - it makes resolving issues a lot easier.&lt;/p&gt;

&lt;p&gt;The issue here is that you are using a Dispatch client and attaching policies at the operation level. CXF does not know the operation for this case, and the policies end up not being processed. The good news is that there is a very easy fix, simply specify something like this to let CXF know what the operation is:&lt;/p&gt;

&lt;p&gt;&#160;disp.getRequestContext().put(MessageContext.WSDL_OPERATION, wsdlOperationQName);&lt;/p&gt;

&lt;p&gt;I added a test-case here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=cxf.git;a=commit;h=6bf89e9c8804c8845ec4d38583dd33eea8256439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=cxf.git;a=commit;h=6bf89e9c8804c8845ec4d38583dd33eea8256439&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This fixes the first and third case listed in your README. I think the second case is not valid (SecurePolicy applied to wsdl:binding, EmptyPolicy applied to wsdl:output). EmptyPolicy will not override SecurePolicy on the response, so having a secured response is &quot;expected&quot; for this case.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="16800546" author="netmikey" created="Mon, 25 Mar 2019 10:20:22 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=coheigea&quot; class=&quot;user-hover&quot; rel=&quot;coheigea&quot;&gt;coheigea&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;First of all, thanks a lot for looking into this and for your explanation and workaround, which works of course. You honestly helped us out a lot!&lt;/p&gt;

&lt;p&gt;If you allow, I&apos;d like to follow up this ticket. Maybe some improvement could be considered, be it only to keep others from stumbling into the same pitfall.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Is there any place (the docs maybe?) where I should have looked that could have told me what I was doing wrong or how I was supposed to do it correctly?&lt;/li&gt;
	&lt;li&gt;It might be an improvement if CXF informed the developer that it was missing some information to do its job correctly, maybe through a log message. That would have pointed us in the right direction in this particular case.&lt;/li&gt;
	&lt;li&gt;After thinking about it a bit: Why does CXF require the developer to tell it the operation in the first place? I mean, technically, in this concrete situation CXF already knew the WSDL and the XML Element used as Document for the SOAPMessage to be sent. Couldn&apos;t it have looked up the matching operation in the WSDL? If it wouldn&apos;t find one, it could still inform that there was something weird going on (see 2.).&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Also, thank you for clarifying that an empty policy cannot &quot;override&quot; a secure policy declared on a higher hierarchical level within a WSDL like we did. Is there, to your knowledge, any other way of doing so? The goal being a declaration like &quot;apply this security for everything within this WSDL by default, except for those few cases excluded explicitly&quot;.&lt;/p&gt;

&lt;p&gt;Thanks again for your support.&lt;br/&gt;
Best regards,&lt;br/&gt;
Mike&lt;/p&gt;</comment>
                            <comment id="16800631" author="dkulp" created="Mon, 25 Mar 2019 12:18:45 +0000"  >&lt;p&gt;In some cases, the DispatchImpl can deduce an operation name from the message.  If you look into DispatchImpl, if the WSDL_OPERATION isn&apos;t set, it does call off to the calculateOpName method to try and calculate one.  I&apos;m not sure why that&apos;s not working in your case.   For certain types of payload we cannot do that without breaking streaming so its not completely reliable.   However, a SOAPMessage should be completely doable without breaking streaming as it&apos;s already in a DOM.&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi18hc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>