<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:20:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6900] invalid signature in case of soap fault</title>
                <link>https://issues.apache.org/jira/browse/CXF-6900</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;Having signature verification problems on the cxf client-side  with a .NET Ws-fed protected webservice, I ask you a little help...&lt;br/&gt;
Here is a summary of the problem :&lt;br/&gt;
Most of the time, communication works well excepted when we got a soap fault message.&lt;br/&gt;
Indeed signature validation works usually well excepted when&lt;br/&gt;
we receive a fault message inside the body of the soap message. Even In this boundary case, signature verification works well excepted for one element, the fault message (see the enclosed server7.log file).             &lt;/p&gt;

&lt;p&gt;After digging a bit, i&apos;ve found that the calculated digest couldn&apos;t be equal to the claimed one because the content of the message given to  the DigesterOutpustrream is not well canonicalized or normalized.&lt;/p&gt;

&lt;p&gt;Partial decrypted msg&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
&amp;lt;s:Body u:Id=&quot;_3&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;Fault xmlns=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&amp;gt;&amp;lt;Code&amp;gt;&amp;lt;Value&amp;gt;DataNotFoundFault&amp;lt;/Value&amp;gt;&amp;lt;/Code&amp;gt;&amp;lt;Reason&amp;gt;&amp;lt;Text xml:lang=&quot;nl-BE&quot;&amp;gt;ContextContactInfo with Id &apos;1&apos; does not exist.&amp;lt;/Text&amp;gt;&amp;lt;/Reason&amp;gt;&amp;lt;Detail&amp;gt;&amp;lt;DataNotFoundFault xmlns=&quot;http://schemas.riziv.fgov.be/contact/2015/08/faults&quot; xmlns:i=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&amp;gt;&amp;lt;ErrorCode&amp;gt;ContextContactInfoNotFound&amp;lt;/ErrorCode&amp;gt;&amp;lt;Message&amp;gt;ContextContactInfo with Id &apos;1&apos; does not exist.&amp;lt;/Message&amp;gt;&amp;lt;/DataNotFoundFault&amp;gt;&amp;lt;/Detail&amp;gt;&amp;lt;/Fault&amp;gt;&lt;br/&gt;
 &amp;lt;/s:Body&amp;gt;&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Predigested input :&lt;/p&gt;

&lt;p&gt;&amp;lt;s:Body xmlns:s=&quot;http://www.w3.org/2003/05/soap-envelope&quot; xmlns:u=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; u:Id=&quot;_3&quot;&amp;gt;&amp;lt;env:Fault&amp;gt;&amp;lt;Code xmlns=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&amp;gt;&amp;lt;Value&amp;gt;DataNotFoundFault&amp;lt;/Value&amp;gt;&amp;lt;/Code&amp;gt;&amp;lt;Reason xmlns=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&amp;gt;&amp;lt;Text xml:lang=&quot;nl-BE&quot;&amp;gt;ContextContactInfo with Id &apos;1&apos; does not exist.&amp;lt;/Text&amp;gt;&amp;lt;/Reason&amp;gt;&amp;lt;env:Detail&amp;gt;&amp;lt;DataNotFoundFault xmlns=&quot;http://schemas.riziv.fgov.be/contact/2015/08/faults&quot;&amp;gt;&amp;lt;ErrorCode&amp;gt;ContextContactInfoNotFound&amp;lt;/ErrorCode&amp;gt;&amp;lt;Message&amp;gt;ContextContactInfo with Id &apos;1&apos; does not exist.&amp;lt;/Message&amp;gt;&amp;lt;/DataNotFoundFault&amp;gt;&amp;lt;/env:Detail&amp;gt;&amp;lt;/env:Fault&amp;gt;&amp;lt;/s:Body&amp;gt;&lt;/p&gt;

&lt;p&gt;Could you please check this problem and give me an advice ?&lt;/p&gt;

&lt;p&gt;The library used are :&lt;/p&gt;

&lt;p&gt;cxf 3.0.3&lt;br/&gt;
wss4j 2.0.2&lt;br/&gt;
xmlsec 2.0.2&lt;/p&gt;

&lt;p&gt;on a jdk 1.6.0_45&lt;/p&gt;

&lt;p&gt;Thanks in advance&lt;br/&gt;
David L&lt;/p&gt;</description>
                <environment>&lt;p&gt;windows 2008  jdk 1.6.0_45&lt;/p&gt;</environment>
        <key id="12969740">CXF-6900</key>
            <summary>invalid signature in case of soap fault</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="david.leruse@gmail.com">david leruse</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 May 2016 07:59:55 +0000</created>
                <updated>Fri, 14 Oct 2016 14:21:57 +0000</updated>
                            <resolved>Tue, 24 May 2016 13:14:03 +0000</resolved>
                                    <version>3.0.3</version>
                                    <fixVersion>3.1.7</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15283473" author="david.leruse@gmail.com" created="Sat, 14 May 2016 08:01:16 +0000"  >&lt;p&gt;jboss 6.3 log file with debug mode on&lt;/p&gt;</comment>
                            <comment id="15286360" author="coheigea" created="Tue, 17 May 2016 10:17:18 +0000"  >&lt;p&gt;It looks like the problem is that extra prefixes are getting added in to the decrypted content which is breaking signature validation. Could you try updating to xmlsec 2.0.4, there was a related bug fixed there (&lt;a href=&quot;https://issues.apache.org/jira/browse/SANTUARIO-412&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SANTUARIO-412&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="15286662" author="david.leruse@gmail.com" created="Tue, 17 May 2016 14:00:40 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;I&apos;ve tested with xmlsec  2.0.4 and 2.0.6 and i still get the same&lt;br/&gt;
error...any other idea ?&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

&lt;p&gt;David L.&lt;/p&gt;

</comment>
                            <comment id="15286731" author="david.leruse@gmail.com" created="Tue, 17 May 2016 14:35:28 +0000"  >&lt;p&gt;ticket moved to ticket &lt;a href=&quot;https://issues.apache.org/jira/browse/SANTUARIO-442&quot; title=&quot;invalid signature in case of soap fault&#57364;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SANTUARIO-442&quot;&gt;&lt;del&gt;SANTUARIO-442&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15286733" author="david.leruse@gmail.com" created="Tue, 17 May 2016 14:36:54 +0000"  >&lt;p&gt;moved to santuario&lt;/p&gt;</comment>
                            <comment id="15286743" author="david.leruse@gmail.com" created="Tue, 17 May 2016 14:42:01 +0000"  >&lt;p&gt;moved back to the place where it was first &lt;/p&gt;</comment>
                            <comment id="15288847" author="david.leruse@gmail.com" created="Wed, 18 May 2016 11:59:14 +0000"  >&lt;p&gt;Thanks Colm ... Is it easily portable to a cxf 3.0.3.custom (alas i&apos;m stuck with this version)? I mean the associated commits are enough ? &lt;/p&gt;</comment>
                            <comment id="15298149" author="coheigea" created="Tue, 24 May 2016 13:13:41 +0000"  >&lt;p&gt;Hi David,&lt;/p&gt;

&lt;p&gt;The problem here is actually a problem with the SAAJ implementation that comes with the JDK, where it &quot;forces&quot; the &quot;env&quot; prefix for a SOAP Fault when it does not have a pre-existing prefix.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkulp&quot; class=&quot;user-hover&quot; rel=&quot;dkulp&quot;&gt;dkulp&lt;/a&gt; and I have managed to &quot;work around&quot; this problem in CXF. Your test-case should now be working on the CXF master + 3.1.x-fixes branch. However, I believe it won&apos;t be backported to CXF 3.0.x, as there are too many changes involved.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="15298390" author="david.leruse@gmail.com" created="Tue, 24 May 2016 15:51:40 +0000"  >&lt;p&gt;Thanks Colm, i think i&apos;m good for a dirty dirty  fix .... If I want only to decrypt in case of a server error, what would be the best way to do that ?&lt;/p&gt;
</comment>
                            <comment id="15304247" author="michael@hurts.ca" created="Fri, 27 May 2016 16:02:01 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;I think I&apos;m seeing this with a CXF 3.1.6 client to a .NET 4.5 WCF service. I see the commit is from a few days ago to the 3.1.x-fixes branch. Would it be possible to get a new 3.1.7 snapshot built so I can test it? The latest build is from May 9 at &lt;a href=&quot;http://repository.apache.org/snapshots/org/apache/cxf/apache-cxf/3.1.7-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repository.apache.org/snapshots/org/apache/cxf/apache-cxf/3.1.7-SNAPSHOT/&lt;/a&gt; .&lt;/p&gt;

&lt;p&gt;Let me know if there&apos;s any information I could provide.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Mike&lt;/p&gt;</comment>
                            <comment id="15304249" author="coheigea" created="Fri, 27 May 2016 16:04:23 +0000"  >&lt;p&gt;Yes, I&apos;m deploying a new SNAPSHOT now.&lt;/p&gt;</comment>
                            <comment id="15306924" author="michael@hurts.ca" created="Mon, 30 May 2016 20:12:22 +0000"  >&lt;p&gt;With 3.1.7-SNAPSHOT, signature verification succeeds. However there&apos;s another problem processing the fault:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;May 30, 2016 3:42:48 PM com.sun.xml.internal.messaging.saaj.soap.ver1_2.Fault1_2Impl checkIfStandardFaultCode
SEVERE: SAAJ0435: Sender is not a standard Code value
May 30, 2016 3:42:48 PM com.sun.xml.internal.messaging.saaj.soap.impl.FaultImpl setFaultCode
SEVERE: SAAJ0140: Empty/Null NamespaceURI specified for faultCode fc1:Sender
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the pre-digested input. The &amp;lt;Fault&amp;gt;&amp;lt;Code&amp;gt;&amp;lt;Value&amp;gt; of &quot;Sender&quot; looks OK to my untrained eye; it&apos;s unqualified, but the default namespace in that block is &lt;a href=&quot;http://www.w3.org/2003/05/soap-envelope&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/2003/05/soap-envelope&lt;/a&gt; so it should be OK.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;s:Body &lt;span class=&quot;code-keyword&quot;&gt;xmlns:s&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2003/05/soap-envelope&quot;&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;xmlns:u&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;&lt;/span&gt;
u:Id=&lt;span class=&quot;code-quote&quot;&gt;&quot;_1&quot;&lt;/span&gt;&amp;gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Fault xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2003/05/soap-envelope&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Code&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Value&amp;gt;&lt;/span&gt;Sender&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Value&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Code&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Reason&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Text xml:lang=&lt;span class=&quot;code-quote&quot;&gt;&quot;en-US&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;CustomerNotFound&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Text&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Reason&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Fault&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/s:Body&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15307814" author="coheigea" created="Tue, 31 May 2016 14:39:22 +0000"  >&lt;p&gt;Where is this exception being thrown? Could you paste the stacktrace?&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="15308003" author="michael@hurts.ca" created="Tue, 31 May 2016 16:07:18 +0000"  >&lt;p&gt;This is what I see when the fault comes back:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2016-05-30 15:42:48,299 DEBUG [http-bio-8080-exec-3|] (PhaseInterceptorChain.java:305) - Invoking handleMessage on interceptor org.apache.cxf.ws.policy.PolicyVerificationInFaultInterceptor@4214d970
May 30, 2016 3:42:48 PM com.sun.xml.internal.messaging.saaj.soap.ver1_2.Fault1_2Impl checkIfStandardFaultCode
SEVERE: SAAJ0435: Sender is not a standard Code value
May 30, 2016 3:42:48 PM com.sun.xml.internal.messaging.saaj.soap.impl.FaultImpl setFaultCode
SEVERE: SAAJ0140: Empty/Null NamespaceURI specified for faultCode fc1:Sender
java.lang.reflect.UndeclaredThrowableException
       at com.sun.proxy.$Proxy93.xxxomitted(Unknown Source)
       at xxxommitted.wcf.xxxomitted.xxxomitted(XXXAdapterWcf.java:24)
...
	   Caused by: com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Empty/Null NamespaceURI specified for faultCode &quot;fc1:Sender&quot;
       at com.sun.xml.internal.messaging.saaj.soap.impl.FaultImpl.setFaultCode(Unknown Source)
       at com.sun.xml.internal.messaging.saaj.soap.impl.FaultImpl.setFaultCode(Unknown Source)
       at org.apache.cxf.binding.soap.saaj.SAAJUtils.setFaultCode(SAAJUtils.java:66)
       at org.apache.cxf.jaxws.JaxWsClientProxy.createSoapFault(JaxWsClientProxy.java:229)
       at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:157)
       ... 58 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15310544" author="coheigea" created="Wed, 1 Jun 2016 16:07:21 +0000"  >&lt;p&gt;I think I&apos;ve fixed this. I&apos;ve uploaded a new 3.1.7-SNAPSHOT, could you try again and let me know if it works?&lt;/p&gt;</comment>
                            <comment id="15310819" author="michael@hurts.ca" created="Wed, 1 Jun 2016 18:21:29 +0000"  >&lt;p&gt;Yes, it appears to be fixed now. Thanks so much! Is there a 3.1.7 release coming soon?&lt;/p&gt;</comment>
                            <comment id="15311987" author="coheigea" created="Thu, 2 Jun 2016 08:58:06 +0000"  >&lt;p&gt;Great, thanks for the confirmation. Yes we normally release every 2 months or so, so a 3.1.7 release is overdue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12970383">SANTUARIO-442</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12970383">SANTUARIO-442</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12804013" name="server7.log" size="463526" author="david.leruse@gmail.com" created="Sat, 14 May 2016 08:01:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2xyyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>