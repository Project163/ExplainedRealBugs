<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:03:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5228] Rest client reports interface not visible for service interface</title>
                <link>https://issues.apache.org/jira/browse/CXF-5228</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When using a rest client in blueprint in OSGi I get the following stacktrace:&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: interface net.lr.tutorial.karaf.cxf.personservice.person.PersonService is not visible from class loader&lt;/p&gt;

&lt;p&gt;See this for the full trace:&lt;br/&gt;
&lt;a href=&quot;https://gist.github.com/cschneider/6156833&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/cschneider/6156833&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I debugged into it and found that the true execption is hidden.&lt;br/&gt;
It happens in org.apache.cxf.jaxrs.client.JAXRSClientFactoryBean.createWithValues(Object...)&lt;/p&gt;

&lt;p&gt;There is first tries to create the proxy using the classloader of the service interface. &lt;/p&gt;

&lt;p&gt;This fails as in the user classloader there is only the service interface but the proxy is also create for the cxf Client interface. So it fails when resolving cxf Client.&lt;/p&gt;

&lt;p&gt;This exception is swallowed and the context classloader is used to create the proxy. This classloader is not set so it reports the user service interface is not visible. This is not the root of the problem though.&lt;/p&gt;

&lt;p&gt;I fixed this by using a ProxyClassloader that contains the user classloader and the classloader of the JAXRSClientFactoryBean. So it then finds user classes as well as cxf classes.&lt;/p&gt;

</description>
                <environment>&lt;p&gt;OSGi&lt;/p&gt;</environment>
        <key id="12665055">CXF-5228</key>
            <summary>Rest client reports interface not visible for service interface</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cschneider">Christian Schneider</assignee>
                                    <reporter username="cschneider">Christian Schneider</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Aug 2013 15:18:47 +0000</created>
                <updated>Fri, 14 Mar 2014 11:26:41 +0000</updated>
                            <resolved>Mon, 26 Aug 2013 16:33:24 +0000</resolved>
                                    <version>2.7.6</version>
                                    <fixVersion>2.7.7</fixVersion>
                    <fixVersion>3.0.0-milestone1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13747781" author="sergey_beryozkin" created="Thu, 22 Aug 2013 19:14:14 +0000"  >&lt;p&gt;Hi Christian, thanks for reporting it, do you propose do use ProxyClassLoader in exception handler, instead of using current thread loader ? &lt;/p&gt;

&lt;p&gt;I don&apos;t recall exactly why I did try to use a context loader in the exception handler, it probably was useful in some cases (for CGLIB proxies may be, do not remember now)... May be we can have the exception handler use ProxyClassLoader with the user classloader and the classloader of the JAXRSClientFactoryBean and finally the context loader in case it can be different from the other two &lt;/p&gt;</comment>
                            <comment id="13748328" author="chris@die-schneider.net" created="Fri, 23 Aug 2013 06:23:22 +0000"  >&lt;p&gt;Hi Sergey,&lt;/p&gt;

&lt;p&gt;I talked to Dan yesterday how to best handle it. Our aproach is to use the provided classloader first. If it can see all interfaces it will be used. If not a proxy classloader of the supplied classloader + all classloaders of the interfaces will be used.&lt;/p&gt;

&lt;p&gt;As this is a generic solution I will add it to the ProxyHelper. So we should then be able to remove the context classloader. This will then also allow to provide a better error message when it does not work in the end. I will commit a fix on trunk today that you can review.&lt;/p&gt;</comment>
                            <comment id="13748596" author="sergey_beryozkin" created="Fri, 23 Aug 2013 14:49:52 +0000"  >&lt;p&gt;H Christian, the fix looks neat,&lt;br/&gt;
thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="13749960" author="sergey_beryozkin" created="Mon, 26 Aug 2013 10:05:51 +0000"  >&lt;p&gt;Hi Christian, the only thing that I&apos;d like to discuss is how to deal with moving ProxyClassLoader to a new location when merging back to 2.7.x. I remember talking to at least 2 users about the use of ProxyClassLoader (in OSGI) so one option, for 2.7.x, is duplicate ProxyClassLoader, with only 3.0.0-SNAPSHOT keeping a single ProxyClassLoader in common util &lt;/p&gt;</comment>
                            <comment id="13749964" author="chris@die-schneider.net" created="Mon, 26 Aug 2013 10:12:13 +0000"  >&lt;p&gt;Hi Sergey, for the backport I have created a ProxyClassLoader in the old location that extends the new one. This should make the switch transaparent for users.&lt;/p&gt;</comment>
                            <comment id="13749969" author="sergey_beryozkin" created="Mon, 26 Aug 2013 10:27:44 +0000"  >&lt;p&gt;This is clever, cool &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13877793" author="scott.oster" created="Tue, 21 Jan 2014 19:58:37 +0000"  >&lt;p&gt;Are there any known workarounds for earlier versions of CXF?  I&apos;m having this problem on 2.6 and can&apos;t move forward yet.&lt;/p&gt;</comment>
                            <comment id="13878503" author="sergey_beryozkin" created="Wed, 22 Jan 2014 10:28:52 +0000"  >&lt;p&gt;org.apache.cxf.jaxrs.client.ProxyClassLoader is shipped with 2.6.1 - try using it, I think JAXRSClientFactory may have a method accepting it, and definitely JAXRSClientFactoryBean&lt;/p&gt;</comment>
                            <comment id="13880289" author="scott.oster" created="Thu, 23 Jan 2014 19:56:48 +0000"  >&lt;p&gt;Awesome, thanks much Sergey.  I can confirm this workaround works for me with 2.6.6.&lt;br/&gt;
Might want to mark this issue as related to &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4290&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-4290&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I based my solution around this:&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/10458378/how-can-i-make-a-java-lang-reflect-proxy-from-two-separate-classloaders&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/10458378/how-can-i-make-a-java-lang-reflect-proxy-from-two-separate-classloaders&lt;/a&gt;&lt;br/&gt;
  ProxyClassLoader classLoader = new ProxyClassLoader();&lt;br/&gt;
    classLoader.addLoader(resourceApiClass.getClassLoader());&lt;br/&gt;
    classLoader.addLoader(JAXRSClientFactoryBean.class.getClassLoader());&lt;/p&gt;

&lt;p&gt;    JAXRSClientFactoryBean bean = new JAXRSClientFactoryBean();&lt;br/&gt;
    bean.setAddress(baseUrl);&lt;br/&gt;
    bean.setServiceClass(resourceApiClass);&lt;br/&gt;
    bean.setClassLoader(classLoader);&lt;br/&gt;
    return bean.create(resourceApiClass);&lt;/p&gt;</comment>
                            <comment id="13934891" author="fmontmasson" created="Fri, 14 Mar 2014 11:26:41 +0000"  >&lt;p&gt;Same issue still in 2.6.11...&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>344996</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nhs7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345297</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>