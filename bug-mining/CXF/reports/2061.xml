<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:07:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5446] systests/jaxrs tests sometimes hang in CI</title>
                <link>https://issues.apache.org/jira/browse/CXF-5446</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I&apos;ve seen at least the following 2 tests hang&lt;/p&gt;

&lt;p&gt;JAXRS20ClientServerBookTest&lt;br/&gt;
JAXRSAsyncClientTest&lt;/p&gt;

&lt;p&gt;I will attach a patch which adds timeouts&lt;/p&gt;</description>
                <environment></environment>
        <key id="12683580">CXF-5446</key>
            <summary>systests/jaxrs tests sometimes hang in CI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kearls">Kevin Anthony Earls</reporter>
                        <labels>
                            <label>test</label>
                    </labels>
                <created>Mon, 9 Dec 2013 11:35:16 +0000</created>
                <updated>Fri, 31 Mar 2017 19:37:56 +0000</updated>
                            <resolved>Wed, 22 Mar 2017 19:41:07 +0000</resolved>
                                                    <fixVersion>Invalid</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13843079" author="kearls" created="Mon, 9 Dec 2013 11:37:22 +0000"  >&lt;p&gt;Added 1 minute timeouts to all tests&lt;/p&gt;</comment>
                            <comment id="13843102" author="sergey_beryozkin" created="Mon, 9 Dec 2013 12:17:43 +0000"  >&lt;p&gt;Thanks for a patch, I did not even know such a Test property exists. &lt;br/&gt;
I&apos;m not sure though we should apply it, I&apos;ve just updated these two tests, removed the hardcoded client timeouts from some of the tests (I use them to debug the server code while the test is in progress). The hangs might be pointing to a real issue, hopefully a test one, say the the test server hangs itself and the client waits indefinitely...&lt;br/&gt;
Can you please update the code with the latest commit, and check the tests again, I expect that you will start getting some failures instead...&lt;/p&gt;

&lt;p&gt;Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="13844073" author="kearls" created="Tue, 10 Dec 2013 08:17:41 +0000"  >&lt;p&gt;Hi Sergey.  Yes, I realize the hangs might be pointing to a real issue.  However, I wanted to add the timeouts so at least the rest of the build can finish.  Also, the timeouts will indicate which test case is the problem, which would make it easier to resolve this.&lt;/p&gt;

&lt;p&gt;I&apos;m a bit tied up with other things this week, but will try to look at this again as soon as I have a chance.&lt;/p&gt;</comment>
                            <comment id="13844162" author="ay" created="Tue, 10 Dec 2013 10:17:22 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I observed this hanging problem on one of our local linux based jenkins installations.&lt;br/&gt;
The problem only occurs and almost always occurs on one installation but never occurs on the other installation.&lt;br/&gt;
I am suspecting some async-io or thread interoperability issues between the linux libs version and jdk versions.&lt;br/&gt;
But I haven&apos;t figured it out nor collected enough information. I will compare the version info of some libs on two installations.&lt;/p&gt;

&lt;p&gt;I came to observe this issue when we went for 2.7.6 and before that, I didn&apos;t see this problem.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13847390" author="ay" created="Fri, 13 Dec 2013 10:58:07 +0000"  >&lt;p&gt;I was using cxf-2.7.8 as the reference build and testing it on several linux boxes that I find.&lt;br/&gt;
And I am observing this issue on some of the linux boxes with different linux versions.&lt;br/&gt;
The problem occurs sometimes more often (very frequently on Linux version 2.6.34.10-0.6-xen) than on others and on one box (Linux version 2.6.32-220.2.1.el6.x86_64), the problem does not seem to be occurring.&lt;/p&gt;

&lt;p&gt;But when the problem occurs on one of the boxes with one particular version of jdk, using a different jdk does not seem to be changing the situation. &lt;/p&gt;

&lt;p&gt;As i mentioned earlier, I am not observing this issue on win and osx boxes. I am not sure if this is an isolated case on some specific linux versions. If the problem is occurring on a wide spectrum of linux versions or even on other systems, we will need to determine the root cause.&lt;/p&gt;

&lt;p&gt;@Kevin, &lt;br/&gt;
what is your setup?&lt;/p&gt;

&lt;p&gt;thanks&lt;br/&gt;
regards, aki&lt;/p&gt;

</comment>
                            <comment id="13847686" author="kearls" created="Fri, 13 Dec 2013 17:27:32 +0000"  >&lt;p&gt;Hi Aki.  I&apos;ve seen this a few places, most recently on our Ubuntu boxes on EC2 (2.6.32-308-ec2) and on a RHEL 6.3 box.&lt;/p&gt;</comment>
                            <comment id="13847707" author="sergey_beryozkin" created="Fri, 13 Dec 2013 17:48:08 +0000"  >&lt;p&gt;We&apos;ve chatted with Aki on IRC and the proposal is to try and narrow it down somehow:&lt;/p&gt;

&lt;p&gt;1. Remove JAXRS20ClientServerBookTest first, try to reproduce; then JAXRSAsyncClientTest and try to reproduce &lt;br/&gt;
2. Remove all individual tests in JAXRS20ClientServerBookTest &amp;amp; JAXRSAsyncClientTest which deal with Future&lt;br/&gt;
3. Remove all systests/jaxrs JAXRS tests but these two ones: may help to confirm they are affected by the missing tests&lt;br/&gt;
And may be try and get a thread dump ?&lt;/p&gt;

&lt;p&gt;Thanks for investigating it, I&apos;ve never seen it, can&apos;t be of help for now&lt;/p&gt;</comment>
                            <comment id="13852936" author="ay" created="Thu, 19 Dec 2013 14:44:03 +0000"  >&lt;p&gt;Hi Sergey,&lt;br/&gt;
I extracted these two test classes and executed them separately at several linux environments. I observed the problem frequently on ubuntu 12.04.3 Linux 3.2.0-57 with all JDK tried (openjdk 6, 7and oracle 6, 7) and also on ubuntu 12.10 Linux 3.5.0-44.&lt;/p&gt;

&lt;p&gt;I think the problem could be something that happens after each test. After I added 1-sec delay between each test (i.e., simply added addDelay with @Before annotation to sleep 1 sec before running each test), I stopped seeing the problem.&lt;/p&gt;

&lt;p&gt;I am not sure if we should look further into it or just add this 1-sec delay for now. What do you think?&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;</comment>
                            <comment id="13852988" author="sergey_beryozkin" created="Thu, 19 Dec 2013 15:55:59 +0000"  >&lt;p&gt;Hi Aki, many thanks for investigating it.&lt;br/&gt;
I just wonder if the work Dan did with AsyncConduit in 3.0.0-milestone1 and the trunk can make an actual difference ?&lt;br/&gt;
Can you give me a favor and just run these  two tests on the actual trunk ? if it works then may be we can add the delays in 2.7.x only &lt;/p&gt;

&lt;p&gt;Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="13853015" author="ay" created="Thu, 19 Dec 2013 16:34:56 +0000"  >&lt;p&gt;hi sergey,&lt;br/&gt;
i wondered about that.&lt;br/&gt;
i&apos;ll run a check.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13853053" author="ay" created="Thu, 19 Dec 2013 17:32:58 +0000"  >&lt;p&gt;hi sergey,&lt;br/&gt;
trunk of today r1551904 has the same issue.&lt;br/&gt;
I executed the whole systests/jaxrs tests twice and both times, one of the tests got stuck.&lt;br/&gt;
Then I added the above 1-sec delay and re-executed the whole tests again twice and both times, none of the tests got stuck.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13853395" author="sergey_beryozkin" created="Thu, 19 Dec 2013 22:27:53 +0000"  >&lt;p&gt;Hi Aki, thanks again,&lt;br/&gt;
I&apos;m just slightly concerned that may be we are seeing a real bug affecting the runs.&lt;br/&gt;
There are probably hundreds of WebClient calls in other tests there and only these two hang. So it does not seem to be a test issue.&lt;/p&gt;

&lt;p&gt;I&apos;m starting thinking of the following:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;http-hc conduit is affecting it - and it can be causing the problems for two reasons, it has a bug of its own or may be because the tests or WebClient fail to release the resources properly&lt;/li&gt;
	&lt;li&gt;or there is some bug in the way new Client API is implemented.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So the next step is to check if it is http-hc which causes it, I&apos;ve temporarily removed its dependency, can you please, when you get a chance, update the source and run without http-hc ?&lt;br/&gt;
I will then continue narrowing down depending on what you see.&lt;/p&gt;

&lt;p&gt;In meantime I&apos;ve added an optional timeout as per your recommendation (except that is optional for now &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;), so it will let users who run builds and see the hangs get the tests running. I guess that in itself should resolve the actual issue, but may be we can trace somehow the actual cause of the problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  &lt;/p&gt;

&lt;p&gt;Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="13853890" author="ay" created="Fri, 20 Dec 2013 12:03:25 +0000"  >&lt;p&gt;Hi Sergey,&lt;br/&gt;
yes. Now without http-hc, I see no test errors from systests/jaxrs (executed three times to confirm).&lt;/p&gt;

&lt;p&gt;by the way, yesterday I also tried cxf trunk with asynchttpclient 4.0.1-SNAPSHOT but got the same problem.&lt;br/&gt;
asynchttpclient 4.0.1-SNAPSHOT itself passed all the unit tests, though.&lt;/p&gt;

&lt;p&gt;maybe we can trace all the calls that go into http-hc for the failed test and recreate the same setup in http-hc test itself?&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;</comment>
                            <comment id="13853921" author="sergey_beryozkin" created="Fri, 20 Dec 2013 12:37:13 +0000"  >&lt;p&gt;Hi Aki, &lt;br/&gt;
We are definitely making some progress here &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, great.&lt;br/&gt;
Lets try to narrow down it further, I&apos;m still not 100% sure it is the http-hc which is at fault, it may be to do with the test code not calling WebClient close which would cleanup what conduit state which might be there, or it may be the actual async processing model in the http-hc which is brittle,&lt;/p&gt;

&lt;p&gt;So what I&apos;ve done: I&apos;ve re-enabled the dependency but disabled all the tests which stress the http-hc asynchronous part.&lt;/p&gt;

&lt;p&gt;If we see the tests not hanging after that then we have a high probability it is the http-hc async mode and we can try to narrow down further. If they do hang again then it might be a conduit cleanup issue.&lt;/p&gt;

&lt;p&gt;Give it a try please with the latest trunk &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="13854561" author="anthonyc" created="Fri, 20 Dec 2013 21:10:02 +0000"  >&lt;p&gt;I think we are facing the same issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-5470&quot; title=&quot;Usage of HttpAsyncClient with async calls is unstable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-5470&quot;&gt;&lt;del&gt;CXF-5470&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It occurs on windows / linux with cxf unit test and other test. If async policy is set to Never the issue is not observed anymore.&lt;/p&gt;

&lt;p&gt;Anthony&lt;/p&gt;</comment>
                            <comment id="13855613" author="ay" created="Mon, 23 Dec 2013 12:58:04 +0000"  >&lt;p&gt;we ran several tests and here the irc transcription recaps the tests.&lt;br/&gt;
&lt;a href=&quot;http://irclogs.dankulp.com/logs/irclogger_log/cxf?date=2013-12-20,Fri&amp;amp;sel=144#l140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://irclogs.dankulp.com/logs/irclogger_log/cxf?date=2013-12-20,Fri&amp;amp;sel=144#l140&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We observed this problem very frequently on one of our jenkins (SUSE Linux 2.6.34.10-0.6-xen) but not on another jenkins (RHE Linux 2.6.32-220.2.1.el6.x86_64) nor on a couple of OSX or Win7-x64 boxes we tried. &lt;/p&gt;

&lt;p&gt;Initially, I thought this was some jenkins related issue. However, I could reproduce this problem on another Linux desktop (SUSE Linux version 2.6.34.8-0.2-desktop). As Sergey was not getting this problem on his Ubuntu (Linux version 3.2.0-56-generic),  I upgraded this desktop to a more recent Ubuntu 12.04.3 LTS (Linux 3.2.0-57-generic-pae) to see if the problem disappears. However, the problem persisted and even after upgrading to Ubuntu 12.10 (Linux version 3.5.0-44-generic) but the problem remained with all JDKs tried (6 and 7 Open- and Oracle JDKs).&lt;/p&gt;

&lt;p&gt;So, if you want to reproduce this problem, I think you can grab the current ubuntu distro (12.04.03 or 12.10) and can reproduce this problem.&lt;/p&gt;

&lt;p&gt;Aki&lt;/p&gt;</comment>
                            <comment id="15936983" author="dkulp" created="Wed, 22 Mar 2017 19:41:07 +0000"  >&lt;p&gt;Marking fixed as the tests seem to be behaving OK recently.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12617814" name="CXF-5446.patch" size="10520" author="kearls" created="Mon, 9 Dec 2013 11:37:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362653</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qifz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362947</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>