<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:36:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2075] Error in spring config file reported as a missing config file during initialization of BusApplicationContext</title>
                <link>https://issues.apache.org/jira/browse/CXF-2075</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The current code to create a Bus in SpringBusFactory masks any problem in processing the spring config file passed in to SpringBusFactory. Currently if a config file is corrupt, the exception thrown trying to process this file is eaten and an attempt to create a Bus is tried again with a different thread context classloader. This completely hides the source of the error and results in a message which indicates that the config file could not be found which is completely misleading for the user.&lt;br/&gt;
The solution is to not perform the 2nd attempt to create a BusApplicationContext and let the original exception propagate upwards.&lt;/p&gt;

&lt;p&gt;     private BusApplicationContext createApplicationContext(String cfgFiles[], boolean includeDefaults) {&lt;br/&gt;
        try &lt;/p&gt;
{      
            return new BusApplicationContext(cfgFiles, includeDefaults, context);
        }
&lt;p&gt; catch (BeansException ex) {&lt;br/&gt;
            ClassLoader contextLoader = Thread.currentThread().getContextClassLoader();&lt;br/&gt;
            if (contextLoader != BusApplicationContext.class.getClassLoader()) {&lt;br/&gt;
                Thread.currentThread().setContextClassLoader(&lt;br/&gt;
                    BusApplicationContext.class.getClassLoader());&lt;br/&gt;
                try &lt;/p&gt;
{
                    return new BusApplicationContext(cfgFiles, includeDefaults, context);        
                }
&lt;p&gt; finally &lt;/p&gt;
{
                    Thread.currentThread().setContextClassLoader(contextLoader);
                }
&lt;p&gt;            } else &lt;/p&gt;
{
                throw ex;
            }
&lt;p&gt;        }&lt;br/&gt;
     }&lt;/p&gt;</description>
                <environment></environment>
        <key id="12415802">CXF-2075</key>
            <summary>Error in spring config file reported as a missing config file during initialization of BusApplicationContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="seumassoltysik">Seumas Soltysik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Feb 2009 15:50:52 +0000</created>
                <updated>Fri, 24 Apr 2009 21:17:05 +0000</updated>
                            <resolved>Tue, 10 Mar 2009 16:46:47 +0000</resolved>
                                    <version>2.1.4</version>
                                    <fixVersion>2.2</fixVersion>
                    <fixVersion>2.1.5</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12677403" author="sergey_beryozkin" created="Fri, 27 Feb 2009 16:07:20 +0000"  >&lt;p&gt;Hi Seumas&lt;/p&gt;

&lt;p&gt;I think the solution should be about introducing a new type of exception. The second class loading attempt is there to ensure things work nicely in OSGI, though it does mask an issue if the problem is caused by the corrupt configuration file. Perhaps the original problem has been fixed but before CXF can get updated with your fix it would be good if a higher-level project which might be depending on CXF run the OSGI tests with the proposed fix in a local snapshot.&lt;/p&gt;

&lt;p&gt;Having a seperate catch block like catch (CorruptConfigurationFile) might be simpler if it&apos;s just a poorly formatted config file which causes the problems. If the application context loading has failed due to class loading issues then it could be trickier.&lt;/p&gt;

&lt;p&gt;Now that I&apos;ve said it all I reckon the best option would be actually to store the original BeansException, give it a second try, and if the exception is thrown again then rethrow the original BeansException&lt;/p&gt;</comment>
                            <comment id="12677410" author="seumassoltysik" created="Fri, 27 Feb 2009 16:26:18 +0000"  >&lt;p&gt;Sergey, thanks for the input. &lt;br/&gt;
One additional issue is that when the BusApplicationContext is tried a second time, it simply logs an error regarding not being able to find the config file but no exceptions is thrown. I think the BAC would also need to be updated to throw an Exception if the config file is not found on the 2nd try to create the BAC. If we did this we could the implement your solution to hold onto the initial exception and throw it if an exception was thrown during the 2nd try.&lt;br/&gt;
Also if this 2nd try is there to satisfy an OSGi requirement, it seems like there should be some kind of test in CXF which requires this 2nd try so that the need for this is confirmed in the testing framework. Currently removing this 2nd try does not affect systests results.&lt;br/&gt;
I can submit a patch for this issue once we sort out the solution.&lt;/p&gt;</comment>
                            <comment id="12678040" author="seumassoltysik" created="Mon, 2 Mar 2009 17:16:28 +0000"  >&lt;p&gt;Sergey&lt;br/&gt;
you suggested holding onto the original expception and then rethrowing if 2nd attempt failed.&lt;/p&gt;

&lt;p&gt;this seems to create another problem whereby you may mislead the user because you throw the first exception when it turns out that the 2nd exception is really the one the user needs to know about.&lt;/p&gt;

&lt;p&gt;Perhaps simply logging the first exception is the way to go. Also I am curious why the BAC does not throw an exception if the configuration passed into the BAC is not found.&lt;/p&gt;
</comment>
                            <comment id="12678041" author="dkulp" created="Mon, 2 Mar 2009 17:27:15 +0000"  >

&lt;p&gt;I&apos;d STRONGLY prefer trying to remove the second call entirely.   This has a side affect of possibly causing objects to be instantiated twice which could do strange things if the objects aren&apos;t expecting that.   One example could be management which would setup connections to MBean servers and such.  You could end up with two things listed in the MBean servers.&lt;/p&gt;

&lt;p&gt;Thus, I&apos;d like to figure out why the second was necessary and try to fix that.   Do you know if it couldn&apos;t find a resource?   Couldn&apos;t find a config file?   Couldn&apos;t find a class?   etc....?&lt;/p&gt;

&lt;p&gt;One option COULD be to create a new Classloader that would delegate first to the current contextClassLoader and then to the BusApplicationContext.class.getClassLoader() and set the contextClassLoader to that.   That SHOULD allow anything that wasn&apos;t found the old method to be found.   &lt;/p&gt;</comment>
                            <comment id="12678047" author="sergey_beryozkin" created="Mon, 2 Mar 2009 17:57:19 +0000"  >&lt;p&gt;&amp;gt; Do you know if it couldn&apos;t find a resource? Couldn&apos;t find a config file? Couldn&apos;t find a class? etc....? &lt;/p&gt;

&lt;p&gt;It was probably 5/6 months ago when I applied this now infamous &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; retry. I belive it was about either classes or class resources being not found when run in OSGI. I honestly don&apos;t remember.&lt;/p&gt;

&lt;p&gt;But I&apos;d personally would not remove the second try before a Progress project which depends on CXF would run all the OSGI tests without it. Dan - perhaps creating a tailored ClassLoader would be a neat idea indeed - but it can also cause some OSGI issues as well as we might end up with some resources/classes being loaded by different loaders.&lt;/p&gt;

&lt;p&gt;&amp;gt; This has a side affect of possibly causing objects to be instantiated twice&lt;/p&gt;

&lt;p&gt;This is something we obviously do not want - but so far we haven&apos;t had any sideeffects - may be because it&apos;s now a dead code altogether which just kick in by swallowing an exception.&lt;/p&gt;

&lt;p&gt;IMHO it would be good if a quick Progress-internal build could be setup without this second retry. If it works then this code can be just removed, If it does not then I&apos;d start with what Seumas suggested - logging the original exception and opened a JIRA for exploring the possibility of creating a new class loader - the idea behind it does sound good - but it can be difficult to implement while working at the CXF/Fuse level only&lt;/p&gt;</comment>
                            <comment id="12680379" author="seumassoltysik" created="Tue, 10 Mar 2009 05:20:02 +0000"  >&lt;p&gt;Attached is a patch for this issue. the patch logs the initial exception after the first attempt to create a Bus and throws an exception when the user config file fails to load.&lt;/p&gt;</comment>
                            <comment id="12680533" author="sergey_beryozkin" created="Tue, 10 Mar 2009 16:46:47 +0000"  >&lt;p&gt;patch applied, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12401804" name="patch.txt" size="4924" author="seumassoltysik" created="Tue, 10 Mar 2009 05:20:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>113531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sy8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>167024</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>