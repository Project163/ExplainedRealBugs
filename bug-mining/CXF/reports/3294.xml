<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:31:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7720] Header values are lost </title>
                <link>https://issues.apache.org/jira/browse/CXF-7720</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When a request is made by WebClient to a service that returns several headers of the same name but with different cases, e.g.:&#160;&lt;/p&gt;

&lt;p&gt;&quot;Set-Cookie&quot; with value &quot;aaa&quot;&lt;br/&gt;
 &quot;set-cookie&quot; with value &quot;bbb&quot;&lt;br/&gt;
 &quot;SET-COOKIE&quot; with value &quot;ccc&quot;&lt;/p&gt;

&lt;p&gt;then the response object contains only one header value, all other values are lost.&lt;/p&gt;

&lt;p&gt;The issue&#160; is not reproducible in all cases, but only with some service providers and is probably caused by low-level details of provider implementation.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In the attachment there is a SoapUI REST mock service and CXF WebClient-based consumer with which the issue is reproducible.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7&lt;/p&gt;

&lt;p&gt;Java&#160;1.8.0_152&lt;/p&gt;

&lt;p&gt;SoapUI 5.2.1&lt;/p&gt;</environment>
        <key id="13154014">CXF-7720</key>
            <summary>Header values are lost </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="Bogatyrov">Vladimir Bogatyrov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Apr 2018 12:20:21 +0000</created>
                <updated>Mon, 25 Mar 2019 12:28:26 +0000</updated>
                            <resolved>Thu, 26 Apr 2018 16:47:47 +0000</resolved>
                                    <version>3.2.4</version>
                                    <fixVersion>3.2.5</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16445660" author="bogatyrov" created="Fri, 20 Apr 2018 12:21:32 +0000"  >&lt;p&gt;Normally, HttpURLConnection object from which the headers are read at &lt;a href=&quot;https://github.com/apache/cxf/blob/master/rt/transports/http/src/main/java/org/apache/cxf/transport/http/Headers.java#L292&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/blob/master/rt/transports/http/src/main/java/org/apache/cxf/transport/http/Headers.java#L292&lt;/a&gt; contains one map entry for all the header values.&lt;/p&gt;

&lt;p&gt;When the issue is reproduced however, HttpURLConnection object contains a separate entry for each of the headers with the similar name but with different cases, which leads to the situation when only one header value gets into headers map and all the other values are lost.&lt;/p&gt;</comment>
                            <comment id="16449585" author="coheigea" created="Tue, 24 Apr 2018 10:20:36 +0000"  >&lt;p&gt;I think your use-case is not valid, as HTTP headers are case-insensitive, from the spec:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Each header field consists of a name followed by a colon (&quot;:&quot;) and the field value. Field names are case-insensitive.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="16451810" author="bogatyrov" created="Wed, 25 Apr 2018 07:44:23 +0000"  >&lt;p&gt;The headers are case-insensitive, which means, that in the request from the use-case there are 3 values of the same header &apos;set cookie&apos; and 2 of them get missing. For me it looks that response object should contain all 3 values under the same header name.&lt;/p&gt;</comment>
                            <comment id="16452562" author="coheigea" created="Wed, 25 Apr 2018 16:04:00 +0000"  >&lt;p&gt;I don&apos;t think this is an option as the spec says:&lt;/p&gt;

&lt;p&gt;Origin servers SHOULD NOT fold multiple Set-Cookie header fields into a single header field.&lt;/p&gt;

&lt;p&gt;I took a look at seeing what would be involved in supporting multiple Set-Cookie headers with different cases but it potentially requires changing a lot of sensitive code, which I&apos;m reluctant to do as this is a niche use-case (why not just use the standard case?).&lt;/p&gt;</comment>
                            <comment id="16453214" author="dkulp" created="Wed, 25 Apr 2018 23:01:53 +0000"  >&lt;p&gt;We have a test case that does check to make sure three separate Set-Cookie headers are returned properly.   See:  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cxf/blob/master/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSClientServerBookTest.java#L930&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/blob/master/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSClientServerBookTest.java#L930&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="16453218" author="dkulp" created="Wed, 25 Apr 2018 23:09:21 +0000"  >&lt;p&gt;Actually, just changed the server side to send different case headers instead of all three being the &quot;proper&quot; Set-Cookie and the test does fail.   I&apos;ll take a look tomorrow.   It&apos;s definitely an issue on the server side as it&apos;s only sending a single Set-Cookie header back:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

HTTP/1.1 200 OK
Date: Wed, 25 Apr 2018 23:10:06 GMT
Set-Cookie: COOKIETWO=dummy2; expires=Sat, 20-Nov-2010 19:11:32 GMT; Path=/
BookId: 123
MAP-NAME: javax.ws.rs.core.MultivaluedMap
Content-Length: 0
Server: Jetty(9.4.8.v20171121)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16453702" author="coheigea" created="Thu, 26 Apr 2018 08:43:01 +0000"  >&lt;p&gt;I was also looking at that test....the server side doesn&apos;t send back the different case headers as the Jetty HttpField class compares header names in a case insensitive way, and just updated the value if they match instead of adding a new header. So I don&apos;t think there is anything we can do on the CXF side for that.&lt;/p&gt;</comment>
                            <comment id="16454528" author="coheigea" created="Thu, 26 Apr 2018 16:47:47 +0000"  >&lt;p&gt;Resolving, as the test-case works with the latest CXF SNAPSHOT.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12920004" name="consumer.zip" size="5459" author="Bogatyrov" created="Fri, 20 Apr 2018 12:13:10 +0000"/>
                            <attachment id="12920005" name="rest_mock_provider_soapui_project.xml" size="2752" author="Bogatyrov" created="Fri, 20 Apr 2018 12:12:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3sthj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>