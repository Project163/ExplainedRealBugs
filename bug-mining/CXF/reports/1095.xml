<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:49:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-3805] BeanInCreationException when CXF client factorybean used</title>
                <link>https://issues.apache.org/jira/browse/CXF-3805</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;In complex spring context, when JaxWsProxyFactoryBean is used, context fails to start with BeanCurrentlyInCreationException.&lt;br/&gt;
Part of exception:&lt;/p&gt;

&lt;p&gt;        at org.springframework.context.support.AbstractApplicationContext.getBea&lt;br/&gt;
nNamesForType(AbstractApplicationContext.java:1136)&lt;br/&gt;
        at org.apache.cxf.bus.spring.SpringBeanLocator.getBeansOfType(SpringBean&lt;br/&gt;
Locator.java:89)&lt;br/&gt;
        at org.apache.cxf.bus.CXFBusImpl.getExtension(CXFBusImpl.java:99)&lt;br/&gt;
        at org.apache.cxf.service.factory.AbstractServiceFactoryBean.setBus(Abst&lt;br/&gt;
ractServiceFactoryBean.java:98)&lt;br/&gt;
        at org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory.initializeSe&lt;br/&gt;
rviceFactory(AbstractWSDLBasedEndpointFactory.java:232)&lt;br/&gt;
        at org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory.createEndpoi&lt;br/&gt;
nt(AbstractWSDLBasedEndpointFactory.java:100)&lt;br/&gt;
        at org.apache.cxf.frontend.ClientFactoryBean.create(ClientFactoryBean.ja&lt;br/&gt;
va:90)&lt;br/&gt;
        at org.apache.cxf.frontend.ClientProxyFactoryBean.create(ClientProxyFact&lt;br/&gt;
oryBean.java:153)&lt;br/&gt;
        at org.apache.cxf.jaxws.JaxWsProxyFactoryBean.create(JaxWsProxyFactoryBe&lt;br/&gt;
an.java:151)&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
Caused by: org.springframework.beans.factory.BeanCurrentlyInCreationException: E&lt;br/&gt;
rror creating bean with name &apos;testBeanBBO&apos;: org.springframework.beans.factory.Fa&lt;br/&gt;
ctoryBeanNotInitializedException: FactoryBean is not fully initialized yet&lt;br/&gt;
        at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.&lt;br/&gt;
doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:146)&lt;br/&gt;
        at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.&lt;br/&gt;
getObjectFromFactoryBean(FactoryBeanRegistrySupport.java:109)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractBeanFactory.getObje&lt;br/&gt;
ctForBeanInstance(AbstractBeanFactory.java:1429)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBe&lt;br/&gt;
an(AbstractBeanFactory.java:245)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean&lt;br/&gt;
(AbstractBeanFactory.java:190)&lt;br/&gt;
        at org.springframework.beans.factory.support.BeanDefinitionValueResolver&lt;br/&gt;
.resolveReference(BeanDefinitionValueResolver.java:322)&lt;br/&gt;
        ... 133 more&lt;/p&gt;

&lt;p&gt;The main reason of the problem is that JaxWsProxyFactoryBean calls spring getBeanNamesForType, which&lt;br/&gt;
needs to instantiate all spring beans - and it is very easy to reach the case, that in spring context&lt;br/&gt;
in creation there are beans not fully initialized yet - and when getBeanNamesForType is called - BIG BUM - exception.&lt;/p&gt;

&lt;p&gt;It is not proper pattern to use spring getBeanNamesForType from FactoryBean.create method.&lt;/p&gt;

&lt;p&gt;I&apos;ve tracked the problem and isolated simple test case - it is attached.&lt;br/&gt;
Unpack it into apache-cxf-2.4.2-src\apache-cxf-2.4.2-src\systests\jaxws\src\test\java&lt;br/&gt;
and run:&lt;br/&gt;
mvn -Dtest=BeanInCreationExceptionTest test&lt;br/&gt;
It fails for spring2 and spring3 as well.&lt;/p&gt;

&lt;p&gt;When you look at beans.xml, you will see that there are no circular dependencies which usually cause &lt;br/&gt;
BeanCurrentlyInCreationException - but JaxWsProxyFactoryBean.create is making the problem.&lt;/p&gt;

&lt;p&gt;Just comment one line as below in beans.xml:&lt;br/&gt;
	&amp;lt;bean id=&quot;testBeanBBOImpl&quot; class=&quot;org.apache.cxf.systest.beanincreationexception.TestBeanABOImpl&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;bean&quot; ref=&quot;testBeanABO&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;!--  		&amp;lt;property name=&quot;client&quot; ref=&quot;client2&quot;/&amp;gt; --&amp;gt; &lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;


&lt;p&gt;and test runs ok.&lt;/p&gt;

&lt;p&gt;How to fix? Provide lighter version (or a switch) of JaxWsProxyFactoryBean - it can just create the proxy,&lt;br/&gt;
and the rest (endpoint, client, all the stuff which requires getBeanNamesForType) can be instantiated later - for example in AfterpropertiesSet phase.&lt;br/&gt;
Or avoid getBeanNamesForType if possible.&lt;/p&gt;

&lt;p&gt;Now the workaround we try, is to change the order of spring beans xml&apos;s and have a luck. Eventually changing from injecting client service/portType to&lt;br/&gt;
getting them from applicationcontext.getBean - but it is not good practice.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12523180">CXF-3805</key>
            <summary>BeanInCreationException when CXF client factorybean used</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="tomaszbech">Tomasz Bech</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Sep 2011 11:46:13 +0000</created>
                <updated>Wed, 19 Oct 2011 17:30:21 +0000</updated>
                            <resolved>Fri, 16 Sep 2011 16:58:35 +0000</resolved>
                                    <version>2.4.2</version>
                                    <fixVersion>2.4.3</fixVersion>
                                    <component>JAX-WS Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13105393" author="dkulp" created="Thu, 15 Sep 2011 14:36:14 +0000"  >&lt;p&gt;Any chance you can re-attach the zip and check the &quot;grant license to Apache&quot; checkbox?   I can then add this directly in the test suite.&lt;/p&gt;

&lt;p&gt;I do have a fix coming.  It&apos;s something I saw a month or so ago and questioned to myself, but didn&apos;t mess with it at the time as I was afraid to do anything about it.   The calls to getBeanNamesForType have a flag to eagerly init things that we are setting to true.   When I saw that it did raise concerns in my head, but didn&apos;t have time to really figure out if it&apos;s an issue or not.  Apparently it is.   Changing that flag to false fixes your testcase (and doesn&apos;t seem to break any of our other tests).&lt;/p&gt;
</comment>
                            <comment id="13105862" author="tomaszbech" created="Fri, 16 Sep 2011 05:18:00 +0000"  >&lt;p&gt;as you wish &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13105923" author="tomaszbech" created="Fri, 16 Sep 2011 07:35:41 +0000"  >&lt;p&gt;i&apos;ve patched cxf localy (changing true-&amp;gt;false in 3 places), and it seems it fixes the problem (context in our real project starts nicely).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12494753" name="beanincreationexction.zip" size="5233" author="tomaszbech" created="Fri, 16 Sep 2011 05:18:00 +0000"/>
                            <attachment id="12494604" name="beanincreationexction.zip" size="5233" author="tomaszbech" created="Thu, 15 Sep 2011 11:46:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3547</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b7lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>