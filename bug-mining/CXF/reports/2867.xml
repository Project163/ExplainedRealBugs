<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:21:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7037] @Suspended can be broken on tomcat</title>
                <link>https://issues.apache.org/jira/browse/CXF-7037</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;For AsyncContext usages, tomcat ensures the non container threads wait for the container thread to exit the execution (the one starting the async context) to avoid concurrency issue.&lt;/p&gt;

&lt;p&gt;For cxf it means you can resume() in a user thread on an AsyncResponse while you execute AsyncResponseImpl.suspendContinuationIfNeeded().&lt;/p&gt;

&lt;p&gt;This can lead to a lock preventing the request to complete.&lt;/p&gt;

&lt;p&gt;Here is a sample thread:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;managed-thread-3@7750&quot;&lt;/span&gt; daemon prio=5 tid=0x48 nid=NA waiting
  java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING
     blocks http-nio-24622-exec-3@7702
      at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:-1)
      at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:502)
      at org.apache.coyote.AsyncStateMachine.pauseNonContainerThread(AsyncStateMachine.java:452)
      at org.apache.coyote.AsyncStateMachine.asyncDispatch(AsyncStateMachine.java:315)
      at org.apache.coyote.http11.Http11Processor.action(Http11Processor.java:858)
      at org.apache.coyote.Request.action(Request.java:390)
      at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:203)
      - locked &amp;lt;0x21ed&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
      at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:171)
      at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:165)
      at org.apache.openejb.server.httpd.EEFilter$AsynContextWrapper.dispatch(EEFilter.java:171)
      at org.apache.cxf.transport.http.Servlet3ContinuationProvider$Servlet3Continuation.redispatch(Servlet3ContinuationProvider.java:125)
      at org.apache.cxf.transport.http.Servlet3ContinuationProvider$Servlet3Continuation.resume(Servlet3ContinuationProvider.java:131)
      at org.apache.cxf.jaxrs.impl.AsyncResponseImpl.doResumeFinal(AsyncResponseImpl.java:96)
      - locked &amp;lt;0x2196&amp;gt; (a org.apache.cxf.jaxrs.impl.AsyncResponseImpl)
      at org.apache.cxf.jaxrs.impl.AsyncResponseImpl.doResume(AsyncResponseImpl.java:89)
      at org.apache.cxf.jaxrs.impl.AsyncResponseImpl.resume(AsyncResponseImpl.java:73)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor.lambda$async$0(AsyncInterceptor.java:63)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$$Lambda$55.375198754.run(Unknown Source:-1)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$TransactionProvider.run(AsyncInterceptor.java:148)
      at sun.reflect.GeneratedMethodAccessor95.invoke(Unknown Source:-1)
      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
      at java.lang.reflect.Method.invoke(Method.java:498)
      at org.apache.webbeans.intercept.AbstractInvocationContext.directProceed(AbstractInvocationContext.java:113)
      at org.apache.webbeans.intercept.AbstractInvocationContext.proceed(AbstractInvocationContext.java:106)
      at org.apache.webbeans.intercept.InterceptorInvocationContext.proceed(InterceptorInvocationContext.java:67)
      at org.apache.openejb.cdi.transactional.InterceptorBase.intercept(InterceptorBase.java:66)
      at org.apache.openejb.cdi.transactional.RequiredInterceptor.intercept(RequiredInterceptor.java:35)
      at sun.reflect.GeneratedMethodAccessor85.invoke(Unknown Source:-1)
      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
      at java.lang.reflect.Method.invoke(Method.java:498)
      at org.apache.webbeans.component.InterceptorBean.intercept(InterceptorBean.java:136)
      at org.apache.webbeans.intercept.InterceptorInvocationContext.proceed(InterceptorInvocationContext.java:63)
      at org.apache.webbeans.intercept.DefaultInterceptorHandler.invoke(DefaultInterceptorHandler.java:139)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$TransactionProvider$$OwbInterceptProxy0.run(com/github/rmannibucau/rblog/jaxrs/async/AsyncInterceptor$TransactionProvider.java:-1)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$TransactionProvider$$OwbNormalScopeProxy0.run(com/github/rmannibucau/rblog/jaxrs/async/AsyncInterceptor$TransactionProvider.java:-1)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$Metas.lambda$runInTransaction$6(AsyncInterceptor.java:130)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$Metas$$Lambda$56.1727885795.run(Unknown Source:-1)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$Metas.lambda$toJaxRs$7(AsyncInterceptor.java:136)
      at com.github.rmannibucau.rblog.jaxrs.async.AsyncInterceptor$Metas$$Lambda$57.1956863343.run(Unknown Source:-1)
      at org.apache.openejb.threads.task.CURunnable$1.call(CURunnable.java:35)
      at org.apache.openejb.threads.task.CURunnable$1.call(CURunnable.java:32)
      at org.apache.openejb.threads.task.CUTask.invoke(CUTask.java:89)
      at org.apache.openejb.threads.task.CURunnable.run(CURunnable.java:32)
      at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
      at java.util.concurrent.FutureTask.run(FutureTask.java:266)
      at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
      at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)

&lt;span class=&quot;code-quote&quot;&gt;&quot;http-nio-24622-exec-3@7702&quot;&lt;/span&gt; daemon prio=5 tid=0x41 nid=NA waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; monitor entry
  java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: BLOCKED
     waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; managed-thread-3@7750 to release lock on &amp;lt;0x2196&amp;gt; (a org.apache.cxf.jaxrs.impl.AsyncResponseImpl)
      at org.apache.cxf.jaxrs.impl.AsyncResponseImpl.suspendContinuationIfNeeded(AsyncResponseImpl.java:263)
      at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:191)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Solution would be to not synchronize both method and probably move to a volatile state&lt;/p&gt;</description>
                <environment></environment>
        <key id="13002344">CXF-7037</key>
            <summary>@Suspended can be broken on tomcat</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="romain.manni-bucau">Romain Manni-Bucau</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Sep 2016 13:23:48 +0000</created>
                <updated>Fri, 21 Oct 2016 18:46:14 +0000</updated>
                            <resolved>Mon, 5 Sep 2016 12:55:05 +0000</resolved>
                                    <version>3.1.7</version>
                                    <fixVersion>3.1.8</fixVersion>
                    <fixVersion>3.0.11</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15458549" author="sergey_beryozkin" created="Fri, 2 Sep 2016 13:38:26 +0000"  >&lt;p&gt;Is it a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6249&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-6249&lt;/a&gt; ? (I opened it after talking to you).&lt;br/&gt;
At a time you said Tomcat was wrong and provided a patch or comment to Tomcat dev ?&lt;/p&gt;</comment>
                            <comment id="15464835" author="sergey_beryozkin" created="Mon, 5 Sep 2016 11:55:15 +0000"  >&lt;p&gt;Hi Romain&lt;/p&gt;

&lt;p&gt;Can you play with 3.1.8-SNAPSHOT please, I&apos;ve removed the synchronized blocks and the code now depends on a volatile state which is the right way forward anyway. Thanks&lt;/p&gt;</comment>
                            <comment id="15464924" author="romain.manni-bucau" created="Mon, 5 Sep 2016 12:46:03 +0000"  >&lt;p&gt;All green where it was locking before, thanks!&lt;/p&gt;</comment>
                            <comment id="15464942" author="sergey_beryozkin" created="Mon, 5 Sep 2016 12:54:52 +0000"  >&lt;p&gt;Great, thanks for identifying the cause of this issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12773767">CXF-6249</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 11 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i336mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>