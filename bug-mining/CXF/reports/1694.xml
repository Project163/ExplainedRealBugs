<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:59:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4851] AttachmentDeserializer cannot handle attachments with Quoted Printable content transfer encoding in initializeRootMessage</title>
                <link>https://issues.apache.org/jira/browse/CXF-4851</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The issue is the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-1847&quot; title=&quot;AttachmentDeserializer cannot handle attachments with Quoted Printable content transfer encoding&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-1847&quot;&gt;&lt;del&gt;CXF-1847&lt;/del&gt;&lt;/a&gt;, but it happens by initializing root message in initializeRootMessage() method.&lt;/p&gt;

&lt;p&gt;processing SOAP&lt;/p&gt;

&lt;p&gt;POST /PortalUpdateStatusServiceWAR/updateStatusService HTTP/1.1&lt;br/&gt;
Host: 127.0.0.1:7788&lt;br/&gt;
Connection: close, TE&lt;br/&gt;
TE: trailers, deflate, gzip, compress&lt;br/&gt;
User-Agent: Oracle HTTPClient Version 10h&lt;br/&gt;
SOAPAction: updateStatus&lt;br/&gt;
Accept-Encoding: gzip, x-gzip, compress, x-compress&lt;br/&gt;
Content-type: multipart/related; type=&quot;text/xml&quot;; start=&quot;&amp;lt;84353ECADD8D15912FBDF2318104ECF4&amp;gt;&quot;; 	boundary=&quot;----=_Part_119_6505558.1361536929956&quot;&lt;br/&gt;
Content-length: 138556&lt;/p&gt;


&lt;p&gt;------=_Part_119_6505558.1361536929956&lt;br/&gt;
Content-Type: text/plain; charset=Cp1251&lt;br/&gt;
Content-Transfer-Encoding: quoted-printable&lt;br/&gt;
Content-Id: &amp;lt;84353ECADD8D15912FBDF2318104ECF4&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=3D&quot;1.0&quot; encoding=3D&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
...&lt;br/&gt;
&amp;lt;/env:Body&amp;gt;&lt;br/&gt;
&amp;lt;/env:Envelope&amp;gt;&lt;br/&gt;
------=_Part_119_6505558.1361536929956&lt;br/&gt;
Content-Type: application/octet-stream&lt;br/&gt;
Content-Transfer-Encoding: binary&lt;br/&gt;
Content-Id: &amp;lt;3048&amp;gt;&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;results in the following exception:&lt;/p&gt;

&lt;p&gt;13:38:30.567 &lt;span class=&quot;error&quot;&gt;&amp;#91;AJPRequestHandler-RMICallHandler-38&amp;#93;&lt;/span&gt; WARN  o.a.cxf.phase.PhaseInterceptorChain - Interceptor for &lt;/p&gt;
{http://ws.apache.org/axis2}
&lt;p&gt;updateStatusService has thrown exception, unwinding now&lt;br/&gt;
java.lang.RuntimeException: Couldn&apos;t parse stream.&lt;br/&gt;
	at org.apache.cxf.staxutils.StaxUtils.createXMLStreamReader(StaxUtils.java:1262) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-api-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.interceptor.StaxInInterceptor.handleMessage(StaxInInterceptor.java:112) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-api-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:262) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-api-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-api-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:237) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:209) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:189) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:130) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:225) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doPost(AbstractHTTPServlet.java:145) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:763) &lt;span class=&quot;error&quot;&gt;&amp;#91;servlet.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:201) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.server.http.ServletRequestDispatcher.invoke(ServletRequestDispatcher.java:734) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.server.http.ServletRequestDispatcher.forwardInternal(ServletRequestDispatcher.java:391) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.server.http.HttpRequestHandler.doProcessRequest(HttpRequestHandler.java:908) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.server.http.HttpRequestHandler.processRequest(HttpRequestHandler.java:458) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.server.http.AJPRequestHandler.run(AJPRequestHandler.java:313) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.server.http.AJPRequestHandler.run(AJPRequestHandler.java:199) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at oracle.oc4j.network.ServerSocketReadHandler$SafeRunnable.run(ServerSocketReadHandler.java:260) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.evermind.util.ReleasableResourcePooledExecutor$MyWorker.run(ReleasableResourcePooledExecutor.java:303) &lt;span class=&quot;error&quot;&gt;&amp;#91;oc4j-internal.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:595) &lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.5.0_18&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: com.ctc.wstx.exc.WstxUnexpectedCharException: Unexpected character &apos;3&apos; (code 51); expected a quote character enclosing value for &apos;version&apos;&lt;br/&gt;
 at [row,col &lt;/p&gt;
{unknown-source}
&lt;p&gt;]: &lt;span class=&quot;error&quot;&gt;&amp;#91;1,15&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.io.InputBootstrapper.reportUnexpectedChar(InputBootstrapper.java:506) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.io.InputBootstrapper.handleEq(InputBootstrapper.java:421) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.io.InputBootstrapper.readXmlVersion(InputBootstrapper.java:319) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.io.InputBootstrapper.readXmlDecl(InputBootstrapper.java:262) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.io.ReaderBootstrapper.bootstrapInput(ReaderBootstrapper.java:155) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.stax.WstxInputFactory.doCreateSR(WstxInputFactory.java:531) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.stax.WstxInputFactory.createSR(WstxInputFactory.java:585) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.stax.WstxInputFactory.createSR(WstxInputFactory.java:610) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ctc.wstx.stax.WstxInputFactory.createXMLStreamReader(WstxInputFactory.java:316) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;woodstox-core-asl-4.1.1.jar:4.1.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.cxf.staxutils.StaxUtils.createXMLStreamReader(StaxUtils.java:1260) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-api-2.6.6.jar:2.6.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	... 20 common frames omitted&lt;/p&gt;

&lt;p&gt;I solved that by the following modification (version 2.6.6)&lt;/p&gt;

&lt;p&gt; try {&lt;br/&gt;
                InternetHeaders ih = new InternetHeaders(stream);&lt;br/&gt;
                message.put(InternetHeaders.class.getName(), ih);&lt;br/&gt;
                String val = ih.getHeader(&quot;Content-Type&quot;, &quot;; &quot;);&lt;br/&gt;
                if (!StringUtils.isEmpty(val)) {&lt;br/&gt;
                    String cs = HttpHeaderHelper.findCharset(val);&lt;br/&gt;
                    if (!StringUtils.isEmpty(cs)) &lt;/p&gt;
{
                        message.put(Message.ENCODING, HttpHeaderHelper.mapCharset(cs));
                    }
&lt;p&gt;                    String contentTransferEncoding = ih.getHeader(&quot;Content-Transfer-Encoding&quot;, null);&lt;br/&gt;
                    quotedPrintable = contentTransferEncoding != null &lt;br/&gt;
                    		&amp;amp;&amp;amp; contentTransferEncoding&lt;br/&gt;
                    		.equalsIgnoreCase(QUOTED_PRINTABLE);&lt;br/&gt;
                }&lt;br/&gt;
            } catch (MessagingException e) &lt;/p&gt;
{
                throw new RuntimeException(e);
            }
&lt;p&gt;            InputStream is;&lt;br/&gt;
            if (quotedPrintable)&lt;/p&gt;
            {
            	InputStream rawInputSream = new MimeBodyPartInputStream(stream, boundary, pbAmount);
				is = new QuotedPrintableDecoderStream(rawInputSream);
            }
&lt;p&gt;            	else&lt;br/&gt;
            		is = new MimeBodyPartInputStream(stream, boundary, pbAmount);&lt;br/&gt;
            body = new DelegatingInputStream(is,&lt;br/&gt;
                                             this);&lt;br/&gt;
            createCount++;&lt;br/&gt;
            message.setContent(InputStream.class, body);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12633892">CXF-4851</key>
            <summary>AttachmentDeserializer cannot handle attachments with Quoted Printable content transfer encoding in initializeRootMessage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="vanarchi">Ivan Grebenek</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Feb 2013 11:44:51 +0000</created>
                <updated>Mon, 10 Apr 2017 19:04:32 +0000</updated>
                            <resolved>Wed, 29 Mar 2017 12:38:15 +0000</resolved>
                                    <version>2.6.6</version>
                    <version>2.7.3</version>
                                    <fixVersion>3.0.13</fixVersion>
                    <fixVersion>3.1.11</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314386</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 39 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1i933:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314731</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>