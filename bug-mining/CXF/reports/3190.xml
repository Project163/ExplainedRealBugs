<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:29:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7578] WS-Trust Secured Request casts SecretKeySpec to PrivateKey</title>
                <link>https://issues.apache.org/jira/browse/CXF-7578</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>
&lt;p&gt;Flow is:&lt;/p&gt;

&lt;p&gt;Set the STS Client for a SOAP-Context to request a Ws-Trust token for a already aquired SAML Assertion (ActsAs)&lt;/p&gt;

&lt;p&gt;STSClient retrieves the WS-Trust token alright, then tries to - a presume - sign the SOAP-request to die actual Service.&lt;br/&gt;
This fails:&lt;/p&gt;

&lt;p&gt;{{Caused by: java.lang.ClassCastException: javax.crypto.spec.SecretKeySpec cannot be cast to java.security.PrivateKey&lt;br/&gt;
	at org.apache.xml.security.stax.impl.algorithms.PKISignatureAlgorithm.engineInitSign(PKISignatureAlgorithm.java:77)&lt;br/&gt;
	at org.apache.xml.security.stax.impl.processor.output.AbstractSignatureEndingOutputProcessor.processHeaderEvent(AbstractSignatureEndingOutputProcessor.java:141)&lt;br/&gt;
	at org.apache.wss4j.stax.impl.processor.output.WSSSignatureEndingOutputProcessor.processHeaderEvent(WSSSignatureEndingOutputProcessor.java:77)&lt;br/&gt;
	at org.apache.xml.security.stax.ext.AbstractBufferingOutputProcessor.flushBufferAndCallbackAfterHeader(AbstractBufferingOutputProcessor.java:68)&lt;br/&gt;
	at org.apache.wss4j.stax.impl.processor.output.WSSSignatureEndingOutputProcessor.flushBufferAndCallbackAfterHeader(WSSSignatureEndingOutputProcessor.java:284)&lt;br/&gt;
	at org.apache.xml.security.stax.ext.AbstractBufferingOutputProcessor.doFinal(AbstractBufferingOutputProcessor.java:54)&lt;br/&gt;
	at org.apache.xml.security.stax.impl.OutputProcessorChainImpl.doFinal(OutputProcessorChainImpl.java:225)&lt;br/&gt;
	at org.apache.xml.security.stax.ext.AbstractOutputProcessor.doFinal(AbstractOutputProcessor.java:140)&lt;br/&gt;
	at org.apache.xml.security.stax.impl.processor.output.AbstractSignatureOutputProcessor.doFinal(AbstractSignatureOutputProcessor.java:72)&lt;br/&gt;
	at org.apache.xml.security.stax.impl.OutputProcessorChainImpl.doFinal(OutputProcessorChainImpl.java:225)&lt;br/&gt;
	at org.apache.xml.security.stax.impl.XMLSecurityStreamWriter.close(XMLSecurityStreamWriter.java:192)&lt;br/&gt;
	at org.apache.cxf.ws.security.wss4j.WSS4JStaxOutInterceptor$WSS4JStaxOutInterceptorInternal.handleMessageInternal(WSS4JStaxOutInterceptor.java:335)&lt;br/&gt;
	at org.apache.cxf.ws.security.wss4j.WSS4JStaxOutInterceptor$WSS4JStaxOutInterceptorInternal.handleMessage(WSS4JStaxOutInterceptor.java:321)&lt;br/&gt;
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:516)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:425)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:326)&lt;br/&gt;
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:279)&lt;br/&gt;
	at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:96)&lt;br/&gt;
	at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:139)&lt;br/&gt;
}}&lt;/p&gt;

&lt;p&gt;The line in question does this:&lt;/p&gt;

&lt;p&gt;{{ signature.initSign((PrivateKey) signingKey);}}&lt;br/&gt;
while signingKey always is set to a SecretKeySpec by cxf&apos;s {{AbstractSignatureEndingOutputProcessor, line 139&lt;br/&gt;
Key key = wrappingSecurityToken.getSecretKey(sigAlgorithm);}}&lt;/p&gt;

&lt;p&gt;This is the WS-Trust token reply I recieve from the STS (Certificates are selfsigned, names and ruis are changed for this report):&lt;br/&gt;
{{&lt;br/&gt;
&amp;lt;S:Envelope xmlns:S=&quot;http://www.w3.org/2003/05/soap-envelope&quot; xmlns:wsse11=&quot;http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd&quot; xmlns:wsse=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;S:Header&amp;gt;&lt;br/&gt;
    &amp;lt;Action xmlns=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:S=&quot;http://www.w3.org/2003/05/soap-envelope&quot; S:mustUnderstand=&quot;true&quot;&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512/RSTRC/IssueFinal&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-sx/ws-trust/200512/RSTRC/IssueFinal&lt;/a&gt;&amp;lt;/Action&amp;gt;&lt;br/&gt;
    &amp;lt;MessageID xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&amp;gt;uuid:bfb37bd1-70a1-4c51-87d5-ea40f8162a0f&amp;lt;/MessageID&amp;gt;&lt;br/&gt;
    &amp;lt;RelatesTo xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&amp;gt;urn:uuid:55c8fc93-73d7-46c7-adcb-1e2ca9f34e16&amp;lt;/RelatesTo&amp;gt;&lt;br/&gt;
    &amp;lt;To xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&amp;gt;&lt;a href=&quot;http://www.w3.org/2005/08/addressing/anonymous&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/2005/08/addressing/anonymous&lt;/a&gt;&amp;lt;/To&amp;gt;&lt;br/&gt;
    &amp;lt;wsse:Security S:mustUnderstand=&quot;true&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;wsu:Timestamp xmlns:ns15=&quot;http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512&quot; xmlns:ns14=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; wsu:Id=&quot;_1&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;wsu:Created&amp;gt;2017-12-04T07:49:48Z&amp;lt;/wsu:Created&amp;gt;&lt;br/&gt;
        &amp;lt;wsu:Expires&amp;gt;2017-12-04T07:54:48Z&amp;lt;/wsu:Expires&amp;gt;&lt;br/&gt;
      &amp;lt;/wsu:Timestamp&amp;gt;&lt;br/&gt;
    &amp;lt;/wsse:Security&amp;gt;&lt;br/&gt;
  &amp;lt;/S:Header&amp;gt;&lt;br/&gt;
  &amp;lt;S:Body&amp;gt;&lt;br/&gt;
    &amp;lt;trust:RequestSecurityTokenResponseCollection xmlns:ns10=&quot;http://www.w3.org/2000/09/xmldsig#&quot; xmlns:ns13=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; xmlns:ns4=&quot;http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd&quot; xmlns:ns5=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512/&quot; xmlns:ns9=&quot;http://schemas.xmlsoap.org/ws/2006/02/addressingidentity&quot; xmlns:sc=&quot;http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512&quot; xmlns:trust=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot; xmlns:wsse=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; xmlns:wst=&quot;http://schemas.xmlsoap.org/ws/2005/02/trust&quot; xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;trust:RequestSecurityTokenResponse&amp;gt;&lt;br/&gt;
        &amp;lt;trust:TokenType&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&lt;/a&gt;&amp;lt;/trust:TokenType&amp;gt;&lt;br/&gt;
        &amp;lt;trust:RequestedSecurityToken&amp;gt;&lt;br/&gt;
          &amp;lt;saml2:Assertion xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot; xmlns:exc14n=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xenc=&quot;http://www.w3.org/2001/04/xmlenc#&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; ID=&quot;nstsb73a0e5a-1ec3-451b-89e1-07fb99b755e0&quot; IssueInstant=&quot;2017-12-04T07:49:48.802Z&quot; Version=&quot;2.0&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;saml2:Issuer&amp;gt;NetIQ_STS&amp;lt;/saml2:Issuer&amp;gt;&lt;br/&gt;
            &amp;lt;ds:Signature&amp;gt;&lt;br/&gt;
              &amp;lt;ds:SignedInfo&amp;gt;&lt;br/&gt;
                &amp;lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&amp;gt;&lt;br/&gt;
                &amp;lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;/&amp;gt;&lt;br/&gt;
                &amp;lt;ds:Reference URI=&quot;#nstsb73a0e5a-1ec3-451b-89e1-07fb99b755e0&quot;&amp;gt;&lt;br/&gt;
                  &amp;lt;ds:Transforms&amp;gt;&lt;br/&gt;
                    &amp;lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;/&amp;gt;&lt;br/&gt;
                    &amp;lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&amp;gt;&lt;br/&gt;
                  &amp;lt;/ds:Transforms&amp;gt;&lt;br/&gt;
                  &amp;lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;/&amp;gt;&lt;br/&gt;
                  &amp;lt;ds:DigestValue&amp;gt;kJMGItWGRm7klCMcQS4VprJromA=&amp;lt;/ds:DigestValue&amp;gt;&lt;br/&gt;
                &amp;lt;/ds:Reference&amp;gt;&lt;br/&gt;
              &amp;lt;/ds:SignedInfo&amp;gt;&lt;br/&gt;
              &amp;lt;ds:SignatureValue&amp;gt;KMH1flkFYr/O5uUd/2AKzJ5iHeei5i1hBs+nbUFqmgRVPtW2OCxlrEq/qXBVhnS0mOIWdnJxE4q7&lt;br/&gt;
N9aKXl7nQUAxkraNVYGSO5gCmaHdVKW/7V9w9bJn6xiNHA8gtzaKGQ8oaw5YqzlT9XN2Kt1+yPOE&lt;br/&gt;
DYZTN0v6R0I3Cl1dFNXKX65A4pGdm32JXTS8XanvXfA2Fd0msh7NbAPLUDX4Noce7MOQRcKim67T&lt;br/&gt;
obH72x8NIu7pQfj+crjIsPswgpYa9Q3uDvSAJqEI/aATd6LVWwnDmutmWLrSHglh/pT6Eo2xXAaY&lt;br/&gt;
rtGxIj7RL5ccoTzUSM+z+mkZRAEX//CCfEViyQ==&amp;lt;/ds:SignatureValue&amp;gt;&lt;br/&gt;
              &amp;lt;ds:KeyInfo&amp;gt;&lt;br/&gt;
                &amp;lt;ds:X509Data&amp;gt;&lt;br/&gt;
                  &amp;lt;ds:X509Certificate&amp;gt;MIIE/jCCA+agAwIBAgIUb2yiaoR9iovKmsL3z7Z7Yc2J5GQwDQYJKoZIhvcNAQELBQAwODEaMBgG&lt;br/&gt;
A1UECxMRT3JnYW5pemF0aW9uYWwgQ0ExGjAYBgNVBAoUEXNfYXBsX3ZtXzAwMV90cmVlMB4XDTE3&lt;br/&gt;
MDcyNTEwMTEwMloXDTI3MDcyNTEwMTEwMlowIjEgMB4GA1UEAxMXcy1hcGwtdm0tMDAxLmNvcnBu&lt;br/&gt;
ZXQuYXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDqsyg1WKCTR+QVoZthSnqjIblW&lt;br/&gt;
zd1Y5JMfI2hRoglgKn5odPuXvOtnbiqelKsmkyhgEXd83T0nHxNimONvT1Tp+/DE4egxSeBvuThM&lt;br/&gt;
Z+C2+6gUpVk4TTYA42LTDedFyz5Dz+38ksTq/lHsha7E+dUStpC8qsQRNVSY99+KzeaB4TZB1vQa&lt;br/&gt;
NX+/zYGEN62petbH31ByygowqrcPRVp2ciKIbUCKtvcNRo7CTd+dTBkApnB0l4Rjbnkt86HNlRkM&lt;br/&gt;
jXY0NWEsDhPTuGBOmAn4llCwP7rXyKuscDA9rSuXR4CsFATYtTXMqTYzPq8+FRF0hH4O8gEfhbko&lt;br/&gt;
MnfK6wxcNEHpAgMBAAGjggIUMIICEDAdBgNVHQ4EFgQUCsUhkj27mPP95ZSDKltZJ/NABjcwHwYD&lt;br/&gt;
VR0jBBgwFoAUyrEJpJ0Xd/FawGIUHtNYF2CrVTgwggHMBgtghkgBhvg3AQkEAQSCAbswggG3BAIB&lt;br/&gt;
AAEB/xMdTm92ZWxsIFNlY3VyaXR5IEF0dHJpYnV0ZSh0bSkWQ2h0dHA6Ly9kZXZlbG9wZXIubm92&lt;br/&gt;
ZWxsLmNvbS9yZXBvc2l0b3J5L2F0dHJpYnV0ZXMvY2VydGF0dHJzX3YxMC5odG0wggFIoBoBAQAw&lt;br/&gt;
CDAGAgEBAgFGMAgwBgIBAQIBCgIBaaEaAQEAMAgwBgIBAQIBADAIMAYCAQECAQACAQCiBgIBFwEB&lt;br/&gt;
/6OCAQSgWAIBAgICAP8CAQADDQCAAAAAAAAAAAAAAAADCQCAAAAAAAAAADAYMBACAQACCH//////&lt;br/&gt;
////AQEAAgQG8N9IMBgwEAIBAAIIf/////////8BAQACBAbw30ihWAIBAgICAP8CAQADDQBAAAAA&lt;br/&gt;
AAAAAAAAAAADCQBAAAAAAAAAADAYMBACAQACCH//////////AQEAAgQR/6pnMBgwEAIBAAIIf///&lt;br/&gt;
//////8BAQACBBH/qmeiTjBMAgECAgEAAgIA/wMNAIAAAAAAAAAAAAAAAAMJAIAAAAAAAAAAMBIw&lt;br/&gt;
EAIBAAIIf/////////8BAQAwEjAQAgEAAgh//////////wEBADANBgkqhkiG9w0BAQsFAAOCAQEA&lt;br/&gt;
Ub6eSzBaltUcb/KmF08me9lRQMefYUR5ILaGMdvulo9KPESP6/PqsRQLWFHjsi6I8HRL5KdFarv/&lt;br/&gt;
Niq1AJSSo+KOOKQSiwAMAo9F3jskGXCCmF5A3gBS+zu7FMt22D1l9bhtvjQoIXCpw7UXdeP/mUp9&lt;br/&gt;
j2MJPa2Lsp+O1r3q6kv1NAjLwcO8uZjfTs+UF1zWkdffsEsudfYXfZjWtJ+2UUJDZbYjf1x5NbY2&lt;br/&gt;
8Ml+Uq51salIXddFYarLRRGiQcUr/8Of1uXkQyS8kyrnO4B+sWYgLrN/6z9ySRukabqtU5VqjV/9&lt;br/&gt;
wvSJGKU2n0aSWynlR0ZqvSM6YbI0MXD4I+Gjxg==&amp;lt;/ds:X509Certificate&amp;gt;&lt;br/&gt;
                &amp;lt;/ds:X509Data&amp;gt;&lt;br/&gt;
              &amp;lt;/ds:KeyInfo&amp;gt;&lt;br/&gt;
            &amp;lt;/ds:Signature&amp;gt;&lt;br/&gt;
            &amp;lt;saml2:Subject&amp;gt;&lt;br/&gt;
              &amp;lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&quot; NameQualifier=&quot;https://CHANGED_FOR_BUGREPORT&quot;&amp;gt;CHANGED_FOR_BUGREPORT&amp;lt;/saml2:NameID&amp;gt;&lt;br/&gt;
              &amp;lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:holder-of-key&quot;&amp;gt;&lt;br/&gt;
                &amp;lt;saml2:SubjectConfirmationData xmlns:ns6=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ns6:type=&quot;saml2:KeyInfoConfirmationDataType&quot;&amp;gt;&lt;br/&gt;
                  &amp;lt;ds:KeyInfo&amp;gt;&lt;/p&gt;

&lt;p&gt;                    &amp;lt;xenc:EncryptedKey&amp;gt;&lt;br/&gt;
                      &amp;lt;xenc:EncryptionMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;/&amp;gt;&lt;br/&gt;
                      &amp;lt;ds:KeyInfo&amp;gt;&lt;br/&gt;
                        &amp;lt;ds:X509Data&amp;gt;&lt;br/&gt;
                          &amp;lt;ds:X509Certificate&amp;gt;&lt;br/&gt;
MIICVjCCAb8CCAogFwUjESABMA0GCSqGSIb3DQEBCwUAMHAxCzAJBgNVBAYTAkRFMRwwGgYDVQQK&lt;br/&gt;
ExNTQVAgVHJ1c3QgQ29tbXVuaXR5MRMwEQYDVQQLEwpTQVAgV2ViIEFTMRQwEgYDVQQLEwtJMDAy&lt;br/&gt;
MDE2NzAwMzEYMBYGA1UEAwwPSTVTX1NTRkFfUzJTVlBFMB4XDTE3MDUyMzExMjAwMVoXDTM4MDEw&lt;br/&gt;
MTAwMDAwMVowcDELMAkGA1UEBhMCREUxHDAaBgNVBAoTE1NBUCBUcnVzdCBDb21tdW5pdHkxEzAR&lt;br/&gt;
BgNVBAsTClNBUCBXZWIgQVMxFDASBgNVBAsTC0kwMDIwMTY3MDAzMRgwFgYDVQQDDA9JNVNfU1NG&lt;br/&gt;
QV9TMlNWUEUwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAM+Jmzrrty94qySuDx0rP39i9FOo&lt;br/&gt;
L14KiKxqXER3dqBW0OhqqdOAutyvpZ9iqvJKn7LTIOUhDLe3LwwW2ZPv26albJXwzyEYrelFk/5S&lt;br/&gt;
foHbEbyVquYnTYFrp8SY7KLxFRyLIYWnuINCPrRg2bB8vGanpQOok3hSqacC9ylNECkxAgMBAAEw&lt;br/&gt;
DQYJKoZIhvcNAQELBQADgYEAl+YITTSNR0xq2Ca3z5ZRxKDcXC7sL5TikgNyW6gx8kFXQhl7tQHh&lt;br/&gt;
fSq7xBRj8Wia3CXR3/iOzfV92apI2AFjmkx8vTQFUsE6cO4qofneHKc2bdZ7sf8dsnAf6Egss24W&lt;br/&gt;
gUGkrsL4KNmq0Q4e6cI2EJwMs84VGp1pfD9PYZOpTm4=&lt;br/&gt;
&amp;lt;/ds:X509Certificate&amp;gt;&lt;/p&gt;

&lt;p&gt;                        &amp;lt;/ds:X509Data&amp;gt;&lt;/p&gt;

&lt;p&gt;                      &amp;lt;/ds:KeyInfo&amp;gt;&lt;br/&gt;
                      &amp;lt;xenc:CipherData&amp;gt;&lt;br/&gt;
                        &amp;lt;xenc:CipherValue&amp;gt;s5hm8saT/x2OS+hWg9AFp8AFKO0/jdnVslBqp27bPpViUHRPOvy7keQPb52W980NhFX3wHGmilmr&lt;br/&gt;
DAPgd0JIH9H8+4ryV038Uw6zwgL+iMQjoWcYiVXFIYUB2b30yjZLoUVO1B8AghbTfBSo6QMKbUET&lt;br/&gt;
5KC1TLAVOff1dML9KZY=&amp;lt;/xenc:CipherValue&amp;gt;&lt;br/&gt;
                      &amp;lt;/xenc:CipherData&amp;gt;&lt;br/&gt;
                    &amp;lt;/xenc:EncryptedKey&amp;gt;&lt;br/&gt;
                  &amp;lt;/ds:KeyInfo&amp;gt;&lt;br/&gt;
                &amp;lt;/saml2:SubjectConfirmationData&amp;gt;&lt;br/&gt;
              &amp;lt;/saml2:SubjectConfirmation&amp;gt;&lt;br/&gt;
            &amp;lt;/saml2:Subject&amp;gt;&lt;br/&gt;
            &amp;lt;saml2:Conditions NotBefore=&quot;2017-12-04T07:49:48.802Z&quot; NotOnOrAfter=&quot;2017-12-04T07:59:48.802Z&quot;&amp;gt;&lt;br/&gt;
              &amp;lt;saml2:AudienceRestriction&amp;gt;&lt;br/&gt;
                &amp;lt;saml2:Audience&amp;gt;&lt;a href=&quot;https://sapwsi5s.sap.wst:9042/sap/bc/srt/rfc/wsv/ca_saf_ping/010/wsv_ca_saf_ping/insurance&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://sapwsi5s.sap.wst:9042/sap/bc/srt/rfc/wsv/ca_saf_ping/010/wsv_ca_saf_ping/insurance&lt;/a&gt;&amp;lt;/saml2:Audience&amp;gt;&lt;br/&gt;
              &amp;lt;/saml2:AudienceRestriction&amp;gt;&lt;br/&gt;
            &amp;lt;/saml2:Conditions&amp;gt;&lt;br/&gt;
            &amp;lt;saml2:Advice/&amp;gt;&lt;br/&gt;
            &amp;lt;saml2:AuthnStatement AuthnInstant=&quot;2017-12-04T07:49:48.802Z&quot;&amp;gt;&lt;br/&gt;
              &amp;lt;saml2:AuthnContext&amp;gt;&lt;br/&gt;
                &amp;lt;saml2:AuthnContextClassRef&amp;gt;urn:oasis:names:tc:SAML:1.0:am:password&amp;lt;/saml2:AuthnContextClassRef&amp;gt;&lt;br/&gt;
              &amp;lt;/saml2:AuthnContext&amp;gt;&lt;br/&gt;
            &amp;lt;/saml2:AuthnStatement&amp;gt;&lt;br/&gt;
            &amp;lt;saml2:AttributeStatement&amp;gt;&lt;br/&gt;
              &amp;lt;saml2:Attribute AttributeName=&quot;actor&quot; AttributeNamespace=&quot;http://schemas.xmlsoap.com/ws/2009/09/identity/claims&quot; Name=&quot;actor&quot; NameFormat=&quot;http://schemas.xmlsoap.com/ws/2009/09/identity/claims&quot;&amp;gt;&lt;br/&gt;
                &amp;lt;saml2:AttributeValue&amp;gt;&amp;lt;Actor&amp;gt;&amp;lt;saml2:Attribute xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; AttributeName=&quot;name&quot; AttributeNamespace=&quot;http://schemas.xmlsoap.com/ws/2005/05/identity/claims&quot; Name=&quot;name&quot; NameFormat=&quot;http://schemas.xmlsoap.com/ws/2005/05/identity/claims&quot;&amp;gt;&amp;lt;saml2:AttributeValue&amp;gt;CHANGED_FOR_BUGREPORT&amp;lt;/saml2:AttributeValue&amp;gt;&amp;lt;/saml2:Attribute&amp;gt;&amp;lt;/Actor&amp;gt;&amp;lt;/saml2:AttributeValue&amp;gt;&lt;br/&gt;
              &amp;lt;/saml2:Attribute&amp;gt;&lt;br/&gt;
            &amp;lt;/saml2:AttributeStatement&amp;gt;&lt;br/&gt;
          &amp;lt;/saml2:Assertion&amp;gt;&lt;br/&gt;
        &amp;lt;/trust:RequestedSecurityToken&amp;gt;&lt;br/&gt;
        &amp;lt;trust:RequestedAttachedReference&amp;gt;&lt;br/&gt;
          &amp;lt;wsse:SecurityTokenReference ns4:TokenType=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;wsse:KeyIdentifier ValueType=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID&quot;&amp;gt;nstsb73a0e5a-1ec3-451b-89e1-07fb99b755e0&amp;lt;/wsse:KeyIdentifier&amp;gt;&lt;br/&gt;
          &amp;lt;/wsse:SecurityTokenReference&amp;gt;&lt;br/&gt;
        &amp;lt;/trust:RequestedAttachedReference&amp;gt;&lt;br/&gt;
        &amp;lt;trust:RequestedUnattachedReference&amp;gt;&lt;br/&gt;
          &amp;lt;wsse:SecurityTokenReference ns4:TokenType=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;wsse:KeyIdentifier ValueType=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID&quot;&amp;gt;nstsb73a0e5a-1ec3-451b-89e1-07fb99b755e0&amp;lt;/wsse:KeyIdentifier&amp;gt;&lt;br/&gt;
          &amp;lt;/wsse:SecurityTokenReference&amp;gt;&lt;br/&gt;
        &amp;lt;/trust:RequestedUnattachedReference&amp;gt;&lt;br/&gt;
        &amp;lt;wsp:AppliesTo&amp;gt;&lt;br/&gt;
          &amp;lt;wsa:EndpointReference&amp;gt;&lt;br/&gt;
            &amp;lt;wsa:Address&amp;gt;&lt;a href=&quot;https://CHANGED&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://CHANGED&lt;/a&gt; FOR BUGREPORT&amp;lt;/wsa:Address&amp;gt;&lt;br/&gt;
          &amp;lt;/wsa:EndpointReference&amp;gt;&lt;br/&gt;
        &amp;lt;/wsp:AppliesTo&amp;gt;&lt;br/&gt;
        &amp;lt;trust:RequestedProofToken&amp;gt;&lt;br/&gt;
          &amp;lt;trust:ComputedKey&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512/CK/PSHA1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-sx/ws-trust/200512/CK/PSHA1&lt;/a&gt;&amp;lt;/trust:ComputedKey&amp;gt;&lt;br/&gt;
        &amp;lt;/trust:RequestedProofToken&amp;gt;&lt;br/&gt;
        &amp;lt;trust:Entropy&amp;gt;&lt;br/&gt;
          &amp;lt;trust:BinarySecret Type=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512/Nonce&quot;&amp;gt;1Ba5e6QgRN251mMBwLTSoUqwbHrmGGL+VXremIGnwZM=&amp;lt;/trust:BinarySecret&amp;gt;&lt;br/&gt;
        &amp;lt;/trust:Entropy&amp;gt;&lt;br/&gt;
        &amp;lt;trust:Lifetime&amp;gt;&lt;br/&gt;
          &amp;lt;wsu:Created&amp;gt;2017-12-04T07:52:04.948Z&amp;lt;/wsu:Created&amp;gt;&lt;br/&gt;
          &amp;lt;wsu:Expires&amp;gt;2017-12-04T08:02:04.948Z&amp;lt;/wsu:Expires&amp;gt;&lt;br/&gt;
        &amp;lt;/trust:Lifetime&amp;gt;&lt;br/&gt;
        &amp;lt;trust:KeySize&amp;gt;256&amp;lt;/trust:KeySize&amp;gt;&lt;br/&gt;
      &amp;lt;/trust:RequestSecurityTokenResponse&amp;gt;&lt;br/&gt;
    &amp;lt;/trust:RequestSecurityTokenResponseCollection&amp;gt;&lt;br/&gt;
  &amp;lt;/S:Body&amp;gt;&lt;br/&gt;
&amp;lt;/S:Envelope&amp;gt;}}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Apache cxf 3.2.1 + transitive gradle dependencies&lt;/p&gt;

&lt;p&gt;opensaml 3.1.1&lt;/p&gt;

&lt;p&gt;NetIQ IDM for SAML 2.0 and WS-TRUST STS&lt;/p&gt;


&lt;p&gt;Ps: with org.apache.cxf:cxf-bundle:2.7.18&apos; this works, but does older versions of cxf do not support opensaml 3.1.1, which is required.&lt;/p&gt;</environment>
        <key id="13122512">CXF-7578</key>
            <summary>WS-Trust Secured Request casts SecretKeySpec to PrivateKey</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="ATNOLL_L">Lukas Noll</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Dec 2017 08:04:50 +0000</created>
                <updated>Wed, 7 Feb 2018 14:52:01 +0000</updated>
                            <resolved>Mon, 4 Dec 2017 16:47:49 +0000</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>3.2.2</fixVersion>
                    <fixVersion>3.1.15</fixVersion>
                                    <component>Soap Binding</component>
                    <component>STS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16276733" author="coheigea" created="Mon, 4 Dec 2017 12:53:46 +0000"  >&lt;p&gt;What version of CXF are you using? Also what is the security policy of the target service?&lt;/p&gt;</comment>
                            <comment id="16276748" author="atnoll_l" created="Mon, 4 Dec 2017 13:07:21 +0000"  >&lt;p&gt;cxf version 3.2.1&lt;br/&gt;
 ps.:&lt;br/&gt;
     ws-security.enable.streaming is set to True&lt;/p&gt;

&lt;p&gt;Policy from wsdl is:&lt;/p&gt;

&lt;p&gt;{{&amp;lt;wsp:ExactlyOne&amp;gt;&lt;br/&gt;
			&amp;lt;wsp:All&amp;gt;&lt;br/&gt;
				&amp;lt;saptrnbnd:OptimizedMimeSerialization xmlns:saptrnbnd=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy/optimizedmimeserialization&quot; wsp:Optional=&quot;true&quot;/&amp;gt;&lt;br/&gt;
				&amp;lt;wsaw:UsingAddressing xmlns:wsaw=&quot;http://www.w3.org/2006/05/addressing/wsdl&quot; wsp:Optional=&quot;true&quot;/&amp;gt;&lt;br/&gt;
				&amp;lt;wsp:All xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot;&amp;gt;&lt;br/&gt;
					&amp;lt;sp:TransportBinding xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot; xmlns:sapsp=&quot;http://www.sap.com/webas/630/soap/features/security/policy&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:wst=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512&quot; xmlns:wsu=&quot;http://schemas.xmlsoap.org/ws/2002/07/utility&quot; xmlns:wsx=&quot;http://schemas.xmlsoap.org/ws/2004/09/mex&quot;&amp;gt;&lt;br/&gt;
						&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;sp:TransportToken&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:HttpsToken/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:TransportToken&amp;gt;&lt;br/&gt;
							&amp;lt;sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:Basic256/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
							&amp;lt;sp:Layout&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:Strict/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:Layout&amp;gt;&lt;br/&gt;
							&amp;lt;sp:IncludeTimestamp/&amp;gt;&lt;br/&gt;
						&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
					&amp;lt;/sp:TransportBinding&amp;gt;&lt;br/&gt;
					&amp;lt;sp:EndorsingSupportingTokens xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot; xmlns:sapsp=&quot;http://www.sap.com/webas/630/soap/features/security/policy&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:wst=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512&quot; xmlns:wsu=&quot;http://schemas.xmlsoap.org/ws/2002/07/utility&quot; xmlns:wsx=&quot;http://schemas.xmlsoap.org/ws/2004/09/mex&quot;&amp;gt;&lt;br/&gt;
						&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;sp:IssuedToken sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient&quot;&amp;gt;&lt;br/&gt;
								&amp;lt;sp:Issuer&amp;gt;&lt;br/&gt;
									&amp;lt;wsa:Address&amp;gt;&lt;a href=&quot;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts&lt;/a&gt;&amp;lt;/wsa:Address&amp;gt;&lt;br/&gt;
									&amp;lt;wsa:Metadata&amp;gt;&lt;br/&gt;
										&amp;lt;Metadata xmlns=&quot;http://schemas.xmlsoap.org/ws/2004/09/mex&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&amp;gt;&lt;br/&gt;
											&amp;lt;wsx:MetadataSection xmlns=&quot;&quot;&amp;gt;&lt;br/&gt;
												&amp;lt;wsx:MetadataReference&amp;gt;&lt;br/&gt;
													&amp;lt;wsa:Address&amp;gt;&lt;a href=&quot;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts/mex&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts/mex&lt;/a&gt;&amp;lt;/wsa:Address&amp;gt;&lt;br/&gt;
												&amp;lt;/wsx:MetadataReference&amp;gt;&lt;br/&gt;
											&amp;lt;/wsx:MetadataSection&amp;gt;&lt;br/&gt;
										&amp;lt;/Metadata&amp;gt;&lt;br/&gt;
									&amp;lt;/wsa:Metadata&amp;gt;&lt;br/&gt;
								&amp;lt;/sp:Issuer&amp;gt;&lt;br/&gt;
								&amp;lt;sp:RequestSecurityTokenTemplate&amp;gt;&lt;br/&gt;
									&amp;lt;wst:KeyType&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey&lt;/a&gt;&amp;lt;/wst:KeyType&amp;gt;&lt;br/&gt;
									&amp;lt;wst:TokenType&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&lt;/a&gt;&amp;lt;/wst:TokenType&amp;gt;&lt;br/&gt;
								&amp;lt;/sp:RequestSecurityTokenTemplate&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:RequireDerivedKeys/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:IssuedToken&amp;gt;&lt;br/&gt;
						&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
					&amp;lt;/sp:EndorsingSupportingTokens&amp;gt;&lt;br/&gt;
				&amp;lt;/wsp:All&amp;gt;&lt;br/&gt;
			&amp;lt;/wsp:All&amp;gt;&lt;br/&gt;
			&amp;lt;wsp:All&amp;gt;&lt;br/&gt;
				&amp;lt;saptrnbnd:OptimizedXMLTransfer uri=&quot;http://xml.sap.com/2006/11/esi/esp/binxml&quot; xmlns:saptrnbnd=&quot;http://www.sap.com/webas/710/soap/features/transportbinding/&quot; wsp:Optional=&quot;true&quot;/&amp;gt;&lt;br/&gt;
				&amp;lt;wsaw:UsingAddressing xmlns:wsaw=&quot;http://www.w3.org/2006/05/addressing/wsdl&quot; wsp:Optional=&quot;true&quot;/&amp;gt;&lt;br/&gt;
				&amp;lt;wsp:All xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot;&amp;gt;&lt;br/&gt;
					&amp;lt;sp:TransportBinding xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot; xmlns:sapsp=&quot;http://www.sap.com/webas/630/soap/features/security/policy&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:wst=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512&quot; xmlns:wsu=&quot;http://schemas.xmlsoap.org/ws/2002/07/utility&quot; xmlns:wsx=&quot;http://schemas.xmlsoap.org/ws/2004/09/mex&quot;&amp;gt;&lt;br/&gt;
						&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;sp:TransportToken&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:HttpsToken/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:TransportToken&amp;gt;&lt;br/&gt;
							&amp;lt;sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:Basic256/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
							&amp;lt;sp:Layout&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:Strict/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:Layout&amp;gt;&lt;br/&gt;
							&amp;lt;sp:IncludeTimestamp/&amp;gt;&lt;br/&gt;
						&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
					&amp;lt;/sp:TransportBinding&amp;gt;&lt;br/&gt;
					&amp;lt;sp:EndorsingSupportingTokens xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot; xmlns:sapsp=&quot;http://www.sap.com/webas/630/soap/features/security/policy&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:wst=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512&quot; xmlns:wsu=&quot;http://schemas.xmlsoap.org/ws/2002/07/utility&quot; xmlns:wsx=&quot;http://schemas.xmlsoap.org/ws/2004/09/mex&quot;&amp;gt;&lt;br/&gt;
						&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;sp:IssuedToken sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient&quot;&amp;gt;&lt;br/&gt;
								&amp;lt;sp:Issuer&amp;gt;&lt;br/&gt;
									&amp;lt;wsa:Address&amp;gt;&lt;a href=&quot;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts&lt;/a&gt;&amp;lt;/wsa:Address&amp;gt;&lt;br/&gt;
									&amp;lt;wsa:Metadata&amp;gt;&lt;br/&gt;
										&amp;lt;Metadata xmlns=&quot;http://schemas.xmlsoap.org/ws/2004/09/mex&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&amp;gt;&lt;br/&gt;
											&amp;lt;wsx:MetadataSection xmlns=&quot;&quot;&amp;gt;&lt;br/&gt;
												&amp;lt;wsx:MetadataReference&amp;gt;&lt;br/&gt;
													&amp;lt;wsa:Address&amp;gt;&lt;a href=&quot;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts/mex&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s-apl-vm-001.corpnet.at/nidp/wstrust/sts/mex&lt;/a&gt;&amp;lt;/wsa:Address&amp;gt;&lt;br/&gt;
												&amp;lt;/wsx:MetadataReference&amp;gt;&lt;br/&gt;
											&amp;lt;/wsx:MetadataSection&amp;gt;&lt;br/&gt;
										&amp;lt;/Metadata&amp;gt;&lt;br/&gt;
									&amp;lt;/wsa:Metadata&amp;gt;&lt;br/&gt;
								&amp;lt;/sp:Issuer&amp;gt;&lt;br/&gt;
								&amp;lt;sp:RequestSecurityTokenTemplate&amp;gt;&lt;br/&gt;
									&amp;lt;wst:KeyType&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey&lt;/a&gt;&amp;lt;/wst:KeyType&amp;gt;&lt;br/&gt;
									&amp;lt;wst:TokenType&amp;gt;&lt;a href=&quot;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0&lt;/a&gt;&amp;lt;/wst:TokenType&amp;gt;&lt;br/&gt;
								&amp;lt;/sp:RequestSecurityTokenTemplate&amp;gt;&lt;br/&gt;
								&amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
									&amp;lt;sp:RequireDerivedKeys/&amp;gt;&lt;br/&gt;
								&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
							&amp;lt;/sp:IssuedToken&amp;gt;&lt;br/&gt;
						&amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
					&amp;lt;/sp:EndorsingSupportingTokens&amp;gt;&lt;br/&gt;
				&amp;lt;/wsp:All&amp;gt;&lt;br/&gt;
			&amp;lt;/wsp:All&amp;gt;&lt;br/&gt;
		&amp;lt;/wsp:ExactlyOne&amp;gt;}}&lt;/p&gt;</comment>
                            <comment id="16276753" author="coheigea" created="Mon, 4 Dec 2017 13:10:47 +0000"  >&lt;p&gt;Can you check the version of XML Security (Santuario)? According to the stacktrace above, the error is on line 141 of AbstractSignatureEndingOutputProcessor. However, that is a simple if statement in the version of Santuario that is shipped with CXF 3.2.1:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/santuario-java/blob/74ebb633b441487707ec27ed60ab33803869c3f9/src/main/java/org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor.java#L141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/santuario-java/blob/74ebb633b441487707ec27ed60ab33803869c3f9/src/main/java/org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor.java#L141&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16276868" author="atnoll_l" created="Mon, 4 Dec 2017 14:43:01 +0000"  >&lt;p&gt;I substituted santuario with version 2.1.0, the error however was the same with the shipped version.&lt;/p&gt;

&lt;p&gt;Rot cause Seems to bei that the WSPolicy &amp;lt;somwthing&amp;gt;staxOutputInterceptor assumes sha1withrsa as default signaturealgorithm While the underlying keymaterial(message security) provides a secret, the Policy also explicitly demands a symetric key.&lt;/p&gt;</comment>
                            <comment id="16277059" author="coheigea" created="Mon, 4 Dec 2017 16:47:41 +0000"  >&lt;p&gt;OK I have fixed this. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 50 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nhlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>