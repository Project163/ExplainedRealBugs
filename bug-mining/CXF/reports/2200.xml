<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:09:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5675] java.lang.ClassCastException: java.net.URI cannot be cast to java.lang.String when adding Location to Response</title>
                <link>https://issues.apache.org/jira/browse/CXF-5675</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Exception:&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: java.net.URI cannot be cast to java.lang.String&lt;/p&gt;


&lt;p&gt;Test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; Response response = getWebClient()
                .path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/blob&quot;&lt;/span&gt;)
                .type(MediaType.MULTIPART_FORM_DATA)
                .post(multipartBody);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;serverside resource:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        URI blobId = UriBuilder.fromResource(getClass()).build(gridFSDBFile.getId());
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Response.created(blobId).build();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;because inside WebClient handleResponse -&amp;gt; AbstractClient the values are assumed to be string arrays, but is an URI object:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; splitHeaders = 
            MessageUtils.isTrue(outMessage.getContextualProperty(HEADER_SPLIT_PROPERTY));
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; entry : protocolHeaders.entrySet()) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == entry.getKey()) {
                &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.getValue().size() &amp;gt; 0) {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (HttpUtils.isDateRelatedHeader(entry.getKey())) {
                    currentResponseBuilder.header(entry.getKey(), entry.getValue().get(0));
                    &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;                    
                }
                &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; val : entry.getValue()) {
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (splitHeaders) {
                        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] values;
                        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || val.length() == 0) {

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12706837">CXF-5675</key>
            <summary>java.lang.ClassCastException: java.net.URI cannot be cast to java.lang.String when adding Location to Response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="davidkarlsen@gmail.com">David J. M. Karlsen</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Apr 2014 10:25:19 +0000</created>
                <updated>Fri, 11 Jul 2014 12:50:55 +0000</updated>
                            <resolved>Fri, 11 Apr 2014 16:19:02 +0000</resolved>
                                    <version>3.0.0-milestone2</version>
                                    <fixVersion>3.0</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13962388" author="sergey_beryozkin" created="Mon, 7 Apr 2014 23:33:30 +0000"  >&lt;p&gt;Hi, I wonder how the client runtime ends up seeing a headers Map where the values may not be Strings, just curious.  &lt;br/&gt;
Do you use AsyncConduit, may be HttpClient translates Location values to URI ?&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="13962389" author="sergey_beryozkin" created="Mon, 7 Apr 2014 23:36:07 +0000"  >&lt;p&gt;Actually, never mind, may be ResponseBuilder gets confused on the client side&lt;/p&gt;</comment>
                            <comment id="13962393" author="sergey_beryozkin" created="Mon, 7 Apr 2014 23:40:31 +0000"  >&lt;p&gt;Can you paste a stacktrace please ? I have a test checking Location.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13963348" author="davidkarlsen@gmail.com" created="Tue, 8 Apr 2014 19:49:45 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
javax.ws.rs.ProcessingException: java.lang.ClassCastException: java.net.URI cannot be cast to java.lang.String
	at org.apache.cxf.jaxrs.client.WebClient.handleResponse(WebClient.java:1174)
	at org.apache.cxf.jaxrs.client.WebClient.doResponse(WebClient.java:1138)
	at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1075)
	at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:869)
	at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:840)
	at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:307)
	at org.apache.cxf.jaxrs.client.WebClient.post(WebClient.java:316)
	at com.davidkarlsen.traxidx.srv.service.blob.BlobServiceTest.postFile(BlobServiceTest.java:61)
	at com.davidkarlsen.traxidx.srv.service.blob.BlobServiceTest.assertInitialAddBlobIs201(BlobServiceTest.java:39)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:232)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:175)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:160)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:67)
Caused by: java.lang.ClassCastException: java.net.URI cannot be cast to java.lang.String
	at org.apache.cxf.jaxrs.client.AbstractClient.setResponseBuilder(AbstractClient.java:389)
	at org.apache.cxf.jaxrs.client.WebClient.handleResponse(WebClient.java:1151)
	... 36 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I should add that I&#180;m runnning localtransport&lt;/p&gt;</comment>
                            <comment id="13963499" author="sergey_beryozkin" created="Tue, 8 Apr 2014 21:56:53 +0000"  >&lt;p&gt;Right, thanks, it is local transport, which explains how URI has appeared in the client stack...&lt;/p&gt;</comment>
                            <comment id="13966705" author="sergey_beryozkin" created="Fri, 11 Apr 2014 16:19:02 +0000"  >&lt;p&gt;Fixing for 3.0.0 only giving the sensitivity of the changes in 2.7.x and the fact it affects a test path with Local transport only&lt;/p&gt;</comment>
                            <comment id="13966714" author="davidkarlsen@gmail.com" created="Fri, 11 Apr 2014 16:23:21 +0000"  >&lt;p&gt;gr8!&lt;br/&gt;
Do you plan a milestone3 or a RC soon?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>385160</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ucq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>385427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>