<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:44:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-3037] Policy references embedded in policy are not processed</title>
                <link>https://issues.apache.org/jira/browse/CXF-3037</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;WS-Policy allows &amp;lt;wsp:PolicyReference&amp;gt; to be embedded within policy documents, but CXF does not handle these references. Here&apos;s an example:&lt;/p&gt;


&lt;p&gt;  &amp;lt;!-- Policy for symmetric binding, using an ephemeral key generated by the client and&lt;br/&gt;
   sent to the server as part of the request, using asymmetric encryption with the server&lt;br/&gt;
   public key to secure the symmetric key. --&amp;gt;&lt;br/&gt;
  &amp;lt;wsp:Policy wsu:Id=&quot;SymmBinding&quot;&lt;br/&gt;
      xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot;&lt;br/&gt;
      xmlns:wsaw=&quot;http://www.w3.org/2006/05/addressing/wsdl&quot;&lt;br/&gt;
      xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;sp:SymmetricBinding&amp;gt;&lt;br/&gt;
      &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;sp:ProtectionToken&amp;gt;&lt;br/&gt;
          &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
            &amp;lt;sp:X509Token sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never&quot;&amp;gt;&lt;br/&gt;
              &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
                &amp;lt;sp:RequireDerivedKeys/&amp;gt;&lt;br/&gt;
                &amp;lt;sp:RequireThumbprintReference/&amp;gt;&lt;br/&gt;
                &amp;lt;sp:WssX509V3Token10/&amp;gt;&lt;br/&gt;
              &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
            &amp;lt;/sp:X509Token&amp;gt;&lt;br/&gt;
          &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;/sp:ProtectionToken&amp;gt;&lt;br/&gt;
        &amp;lt;sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
          &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
            &amp;lt;sp:Basic128Rsa15/&amp;gt;&lt;br/&gt;
          &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;/sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
        &amp;lt;sp:OnlySignEntireHeadersAndBody/&amp;gt;&lt;br/&gt;
      &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
    &amp;lt;/sp:SymmetricBinding&amp;gt;&lt;br/&gt;
  &amp;lt;/wsp:Policy&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Policy for symmetric binding, using an ephemeral key generated by the client and&lt;br/&gt;
   sent to the server as part of the request, using asymmetric encryption with the server&lt;br/&gt;
   public key to secure the symmetric key. --&amp;gt;&lt;br/&gt;
  &amp;lt;wsp:Policy wsu:Id=&quot;SymmEncr&quot;&lt;br/&gt;
      xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot;&lt;br/&gt;
      xmlns:wsaw=&quot;http://www.w3.org/2006/05/addressing/wsdl&quot;&lt;br/&gt;
      xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;wsp:PolicyReference xmlns:wsp=&quot;http://www.w3.org/ns/ws-policy&quot; URI=&quot;#SymmBinding&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;sp:Wss11&amp;gt;&lt;br/&gt;
      &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;sp:MustSupportRefKeyIdentifier/&amp;gt;&lt;br/&gt;
        &amp;lt;sp:MustSupportRefThumbprint/&amp;gt;&lt;br/&gt;
        &amp;lt;sp:MustSupportRefEncryptedKey/&amp;gt;&lt;br/&gt;
      &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
    &amp;lt;/sp:Wss11&amp;gt;&lt;br/&gt;
  &amp;lt;/wsp:Policy&amp;gt;&lt;/p&gt;

&lt;p&gt;When trying to use this policy on the client it causes an NPE inside Neethi:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; WARNING: Interceptor for &lt;/p&gt;
{http://ws.sosnoski.com/library/wsdl}
&lt;p&gt;CXFLibrary#&lt;/p&gt;
{http://ws.sosnoski.com/library/wsdl}
&lt;p&gt;getBook has thrown exception, unwinding now&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; java.lang.NullPointerException&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.AbstractPolicyOperator.normalizeOperator(AbstractPolicyOperator.java:116)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.AbstractPolicyOperator.normalize(AbstractPolicyOperator.java:73)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.Policy.normalize(Policy.java:64)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.Policy.normalize(Policy.java:49)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.cxf.ws.policy.EffectivePolicyImpl.initialisePolicy(EffectivePolicyImpl.java:134)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.cxf.ws.policy.EffectivePolicyImpl.initialise(EffectivePolicyImpl.java:86)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.cxf.ws.policy.PolicyEngineImpl.getEffectiveClientRequestPolicy(PolicyEngineImpl.java:155)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.cxf.ws.policy.PolicyOutInterceptor.handle(PolicyOutInterceptor.java:110)&lt;/p&gt;

&lt;p&gt;The problem here is that CXF passes a null for the policy context when calling the Policy.normalize() method. Just passing the context should be enough to make this work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12475845">CXF-3037</key>
            <summary>Policy references embedded in policy are not processed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="dsosnoski">Dennis M. Sosnoski</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Oct 2010 10:15:57 +0000</created>
                <updated>Fri, 21 Jan 2011 18:14:24 +0000</updated>
                            <resolved>Wed, 5 Jan 2011 17:50:31 +0000</resolved>
                                    <version>2.2.10</version>
                                    <fixVersion>2.3.2</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12918651" author="dkulp" created="Wed, 6 Oct 2010 20:07:29 +0000"  >&lt;p&gt;&lt;br/&gt;
I went ahead and passed the registry into the normalize calls in the areas where I have access to the registry.  Hopefully that will fix it.&lt;/p&gt;</comment>
                            <comment id="12919471" author="dsosnoski" created="Sat, 9 Oct 2010 08:09:02 +0000"  >&lt;p&gt;Did you also include these changes in the 2.3.0 code? I&apos;ve tried this, using the 2.3.0 distribution build (not yet released), and still have the same NPE (though in a different place, which may be because I&apos;m using a different policy sample:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.AbstractPolicyOperator.normalizeOperator(AbstractPolicyOperator.java:116)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.AbstractPolicyOperator.normalize(AbstractPolicyOperator.java:73)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.Policy.normalize(Policy.java:64)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.neethi.Policy.normalize(Policy.java:49)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.cxf.ws.security.policy.builders.AsymmetricBindingBuilder.build(AsymmetricBindingBuilder.java:66)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Here are the relevant portions of this policy:&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Initiator token policy. --&amp;gt;&lt;br/&gt;
  &amp;lt;wsp:Policy wsu:Id=&quot;InitiatorToken&quot; xmlns:wsu=&lt;br/&gt;
      &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;&lt;br/&gt;
      xmlns:wsp=&quot;http://www.w3.org/ns/ws-policy&quot;&lt;br/&gt;
      xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;sp:InitiatorToken&amp;gt;&lt;br/&gt;
      &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;sp:X509Token sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient&quot;&amp;gt;&lt;br/&gt;
          &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
            &amp;lt;sp:RequireThumbprintReference/&amp;gt;&lt;br/&gt;
          &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;/sp:X509Token&amp;gt;&lt;br/&gt;
      &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
    &amp;lt;/sp:InitiatorToken&amp;gt;&lt;br/&gt;
  &amp;lt;/wsp:Policy&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Recipient token policy. --&amp;gt;&lt;br/&gt;
  &amp;lt;wsp:Policy wsu:Id=&quot;RecipientToken&quot; xmlns:wsu=&lt;br/&gt;
      &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;&lt;br/&gt;
      xmlns:wsp=&quot;http://www.w3.org/ns/ws-policy&quot;&lt;br/&gt;
      xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;sp:RecipientToken&amp;gt;&lt;br/&gt;
      &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;sp:X509Token sp:IncludeToken=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never&quot;&amp;gt;&lt;br/&gt;
          &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
            &amp;lt;sp:RequireThumbprintReference/&amp;gt;&lt;br/&gt;
          &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;/sp:X509Token&amp;gt;&lt;br/&gt;
      &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
    &amp;lt;/sp:RecipientToken&amp;gt;&lt;br/&gt;
  &amp;lt;/wsp:Policy&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Policy for asymmetric binding with the certificate included in the message from&lt;br/&gt;
   client to server but only a thumbprint on messages from the server to the client. --&amp;gt;&lt;br/&gt;
  &amp;lt;wsp:Policy wsu:Id=&quot;AsymmBinding&quot; xmlns:wsu=&lt;br/&gt;
      &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;&lt;br/&gt;
      xmlns:wsp=&quot;http://www.w3.org/ns/ws-policy&quot;&lt;br/&gt;
      xmlns:sp=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;sp:AsymmetricBinding&amp;gt;&lt;br/&gt;
      &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;wsp:PolicyReference URI=&quot;#InitiatorToken&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;wsp:PolicyReference URI=&quot;#RecipientToken&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
          &amp;lt;wsp:Policy&amp;gt;&lt;br/&gt;
            &amp;lt;sp:Basic128Rsa15/&amp;gt;&lt;br/&gt;
          &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
        &amp;lt;/sp:AlgorithmSuite&amp;gt;&lt;br/&gt;
      &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
    &amp;lt;/sp:AsymmetricBinding&amp;gt;&lt;br/&gt;
  &amp;lt;/wsp:Policy&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12919618" author="dkulp" created="Sun, 10 Oct 2010 16:46:07 +0000"  >
&lt;p&gt;I was semi-afraid of that.    &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;In the builders, right now, I didn&apos;t have access to the registry or Bus or anything that would allow easy access to the registry.  Thus, since I was trying to get 2.3 out and the initial bug report didn&apos;t show any issue there, I left them alone.     I just fixed the issues in the calculation of the effective policies and such which was the stack trace from the initial report.&lt;/p&gt;

&lt;p&gt;I&apos;ll re-open the issue.  It&apos;s definitely a bit more complex as I&apos;ll need to pass the registry into the builders and such.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47164</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 7 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i13yn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231242</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>