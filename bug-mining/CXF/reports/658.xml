<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:42:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2954] Occur ConcurrentModificationException when creating mutiple WebService client in mutiple thread</title>
                <link>https://issues.apache.org/jira/browse/CXF-2954</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The cxf application will throw ConcurrentModificationException when creating mutiple WebService client in mutiple thread in the same time.  &lt;/p&gt;

&lt;p&gt;Here is to create WebService client source code:&lt;/p&gt;

&lt;p&gt;           JaxWsProxyFactoryBean factory = new JaxWsProxyFactoryBean();&lt;br/&gt;
            factory.setServiceClass(SystemPortType.class);&lt;br/&gt;
            factory.setAddress(wsdlPort);&lt;br/&gt;
            SystemPortType isspt = (SystemPortType) factory.create();&lt;br/&gt;
            ((BindingProvider) isspt).getRequestContext().put(BindingProvider.SESSION_MAINTAIN_PROPERTY, true);&lt;/p&gt;

&lt;p&gt;Here is the ConcurrentModificationException stack track, notice only to create mutiple WebService client in the same time will throw this exception:&lt;/p&gt;

&lt;p&gt;Caused by: java.util.ConcurrentModificationException&lt;br/&gt;
	at java.util.AbstractList$Itr.checkForComodification(Unknown Source)&lt;br/&gt;
	at java.util.AbstractList$Itr.remove(Unknown Source)&lt;br/&gt;
	at org.apache.cxf.bus.extension.ExtensionManagerImpl.activateAllByType(ExtensionManagerImpl.java:115)&lt;br/&gt;
	at org.apache.cxf.bus.extension.DeferredMap.undefer(DeferredMap.java:36)&lt;br/&gt;
	at org.apache.cxf.transport.DestinationFactoryManagerImpl.getDestinationFactoryForUri(DestinationFactoryManagerImpl.java:140)&lt;br/&gt;
	at org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory.createEndpointInfo(AbstractWSDLBasedEndpointFactory.java:239)&lt;br/&gt;
	at org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory.createEndpoint(AbstractWSDLBasedEndpointFactory.java:145)&lt;br/&gt;
	at org.apache.cxf.frontend.ClientFactoryBean.create(ClientFactoryBean.java:51)&lt;br/&gt;
	at org.apache.cxf.frontend.ClientProxyFactoryBean.create(ClientProxyFactoryBean.java:102)&lt;br/&gt;
	at org.apache.cxf.jaxws.JaxWsProxyFactoryBean.create(JaxWsProxyFactoryBean.java:121)&lt;/p&gt;

&lt;p&gt;I did some research and found this couses that different thread try to operate the map in class ExtensionManagerImpl, the map was defined &lt;br/&gt;
by ConcurrentHashMap&amp;lt;String, ArrayList&amp;lt;Extension&amp;gt;&amp;gt; deferred,  although ConcurrentHashMap is Multithread-Safe but ArrayList is not, Here is a piece of cxf code will trigger the exception,  &lt;/p&gt;

&lt;p&gt;    public  &amp;lt;T&amp;gt; void activateAllByType(Class&amp;lt;T&amp;gt; type) {&lt;br/&gt;
        for (Map.Entry&amp;lt;String, Collection&amp;lt;Extension&amp;gt;&amp;gt; e : deferred.entrySet()) {&lt;br/&gt;
            Iterator&amp;lt;Extension&amp;gt; it = e.getValue().iterator();&lt;br/&gt;
            while (it.hasNext()) {&lt;br/&gt;
                Extension ex = it.next();&lt;br/&gt;
                if (type.isAssignableFrom(ex.getClassObject(loader))) &lt;/p&gt;
{
                    loadAndRegister(ex);
                    it.remove();
                }
&lt;p&gt;            }&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;br/&gt;
why you didn&apos;t declare this method as synchronized? I found some else methods both declare as synchronized such as activateAll(), activateViaNS(). so I tried to did some changes which declare activateAllByType() as synchronized everything work fine. &lt;/p&gt;

&lt;p&gt;This maybe your bug I hope you fix it asap, This is very important for our current project. really thank you&lt;/p&gt;</description>
                <environment>&lt;p&gt;CXF2.2.10, JDK1.5, Tomcat 5.5&lt;/p&gt;</environment>
        <key id="12472191">CXF-2954</key>
            <summary>Occur ConcurrentModificationException when creating mutiple WebService client in mutiple thread</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="jammy.chen">Jammy chen</reporter>
                        <labels>
                    </labels>
                <created>Sun, 22 Aug 2010 16:39:49 +0000</created>
                <updated>Thu, 26 Aug 2010 16:45:01 +0000</updated>
                            <resolved>Mon, 23 Aug 2010 20:41:20 +0000</resolved>
                                    <version>2.2.10</version>
                                    <fixVersion>2.2.11</fixVersion>
                                    <component>Bus</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12902924" author="jammy.chen" created="Thu, 26 Aug 2010 16:45:01 +0000"  >&lt;p&gt;Daniel, thank you did so good work!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47244</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178970</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>