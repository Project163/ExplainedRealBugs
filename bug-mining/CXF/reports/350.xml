<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:38:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2380] Cannot use custom client TLS settings when creating javax.xml.ws.Service from &quot;https://...?wsdl&quot; URL when WSDL contains https imports</title>
                <link>https://issues.apache.org/jira/browse/CXF-2380</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;(See enclosed test case, based on WSDL-first HTTPS sample)&lt;/p&gt;

&lt;p&gt;I have a CXF client and server.  The server listens on https and publishes its WSDL at &quot;https://...?wsdl&quot;.&lt;/p&gt;

&lt;p&gt;The scenario is also such that the WSDL published at this address has a wsdl:import, also with an https:// address, as in:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;UTF-8&apos;?&amp;gt;&amp;lt;wsdl:definitions ...&amp;gt;&lt;br/&gt;
  &amp;lt;wsdl:import location=&quot;https://localhost:9001/demo/secure?wsdl=Greeter.wsdl&quot; namespace=&quot;http://apache.org/hello_world_soap_http&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;/wsdl:import&amp;gt;&lt;br/&gt;
  ...&lt;br/&gt;
&amp;lt;/wsdl:definitions&amp;gt;&lt;/p&gt;



&lt;p&gt;The client is designed so that:&lt;/p&gt;

&lt;p&gt;1. It bootstraps the client proxy using the live &quot;https://...?wsdl&quot; URL at the service endpoint&lt;br/&gt;
2. The bus is programatically configured to use a custom resource resolver (see client source code in enclosed test case), so that custom key material (trusted certificates, in this case) is used when resolving the resource.  I.e., we are NOT relying on the JVM&apos;s trust-store to establish trust with the server (or so is our desire).&lt;/p&gt;


&lt;p&gt;The client will fail to download all of the WSDL during the call to Service.create.  The stacktrace is:&lt;/p&gt;

&lt;p&gt;javax.xml.ws.WebServiceException: org.apache.cxf.service.factory.ServiceConstructionException: Failed to create service.&lt;br/&gt;
	at org.apache.cxf.jaxws.ServiceImpl.&amp;lt;init&amp;gt;(ServiceImpl.java:149)&lt;br/&gt;
	at org.apache.cxf.jaxws.spi.ProviderImpl.createServiceDelegate(ProviderImpl.java:65)&lt;br/&gt;
	at javax.xml.ws.Service.&amp;lt;init&amp;gt;(Service.java:36)&lt;br/&gt;
	at javax.xml.ws.Service.create(Service.java:116)&lt;br/&gt;
	at demo.hw_https.client.Client.call(Client.java:84)&lt;br/&gt;
	at demo.hw_https.client.Client.main(Client.java:76)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:592)&lt;br/&gt;
	at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:283)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:613)&lt;br/&gt;
Caused by: org.apache.cxf.service.factory.ServiceConstructionException: Failed to create service.&lt;br/&gt;
	at org.apache.cxf.wsdl11.WSDLServiceFactory.&amp;lt;init&amp;gt;(WSDLServiceFactory.java:93)&lt;br/&gt;
	at org.apache.cxf.jaxws.ServiceImpl.initializePorts(ServiceImpl.java:204)&lt;br/&gt;
	at org.apache.cxf.jaxws.ServiceImpl.&amp;lt;init&amp;gt;(ServiceImpl.java:147)&lt;br/&gt;
	... 11 more&lt;br/&gt;
Caused by: javax.wsdl.WSDLException: WSDLException (at /wsdl:definitions/wsdl:import): faultCode=PARSER_ERROR: Problem parsing &apos;https://localhost:9001/demo/secure?wsdl=Greeter.wsdl&apos;.: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.getDocument(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.parseImport(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.parseDefinitions(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)&lt;br/&gt;
	at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)&lt;br/&gt;
	at org.apache.cxf.wsdl11.WSDLManagerImpl.loadDefinition(WSDLManagerImpl.java:210)&lt;br/&gt;
	at org.apache.cxf.wsdl11.WSDLManagerImpl.getDefinition(WSDLManagerImpl.java:175)&lt;br/&gt;
	at org.apache.cxf.wsdl11.WSDLServiceFactory.&amp;lt;init&amp;gt;(WSDLServiceFactory.java:91)&lt;br/&gt;
	... 13 more&lt;br/&gt;
Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Alerts.java:150)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1584)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:174)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:168)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:848)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:106)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.Handshaker.processLoop(Handshaker.java:495)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.Handshaker.process_record(Handshaker.java:433)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:877)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1089)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1116)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1100)&lt;br/&gt;
	at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:402)&lt;br/&gt;
	at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:166)&lt;br/&gt;
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:960)&lt;br/&gt;
	at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:234)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:973)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLVersionDetector.determineDocVersion(XMLVersionDetector.java:184)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:798)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:148)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:250)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:292)&lt;br/&gt;
	... 24 more&lt;br/&gt;
Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&lt;br/&gt;
	at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:221)&lt;br/&gt;
	at sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:145)&lt;br/&gt;
	at sun.security.validator.Validator.validate(Validator.java:203)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:172)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.JsseX509TrustManager.checkServerTrusted(SSLContextImpl.java:320)&lt;br/&gt;
	at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:841)&lt;br/&gt;
	... 42 more&lt;br/&gt;
Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&lt;br/&gt;
	at sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:236)&lt;br/&gt;
	at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:194)&lt;br/&gt;
	at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:216)&lt;br/&gt;
	... 47 more&lt;/p&gt;


&lt;p&gt;Discussion:&lt;/p&gt;

&lt;p&gt;I believe what is happening here is that the com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL operation is not respecting the resource resolver that&apos;s been configured in CXF, when loading imported WSDLs, but that&apos;s just a guess.  The reason I suspect this is that I have inserted printlns/breakpoints in the custom resource resolver, and we appear never to be calling resolve for the imported WSDL.&lt;/p&gt;


&lt;p&gt;Test Case:&lt;/p&gt;

&lt;p&gt;I&apos;m submitting a test-case based on the wsdl-first https sample.&lt;/p&gt;

&lt;p&gt;To reproduce, use maven as per the usual instructions:&lt;/p&gt;

&lt;p&gt;mvn -Pserver&lt;br/&gt;
mvn -Pclient&lt;/p&gt;

&lt;p&gt;Note that the client has been modified extensively in this sample.  It will first make a plain http call to the service, to ensure that the server is at least running and nominally configured correctly.  It will then attempt to connect over https, bootstrapping with the WSDL at the HTTPS service URL.  It also has some code for adding a custom resource resolver, which is needed to set the TLS parameters on the client connection to the &quot;https://...?wsdl&quot; URL.  (CXF is calling toString() the URL that&apos;s passed in to the Service.create operation, so that URL cannot carry the URLStreamHandler used to connect to the HTTPs URL.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12432184">CXF-2380</key>
            <summary>Cannot use custom client TLS settings when creating javax.xml.ws.Service from &quot;https://...?wsdl&quot; URL when WSDL contains https imports</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="fdushin">Fred Dushin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Aug 2009 18:21:51 +0000</created>
                <updated>Mon, 12 Oct 2009 20:44:59 +0000</updated>
                            <resolved>Wed, 5 Aug 2009 19:47:19 +0000</resolved>
                                    <version>2.2.3</version>
                                    <fixVersion>2.1.7</fixVersion>
                    <fixVersion>2.2.4</fixVersion>
                                    <component>JAX-WS Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12739078" author="fdushin" created="Tue, 4 Aug 2009 18:24:36 +0000"  >&lt;p&gt;Test case for &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-2380&quot; title=&quot;Cannot use custom client TLS settings when creating javax.xml.ws.Service from &amp;quot;https://...?wsdl&amp;quot; URL when WSDL contains https imports&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-2380&quot;&gt;&lt;del&gt;CXF-2380&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Instructions:&lt;/p&gt;

&lt;p&gt;1. Unpack, cd in &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-2380&quot; title=&quot;Cannot use custom client TLS settings when creating javax.xml.ws.Service from &amp;quot;https://...?wsdl&amp;quot; URL when WSDL contains https imports&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-2380&quot;&gt;&lt;del&gt;CXF-2380&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
2. mvn -Pserver &amp;amp;&lt;br/&gt;
3. mvn -Pclient&lt;/p&gt;
</comment>
                            <comment id="12739638" author="dkulp" created="Wed, 5 Aug 2009 17:40:27 +0000"  >
&lt;p&gt;Fred,&lt;/p&gt;

&lt;p&gt;I can reproduce it here and am testing a fix.  &lt;/p&gt;

&lt;p&gt;That said, you can probably work around it by changing your config.   If you change:&lt;/p&gt;

&lt;p&gt;&amp;lt;http:conduit name=&quot;&lt;/p&gt;
{http://apache.org/demos}
&lt;p&gt;SecureGreeterPort.http-conduit&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;to:&lt;/p&gt;

&lt;p&gt;&amp;lt;http:conduit name=&quot;https://localhost:9000/demo/secure.*&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;It will probably work.   With recent versions of CXF, we allow the conduits to be configured via URL wildcards and also have the wsdl loading and such use the conduits for https if possible.&lt;/p&gt;

</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12433944">CXF-2403</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12415507" name="CXF-2380.tar.gz" size="8503" author="fdushin" created="Tue, 4 Aug 2009 18:24:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10063"><![CDATA[Advanced]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>113806</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0cv1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72972</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>