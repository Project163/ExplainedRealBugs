<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:29:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6454] Orphaned JMS connections created in endless loop</title>
                <link>https://issues.apache.org/jira/browse/CXF-6454</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;Problemdescription&quot;&gt;&lt;/a&gt;Problem description&lt;/h3&gt;
&lt;p&gt;In JMSFactory.createConnection(JMSConfiguration):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Connection createConnection(JMSConfiguration jmsConfig) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; JMSException {
	&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; username = jmsConfig.getUserName();
	ConnectionFactory cf = jmsConfig.getConnectionFactory();
	Connection connection = username != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; 
		? cf.createConnection(username, jmsConfig.getPassword())
		: cf.createConnection();
	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (jmsConfig.getDurableSubscriptionClientId() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
		connection.setClientID(jmsConfig.getDurableSubscriptionClientId());
	}
	&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; connection;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;there is no exception handling if the clientID fails to be set. Such an exception would exit this method without passing the reference to the just-opened JMS connection to exception handling code (JMSDestination.createTargetDestinationListener()).&lt;/p&gt;

&lt;p&gt;Moreover, JMSDestination.restartConnection() keeps on starting new connections (there is no max attempt restriction!) until it creates one without an exception thrown in the process.&lt;/p&gt;

&lt;p&gt;Now, if the clientID is already connected to the ESB, this creation of new connection will last until server resources are no longer available to the JVM.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Possiblesolution&quot;&gt;&lt;/a&gt;Possible solution&lt;/h3&gt;
&lt;ol&gt;
	&lt;li&gt;Close the connection if it&apos;s not possible to set the specified clientID at the time:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Connection createConnection(JMSConfiguration jmsConfig) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; JMSException {
	&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; username = jmsConfig.getUserName();
	ConnectionFactory cf = jmsConfig.getConnectionFactory();
	Connection connection = username != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; 
			? cf.createConnection(username, jmsConfig.getPassword()) 
			: cf.createConnection();
	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (jmsConfig.getDurableSubscriptionClientId() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
		&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {					connection.setClientID(jmsConfig.getDurableSubscriptionClientId());
		} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InvalidClientIDException e) {
			connection.close();
			&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; e;
		}
	}
	&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; connection;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Add a setting to restrict the maximum attempts to restart the connection in JMSDestination.restartConnection() A configurable value would be best, but even a hardcoded.. anything but the practically endless loop &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="12836806">CXF-6454</key>
            <summary>Orphaned JMS connections created in endless loop</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cschneider">Christian Schneider</assignee>
                                    <reporter username="wszostak">Waldemar Szostak</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Jun 2015 11:35:32 +0000</created>
                <updated>Fri, 27 Oct 2017 08:31:37 +0000</updated>
                            <resolved>Wed, 15 Mar 2017 14:31:10 +0000</resolved>
                                    <version>3.0.5</version>
                                    <fixVersion>3.1.14</fixVersion>
                    <fixVersion>3.2.1</fixVersion>
                                    <component>JMS</component>
                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15246435" author="githubbot" created="Mon, 18 Apr 2016 20:07:27 +0000"  >&lt;p&gt;GitHub user vikash32504 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/131&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    3.1.x fixes&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6454&quot; title=&quot;Orphaned JMS connections created in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6454&quot;&gt;&lt;del&gt;CXF-6454&lt;/del&gt;&lt;/a&gt; - Orphaned JMS connections created in endless loop&lt;br/&gt;
    Changing the code to limit the number of retries to a pre-defined value. It can be configured as maxNoOfRetries in JMS Enpoint. &lt;br/&gt;
    Adding another property to make the sleep time configurable. We were seeing high CPU consumption because of low sleep interval time. &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/apache/cxf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf&lt;/a&gt; 3.1.x-fixes&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/131.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/131.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #131&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0ddd071dd1e7c475d8a0463564a991d62c96e3b0&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-04T17:08:56Z&lt;/p&gt;

&lt;p&gt;    Introducing a REST interface for the STS&lt;/p&gt;

&lt;p&gt;commit 9f457003d766950abc6a22d87d7045d3cf6aee44&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-05T13:32:33Z&lt;/p&gt;

&lt;p&gt;    Cleaning up AbstractImplicitService and prototyping the code to deal with id_token response type in OidcImplicitService, not complete yet&lt;/p&gt;

&lt;p&gt;commit 89b7bb172804ebaffaa69c9207065e50eb5a5d36&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-05T14:15:58Z&lt;/p&gt;

&lt;p&gt;    Converting most of AbstractJose* helpers into concrete classes to make it simpler to delegate to them without having to extend&lt;/p&gt;

&lt;p&gt;commit c3399966e4060837fd17511d604a26c8d12dad7c&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-05T14:20:40Z&lt;/p&gt;

&lt;p&gt;    Adding the renamed resources&lt;/p&gt;

&lt;p&gt;commit 14ed2e2c44b6da7641c95fb57212f8b5a5e77f3d&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-05T14:30:05Z&lt;/p&gt;

&lt;p&gt;    Updating OidcImplicitService to process IdToken&lt;/p&gt;

&lt;p&gt;commit 6a08736476f84c3bc40826d6debc6d4d96589cde&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-05T14:32:25Z&lt;/p&gt;

&lt;p&gt;    Fixing a typo&lt;/p&gt;

&lt;p&gt;commit dbfaf2b5aea3c4b09a825c82cae88c9d5f777aac&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-05T12:09:56Z&lt;/p&gt;

&lt;p&gt;    Renaming tests&lt;/p&gt;

&lt;p&gt;commit 9aae5c5622dec1198a333ac6bb3508d3ca4634c1&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-05T14:54:03Z&lt;/p&gt;

&lt;p&gt;    Refactor of &quot;BasicAuthFilter&quot;&lt;/p&gt;

&lt;p&gt;commit 0b7e0e914328aa7a78a2eab00bb1040c703e9b63&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-05T16:53:40Z&lt;/p&gt;

&lt;p&gt;    Prototyping OAuth2 redirection service which can support all the response types on a single path&lt;/p&gt;

&lt;p&gt;commit 194224faeb3e8eb6c8feabe6397f6b42ff0f605d&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-05T16:14:08Z&lt;/p&gt;

&lt;p&gt;    Fixed TLS client auth issue&lt;/p&gt;

&lt;p&gt;commit bbe5e870579720272af49b9cea65b8293d5b1f3c&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-05T17:53:25Z&lt;/p&gt;

&lt;p&gt;    Changing the default to issue tokens rather than WS-Trust responses&lt;/p&gt;

&lt;p&gt;commit 96802a240f833a1e1cf66cca376f8123b75d68cf&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-05T17:53:39Z&lt;/p&gt;

&lt;p&gt;    Update SourceProvider to be able to write out any Nodes and not just Documents&lt;/p&gt;

&lt;p&gt;commit 04300f6e34a3243418f764640f85be60eb7e05df&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-08T12:05:34Z&lt;/p&gt;

&lt;p&gt;    Return a correct error if a composite oAuth AS can not find the right service&lt;/p&gt;

&lt;p&gt;commit 814dafbb8d0b6124b3a7efe5ead768f731a9ff66&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-08T13:23:31Z&lt;/p&gt;

&lt;p&gt;    Updating SubjectCreator to accept Client too as it may be needed to create UserSubject correctly&lt;/p&gt;

&lt;p&gt;commit e8719af028f014782a282da4c5907ea2252c5095&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-08T14:16:56Z&lt;/p&gt;

&lt;p&gt;    Fixing a duplicate state property issue when OidcImplicitService handles an id_token response type&lt;/p&gt;

&lt;p&gt;commit 03a3cf4f94236f94fc35c39b5c075ff79c82e0dc&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-08T16:02:12Z&lt;/p&gt;

&lt;p&gt;    Adding a homeRealm property to OAuth2 Client&lt;/p&gt;

&lt;p&gt;commit b60702df6f4f8a651395999ee7cc583bb89589e3&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-08T11:24:06Z&lt;/p&gt;

&lt;p&gt;    Adding more STS tests&lt;/p&gt;

&lt;p&gt;commit 01956cc9af68f80d4f12018a3779c12f36d5308e&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-08T11:58:36Z&lt;/p&gt;

&lt;p&gt;    Adding AppliesTo support&lt;/p&gt;

&lt;p&gt;commit bc025f0fe4acf7191430230080318346272543e1&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-08T12:17:57Z&lt;/p&gt;

&lt;p&gt;    Adding claims test&lt;/p&gt;

&lt;p&gt;commit 9da51a99400fad5e6396949bd74a9efaf2093ade&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-08T14:13:16Z&lt;/p&gt;

&lt;p&gt;    Got the PublicKey case working with TLS client certs&lt;/p&gt;

&lt;p&gt;commit 1808d49f62dd08b701c886f529ae7b9efb4b9fbe&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-08T14:42:35Z&lt;/p&gt;

&lt;p&gt;    Got WS-Trust issuing working again&lt;/p&gt;

&lt;p&gt;commit 547f8af0519e6fd973e9cf379034fa6940eb7ceb&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-08T16:33:51Z&lt;/p&gt;

&lt;p&gt;    Adding tests for POST interface&lt;/p&gt;

&lt;p&gt;commit 448fdcf01e27006fef31de39c7672cc251e07dbc&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-09T12:19:47Z&lt;/p&gt;

&lt;p&gt;    Passing request params to SubjectCreator too&lt;/p&gt;

&lt;p&gt;commit d0e42861b5df45cf24985d956372f75bf04800f3&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-09T13:00:41Z&lt;/p&gt;

&lt;p&gt;    Restoring the option to store client id in a session&lt;/p&gt;

&lt;p&gt;commit 87fd53f908c9cdbcf37b2c763664d66f4a4b8420&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-09T13:55:48Z&lt;/p&gt;

&lt;p&gt;    Converting a username in the introspection response&lt;/p&gt;

&lt;p&gt;commit b0ccc3f87b373009f4bd9d9a6a7aa9484e7aca73&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-09T16:17:00Z&lt;/p&gt;

&lt;p&gt;    Avoiding linking UserSubject to indiv clients too early&lt;/p&gt;

&lt;p&gt;commit a75df553a2bb0cee94b96fababa723d7d0f45d90&lt;br/&gt;
Author: Colm O hEigeartaigh &amp;lt;coheigea@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-02-09T17:52:28Z&lt;/p&gt;

&lt;p&gt;    Adding renew/validate tests for the REST STS&lt;/p&gt;

&lt;p&gt;commit b6b48c1bca784fd0e84c6e74223f0d535f4c7ec6&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-10T10:57:38Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6771&quot; title=&quot;JAX-RS ContextProvider should be able to support Servlet contexts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6771&quot;&gt;&lt;del&gt;CXF-6771&lt;/del&gt;&lt;/a&gt; Checking ContextProvider before Servlet contexts are initialized from the message&lt;/p&gt;

&lt;p&gt;commit 60c24cda73a2612551bdc518d901a7c6bc82ee77&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-10T11:15:42Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6772&quot; title=&quot;HttpClientPolicy browserType is reported as BrowserType header &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6772&quot;&gt;&lt;del&gt;CXF-6772&lt;/del&gt;&lt;/a&gt; Reporting browserType property as HTTP User-Agent header&lt;/p&gt;

&lt;p&gt;commit 23112f714cc6c52bef8678739f216f5a8ef26d49&lt;br/&gt;
Author: Sergey Beryozkin &amp;lt;sberyozkin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-10T12:05:57Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6770&quot; title=&quot;PrettyLoggingFilter not working well when using camel-cxf-transport&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6770&quot;&gt;&lt;del&gt;CXF-6770&lt;/del&gt;&lt;/a&gt; Fixing NPE&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15246578" author="githubbot" created="Mon, 18 Apr 2016 21:26:12 +0000"  >&lt;p&gt;GitHub user vikash32504 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    3.1.x fixes - &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6454&quot; title=&quot;Orphaned JMS connections created in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6454&quot;&gt;&lt;del&gt;CXF-6454&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6454&quot; title=&quot;Orphaned JMS connections created in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6454&quot;&gt;&lt;del&gt;CXF-6454&lt;/del&gt;&lt;/a&gt; - Orphaned JMS connections created in endless loop&lt;br/&gt;
    Changing the code to limit the number of retries to a pre-defined value. It can be configured as maxNoOfRetries in JMS Enpoint. &lt;br/&gt;
    Adding another property to make the sleep time configurable. We were seeing high CPU consumption because of low sleep interval time. &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/vikash32504/cxf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vikash32504/cxf&lt;/a&gt; 3.1.x-fixes&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #132&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9b2e894a04fd40ab0178c9f752a760a1dca0fec4&lt;br/&gt;
Author: Vikash Kumar &amp;lt;vikash32504@users.noreply.github.com&amp;gt;&lt;br/&gt;
Date:   2016-04-18T21:17:23Z&lt;/p&gt;

&lt;p&gt;    Update JMSEndpoint.java&lt;/p&gt;

&lt;p&gt;commit c3b98d5602db868e713762279e5c460e18f582c5&lt;br/&gt;
Author: Vikash Kumar &amp;lt;vikash32504@users.noreply.github.com&amp;gt;&lt;br/&gt;
Date:   2016-04-18T21:21:06Z&lt;/p&gt;

&lt;p&gt;    Update JMSDestination.java&lt;/p&gt;

&lt;p&gt;commit 9a2e9e14e758a18b079cca75807e3dd754df6c21&lt;br/&gt;
Author: Vikash Kumar &amp;lt;vikash32504@users.noreply.github.com&amp;gt;&lt;br/&gt;
Date:   2016-04-18T21:22:53Z&lt;/p&gt;

&lt;p&gt;    Update JMSConfiguration.java&lt;/p&gt;

&lt;p&gt;commit 744c4a1d995338fd8703f5baea7002c469035411&lt;br/&gt;
Author: Vikash Kumar &amp;lt;vikash32504@users.noreply.github.com&amp;gt;&lt;br/&gt;
Date:   2016-04-18T21:24:28Z&lt;/p&gt;

&lt;p&gt;    Update JMSConfigFactory.java&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15250749" author="githubbot" created="Wed, 20 Apr 2016 21:28:31 +0000"  >&lt;p&gt;Github user vikash32504 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-212613602&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-212613602&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @cschneider - can you please check this. If this fix looks fine to you. &lt;/p&gt;</comment>
                            <comment id="15251280" author="githubbot" created="Thu, 21 Apr 2016 05:05:29 +0000"  >&lt;p&gt;Github user cschneider commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-212747038&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-212747038&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Will look into it. The tests look good already. &lt;br/&gt;
    I will need to squash the commits into one commit but that is fine. &lt;/p&gt;</comment>
                            <comment id="15251582" author="chris@die-schneider.net" created="Thu, 21 Apr 2016 08:54:59 +0000"  >&lt;p&gt;Why is the endless loop a problem? The case why I created this was to support reconnects if the jms server is down.&lt;br/&gt;
Imagine that for some reason the jms servers are down for some hours. If you set max reconnect attempts then you application will fail permanently after these attempts.&lt;/p&gt;

&lt;p&gt;I agree though that we must detect the case of a clientId that is already taken and that we must avoid having active connections hanging around.&lt;/p&gt;

&lt;p&gt;So I think the first approach is good. Additionally I think it makes sense to be able to set the reconnect delay. For example to avoid spamming the server or your own log.&lt;/p&gt;</comment>
                            <comment id="15251897" author="githubbot" created="Thu, 21 Apr 2016 13:32:47 +0000"  >&lt;p&gt;Github user cschneider commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-212920926&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-212920926&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I think the max retries does not really solve the problem with the InvalidClientIdException. &lt;br/&gt;
    I have pushed an alternative solution with just retryInterval and special handling of the exception to&lt;br/&gt;
    the CXF branch &lt;a href=&quot;https://github.com/apache/cxf/tree/CXF-6454&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/tree/CXF-6454&lt;/a&gt;. Can you try if this fixes your problem?&lt;/p&gt;</comment>
                            <comment id="15252210" author="githubbot" created="Thu, 21 Apr 2016 17:06:39 +0000"  >&lt;p&gt;Github user dhpatel27 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/commit/5e3ac2b252412b90d6c91dea855773a294c3a565#commitcomment-17201043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/commit/5e3ac2b252412b90d6c91dea855773a294c3a565#commitcomment-17201043&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    In rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java:&lt;br/&gt;
    In rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java on line 182:&lt;br/&gt;
    @cschneider #2 Problem mentioned in CXF Bug &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6454&quot; title=&quot;Orphaned JMS connections created in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6454&quot;&gt;&lt;del&gt;CXF-6454&lt;/del&gt;&lt;/a&gt;, I think we should still try to get rid of infinite loop problem as well. We are trying to give a feature of maxRetries as well so that customers can configure on their own as per their needs. Thus, I would still suggest we put a loop controller with maxRetries as in the original code from @vikash32504. Further there are 2 problems in addition&lt;br/&gt;
    1. If a thread interrupts the loop, you are not cleaning up the resources done in method deactivate(). It simply is coming out without cleaning up the resources.&lt;br/&gt;
    2. We are still not giving control to the customer using this feature to control the maxRetries and coming out of the loop without interrupting the thread.&lt;br/&gt;
    3. Also, in addition to that, Thread.sleep() should be put in try block before deactivate as done in original commit by @vikash32504 since it does not make sense to retry immediately the JMS Connection. Thread.sleep will allow a grace period for Queue Mgr to come up and thus, we should keep Thread.sleep before deactivate and put maxRetries back in loop to come out of the endless loop&lt;/p&gt;
</comment>
                            <comment id="15252215" author="githubbot" created="Thu, 21 Apr 2016 17:10:15 +0000"  >&lt;p&gt;Github user dhpatel27 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-213021417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-213021417&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @cschneider We are also trying to address the 2nd point mentioned in mentioned in CXF Bug &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6454&quot; title=&quot;Orphaned JMS connections created in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6454&quot;&gt;&lt;del&gt;CXF-6454&lt;/del&gt;&lt;/a&gt;, I think we should still try to get rid of infinite loop problem as well. We are trying to give a feature of maxRetries as well so that customers can configure on their own as per their needs. Thus, I would still suggest we put a loop controller with maxRetries as in the original code from this pull request. Further there are 2 problems in addition&lt;br/&gt;
    1. If a thread interrupts the loop, you are not cleaning up the resources done in method deactivate(). It simply is coming out without cleaning up the resources.&lt;br/&gt;
    2. We are still not giving control to the customer using this feature to control the maxRetries and coming out of the loop without interrupting the thread.&lt;br/&gt;
    3. Also, in addition to that, Thread.sleep() should be put in try block before deactivate as done in original code in this pull request since it does not make sense to retry immediately the JMS Connection. Thread.sleep will allow a grace period for Queue Mgr to come up and thus, we should keep Thread.sleep before deactivate and put maxRetries back in loop to come out of the endless loop&lt;/p&gt;</comment>
                            <comment id="15253599" author="githubbot" created="Fri, 22 Apr 2016 09:19:16 +0000"  >&lt;p&gt;Github user cschneider commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-213348723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-213348723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I do not yet see a good case for limiting the number of retries as the cxf endpoint or client would be unusable at this point. Can you elaborate how the max retries would help in practice? Especially what would happen after the retries are stopped. Btw. This might be something we could discuss on IRC. I am always in the &lt;a href=&quot;#apache-cxf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;channel #apache-cxf&lt;/a&gt;(&lt;a href=&quot;https://cxf.apache.org/mailing-lists.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cxf.apache.org/mailing-lists.html&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;    1. Not sure I understand this case. Can you elaborate the steps that would happen?&lt;br/&gt;
    2. I think the retry thread should run as long as the CXF endpoint is active. My intention is that you can simply call shutdown on the Destination which ends the retry thread. Interrupting a thread is not such a good idea to achieve this.&lt;br/&gt;
    3. I agree to have the sleep there. I wrongly thought that this code would also be run on the first connect.&lt;/p&gt;
</comment>
                            <comment id="15255134" author="githubbot" created="Sat, 23 Apr 2016 04:49:28 +0000"  >&lt;p&gt;Github user dhpatel27 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-213663398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-213663398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @cschneider The use case for point-1 mentioned by me above is when the application wants the flexibility to stop the retries after certain number of attempts if the Connection couldnt be established to JMS queue managers or JMS Destinations itself. The client may not like to continue the retry infinite times due to the CPU Spikes that they can experience unnecessarily after every completion of thread.sleep. Also, this situation becomes worst if a single JVM has &amp;gt;50 JMS Destination Listeners defined and a single physical host has multiple such JVMs. In such scenario, client would still see high CPU when it continues to do infinite retries. Thus it makes sense to give flexibility to client in terms of exposing both retries and retryinterval.&lt;/p&gt;

&lt;p&gt;    Also for point 2, I was trying to avoid need for client to put custom solution to call explicitly shutdown on JMSDestination as well. ALso, if you note, shutdown variable is proned to race condition since its not defined volatile. If you call shutdown from another Thread, and the retry thread is still looping in another thread, the change in the value of shutdown variable may not be instantaenously visible to other thread.&lt;br/&gt;
    Thanks!&lt;/p&gt;</comment>
                            <comment id="15272860" author="githubbot" created="Thu, 5 May 2016 19:01:42 +0000"  >&lt;p&gt;Github user dhpatel27 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-217244341&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-217244341&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    hi @cschneider Can you please comment on my last comment. If you are fine then we would like to go ahead with the original fix provided by @vikash32504 &lt;/p&gt;
</comment>
                            <comment id="15272863" author="githubbot" created="Thu, 5 May 2016 19:02:10 +0000"  >&lt;p&gt;Github user dhpatel27 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-217244517&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-217244517&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We are hitting critical issues due to this bug in our applications&lt;/p&gt;</comment>
                            <comment id="15279947" author="githubbot" created="Wed, 11 May 2016 11:17:20 +0000"  >&lt;p&gt;Github user tomitribe-dev commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-218430587&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-218430587&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Build triggered. sha1 is merged.&lt;/p&gt;</comment>
                            <comment id="15279959" author="githubbot" created="Wed, 11 May 2016 11:19:05 +0000"  >&lt;p&gt;Github user tomitribe-dev commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-218430942&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-218430942&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Build started sha1 is merged.&lt;/p&gt;
</comment>
                            <comment id="15279973" author="githubbot" created="Wed, 11 May 2016 11:27:10 +0000"  >&lt;p&gt;Github user tomitribe-dev commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132#issuecomment-218432457&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132#issuecomment-218432457&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Build finished. 717 tests run, 2 skipped, 0 failed.&lt;/p&gt;
</comment>
                            <comment id="15331803" author="githubbot" created="Wed, 15 Jun 2016 14:09:27 +0000"  >&lt;p&gt;Github user vikash32504 closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/132&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15407509" author="sergey_beryozkin" created="Thu, 4 Aug 2016 10:02:45 +0000"  >&lt;p&gt;Hi Christian, this was automatically moved to 3.2.0 when I marked 3.1.7 as being released&lt;/p&gt;</comment>
                            <comment id="15925926" author="chris@die-schneider.net" created="Wed, 15 Mar 2017 11:15:24 +0000"  >&lt;p&gt;What is the status of this? I have seen two pull requests but both are closed now. &lt;br/&gt;
The pull requests also seemed to be quite extensive .. much more than a simple bug fix. &lt;/p&gt;

&lt;p&gt;Can we maybe discuss a design and then open a new issue that documents the problem and the agreed on design. This issue has grown quite large and it is difficult to work through the  comments and get a clear pricture. If there is interest I am also available on google hangouts for a personal chat to discuss possible solutions.&lt;br/&gt;
My hangouts id is cschneider111::at::gmail.com (replace ::at:: with @ of course). .. oh and you can also reach me in the #apache-cxf channel on irc.&lt;/p&gt;</comment>
                            <comment id="15926239" author="vikash32504@gmail.com" created="Wed, 15 Mar 2017 14:15:47 +0000"  >&lt;p&gt;This ticket is raised with multiple issues. What we were concerned was related to infinite number of retries without any sleep.&lt;br/&gt;
The fix committed with pull request #132 (&lt;a href=&quot;https://github.com/apache/cxf/commit/5e3ac2b252412b90d6c91dea855773a294c3a565&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/commit/5e3ac2b252412b90d6c91dea855773a294c3a565&lt;/a&gt;)&lt;br/&gt;
is good enough for us. We have deployed the change in our production env.&lt;/p&gt;</comment>
                            <comment id="15926265" author="chris@die-schneider.net" created="Wed, 15 Mar 2017 14:31:10 +0000"  >&lt;p&gt;Ok. So I will close this issue. Please open new ones if you would like further changes. Please also keep in mind the smaller and more focused an issue is the faster it can be fixed.&lt;/p&gt;</comment>
                            <comment id="16216158" author="ffang" created="Tue, 24 Oct 2017 01:05:29 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chris%40die-schneider.net&quot; class=&quot;user-hover&quot; rel=&quot;chris@die-schneider.net&quot;&gt;chris@die-schneider.net&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Seems your commit&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; to fix this issue only in the &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6454&quot; title=&quot;Orphaned JMS connections created in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6454&quot;&gt;&lt;del&gt;CXF-6454&lt;/del&gt;&lt;/a&gt; working branch, not in the master nor the 3.1.x-fixes branch.&lt;/p&gt;

&lt;p&gt;Could we merge this fix to the community used branch?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;https://github.com/apache/cxf/commit/5e3ac2b252412b90d6c91dea855773a294c3a565&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="16221937" author="ffang" created="Fri, 27 Oct 2017 08:31:37 +0000"  >&lt;p&gt;Merged this fix into master and 3.1.x-fixes branch&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 3 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fvif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>