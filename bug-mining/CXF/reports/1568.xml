<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:57:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4666] [OAuth2] securityContext problem on createSubject</title>
                <link>https://issues.apache.org/jira/browse/CXF-4666</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;This is probably just ignorance on my part, but when I override the createSubject method in the RedirecationBasedGrantService.java file, the securityContext parameter that is passed in is of type AbstractHTTPDestination$2. This parameter contains my authentication token, but I don&apos;t know how to get at it, so I&apos;m having to go to the SecurityContextHolder to get the context instead of just using the parameter.&lt;/p&gt;

&lt;p&gt;I&apos;m just using standard Spring authentication, so it seems like many other people would also have AbstractHTTPDestination$2 as the security type, which causes roles to be missed in the OAuthUtils.createSubject method.&lt;/p&gt;

&lt;p&gt;I&apos;m sure I missed some details so please let know your questions and thanks for your help.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12618187">CXF-4666</key>
            <summary>[OAuth2] securityContext problem on createSubject</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="tippettssh">Steven Tippetts</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Nov 2012 17:40:23 +0000</created>
                <updated>Wed, 19 Dec 2012 14:38:39 +0000</updated>
                            <resolved>Fri, 30 Nov 2012 13:09:44 +0000</resolved>
                                    <version>2.7</version>
                                    <fixVersion>2.6.4</fixVersion>
                    <fixVersion>2.7.1</fixVersion>
                                    <component>JAX-RS Security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13506666" author="sergey_beryozkin" created="Thu, 29 Nov 2012 18:54:04 +0000"  >&lt;p&gt;To be honest I&apos;m not sure we can do anything about it and as such I would not treat it as a bug. &lt;/p&gt;

&lt;p&gt;How about the following (Christian suggested something like that awhile back): &lt;/p&gt;

&lt;p&gt;Postpone using Spring security at the servlet level and use CXF JAASLoginInterceptor instead, or may be for JAX-RS - org.apache.cxf.jaxrs.security.JAASAuthenticationFilter. It is very easy to use - just let it know the jaas context name and that is it.&lt;br/&gt;
Effectively it simply postpones the servlet-level authentication till later, once the call reaches CXF chain.&lt;/p&gt;

&lt;p&gt;It will return org.apache.cxf.security.LoginSecurityContext - this is what the default UserSubject creation checks.&lt;br/&gt;
You can also check for some other Subject properties with LoginSecurityContext.&lt;/p&gt;

&lt;p&gt;Next you can map LoginSecurityContext to Spring Security specific context and let it proceed...&lt;/p&gt;

&lt;p&gt;That is the only I can suggest to be honest - would it work for you ?&lt;/p&gt;

&lt;p&gt;By the way, as far as &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4656&quot; title=&quot;[OAuth 2] Add attributes property to UserSubject object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-4656&quot;&gt;&lt;del&gt;CXF-4656&lt;/del&gt;&lt;/a&gt; is concerned, what other properties, apart from the principal name and its roles you are interested ?&lt;/p&gt;







</comment>
                            <comment id="13506987" author="tippettssh" created="Fri, 30 Nov 2012 00:38:22 +0000"  >&lt;p&gt;Thanks for the info. I&apos;ll look into the CXF JAAS approach in the future, but for now I&apos;ll just get the context from ContextSecurityHolder.&lt;/p&gt;

&lt;p&gt;Regarding &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4656&quot; title=&quot;[OAuth 2] Add attributes property to UserSubject object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-4656&quot;&gt;&lt;del&gt;CXF-4656&lt;/del&gt;&lt;/a&gt;, the additional properties I&apos;m interested in are: account id, surname, and given name.&lt;/p&gt;</comment>
                            <comment id="13507309" author="sergey_beryozkin" created="Fri, 30 Nov 2012 13:07:44 +0000"  >&lt;p&gt;I&apos;ve made the method where UserSubject is created protected and also updated it to check for UserSubject which may&apos;ve already been created from filters/interceptors, so you can say register a custom RequestHandler filter, create UserSubject and do &quot;message.setContent(UserSubject.class, mySubject);&quot; - this may be simpler than extending the class...&lt;/p&gt;

&lt;p&gt;&quot;the additional properties I&apos;m interested in are: account id, surname, and given name.&quot; - OK, thanks, I thought may be I can get away with extending UserSubject &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13507310" author="sergey_beryozkin" created="Fri, 30 Nov 2012 13:09:44 +0000"  >&lt;p&gt;see r1415609&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>292809</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 51 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0seg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163817</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>