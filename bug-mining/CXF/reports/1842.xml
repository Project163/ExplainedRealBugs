<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:01:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5063] When using AsyncHttpConduit with a certificate alias CXF hangs after a bunch of requests</title>
                <link>https://issues.apache.org/jira/browse/CXF-5063</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When using AsyncHttpConduit with a certificate alias CXF hangs after a bunch of requests. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Root cause:&lt;/b&gt;&lt;br/&gt;
For each request, when AsyncHTTPConduit.getSSLContext() is called,  the KeyManagers are wrapped by an AliasedX509ExtendedKeyManager. After some time, the KeyManagers are wrapped thousands of times. Then, at the moment a new connection needs to be established, a StackOverflowError is thrown when AliasedX509ExtendedKeyManager.getPrivateKey() is called. This causes the I/O dispatchers of the HttpAsynClient to all go down one after the other. When all the I/O dispatchers are down all requests done on the HttpAsyncClient are timing out.&lt;/p&gt;

&lt;p&gt;In AsyncHTTPConduit.getSSLContext() the hash code of the TlsClientParameters is checked to decide whether or not a new SSLContext should be created. This is not working in this context as the wrapping of the KeyManagers has an influence on the tlsClientParameters hash code. &lt;br/&gt;
Additionally (not directly linked to the issue), the hash code should never be used as an identifier. Two different TlsClientParameters might have the same hash code, in such a case the cached SSLContext won&apos;t be refreshed.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Other points:&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The AsyncHTTPConduit is containing a few auto generated catch blocks (with e.printStackTrace(); ).&lt;/li&gt;
	&lt;li&gt;When the I/O dispatchers are going down (quite an important issue), the error is logged on the System.err and nothing is logged on the Logger.&lt;/li&gt;
	&lt;li&gt;In the CXF documentation nothing is mentioned on the fact the HttpAsyncClient is still in beta.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12651384">CXF-5063</key>
            <summary>When using AsyncHttpConduit with a certificate alias CXF hangs after a bunch of requests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="alevaux">Aymeric Levaux</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jun 2013 17:05:31 +0000</created>
                <updated>Wed, 14 Aug 2013 15:49:14 +0000</updated>
                            <resolved>Fri, 14 Jun 2013 02:49:56 +0000</resolved>
                                    <version>2.7.5</version>
                                    <fixVersion>2.7.6</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13682188" author="alevaux" created="Thu, 13 Jun 2013 12:39:23 +0000"  >&lt;p&gt;Hi Daniel,&lt;/p&gt;

&lt;p&gt;The fix is not working, the getKeyManagersWithCertAlias method has been changed to return the wrapped KeyManager instead of modifying the TLSClientParameters but the returned KeyManagers are never used in getSSLContext.&lt;/p&gt;

&lt;p&gt;Other questions:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Is the hashCode check in getSSLContext required? Are there cases where the TLSClientParameters would change after the first connection has been established? I saw that there is no such mechanism in the HttpsURLConnectionFactory.&lt;/li&gt;
	&lt;li&gt;Should I create a separate issue for the generated catch blocks that are swallowing exceptions?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Aymeric&lt;/p&gt;</comment>
                            <comment id="13683033" author="dkulp" created="Fri, 14 Jun 2013 02:49:56 +0000"  >&lt;p&gt;Thanks for checking/testing.&lt;/p&gt;

&lt;p&gt;The HttpsURLCOnnectionFactory does do the hashcode thing in the decorateWithTLS method.   It&apos;s a rare case that the client params will change after the first connection, but it is allowed by the API&apos;s and such so we try to make a decent effort to detect it and reset.  The hashcode isn&apos;t 100% reliable, but generally OK for such a rare occurance.&lt;/p&gt;

&lt;p&gt;Please create separate issues for other problems and patches would be appreciated.   &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331710</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l84f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>332041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>