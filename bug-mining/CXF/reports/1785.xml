<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:00:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4919] UriInfo.relativize (and HttpUtils.relativize) broken</title>
                <link>https://issues.apache.org/jira/browse/CXF-4919</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;None of these tests pass:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testRelativize() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        URI ab = URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//example.com/a/b/&quot;&lt;/span&gt;);
&lt;/span&gt;        URI abcd = URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//example.com/a/b/c/d&quot;&lt;/span&gt;);
&lt;/span&gt;        assertEquals(URI.create(&quot;&quot;), HttpUtils.relativize(ab, ab));
        assertEquals(URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;c/d&quot;&lt;/span&gt;), HttpUtils.relativize(ab, abcd));
        assertEquals(URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;../&quot;&lt;/span&gt;), HttpUtils.relativize(abcd, ab));
        assertEquals(URI.create(&quot;&quot;), HttpUtils.relativize(abcd, abcd));
        URI abcd2 = URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//example.com/a/b/c/d2&quot;&lt;/span&gt;);
&lt;/span&gt;        assertEquals(URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;d2&quot;&lt;/span&gt;), HttpUtils.relativize(abcd, abcd2));
        URI ab2cd = URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//example.com/a/b2/c/d&quot;&lt;/span&gt;);
&lt;/span&gt;        assertEquals(URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;../../b2/c/d&quot;&lt;/span&gt;), HttpUtils.relativize(abcd, ab2cd));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This affects LinkBuilder.buildRelativize() and UriInfo.relativize()&lt;/p&gt;

&lt;p&gt;The algorithm is basically working by counting elements common by position - this would also fail hard when there are common elements later - but with a different ancestor.&lt;/p&gt;

&lt;p&gt;Javadoc for UriInfo.relativize() also has some testcases that should work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12638843">CXF-4919</key>
            <summary>UriInfo.relativize (and HttpUtils.relativize) broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="soilandreyes">Stian Soiland-Reyes (old)</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Mar 2013 10:08:41 +0000</created>
                <updated>Tue, 26 Nov 2013 17:40:18 +0000</updated>
                            <resolved>Tue, 30 Apr 2013 15:32:09 +0000</resolved>
                                    <version>2.7.3</version>
                                    <fixVersion>3.0.0-milestone1</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13616506" author="sergey_beryozkin" created="Thu, 28 Mar 2013 18:26:03 +0000"  >&lt;p&gt;Stian, would you consider a contribution in the form of a regular patch ? It appears that the only option for us. If it is not easy for you then I&apos;d go ahead and fix this issue, without copying your code - guaranteed&lt;/p&gt;</comment>
                            <comment id="13620813" author="soilandreyes" created="Wed, 3 Apr 2013 10:20:53 +0000"  >&lt;p&gt;OK, I&apos;ll do a patch; next week, I&apos;m afraid.&lt;/p&gt;</comment>
                            <comment id="13633331" author="sergey_beryozkin" created="Tue, 16 Apr 2013 20:45:11 +0000"  >&lt;p&gt;Are you still planning to do it ? Cheers&lt;/p&gt;</comment>
                            <comment id="13637707" author="soilandreyes" created="Mon, 22 Apr 2013 01:05:10 +0000"  >&lt;p&gt;Sorry for the wait, I was waiting for our legal department to clear the contributors agreement, in the end I just did it from scratch in my spare time at home. I did not look at nor use the similar (but in retrospect subtly different) algorithm I wrote in 2011 for my employer.&lt;/p&gt;


&lt;p&gt;Here&apos;s the suggested patch:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://github.com/stain/cxf/compare/CXF-4919-jaxrs-relativize-uri&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stain/cxf/compare/CXF-4919-jaxrs-relativize-uri&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The algorithm uses Java&apos;s URI.relativize(), but if needed climbs up to find a common parent (as URI.relativize will refuse to do &quot;../&quot;). It has a requirement that the base URI must already be absolute; ie &quot;http://example.com/base/root/&quot; rather than &quot;/base/root/&quot; - I can make that supported as well, but that must be done carefully.&lt;/p&gt;

&lt;p&gt;I just created the code of the above patch in my personal time, and should therefore not depend on the my employers (pending) contributors license assignment.&lt;/p&gt;


&lt;p&gt;I am still waiting for the cxf-systests-jaxrs to complete and will let you know if they fail due to this. &lt;/p&gt;</comment>
                            <comment id="13637718" author="soilandreyes" created="Mon, 22 Apr 2013 01:28:42 +0000"  >&lt;p&gt;I&apos;ve reported the misleading JAX-RS javadoc at &lt;a href=&quot;https://java.net/jira/browse/JAX_RS_SPEC-398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://java.net/jira/browse/JAX_RS_SPEC-398&lt;/a&gt; &amp;#8211; but as JAX-RS is scheduled for release tomorrow &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; 2013-04-23 we might end up in a confusing situation where we would have to choose between following the specification of JAX-RS or generate URI references that are correct for the rest of the world.&lt;/p&gt;</comment>
                            <comment id="13637880" author="sergey_beryozkin" created="Mon, 22 Apr 2013 09:47:34 +0000"  >&lt;p&gt;Hi Stian, thanks for the effort, &lt;/p&gt;

&lt;p&gt;&amp;gt; It has a requirement that the base URI must already be absolute&lt;/p&gt;

&lt;p&gt;I think this is what the JAX-RS expectation is too, see bullet 1 at &lt;br/&gt;
&lt;a href=&quot;https://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/core/UriInfo.html#relativize(java.net.URI&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/core/UriInfo.html#relativize(java.net.URI&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;(If the URI to relativize needs to become absolute then obviously the base has to be absolute too).&lt;/p&gt;

&lt;p&gt;Regarding &lt;a href=&quot;https://java.net/jira/browse/JAX_RS_SPEC-398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://java.net/jira/browse/JAX_RS_SPEC-398&lt;/a&gt;, I can not access it, may be you need to update the permissions on it (who can see it and such ?).&lt;br/&gt;
FYI, I&apos;m not sure what is wrong with: &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Request URI: http://host:port/app/root/a/b/c
Supplied URI: a/b/c/d/e
Returned URI: d/e 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to &lt;a href=&quot;http://docs.oracle.com/javase/6/docs/api/java/net/URI.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oracle.com/javase/6/docs/api/java/net/URI.html&lt;/a&gt;,&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;u.resolve(u.relativize(v)).equals(v) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and resolving &quot;d/e&quot; against &quot;http://host:port/app/root/a/b/c&quot; should produce &quot;http://host:port/app/root/a/b/c/d/e&quot;&lt;/p&gt;

&lt;p&gt;Actually, I think I see the doc bug, should be &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Request URI: http://host:port/app/root/a/b/c/
Supplied URI: a/b/c/d/e
Returned URI: d/e 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Right ?&lt;/p&gt;</comment>
                            <comment id="13640505" author="soilandreyes" created="Wed, 24 Apr 2013 14:48:58 +0000"  >&lt;p&gt; &lt;a href=&quot;https://java.net/jira/browse/JAX_RS_SPEC-398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://java.net/jira/browse/JAX_RS_SPEC-398&lt;/a&gt; was for some reason was deleted, on request I posted it again.&lt;/p&gt;

&lt;p&gt;content below (for records):&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Note: This issue was previously posted as JAX_RS_SPEC-398 which somehow disappeared. I was requested to post it again - see &lt;/p&gt;


&lt;p&gt;In the documentation &lt;a href=&quot;https://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/core/UriInfo.html#relativize(java.net.URI&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jax-rs-spec.java.net/nonav/2.0-SNAPSHOT/apidocs/javax/ws/rs/core/UriInfo.html#relativize(java.net.URI&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;The example is misleading (and wrong):&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Examples (for base URI &lt;a href=&quot;http://host:port/app/root/):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://host:port/app/root/):&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Request URI: &lt;a href=&quot;http://host:port/app/root/a/b/c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://host:port/app/root/a/b/c&lt;/a&gt;&lt;br/&gt;
Supplied URI: a/b/c/d/e&lt;br/&gt;
Returned URI: d/e&lt;/p&gt;
&lt;blockquote&gt;


&lt;p&gt;But this would be an invalid example, as trying to resolve the returned URI shows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.net.URI.create(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//host:port/app/root/a/b/c&quot;&lt;/span&gt;).resolve(&lt;span class=&quot;code-quote&quot;&gt;&quot;d/e&quot;&lt;/span&gt;)
&lt;/span&gt;http:&lt;span class=&quot;code-comment&quot;&gt;//host:port/app/root/a/b/d/e&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is simply because a / is missing at the end of the request URI - it would be very strange for someone requesting /app/root/a/b/c to interpret that as /app/root/a/b/c/. Replace &quot;c&quot; with &quot;index.html&quot; to understand in a web sense, it&apos;s reference to d.png should not resolve to index.html/d.png.&lt;/p&gt;


&lt;p&gt;The above misleading example has already led to confusions in the implementation in CXF - see &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-4919&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-4919&lt;/a&gt;  &amp;#8211; in my suggested patch I have deliberately changed the original test to not check for the specified behaviour in JAX-RS javadocs as I believe it is wrong.&lt;/p&gt;


&lt;p&gt;The documentation could probably be rewritten to use a .html resource to be more understandable out of the box. I would also change the confusing (and HTTP-wise invalid) &quot;:port&quot; - as this is an example no need to be generic &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;


&lt;p&gt;For instance:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Base URI: &lt;a href=&quot;http://example.com:8080/app/root/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://example.com:8080/app/root/&lt;/a&gt;&lt;br/&gt;
Request URI: &lt;a href=&quot;http://example.com:8080/app/root/a/b/c/resource.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://example.com:8080/app/root/a/b/c/resource.html&lt;/a&gt;&lt;br/&gt;
Supplied URI: a/b/c/d/e.txt&lt;br/&gt;
Returned URI: d/e.txt&lt;/p&gt;
&lt;blockquote&gt;

&lt;p&gt;Or a very simpler fix would be to just add the missing / in the request URI:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Examples (for base URI &lt;a href=&quot;http://host:port/app/root/):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://host:port/app/root/):&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Request URI: &lt;a href=&quot;http://host:port/app/root/a/b/c/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://host:port/app/root/a/b/c/&lt;/a&gt;&lt;br/&gt;
Supplied URI: a/b/c/d/e&lt;br/&gt;
Returned URI: d/e&lt;/p&gt;
&lt;blockquote&gt;

&lt;p&gt;.. although that would still lead open to the same confusions for request URIs not ending in /.&lt;/p&gt;
&lt;/blockquote&gt;</comment>
                            <comment id="13640519" author="sergey_beryozkin" created="Wed, 24 Apr 2013 15:01:30 +0000"  >&lt;p&gt;Hi, looks like I&apos;ve got it, see the example at the end of my last comment. I&apos;ll support JAX_RS_SPEC-398, that can be fixed for 2.1.&lt;/p&gt;

</comment>
                            <comment id="13640525" author="soilandreyes" created="Wed, 24 Apr 2013 15:14:12 +0000"  >&lt;p&gt;yes, you reasoned correct about what was the documentation bug &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks for responding on &quot;the other side&quot; as well. Too bad we seemed to have missed it for 2.0..&lt;/p&gt;</comment>
                            <comment id="13645666" author="sergey_beryozkin" created="Tue, 30 Apr 2013 15:32:09 +0000"  >&lt;p&gt;Stian, patch has been applied, many thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319318</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j3hr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319659</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>