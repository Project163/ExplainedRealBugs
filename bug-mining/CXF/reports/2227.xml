<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:09:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5722] JAXB generated Enum throws IllegalArgumentException by unmarshalling as @QueryParam</title>
                <link>https://issues.apache.org/jira/browse/CXF-5722</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;By processing request with Query parameter, InjectionUtils tries to recognize and instantiate parameter class.&lt;br/&gt;
In case of Enum parameter class, InjectionUtils.handleParameter() method calls in loop following methods: &quot;fromString&quot;, &quot;fromValue&quot;, &quot;valueOf&quot; using reflection. If method returns null, it tries the next one:&lt;/p&gt;

&lt;p&gt;        if (result == null) {&lt;br/&gt;
            // check for valueOf(String) static methods&lt;br/&gt;
            String[] methodNames = cls.isEnum() &lt;br/&gt;
                ? new String[] &lt;/p&gt;
{&quot;fromString&quot;, &quot;fromValue&quot;, &quot;valueOf&quot;}
&lt;p&gt; &lt;br/&gt;
                : new String[] &lt;/p&gt;
{&quot;valueOf&quot;, &quot;fromString&quot;}
&lt;p&gt;;&lt;br/&gt;
            for (String mName : methodNames) {   &lt;br/&gt;
                result = evaluateFactoryMethod(value, cls, pType, mName);&lt;br/&gt;
                if (result != null) &lt;/p&gt;
{
                    break;
                }
&lt;p&gt;            }&lt;/p&gt;

&lt;p&gt;The problem is that factory methods in JAXB generated Enum behaves differently:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;valueOf() accepts enum identifier (not value)&lt;/li&gt;
	&lt;li&gt;fromValue() accepts enum value&lt;br/&gt;
Both methods throws IllegalArgumentException by worng argument and do not return null, how current code expecting. Because formValue() is tried before valueOf(), it throws exception and valueOf() is never tried, despite of fact that it will convert the value correctly.&lt;br/&gt;
As a result following method throws IllegalArgumentException:&lt;br/&gt;
1) method:&lt;br/&gt;
    @GET&lt;br/&gt;
    @Path(&quot;/enum/&quot;)&lt;br/&gt;
    Response checkEnum(@QueryParam(&quot;car&quot;) CarType car);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;2) generated enum:&lt;br/&gt;
@XmlRootElement(name = &quot;Car&quot;)&lt;br/&gt;
@XmlType(name = &quot;carType&quot;)&lt;br/&gt;
@XmlEnum&lt;br/&gt;
public enum CarType {&lt;/p&gt;

&lt;p&gt;    @XmlEnumValue(&quot;Audi&quot;)&lt;br/&gt;
    AUDI(&quot;Audi&quot;),&lt;br/&gt;
    @XmlEnumValue(&quot;Golf&quot;)&lt;br/&gt;
    GOLF(&quot;Golf&quot;),&lt;br/&gt;
    BMW(&quot;BMW&quot;);&lt;br/&gt;
    private final String value;&lt;/p&gt;

&lt;p&gt;    CarType(String v) &lt;/p&gt;
{
        value = v;
    }

&lt;p&gt;    public String value() &lt;/p&gt;
{
        return value;
    }

&lt;p&gt;    public static CarType fromValue(String v) {&lt;br/&gt;
        for (CarType c: CarType.values()) {&lt;br/&gt;
            if (c.value.equals(v)) &lt;/p&gt;
{
                return c;
            }
&lt;p&gt;        }&lt;br/&gt;
        throw new IllegalArgumentException(v);&lt;br/&gt;
    }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;3) call:&lt;br/&gt;
customerService.checkEnum(CarType.AUDI);&lt;/p&gt;

&lt;p&gt;The issue was found by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeroenvlek&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Jeroen Vlek &lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12711544">CXF-5722</key>
            <summary>JAXB generated Enum throws IllegalArgumentException by unmarshalling as @QueryParam</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ashakirin">Andrei Shakirin</assignee>
                                    <reporter username="ashakirin">Andrei Shakirin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Apr 2014 18:26:29 +0000</created>
                <updated>Thu, 12 Mar 2015 10:09:54 +0000</updated>
                            <resolved>Fri, 25 Jul 2014 15:17:05 +0000</resolved>
                                    <version>3.0.0-milestone2</version>
                                    <fixVersion>3.0</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13986451" author="ashakirin" created="Thu, 1 May 2014 08:35:31 +0000"  >&lt;p&gt;Additional challenge is that handleParameter() returns different errors in case if parameter cannot be converted (500) and if factory method throws exception (404 or 400 depending on parameter type).&lt;/p&gt;

&lt;p&gt;The idea would be not throwing exception immediately by evaluation of current factory method, but try all of them any throw exception only in case if all failed.&lt;/p&gt;</comment>
                            <comment id="13986470" author="sergey_beryozkin" created="Thu, 1 May 2014 10:02:51 +0000"  >&lt;p&gt;Hi Andrei&lt;/p&gt;

&lt;p&gt;Note what the spec 3.2 says: &quot;4. Types that have a static method named valueOf or fromString with a single String argument&lt;br/&gt;
that return an instance of the type. If both methods are present then valueOf MUST be used unless&lt;br/&gt;
the type is an enum in which case fromString MUST be used1 .&lt;br/&gt;
&quot;&lt;br/&gt;
We have to be careful here to make sure we don&apos;t break some compliance&lt;/p&gt;</comment>
                            <comment id="13986477" author="sergey_beryozkin" created="Thu, 1 May 2014 10:19:26 +0000"  >&lt;p&gt;Hi Andrei, the fix looks good to me, except that we need to limit it specifically to the enum &amp;amp; &apos;fromValue&apos; case to minimize the compliance break risks, I&apos;ll take care of it. I&apos;ll also raise a JAX-RS clarification request and see if it gets accepted...&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="13987559" author="ashakirin" created="Fri, 2 May 2014 10:18:27 +0000"  >&lt;p&gt;Let keep issue open until clarification request will be commented:&lt;br/&gt;
&lt;a href=&quot;https://java.net/jira/browse/JAX_RS_SPEC-460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://java.net/jira/browse/JAX_RS_SPEC-460&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13990500" author="jeroenvlek" created="Tue, 6 May 2014 10:02:06 +0000"  >&lt;p&gt;Hi there, &lt;/p&gt;

&lt;p&gt;I just wanted to out myself as the one submitting this bug to Andrei. If you have any more questions please let me know, although Andrei&apos;s example is exhaustive and self-explanatory.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Jeroen Vlek&lt;/p&gt;</comment>
                            <comment id="13990537" author="sergey_beryozkin" created="Tue, 6 May 2014 11:02:26 +0000"  >&lt;p&gt;Hi Jeroen&lt;/p&gt;

&lt;p&gt;Thanks for the comments. &lt;/p&gt;

&lt;p&gt;I&apos;d like to say that there&apos;s no guarantee that JAX_RS_SPEC-460 will be resolved.  While it makes a perfect sense in this particular case, there could be a counter-argument coming in from the spec experts that ignoring the exceptions thrown from fromValue() may cause the side-effects because fromValue() may have been written to enforce the case sensitivity or some other requirements as opposed to being a basic value matcher generated by JAXB.&lt;/p&gt;

&lt;p&gt;I think it makes sense to relax the current spec text from the practical point of view, and let a fromValue() to valueOf() transition happen if the former throws IllegalArgumentException, but we can&apos;t guarantee it will be fixed as we expect.&lt;/p&gt;

&lt;p&gt;We will keep the fix provided by Andrei either way but it may require setting an endpoint property for it to be effective if JAX_RS_SPEC-460 gets refused.&lt;/p&gt;

&lt;p&gt;Finally, note that JAX-RS 2.0 ParamConverterProvider can be used in CXF 3.0.0 onwards to &apos;fix&apos; this issue too&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14074464" author="sergey_beryozkin" created="Fri, 25 Jul 2014 15:17:05 +0000"  >&lt;p&gt;Hi Andrei&lt;/p&gt;

&lt;p&gt;Let me resolve this issue, we will reopen it we will have to introduce a contextual property&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="14356820" author="sergey_beryozkin" created="Wed, 11 Mar 2015 12:35:54 +0000"  >&lt;p&gt;We&apos;ve actually done the right thing by delaying an exception in case of fromValue() throwing the exception and trying valueOf given that the spec talks about fromString and valueOf only &lt;/p&gt;</comment>
                            <comment id="14357341" author="dhirajsb" created="Wed, 11 Mar 2015 18:25:16 +0000"  >&lt;p&gt;I beg to differ. CXF support for fromValue() for JAXB enums essentially renders it&apos;s enum handling asymmetrical (inconsistent from a user&apos;s point of view) for clients and servers. &lt;/p&gt;

&lt;p&gt;The options for CXF are:&lt;/p&gt;

&lt;p&gt;1. If CXF wants to support fromValue() on server side, it should also support value() on the client side, otherwise it can&apos;t produce what it can consume. &lt;br/&gt;
2. Drop support for fromValue() on server side, provide a JAXB enum ParamConverterProvider that users can configure on the client and server side. &lt;/p&gt;

&lt;p&gt;Either way, CXF should treat JAXB enums as a producer and consumer consistently. &lt;/p&gt;</comment>
                            <comment id="14358431" author="sergey_beryozkin" created="Thu, 12 Mar 2015 10:09:54 +0000"  >&lt;p&gt;CXF has been updated to postpone throwing exceptions caught from fromValue() in case valueOf works.&lt;br/&gt;
Ultimately we need to stay compliant as opposed to trying to come with a universal Enum solution that works for all.&lt;br/&gt;
fromValue() is not even mentioned in the spec - I think I added checking it after someone asked for it on the users list or may be on JIRA...&lt;br/&gt;
Basically, the spec says fromString() or valueOf() as far as the &lt;b&gt;default&lt;/b&gt; conversion from String is concerned. The spec also says toString()  as far as converting parameters on the client side is concerned. This is what we do. Just register a custom param converter if you need to customize. And vote for two JAX-RS JIRAs I created if you&apos;d like some additional progress - I&apos;ve already had enough concerns after doing a non-compliant algorithm selection in one of edge cases so not in a mood to do a non-compliant treatment of enums by default &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12727914">CXF-5887</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12780942">CXF-6287</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1v5jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>390106</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>