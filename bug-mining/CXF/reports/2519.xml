<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:15:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6327] Invalid Policy exception for EndorsingSupportingTokens with more than one token assertions</title>
                <link>https://issues.apache.org/jira/browse/CXF-6327</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Parsing WS-Security Policies containing EndorsingSupportingTokens with more than one token assertion in its nested Policy throws a &quot;java.lang.IllegalArgumentException: Invalid Policy&quot;.&lt;/p&gt;

&lt;p&gt;Here is a WSDL test-case:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://rheaavs.element44.net/AvsMpsService_R1_Variante2.wsdl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://rheaavs.element44.net/AvsMpsService_R1_Variante2.wsdl&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The sp:EndorsingSupportingTokens/wsp:Policy has 2 token assertions as children: a sp:X509Token and a sp:IssuedToken. Apparently CXF doesn&apos;t like that.&lt;/p&gt;

&lt;p&gt;If I either remove one of these token assertions or put a wsp:ExactlyOne around them, the exception will not be thrown and the SOAP-Request will be sent but the remote server will not accept the message and return an InvalidSecurity SOAP-Fault. Putting an wsp:ExactlyOne/wsp:All around the 2 tokens will cause the exception to be thrown again.&lt;/p&gt;

&lt;p&gt;According to the specification I cannot see anything wrong with this Policy. See &lt;a href=&quot;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/v1.2/errata01/os/ws-securitypolicy-1.2-errata01-os-complete.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-sx/ws-securitypolicy/v1.2/errata01/os/ws-securitypolicy-1.2-errata01-os-complete.html&lt;/a&gt; Section 8.3:&lt;/p&gt;

&lt;p&gt;&amp;lt;sp:EndorsingSupportingTokens xmlns:sp=&quot;...&quot; ... &amp;gt;&lt;br/&gt;
  &amp;lt;wsp:Policy xmlns:wsp=&quot;...&quot;&amp;gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;Token Assertion&amp;#93;&lt;/span&gt;+&lt;br/&gt;
    &amp;lt;sp:AlgorithmSuite ... &amp;gt; ... &amp;lt;/sp:AlgorithmSuite&amp;gt; ?&lt;br/&gt;
    (&lt;br/&gt;
      &amp;lt;sp:SignedParts ... &amp;gt; ... &amp;lt;/sp:SignedParts&amp;gt; |&lt;br/&gt;
      &amp;lt;sp:SignedElements ... &amp;gt; ... &amp;lt;/sp:SignedElements&amp;gt; |&lt;br/&gt;
      &amp;lt;sp:EncryptedParts ... &amp;gt; ... &amp;lt;/sp:EncryptedParts&amp;gt; |&lt;br/&gt;
      &amp;lt;sp:EncryptedElements ... &amp;gt; ... &amp;lt;/sp:EncryptedElements&amp;gt; |&lt;br/&gt;
      &amp;lt;sp:ContentEncryptedElements ... &amp;gt; ... &amp;lt;/sp:ContentEncryptedElements&amp;gt;&lt;br/&gt;
    ) *&lt;br/&gt;
    ...&lt;br/&gt;
  &amp;lt;/wsp:Policy&amp;gt;&lt;br/&gt;
  ...&lt;br/&gt;
&amp;lt;/sp:EndorsingSupportingTokens&amp;gt;&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;/sp:EndorsingSupportingTokens/wsp:Policy/&lt;span class=&quot;error&quot;&gt;&amp;#91;Token Assertion&amp;#93;&lt;/span&gt;&lt;br/&gt;
  The policy MUST identify one or more token assertions.&lt;/p&gt;

&lt;p&gt;This bug currently makes it impossible to access WebServices using such a SecurityPolicy for me as I couldn&apos;t find a client-side workaround.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12787600">CXF-6327</key>
            <summary>Invalid Policy exception for EndorsingSupportingTokens with more than one token assertions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="s.proels">Stefan Pr&#246;ls</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Apr 2015 08:13:54 +0000</created>
                <updated>Fri, 14 Oct 2016 14:23:55 +0000</updated>
                            <resolved>Wed, 15 Apr 2015 12:47:11 +0000</resolved>
                                    <version>3.0.4</version>
                                    <fixVersion>3.1</fixVersion>
                    <fixVersion>3.0.5</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14394419" author="coheigea" created="Fri, 3 Apr 2015 13:29:08 +0000"  >
&lt;p&gt;We don&apos;t support multiple &quot;all&quot; token assertions.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="14494291" author="s.proels" created="Tue, 14 Apr 2015 15:39:38 +0000"  >&lt;p&gt;Could it be you already did support this in the 2.7.14 days? At least 2.7.14 does not throw this exception for the WSDL file.&lt;/p&gt;</comment>
                            <comment id="14496002" author="s.proels" created="Wed, 15 Apr 2015 10:36:12 +0000"  >&lt;p&gt;Update: I&apos;ve successfully written a Client for this Service using Apache CXF 2.7.15. So apparently this feature already existed in the 2.7 series and got lost in 3.0.&lt;/p&gt;</comment>
                            <comment id="14496131" author="coheigea" created="Wed, 15 Apr 2015 12:47:05 +0000"  >
&lt;p&gt;Fixed in WSS4J: &lt;a href=&quot;https://issues.apache.org/jira/browse/WSS-534&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/WSS-534&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Some additional fixes also made in CXF.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27otr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>