<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:42:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2919] NullPointerException at org.apache.cxf.staxutils.StaxUtils.writeNode(Node, XMLStreamWriter, boolean) when DOCTYPE is in a XML Schema</title>
                <link>https://issues.apache.org/jira/browse/CXF-2919</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Following a contract first approach, if I expose a WSDL which imports a XSD with a DOCTYPE declaration, for instance:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;!DOCTYPE xs:schema PUBLIC &quot;-//W3C//DTD XMLSCHEMA 200102//EN&quot; &quot;http://www.w3.org/2001/XMLSchema.dtd&quot;&amp;gt;&lt;br/&gt;
&amp;lt;!--&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
--&amp;gt;&lt;br/&gt;
&amp;lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;then, when invoking the CXFServlet to show this XSD I get the following exception:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at com.sun.xml.internal.stream.writers.UTF8OutputStreamWriter.write(UTF8OutputStreamWriter.java:127)&lt;br/&gt;
	at com.sun.xml.internal.stream.writers.XMLStreamWriterImpl.writeDTD(XMLStreamWriterImpl.java:722)&lt;br/&gt;
	at org.apache.cxf.staxutils.StaxUtils.writeNode(StaxUtils.java:775)&lt;br/&gt;
	at org.apache.cxf.staxutils.StaxUtils.writeDocument(StaxUtils.java:600)&lt;br/&gt;
	at org.apache.cxf.staxutils.StaxUtils.writeDocument(StaxUtils.java:588)&lt;br/&gt;
	at org.apache.cxf.staxutils.StaxUtils.writeNode(StaxUtils.java:762)&lt;br/&gt;
	at org.apache.cxf.transport.http.WSDLQueryHandler.writeResponse(WSDLQueryHandler.java:230)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:162)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractCXFServlet.invoke(AbstractCXFServlet.java:142)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:179)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doGet(AbstractHTTPServlet.java:108)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:159)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)&lt;br/&gt;
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)&lt;br/&gt;
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;This is because org.apache.cxf.staxutils.StaxUtils.writeNode(Node, XMLStreamWriter, boolean) does the following for a Node of type DOCUMENT_TYPE_NODE:&lt;/p&gt;

&lt;p&gt;            try &lt;/p&gt;
{
                writer.writeDTD(((DocumentType)n).getTextContent());
            }
&lt;p&gt; catch (UnsupportedOperationException ex) &lt;/p&gt;
{
                //can we ignore?  DOM writers really don&apos;t allow this
                //as there isn&apos;t a way to write a DTD in dom
            }

&lt;p&gt;However, org.w3c.dom.Node.getTextContent() by contract returns NULL for a Node of type DOCUMENT_TYPE_NODE. This causes the NPE.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470517">CXF-2919</key>
            <summary>NullPointerException at org.apache.cxf.staxutils.StaxUtils.writeNode(Node, XMLStreamWriter, boolean) when DOCTYPE is in a XML Schema</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="mauromol">Mauro Molinari</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Jul 2010 14:18:46 +0000</created>
                <updated>Mon, 11 Oct 2010 14:52:53 +0000</updated>
                            <resolved>Wed, 11 Aug 2010 17:42:12 +0000</resolved>
                                    <version>2.2.9</version>
                                    <fixVersion>2.2.10</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12894061" author="gmazza" created="Fri, 30 Jul 2010 15:08:38 +0000"  >&lt;p&gt;Why is this &quot;critical&quot;, it seems oxymoronic for a XML Schema to contain a DTD declaration.  (Are they even permitted to have them?)  What do you propose as a solution &amp;#8211; are you just asking for a wrapping of the NPE (reasonable enough) or for CXF to somehow handle DTD&apos;s within XML Schemas?  (Are there specifications for that? &amp;#8211; I don&apos;t know.)&lt;/p&gt;</comment>
                            <comment id="12894069" author="mauromol" created="Fri, 30 Jul 2010 16:31:59 +0000"  >&lt;p&gt;&quot;Critical&quot; because I find it quite normal that a XSD (which is an XML) may contain a DOCTYPE. I&apos;m trying to expose the XSD of WS-Addressing (ws-addr.xsd - &quot;W3C XML Schema defined in the Web Services Addressing 1.0 specification&quot;) provided by JBoss Transactions XTS, which comes with a DOCTYPE and I have to edit it (removing the DOCTYPE) in order to avoid CXF to throw the NPE.&lt;/p&gt;

&lt;p&gt;I think CXF should handle the DOCTYPE by either skipping it (if it&apos;s useless with regards to WDSL publishing) or by just printing it out as-is.&lt;/p&gt;</comment>
                            <comment id="12897352" author="dkulp" created="Wed, 11 Aug 2010 17:42:12 +0000"  >&lt;p&gt;&lt;br/&gt;
Added a null guard&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178883</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>