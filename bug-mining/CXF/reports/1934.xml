<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:03:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5231] NoSuchElementException in ClientFaultConverter when stack trace message contains line breaks</title>
                <link>https://issues.apache.org/jira/browse/CXF-5231</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;On server side, I have enabled those two flags in order to be able to retrieve the full exception in client :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Message.FAULT_STACKTRACE_ENABLED -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
Message.EXCEPTION_MESSAGE_CAUSE_ENABLED -&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is that one of the exception message contains a line break &quot;\n&quot; character. Thus when the exception is thrown, here is what I have on client side with version 2.7.6 :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.util.NoSuchElementException
	at java.util.StringTokenizer.nextToken(StringTokenizer.java:349)
	at org.apache.cxf.interceptor.ClientFaultConverter.parseStackTrackLine(ClientFaultConverter.java:288)
	at org.apache.cxf.interceptor.ClientFaultConverter.getCause(ClientFaultConverter.java:279)
	at org.apache.cxf.interceptor.ClientFaultConverter.setStackTrace(ClientFaultConverter.java:247)
	at org.apache.cxf.interceptor.ClientFaultConverter.handleMessage(ClientFaultConverter.java:80)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.interceptor.AbstractFaultChainInitiatorObserver.onMessage(AbstractFaultChainInitiatorObserver.java:113)
	at org.apache.cxf.binding.soap.interceptor.CheckFaultInterceptor.handleMessage(CheckFaultInterceptor.java:69)
	at org.apache.cxf.binding.soap.interceptor.CheckFaultInterceptor.handleMessage(CheckFaultInterceptor.java:34)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.endpoint.ClientImpl.onMessage(ClientImpl.java:811)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1590)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1486)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1305)
	at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
	at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:623)
	at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:541)
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:474)
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:377)
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:330)
	at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:96)
	at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:134)
	at com.sun.proxy.$Proxy71.execute(Unknown Source)
	at com.mycompany.client.WebServiceClient.main(WebServiceClient.java:111)

Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; javax.xml.ws.soap.SOAPFaultException: Fault string, and possibly fault code, not set
	at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:156)
	at com.sun.proxy.$Proxy71.execute(Unknown Source)
	at com.mycompany.client.WebServiceClient.main(WebServiceClient.java:111)
Caused by: java.util.NoSuchElementException
	at java.util.StringTokenizer.nextToken(StringTokenizer.java:349)
	at org.apache.cxf.interceptor.ClientFaultConverter.parseStackTrackLine(ClientFaultConverter.java:288)
	at org.apache.cxf.interceptor.ClientFaultConverter.getCause(ClientFaultConverter.java:279)
	at org.apache.cxf.interceptor.ClientFaultConverter.setStackTrace(ClientFaultConverter.java:247)
	at org.apache.cxf.interceptor.ClientFaultConverter.handleMessage(ClientFaultConverter.java:80)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.interceptor.AbstractFaultChainInitiatorObserver.onMessage(AbstractFaultChainInitiatorObserver.java:113)
	at org.apache.cxf.binding.soap.interceptor.CheckFaultInterceptor.handleMessage(CheckFaultInterceptor.java:69)
	at org.apache.cxf.binding.soap.interceptor.CheckFaultInterceptor.handleMessage(CheckFaultInterceptor.java:34)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.endpoint.ClientImpl.onMessage(ClientImpl.java:811)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponseInternal(HTTPConduit.java:1590)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleResponse(HTTPConduit.java:1486)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1305)
	at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
	at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:623)
	at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:541)
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:474)
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:377)
	at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:330)
	at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:96)
	at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:134)
	... 2 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After debugging, I can see that in the getCause method of ClientFaultConverter, you are using a StringTokenizer to iterate through different lines.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;StringTokenizer st = new StringTokenizer(ss, &quot;\n&quot;);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;When it comes to the exception message, we have this kind of string :&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Caused by: beginning of the message&lt;br/&gt;
end of the message&lt;br/&gt;
first line of stack trace&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thus this piece of code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Throwable getCause(StringTokenizer st, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; firstLine) {
        &lt;span class=&quot;code-comment&quot;&gt;// The actual exception &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;of the cause might be unavailable at the
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// client -&amp;gt; use a standard throwable to represent the cause.
&lt;/span&gt;        Throwable res = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Throwable(firstLine.substring(firstLine.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt;) + 2));
        List&amp;lt;StackTraceElement&amp;gt; stackTraceList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;StackTraceElement&amp;gt;();
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (st.hasMoreTokens()) {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; oneLine = st.nextToken();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (oneLine.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Caused by:&quot;&lt;/span&gt;)) {
                Throwable nestedCause = getCause(st, oneLine);
                res.initCause(nestedCause);
                &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
            }
            stackTraceList.add(parseStackTrackLine(oneLine));
        }
        StackTraceElement[] stackTraceElement = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StackTraceElement[stackTraceList.size()];
        res.setStackTrace(stackTraceList.toArray(stackTraceElement));
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; res;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will result in calling &quot;parseStackTrackLine&quot; on element &quot;end of the message&quot; which causes the exception.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12665267">CXF-5231</key>
            <summary>NoSuchElementException in ClientFaultConverter when stack trace message contains line breaks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="jbe">JBE</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Aug 2013 17:22:05 +0000</created>
                <updated>Mon, 2 Jun 2014 23:37:17 +0000</updated>
                            <resolved>Fri, 30 Aug 2013 07:49:56 +0000</resolved>
                                    <version>2.7.3</version>
                    <version>2.7.6</version>
                                    <fixVersion>2.6.10</fixVersion>
                    <fixVersion>2.7.7</fixVersion>
                    <fixVersion>3.0.0-milestone1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13754472" author="ffang" created="Fri, 30 Aug 2013 07:49:56 +0000"  >&lt;p&gt;commit fix&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1517432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1517432&lt;/a&gt; for trunk&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1517463&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1517463&lt;/a&gt; for 2.7.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1517467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1517467&lt;/a&gt; for 2.6.x branch&lt;/p&gt;</comment>
                            <comment id="14015933" author="cerebralvortex" created="Mon, 2 Jun 2014 21:39:18 +0000"  >&lt;p&gt;We are still seeing this issue with 3.0.0-milestone1, let us know what you need to help reproduce it.&lt;/p&gt;</comment>
                            <comment id="14015951" author="sbenbouzid" created="Mon, 2 Jun 2014 22:01:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cerebralvortex&quot; class=&quot;user-hover&quot; rel=&quot;cerebralvortex&quot;&gt;cerebralvortex&lt;/a&gt;, ain&apos;t that the same cause as following issue : &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-5719&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-5719&lt;/a&gt; ??&lt;/p&gt;</comment>
                            <comment id="14016046" author="cerebralvortex" created="Mon, 2 Jun 2014 23:36:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbenbouzid&quot; class=&quot;user-hover&quot; rel=&quot;sbenbouzid&quot;&gt;sbenbouzid&lt;/a&gt; Yes, it does appear to be that same issue.  I didn&apos;t see the other open issue. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345207</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nj2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345508</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>