<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:31:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7676] TCK: An Entity OutputStream is not set before ClientRequestFilterInterceptor.handleMessage()  processes a user&apos;s ClientRequestFilter which modifies the EntityStream via ClientRequestContext.setEntityStream()</title>
                <link>https://issues.apache.org/jira/browse/CXF-7676</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;CXF is failing a test in both the JAXRS 2.0 and 2.1 TCKs where a user creates a ClientRequestFilter which wraps the EntityStream in the filter() method via&#160;ClientRequestContext.setEntityStream().&lt;/p&gt;

&lt;p&gt;CXF uses Phases to order the interceptors in the PhaseInterceptorChain.&#160;&lt;a href=&quot;http://cxf.apache.org/docs/interceptors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/docs/interceptors.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;A customer&apos;s client filter code gets executed in ClientRequestFilterInterceptor.handleMessage() during the PRE_LOGICAL phase of the outgoing chain.&lt;br/&gt;
We don&apos;t actually create the entity output stream until HTTPConduit.prepare() which is called by MessageSenderInterceptor.handleMessage() during the PREPARE_SEND phase of the outgoing chain.&lt;/p&gt;

&lt;p&gt;As a result, any interaction/modification of the entity stream by the user gets overwritten.&lt;/p&gt;</description>
                <environment>&lt;p&gt;all versions, any environment&lt;/p&gt;</environment>
        <key id="13144379">CXF-7676</key>
            <summary>TCK: An Entity OutputStream is not set before ClientRequestFilterInterceptor.handleMessage()  processes a user&apos;s ClientRequestFilter which modifies the EntityStream via ClientRequestContext.setEntityStream()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="atanders">Adam Anderson</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Mar 2018 17:09:12 +0000</created>
                <updated>Tue, 17 Apr 2018 00:57:09 +0000</updated>
                            <resolved>Fri, 16 Mar 2018 18:08:12 +0000</resolved>
                                                    <fixVersion>3.2.3</fixVersion>
                    <fixVersion>3.2.4</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="16395527" author="atanders" created="Mon, 12 Mar 2018 17:09:48 +0000"  >&lt;p&gt;I have a fix already, creating a PR&lt;/p&gt;</comment>
                            <comment id="16395890" author="githubbot" created="Mon, 12 Mar 2018 21:02:15 +0000"  >&lt;p&gt;WhiteCat22 opened a new pull request #390: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7676&quot; title=&quot;TCK: An Entity OutputStream is not set before ClientRequestFilterInterceptor.handleMessage()  processes a user&amp;#39;s ClientRequestFilter which modifies the EntityStream via ClientRequestContext.setEntityStream()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7676&quot;&gt;&lt;del&gt;CXF-7676&lt;/del&gt;&lt;/a&gt; Create a proxy OutputStream to create an EntityStream that&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/390&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &#8230; a user&apos;s ClientRequestFilter can interact with and holds a reference that we can set our URLConnectionWrappedOutputStream to later.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16395891" author="githubbot" created="Mon, 12 Mar 2018 21:02:49 +0000"  >&lt;p&gt;WhiteCat22 commented on issue #390: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7676&quot; title=&quot;TCK: An Entity OutputStream is not set before ClientRequestFilterInterceptor.handleMessage()  processes a user&amp;#39;s ClientRequestFilter which modifies the EntityStream via ClientRequestContext.setEntityStream()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7676&quot;&gt;&lt;del&gt;CXF-7676&lt;/del&gt;&lt;/a&gt; Create a proxy OutputStream to create an EntityStream that&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/390#issuecomment-372461490&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/390#issuecomment-372461490&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Currently creating a systest, will add before merge&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16399145" author="githubbot" created="Wed, 14 Mar 2018 19:18:03 +0000"  >&lt;p&gt;WhiteCat22 commented on issue #390: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7676&quot; title=&quot;TCK: An Entity OutputStream is not set before ClientRequestFilterInterceptor.handleMessage()  processes a user&amp;#39;s ClientRequestFilter which modifies the EntityStream via ClientRequestContext.setEntityStream()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7676&quot;&gt;&lt;del&gt;CXF-7676&lt;/del&gt;&lt;/a&gt; Create a proxy OutputStream to create an EntityStream that&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/390#issuecomment-373143264&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/390#issuecomment-373143264&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Test has been created and is passing.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16402284" author="githubbot" created="Fri, 16 Mar 2018 18:07:52 +0000"  >&lt;p&gt;dkulp closed pull request #390: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7676&quot; title=&quot;TCK: An Entity OutputStream is not set before ClientRequestFilterInterceptor.handleMessage()  processes a user&amp;#39;s ClientRequestFilter which modifies the EntityStream via ClientRequestContext.setEntityStream()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7676&quot;&gt;&lt;del&gt;CXF-7676&lt;/del&gt;&lt;/a&gt; Create a proxy OutputStream to create an EntityStream that&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/390&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/390&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientRequestFilterInterceptor.java b/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientRequestFilterInterceptor.java&lt;br/&gt;
index 44430f393ca..d207d76ef87 100644&lt;br/&gt;
&amp;#8212; a/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientRequestFilterInterceptor.java&lt;br/&gt;
+++ b/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientRequestFilterInterceptor.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;br/&gt;
 package org.apache.cxf.jaxrs.client.spec;&lt;/p&gt;

&lt;p&gt; import java.io.IOException;&lt;br/&gt;
+import java.io.OutputStream;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
 import java.util.Map;&lt;/p&gt;

&lt;p&gt;@@ -39,6 +40,7 @@&lt;br/&gt;
 import org.apache.cxf.message.MessageImpl;&lt;br/&gt;
 import org.apache.cxf.phase.Phase;&lt;br/&gt;
 import org.apache.cxf.transport.MessageObserver;&lt;br/&gt;
+import org.apache.cxf.transport.http.ProxyOutputStream;&lt;/p&gt;

&lt;p&gt; public class ClientRequestFilterInterceptor extends AbstractOutDatabindingInterceptor {&lt;/p&gt;

&lt;p&gt;@@ -52,6 +54,12 @@ public void handleMessage(Message outMessage) throws Fault &lt;/p&gt;
{
             return;
         }

&lt;p&gt;+        // create an empty proxy output stream that the filter can interact with&lt;br/&gt;
+        // and save a reference for later&lt;br/&gt;
+        ProxyOutputStream pos = new ProxyOutputStream();&lt;br/&gt;
+        outMessage.setContent(OutputStream.class, pos);&lt;br/&gt;
+        outMessage.setContent(ProxyOutputStream.class, pos);&lt;br/&gt;
+&lt;br/&gt;
         List&amp;lt;ProviderInfo&amp;lt;ClientRequestFilter&amp;gt;&amp;gt; filters = pf.getClientRequestFilters();&lt;br/&gt;
         if (!filters.isEmpty()) {&lt;/p&gt;

&lt;p&gt;diff --git a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/HTTPConduit.java b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/HTTPConduit.java&lt;br/&gt;
index 4b84aa32212..fda7b8fad29 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/HTTPConduit.java&lt;br/&gt;
+++ b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/HTTPConduit.java&lt;br/&gt;
@@ -562,11 +562,21 @@ public void prepare(Message message) throws IOException {&lt;/p&gt;

&lt;p&gt;         setHeadersByAuthorizationPolicy(message, currentAddress.getURI());&lt;br/&gt;
         new Headers(message).setFromClientPolicy(getClient(message));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;message.setContent(OutputStream.class,&lt;/li&gt;
	&lt;li&gt;createOutputStream(message,&lt;/li&gt;
	&lt;li&gt;needToCacheRequest,&lt;/li&gt;
	&lt;li&gt;isChunking,&lt;/li&gt;
	&lt;li&gt;chunkThreshold));&lt;br/&gt;
+&lt;br/&gt;
+        // set the OutputStream on the ProxyOutputStream&lt;br/&gt;
+        ProxyOutputStream pos = message.getContent(ProxyOutputStream.class);&lt;br/&gt;
+        if (pos != null &amp;amp;&amp;amp; message.getContent(OutputStream.class) != null) 
{
+            pos.setWrappedOutputStream(createOutputStream(message,
+                                                          needToCacheRequest,
+                                                          isChunking,
+                                                          chunkThreshold));
+        }
&lt;p&gt; else &lt;/p&gt;
{
+            message.setContent(OutputStream.class,
+                               createOutputStream(message,
+                                                  needToCacheRequest,
+                                                  isChunking,
+                                                  chunkThreshold));
+        }
&lt;p&gt;         // We are now &quot;ready&quot; to &quot;send&quot; the message.&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/ProxyOutputStream.java b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/ProxyOutputStream.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..f1d0f4af1f8&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/ProxyOutputStream.java&lt;br/&gt;
@@ -0,0 +1,29 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+package org.apache.cxf.transport.http;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.OutputStream;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.io.AbstractWrappedOutputStream;&lt;br/&gt;
+&lt;br/&gt;
+public class ProxyOutputStream extends AbstractWrappedOutputStream {&lt;br/&gt;
+    public void setWrappedOutputStream(OutputStream os) &lt;/p&gt;
{
+        this.wrappedStream = os;
+    }
&lt;p&gt;+}&lt;br/&gt;
diff --git a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java&lt;br/&gt;
index fe843667392..538b99bcd09 100644&lt;br/&gt;
&amp;#8212; a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java&lt;br/&gt;
+++ b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java&lt;br/&gt;
@@ -1668,6 +1668,14 @@ public Response getBadlyQuotedHeader(@QueryParam(&quot;type&quot;)int t) {&lt;br/&gt;
     public BookSubresource getBookFromSubresource() &lt;/p&gt;
{
         return new BookSubresourceImpl();
     }
&lt;p&gt;+    &lt;br/&gt;
+    @POST&lt;br/&gt;
+    @Path(&quot;/entityecho&quot;)&lt;br/&gt;
+    @Consumes(&quot;text/plain&quot;)&lt;br/&gt;
+    @Produces(&quot;text/plain&quot;)&lt;br/&gt;
+    public Response echoEntity(String entity) &lt;/p&gt;
{
+        return Response.ok().entity(entity).build();
+    }

&lt;p&gt;     public final String init() {&lt;br/&gt;
         books.clear();&lt;br/&gt;
diff --git a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRS20ClientServerBookTest.java b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRS20ClientServerBookTest.java&lt;br/&gt;
index 418408fa23a..f3b37a8c004 100644&lt;br/&gt;
&amp;#8212; a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRS20ClientServerBookTest.java&lt;br/&gt;
+++ b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRS20ClientServerBookTest.java&lt;br/&gt;
@@ -834,6 +834,27 @@ public void testUnknownHostException() throws InterruptedException &lt;/p&gt;
{
                     ExceptionUtils.getRootCause(e) instanceof UnknownHostException);
         }
&lt;p&gt;     }&lt;br/&gt;
+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testGetSetEntityStream() {&lt;br/&gt;
+        String address = &quot;http://localhost:&quot; + PORT + &quot;/bookstore/entityecho&quot;;&lt;br/&gt;
+        String entity = &quot;BOOKSTORE&quot;;&lt;br/&gt;
+&lt;br/&gt;
+        Client client = ClientBuilder.newClient();&lt;br/&gt;
+        client.register(new ClientRequestFilter() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public void filter(ClientRequestContext context) throws IOException &lt;/p&gt;
{
+                context.setEntityStream(new ReplacingOutputStream(
+                                 context.getEntityStream(), &apos;X&apos;, &apos;O&apos;));
+            }
&lt;p&gt;+        });&lt;br/&gt;
+&lt;br/&gt;
+        WebTarget target = client.target(address);&lt;br/&gt;
+&lt;br/&gt;
+        Response response = target.request().post(&lt;br/&gt;
+                Entity.entity(entity.replace(&apos;O&apos;, &apos;X&apos;), &quot;text/plain&quot;));&lt;br/&gt;
+        assertEquals(entity, response.readEntity(String.class));&lt;br/&gt;
+    }&lt;/p&gt;

&lt;p&gt;     private static class ReplaceBodyFilter implements ClientRequestFilter {&lt;/p&gt;

&lt;p&gt;diff --git a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/ReplacingOutputStream.java b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/ReplacingOutputStream.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..0668961e47b&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/ReplacingOutputStream.java&lt;br/&gt;
@@ -0,0 +1,45 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.io.OutputStream;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.io.AbstractWrappedOutputStream;&lt;br/&gt;
+&lt;br/&gt;
+public class ReplacingOutputStream extends AbstractWrappedOutputStream {&lt;br/&gt;
+&lt;br/&gt;
+    private char oldChar;&lt;br/&gt;
+    private char newChar;&lt;br/&gt;
+&lt;br/&gt;
+    public ReplacingOutputStream(OutputStream wrappedStream, char oldChar, char newChar) &lt;/p&gt;
{
+        super(wrappedStream);
+        this.oldChar = oldChar;
+        this.newChar = newChar;
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void write(byte[] b) throws IOException &lt;/p&gt;
{
+        replace(b);
+    }
&lt;p&gt;+&lt;br/&gt;
+    private void replace(byte[] b) throws IOException &lt;/p&gt;
{
+        this.wrappedStream.write(new String(b).replace(this.oldChar, this.newChar).getBytes());
+    }
&lt;p&gt;+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16402560" author="atanders" created="Fri, 16 Mar 2018 21:28:39 +0000"  >&lt;p&gt;Can we backport this to 3.1.X?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3r6pz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>