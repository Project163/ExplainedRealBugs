<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:29:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7544] Support @Context-based injection into proxied CDI beans</title>
                <link>https://issues.apache.org/jira/browse/CXF-7544</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;The issue pop up as part of &lt;a href=&quot;https://github.com/apache/cxf/pull/330&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/330&lt;/a&gt; discussion. In case when provider / feature / resource is a proxied CDI bean, the contextual class members (annotated with @Context) are not injected.&lt;/p&gt;

&lt;p&gt;Test case to reproduce:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@ApplicationScoped
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BookStoreRequestFilter &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ContainerRequestFilter {
    @Context &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ResourceInfo resourceInfo;
    
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void filter(ContainerRequestContext requestContext) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-comment&quot;&gt;// Contextual instances should be injected independently
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (resourceInfo == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || resourceInfo.getResourceMethod() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            requestContext.abortWith(Response.serverError().build());
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rmannibucau&quot; class=&quot;user-hover&quot; rel=&quot;rmannibucau&quot;&gt;rmannibucau&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Abitmorecontext&quot;&gt;&lt;/a&gt;A bit more context &lt;/h3&gt;

&lt;p&gt;In some circumstances (like using @ApplicationScoped annotation for example) the CDI runtime will create a proxy class for a particular bean. As the result, the CXF side is going to bind the particular provider metadata to this proxy instance. It looks logical and unambiguous.&lt;/p&gt;

&lt;p&gt;However, the interesting things are happening when CXF will try to inject contextual proxies (@Context annotations) into the provider instance. The injections are successful but the target object for them will be the proxy instance (not the real instance behind it). Consequently, at runtime, when the proxy delegates the call to a backing instance, all contextual proxies are null in there (simply put, not set).&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Howtosolve&quot;&gt;&lt;/a&gt;How to solve &lt;/h3&gt;

&lt;p&gt;Referring to the recent discussions with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergeyb&quot; class=&quot;user-hover&quot; rel=&quot;sergeyb&quot;&gt;sergeyb&lt;/a&gt;, the best solution would be to delegate the @Context annotation to CDI framework (as such, relieving the CXF from doing the injection work). This proposal may need a support from the JAX-RS specification side.&lt;/p&gt;

&lt;p&gt;Simpler (interim?) possible solution would be to complement the CDI injection with @Context injection (delegating this work to the CXF as it works right now for non-proxy beans and non-CDI deployments). This could be done by observing ProcessInjectionTarget events and supplying our own InjectionTarget (have working PoC for this approach).&lt;/p&gt;

&lt;p&gt;Regarding constructor injection, it seems like CXF does not support passing the arguments to provider constructor (in case of CDI, w/o @Context annotation) so I it would be another (separate) issue to look at.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Update&quot;&gt;&lt;/a&gt;Update&lt;/h3&gt;
&lt;p&gt;Addressing the issue requires a significant revamp of the CXF injection mechanism, it is turned out to be hard to solve even with @AroundConstruct or, previously, providing custom @Context injectors. The good news is that the field-based injection could be easily workarounded using setter-based injection. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@ApplicationScoped
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BookStoreRequestFilter &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ContainerRequestFilter {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ResourceInfo resourceInfo;
    
    @Context 
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setResourceInfo(ResourceInfo resourceInfo) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.resourceInfo = resourceInfo;
    }
    
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void filter(ContainerRequestContext requestContext) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-comment&quot;&gt;// Contextual instances should be injected independently
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (resourceInfo == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || resourceInfo.getResourceMethod() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            requestContext.abortWith(Response.serverError().build());
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The work related to CXF injection refactoring is tracked under &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7571&quot; title=&quot; Revamp of the CXF injection implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7571&quot;&gt;&lt;del&gt;CXF-7571&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13112897">CXF-7544</key>
            <summary>Support @Context-based injection into proxied CDI beans</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="reta">Andriy Redko</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Oct 2017 17:57:19 +0000</created>
                <updated>Wed, 14 Aug 2019 17:25:50 +0000</updated>
                            <resolved>Mon, 27 Nov 2017 12:08:44 +0000</resolved>
                                    <version>3.1.13</version>
                    <version>3.2.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16224118" author="romain.manni-bucau" created="Sun, 29 Oct 2017 18:09:26 +0000"  >&lt;p&gt;Think we also have the case of a standard provider with @Context as constructor param but @Inject fields (so the bean is not a cdi bean but uses cdi beans)&lt;/p&gt;</comment>
                            <comment id="16224128" author="johndament" created="Sun, 29 Oct 2017 18:22:19 +0000"  >&lt;p&gt;Does it happen even with the CDIClassUnwrapper in use?&lt;/p&gt;</comment>
                            <comment id="16224157" author="romain.manni-bucau" created="Sun, 29 Oct 2017 19:34:45 +0000"  >&lt;p&gt;Yes cause issue is ot only the model but also the instance used. Can need an AroundConstruct to be solved properly.&lt;/p&gt;</comment>
                            <comment id="16251196" author="sergey_beryozkin" created="Tue, 14 Nov 2017 10:25:31 +0000"  >&lt;p&gt;Hi Andriy, &lt;br/&gt;
Can you please first check if a CDIClassUnwrapper idea works as suggested by John ?&lt;/p&gt;

&lt;p&gt;FYI, in case of Spring proxies, I&apos;ve been always recommending users to simply create an interface, example, with the code above in mind, it would be something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Injectable {
  @Context
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; setResourceInfo(ResourceInfo resourceInfo);
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BookStoreRequestFilter &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ContainerRequestFilter, Injectable {
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ResourceInfo resourceInfo;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; setResourceInfo(ResourceInfo resourceInfo) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.resourceInfo = resourceInfo;
    }
    
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and it has always worked, the interfaces are always retained during the proxification. Can you try this as well ?&lt;/p&gt;

&lt;p&gt;Seeing a POC branch would be interesting &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, and indeed having the CXF JAX-RS itself not to deal with the injection &apos;manually&apos; would be nice, though I agree it is the kind of change that perhaps should go to the next/new CXF master &lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="16251272" author="reta" created="Tue, 14 Nov 2017 11:38:31 +0000"  >&lt;p&gt;Hey Sergey,&lt;/p&gt;

&lt;p&gt;Yeah, I think the interface would be helpful but it is more like a workaround. The CDIClassUnwrapper is useful indeed, I am relying on it in the solution I have, will send the PR shortly just to get some feedback from you guys. However, the CDIClassUnwrapper does not solve the problem. Here is the flow I am observing in case of simple filter from the description of this issue. &lt;/p&gt;

&lt;p&gt;1. The ServerProviderFactory creates the provider instance -&amp;gt; this is just a proxy at the moment&lt;br/&gt;
2. The request comes in, ServerProviderFactory runs request filters -&amp;gt; this is were the instance behind the proxy is instantiated and injection happens (and we would never have direct access to it from CXF side)&lt;/p&gt;

&lt;p&gt;So basically the issue I am solving is this: when CDI creates the instance of the bean (corresponding to providers), try to trace it back to the ProviderInfo through the ServerProviderFactory and inject the contextual properties. Hope it make sense &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;Best Regards,&lt;br/&gt;
    Andriy Redko&lt;/p&gt;</comment>
                            <comment id="16251274" author="sergey_beryozkin" created="Tue, 14 Nov 2017 11:42:50 +0000"  >&lt;p&gt;Hi Andriy&lt;/p&gt;

&lt;p&gt;Would it lead though to new callback interfaces/etc ? I&apos;d have no probs with asking users to create interfaces. Though lets see your PR &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16251277" author="sergey_beryozkin" created="Tue, 14 Nov 2017 11:45:24 +0000"  >&lt;p&gt;In general, rather than trying to add various add-ons in the CXF JAX-RS core for CDI to inject, I&apos;d consider doing encapsulating the current &apos;manual&apos; code into a default injection strategy and then move on to providing a CDI one, on the next master &lt;/p&gt;</comment>
                            <comment id="16251283" author="reta" created="Tue, 14 Nov 2017 11:50:20 +0000"  >&lt;p&gt;Yes, this is the goal, extract the generic injection strategy which should be easy pluggable into dependency injection frameworks (like CDI) lifecycle. &lt;/p&gt;</comment>
                            <comment id="16251292" author="sergey_beryozkin" created="Tue, 14 Nov 2017 12:01:21 +0000"  >&lt;p&gt;IMHO it should be the other way around, dependency injection framework be pluggable into CXF JAX-RS core. &lt;/p&gt;</comment>
                            <comment id="16251293" author="sergey_beryozkin" created="Tue, 14 Nov 2017 12:04:22 +0000"  >&lt;p&gt;Never mind, I haven;t even seen the PR &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, sorry. &lt;/p&gt;</comment>
                            <comment id="16251357" author="reta" created="Tue, 14 Nov 2017 13:20:13 +0000"  >&lt;p&gt;The game of words &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; but I think we are meaning the same thing. The PR for this issue is much simpler in scope (more like interim fix). &lt;/p&gt;</comment>
                            <comment id="16251374" author="githubbot" created="Tue, 14 Nov 2017 13:37:43 +0000"  >&lt;p&gt;reta opened a new pull request #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The issue pop up as part of &lt;a href=&quot;https://github.com/apache/cxf/pull/330&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/330&lt;/a&gt; discussion. In case when provider / feature / resource is a proxied CDI bean, the contextual class members (annotated with @Context) are not injected.&lt;/p&gt;

&lt;p&gt;   More broadly,iIn some circumstances (like using `@ApplicationScoped` annotation for example) the CDI runtime will create a proxy class for a particular bean. As the result, the CXF side is going to bind the particular provider metadata to this proxy instance. It looks logical and unambiguous.&lt;/p&gt;

&lt;p&gt;   However, the interesting things are happening when CXF will try to inject contextual proxies (`@Context` annotations) into the provider instance. The injections are successful but the target object for them will be the proxy instance (not the real instance behind it). Consequently, at runtime, when the proxy delegates the call to a backing instance, all contextual proxies are null in there (simply put, not set).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251377" author="githubbot" created="Tue, 14 Nov 2017 13:39:42 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344261613&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344261613&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @johnament @sberyozkin @rmannibucau could you guys take a look? The are few things I don&apos;t like (but don&apos;t have a better idea yet how to implement). The PR solves the simplest case with field injection (at the moment).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251392" author="githubbot" created="Tue, 14 Nov 2017 13:46:30 +0000"  >&lt;p&gt;rmannibucau commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344263525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344263525&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @reta did you try implementing it wrapping the bean annotated type (or attributes) to add a CxfInjectionInterceptor annotation binding and implement it with a @AroundConstruct? Should work for all &quot;handlable&quot; cases and looks more or less as complicated as this PR&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251418" author="githubbot" created="Tue, 14 Nov 2017 14:09:54 +0000"  >&lt;p&gt;johnament commented on a change in pull request #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#discussion_r150841179&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#discussion_r150841179&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -22,8 +22,18 @@&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.util.ClassUnwrapper;&lt;/p&gt;

&lt;p&gt;+/**&lt;br/&gt;
+ * Unwraps the CDI proxy classes into real classes.&lt;br/&gt;
+ */&lt;br/&gt;
 class CdiClassUnwrapper implements ClassUnwrapper {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$&lt;br class=&quot;atl-forced-newline&quot; /&gt;$.+Proxy&quot;);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Known proxy patterns for OWB and Weld:&lt;br/&gt;
+     * &lt;br/&gt;
+     *  Xxx$$OwbNormalScopeProxy0&lt;br/&gt;
+     *  Xxx$Proxy$_$$_WeldClientProxy&lt;br/&gt;
+     *  &lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$\\$.+Proxy&lt;br class=&quot;atl-forced-newline&quot; /&gt;d*&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   are you sure its always digits on the end?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251431" author="sergey_beryozkin" created="Tue, 14 Nov 2017 14:17:06 +0000"  >&lt;p&gt;Hey Andriy&lt;/p&gt;

&lt;p&gt;First of all thanks for the effort, you are always taking on the tricky issues &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I agree this PR would qualify as an interim solution. I can see the newly added ServerProviderFactory methods are only called from CDI and they do not affect the existing logic of the ServerProviderFactory, so it&apos;s prob safe enough to merge even to 3.2.2-SNAPSHOT with the expectations that these ServerProviderFactory callback methods will be eventually gone.&lt;/p&gt;

&lt;p&gt;That said, I&apos;d not hesitate to use another interim solution till a new master opening soon enough, which us doing nothing and asking users do the interfaces &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, it works and thus is quite reasonable.&lt;/p&gt;

&lt;p&gt;With the new master opening, I&apos;d propose starting with a strategy approach along these lines: CXF JAX-RS submits all the valid ClassResourceInfos to InjectionStrategy. It won&apos;t CDI/etc calling back, it will be CXF asking the strategy to inject onto a provided set of classes. As I said the default one will do what is done now, it will check @Context (fields/constructors) and if it can see it it will inject. CDI will instead will also check @Inject and may also delegate to the default one otherwise, etc. We&apos;ll have a lot of time to do it right on the new master. I believe Jersey is doing @Inject of standard JAX-RS contexts via a similar mechanisms for a while.   &lt;/p&gt;</comment>
                            <comment id="16251485" author="githubbot" created="Tue, 14 Nov 2017 14:52:59 +0000"  >&lt;p&gt;reta commented on a change in pull request #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#discussion_r150854464&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#discussion_r150854464&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -22,8 +22,18 @@&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.util.ClassUnwrapper;&lt;/p&gt;

&lt;p&gt;+/**&lt;br/&gt;
+ * Unwraps the CDI proxy classes into real classes.&lt;br/&gt;
+ */&lt;br/&gt;
 class CdiClassUnwrapper implements ClassUnwrapper {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$&lt;br class=&quot;atl-forced-newline&quot; /&gt;$.+Proxy&quot;);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Known proxy patterns for OWB and Weld:&lt;br/&gt;
+     * &lt;br/&gt;
+     *  Xxx$$OwbNormalScopeProxy0&lt;br/&gt;
+     *  Xxx$Proxy$_$$_WeldClientProxy&lt;br/&gt;
+     *  &lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$\\$.+Proxy&lt;br class=&quot;atl-forced-newline&quot; /&gt;d*&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I see it consistently on OWB but it may not be always (hereby `\d*` to make this part optional)&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251493" author="githubbot" created="Tue, 14 Nov 2017 14:58:40 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344284976&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344284976&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @rmannibucau Yes, I tried this approach first thing (and would very likely complement this PR to handle the `@Context` arguments in constructors). The issue I hit hard is that I couldn&apos;t trace back the `ServerProviderFactory` to use for constructor injection &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Plus, the `InvocationContext::target` is set to `null` so I don&apos;t have access to the instance being constructed (very likely because is being constructed indeed).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251494" author="githubbot" created="Tue, 14 Nov 2017 14:59:24 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344284976&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344284976&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @rmannibucau Yes, I tried this approach first thing (and would very likely complement this PR to handle the `@Context` arguments in constructors). The issue I hit hard is that I couldn&apos;t trace back the `ServerProviderFactory` to use for constructor injection &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Plus, the `InvocationContext::target` is set to `null` so I don&apos;t have access to the instance being constructed (very likely because &#1096;&#1077; is being constructed indeed).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251495" author="githubbot" created="Tue, 14 Nov 2017 14:59:30 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344284976&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344284976&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @rmannibucau Yes, I tried this approach first thing (and would very likely complement this PR to handle the `@Context` arguments in constructors). The issue I hit hard is that I couldn&apos;t trace back the `ServerProviderFactory` to use for constructor injection &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Plus, the `InvocationContext::target` is set to `null` so I don&apos;t have access to the instance being constructed (very likely because it is being constructed indeed).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251498" author="githubbot" created="Tue, 14 Nov 2017 15:00:32 +0000"  >&lt;p&gt;rmannibucau commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344285631&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344285631&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   You should have the instance after having called proceed normally if you return an Object, no? - or just use a lazy init in @AroundInvoke even if less elegant.&lt;/p&gt;

&lt;p&gt;   If you add an interceptor in the JAXRSCdiExtension you can pass to the interceptor the ServerProviderfactory and be contextual without any later lookup.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251622" author="githubbot" created="Tue, 14 Nov 2017 16:10:49 +0000"  >&lt;p&gt;johnament commented on a change in pull request #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#discussion_r150880615&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#discussion_r150880615&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -22,8 +22,18 @@&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.util.ClassUnwrapper;&lt;/p&gt;

&lt;p&gt;+/**&lt;br/&gt;
+ * Unwraps the CDI proxy classes into real classes.&lt;br/&gt;
+ */&lt;br/&gt;
 class CdiClassUnwrapper implements ClassUnwrapper {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$&lt;br class=&quot;atl-forced-newline&quot; /&gt;$.+Proxy&quot;);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Known proxy patterns for OWB and Weld:&lt;br/&gt;
+     * &lt;br/&gt;
+     *  Xxx$$OwbNormalScopeProxy0&lt;br/&gt;
+     *  Xxx$Proxy$_$$_WeldClientProxy&lt;br/&gt;
+     *  &lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$\\$.+Proxy&lt;br class=&quot;atl-forced-newline&quot; /&gt;d*&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   should it perhaps then be `.*`&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251945" author="githubbot" created="Tue, 14 Nov 2017 18:53:02 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344359630&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344359630&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @rmannibucau Thank a lot for the advice, I will try the implementation with `@AroundInvoke`, the `ServerProviderfactory` sadly is not a singleton but per-factory bean (so there could be more than one) ... Anyway, this is something very CXFy, figuring out the way to do that &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251947" author="githubbot" created="Tue, 14 Nov 2017 18:53:19 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344359630&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344359630&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @rmannibucau Thank a lot for the advice, I will retry the implementation with `@AroundInvoke`, the `ServerProviderfactory` sadly is not a singleton but per-factory bean (so there could be more than one) ... Anyway, this is something very CXFy, figuring out the way to do that &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16251953" author="githubbot" created="Tue, 14 Nov 2017 18:54:45 +0000"  >&lt;p&gt;reta commented on a change in pull request #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#discussion_r150928467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#discussion_r150928467&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -22,8 +22,18 @@&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.util.ClassUnwrapper;&lt;/p&gt;

&lt;p&gt;+/**&lt;br/&gt;
+ * Unwraps the CDI proxy classes into real classes.&lt;br/&gt;
+ */&lt;br/&gt;
 class CdiClassUnwrapper implements ClassUnwrapper {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$&lt;br class=&quot;atl-forced-newline&quot; /&gt;$.+Proxy&quot;);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Known proxy patterns for OWB and Weld:&lt;br/&gt;
+     * &lt;br/&gt;
+     *  Xxx$$OwbNormalScopeProxy0&lt;br/&gt;
+     *  Xxx$Proxy$_$$_WeldClientProxy&lt;br/&gt;
+     *  &lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$\\$.+Proxy&lt;br class=&quot;atl-forced-newline&quot; /&gt;d*&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Hm ... not sure,`\d*` could be explained (and I have example for it), .* not sure .... &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16253430" author="githubbot" created="Wed, 15 Nov 2017 13:27:54 +0000"  >&lt;p&gt;reta commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344591904&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344591904&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Better solution is required, closing &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16253431" author="githubbot" created="Wed, 15 Nov 2017 13:27:55 +0000"  >&lt;p&gt;reta closed pull request #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java b/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
index c32e6690981..ac54da90535 100644&lt;br/&gt;
&amp;#8212; a/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
+++ b/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
@@ -22,8 +22,18 @@&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.util.ClassUnwrapper;&lt;/p&gt;

&lt;p&gt;+/**&lt;br/&gt;
+ * Unwraps the CDI proxy classes into real classes.&lt;br/&gt;
+ */&lt;br/&gt;
 class CdiClassUnwrapper implements ClassUnwrapper {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$&lt;br class=&quot;atl-forced-newline&quot; /&gt;$.+Proxy&quot;);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Known proxy patterns for OWB and Weld:&lt;br/&gt;
+     * &lt;br/&gt;
+     *  Xxx$$OwbNormalScopeProxy0&lt;br/&gt;
+     *  Xxx$Proxy$_$$_WeldClientProxy&lt;br/&gt;
+     *  &lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$\\$.+Proxy&lt;br class=&quot;atl-forced-newline&quot; /&gt;d*&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     CdiClassUnwrapper() {&lt;/p&gt;

&lt;p&gt;diff --git a/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java b/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java&lt;br/&gt;
index ce23e1a924c..823ae5e8291 100644&lt;br/&gt;
&amp;#8212; a/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java&lt;br/&gt;
+++ b/integration/cdi/src/main/java/org/apache/cxf/cdi/JAXRSCdiResourceExtension.java&lt;br/&gt;
@@ -27,6 +27,7 @@&lt;br/&gt;
 import java.util.ServiceLoader;&lt;br/&gt;
 import java.util.Set;&lt;/p&gt;

&lt;p&gt;+import javax.enterprise.context.ApplicationScoped;&lt;br/&gt;
 import javax.enterprise.context.spi.CreationalContext;&lt;br/&gt;
 import javax.enterprise.event.Observes;&lt;br/&gt;
 import javax.enterprise.inject.spi.AfterBeanDiscovery;&lt;br/&gt;
@@ -38,10 +39,13 @@&lt;br/&gt;
 import javax.enterprise.inject.spi.Extension;&lt;br/&gt;
 import javax.enterprise.inject.spi.InjectionTarget;&lt;br/&gt;
 import javax.enterprise.inject.spi.ProcessBean;&lt;br/&gt;
+import javax.enterprise.inject.spi.ProcessInjectionTarget;&lt;br/&gt;
 import javax.enterprise.inject.spi.ProcessProducerField;&lt;br/&gt;
 import javax.enterprise.inject.spi.ProcessProducerMethod;&lt;br/&gt;
 import javax.ws.rs.ApplicationPath;&lt;br/&gt;
 import javax.ws.rs.Path;&lt;br/&gt;
+import javax.ws.rs.container.ContainerRequestFilter;&lt;br/&gt;
+import javax.ws.rs.container.ContainerResponseFilter;&lt;br/&gt;
 import javax.ws.rs.core.Application;&lt;br/&gt;
 import javax.ws.rs.ext.MessageBodyReader;&lt;br/&gt;
 import javax.ws.rs.ext.MessageBodyWriter;&lt;br/&gt;
@@ -51,6 +55,7 @@&lt;br/&gt;
 import org.apache.cxf.bus.extension.ExtensionManagerBus;&lt;br/&gt;
 import org.apache.cxf.cdi.event.DisposableCreationalContext;&lt;br/&gt;
 import org.apache.cxf.cdi.extension.JAXRSServerFactoryCustomizationExtension;&lt;br/&gt;
+import org.apache.cxf.cdi.inject.ContextInjectionTarget;&lt;br/&gt;
 import org.apache.cxf.feature.Feature;&lt;br/&gt;
 import org.apache.cxf.jaxrs.JAXRSServerFactoryBean;&lt;br/&gt;
 import org.apache.cxf.jaxrs.provider.ServerConfigurableFactory;&lt;br/&gt;
@@ -122,6 +127,21 @@ public void addResourceProvider(final CdiResourceProvider other) {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    public &amp;lt;X&amp;gt; void processInjectionTarget(@Observes final ProcessInjectionTarget&amp;lt;X&amp;gt; target, &lt;br/&gt;
+            final BeanManager beanManager) {&lt;br/&gt;
+        &lt;br/&gt;
+        final InjectionTarget&amp;lt;X&amp;gt; injectionTarget = target.getInjectionTarget();&lt;br/&gt;
+        final AnnotatedType&amp;lt;X&amp;gt; type = target.getAnnotatedType();&lt;br/&gt;
+        &lt;br/&gt;
+        // The beans annotated with @ApplicationScoped will be very likely proxified.&lt;br/&gt;
+        boolean isApplicationScoped = type.isAnnotationPresent(ApplicationScoped.class);&lt;br/&gt;
+        if (isApplicationScoped &amp;amp;&amp;amp; isProvider(type)) &lt;/p&gt;
{
+            // Limit the scope to providers for now
+            final InjectionTarget&amp;lt;X&amp;gt; contextual = new ContextInjectionTarget&amp;lt;&amp;gt;(injectionTarget, type.getJavaClass());
+            target.setInjectionTarget(contextual);
+        }
&lt;p&gt;+    }&lt;br/&gt;
+    &lt;br/&gt;
     public &amp;lt;T, X&amp;gt; void collect(@Observes final ProcessProducerField&amp;lt; T, X &amp;gt; event) &lt;/p&gt;
{
         final Type baseType = event.getAnnotatedProducerField().getBaseType();
         processProducer(event, baseType);
@@ -421,4 +441,16 @@ private void customize(final BeanManager beanManager, final JAXRSServerFactoryBe
         }
&lt;p&gt;     }&lt;/p&gt;

&lt;p&gt;+    /**&lt;br/&gt;
+     * Tries to detect of a particular annotated type corresponds to provider&lt;br/&gt;
+     * @param type annotated type &lt;br/&gt;
+     * @return &quot;true&quot; if annotated type corresponds to provider, &quot;false&quot; otherwise&lt;br/&gt;
+     */&lt;br/&gt;
+    private boolean isProvider(final AnnotatedType&amp;lt;?&amp;gt; type) &lt;/p&gt;
{
+        return type.isAnnotationPresent(Provider.class) 
+            || ContainerRequestFilter.class.isAssignableFrom(type.getJavaClass()) 
+            || ContainerResponseFilter.class.isAssignableFrom(type.getJavaClass()) 
+            || MessageBodyWriter.class.isAssignableFrom(type.getJavaClass()) 
+            || MessageBodyReader.class.isAssignableFrom(type.getJavaClass());
+    }
&lt;p&gt; }&lt;br/&gt;
diff --git a/integration/cdi/src/main/java/org/apache/cxf/cdi/inject/ContextInjectionTarget.java b/integration/cdi/src/main/java/org/apache/cxf/cdi/inject/ContextInjectionTarget.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..ca6ac2c3820&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/integration/cdi/src/main/java/org/apache/cxf/cdi/inject/ContextInjectionTarget.java&lt;br/&gt;
@@ -0,0 +1,76 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.cdi.inject;&lt;br/&gt;
+&lt;br/&gt;
+import java.util.Set;&lt;br/&gt;
+&lt;br/&gt;
+import javax.enterprise.context.spi.CreationalContext;&lt;br/&gt;
+import javax.enterprise.inject.spi.InjectionPoint;&lt;br/&gt;
+import javax.enterprise.inject.spi.InjectionTarget;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.jaxrs.provider.ServerProviderFactory;&lt;br/&gt;
+import org.apache.cxf.message.Message;&lt;br/&gt;
+import org.apache.cxf.phase.PhaseInterceptorChain;&lt;br/&gt;
+&lt;br/&gt;
+public final class ContextInjectionTarget&amp;lt;X&amp;gt; implements InjectionTarget&amp;lt;X&amp;gt; {&lt;br/&gt;
+    private final InjectionTarget&amp;lt;X&amp;gt; delegate;&lt;br/&gt;
+    private final Class&amp;lt;?&amp;gt; providerClass;&lt;br/&gt;
+    &lt;br/&gt;
+    public ContextInjectionTarget(final InjectionTarget&amp;lt;X&amp;gt; delegate, final Class&amp;lt;?&amp;gt; providerClass) &lt;/p&gt;
{
+        this.delegate = delegate;
+        this.providerClass = providerClass;
+    }
&lt;p&gt;+    &lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void inject(X instance, CreationalContext&amp;lt;X&amp;gt; ctx) {&lt;br/&gt;
+        delegate.inject(instance, ctx);&lt;br/&gt;
+        &lt;br/&gt;
+        final Message message = PhaseInterceptorChain.getCurrentMessage();&lt;br/&gt;
+        if (message != null) &lt;/p&gt;
{
+            final ServerProviderFactory factory = ServerProviderFactory.getInstance(message);
+            factory.injectContextProxiesIntoProvider(providerClass, instance);
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void postConstruct(X instance) &lt;/p&gt;
{
+        delegate.postConstruct(instance);
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void preDestroy(X instance) &lt;/p&gt;
{
+        delegate.dispose(instance);
+    }&lt;br/&gt;
+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void dispose(X instance) {+        delegate.dispose(instance);+    }
&lt;p&gt;+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public Set&amp;lt;InjectionPoint&amp;gt; getInjectionPoints() &lt;/p&gt;
{
+        return delegate.getInjectionPoints();
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public X produce(CreationalContext&amp;lt;X&amp;gt; ctx) &lt;/p&gt;
{
+        return delegate.produce(ctx);
+    }
&lt;p&gt;+}&lt;br/&gt;
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
index dda7ee290d3..fff727237fc 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
@@ -24,6 +24,7 @@&lt;br/&gt;
 import java.util.Collection;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
 import java.util.HashMap;&lt;br/&gt;
+import java.util.HashSet;&lt;br/&gt;
 import java.util.LinkedHashSet;&lt;br/&gt;
 import java.util.LinkedList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
@@ -49,6 +50,7 @@&lt;br/&gt;
 import org.apache.cxf.Bus;&lt;br/&gt;
 import org.apache.cxf.BusFactory;&lt;br/&gt;
 import org.apache.cxf.common.util.ClassHelper;&lt;br/&gt;
+import org.apache.cxf.common.util.ClassUnwrapper;&lt;br/&gt;
 import org.apache.cxf.endpoint.Endpoint;&lt;br/&gt;
 import org.apache.cxf.helpers.CastUtils;&lt;br/&gt;
 import org.apache.cxf.jaxrs.impl.ConfigurableImpl;&lt;br/&gt;
@@ -269,6 +271,32 @@ protected void setProviders(boolean custom, boolean busGlobal, Object... provide&lt;br/&gt;
             containerResponseFilters.values());&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    /**&lt;br/&gt;
+     * Injects the context proxies into the provider identified by a particular &lt;br/&gt;
+     * provider class, using the provider instance supplied. This method is used when&lt;br/&gt;
+     * the instance inside ProviderInfo class is pointing out to proxy, not a real class&lt;br/&gt;
+     * instance. In this case the contextual properties are not injected properly&lt;br/&gt;
+     * (f.e. in case of CDI).&lt;br/&gt;
+     * @param providerClass provider class&lt;br/&gt;
+     * @param instance provider instance&lt;br/&gt;
+     */&lt;br/&gt;
+    public void injectContextProxiesIntoProvider(Class&amp;lt;?&amp;gt; providerClass, Object instance) {&lt;br/&gt;
+        final ClassUnwrapper unwrapper = (ClassUnwrapper)getBus().getProperty(ClassUnwrapper.class.getName());&lt;br/&gt;
+        &lt;br/&gt;
+        final Collection&amp;lt;ProviderInfo&amp;lt;?&amp;gt;&amp;gt; infos = findProviderByClass(unwrapper, providerClass,&lt;br/&gt;
+            exceptionMappers, postMatchContainerRequestFilters.values(), &lt;br/&gt;
+                preMatchContainerRequestFilters, containerResponseFilters.values());&lt;br/&gt;
+        &lt;br/&gt;
+        // We may end up with a multiple providers but we don&apos;t know exactly which one&lt;br/&gt;
+        // is being referenced by provider class.&lt;br/&gt;
+        for (final ProviderInfo&amp;lt;?&amp;gt; info: infos) {&lt;br/&gt;
+            if (info.contextsAvailable()) &lt;/p&gt;
{
+                InjectionUtils.injectContextProxiesAndApplication(info, instance, 
+                    application == null ? null : application.getProvider(), this);
+            }
&lt;p&gt;+        }&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     @Override&lt;br/&gt;
     protected void injectContextProxiesIntoProvider(ProviderInfo&amp;lt;?&amp;gt; pi) {&lt;br/&gt;
         injectContextProxiesIntoProvider(pi, application == null ? null : application.getProvider());&lt;br/&gt;
@@ -602,4 +630,28 @@ public int compare(ProviderInfo&amp;lt;?&amp;gt; p1, ProviderInfo&amp;lt;?&amp;gt; p2) {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    /**&lt;br/&gt;
+     * Finds the providers which correspond to a particular provider class. &lt;br/&gt;
+     */&lt;br/&gt;
+    protected Collection&amp;lt;ProviderInfo&amp;lt;?&amp;gt;&amp;gt; findProviderByClass(final ClassUnwrapper unwrapper, &lt;br/&gt;
+            final Class&amp;lt;?&amp;gt; providerClass, final Collection&amp;lt;?&amp;gt; ... providerLists) {&lt;br/&gt;
+        &lt;br/&gt;
+        final Set&amp;lt;ProviderInfo&amp;lt;?&amp;gt;&amp;gt; providers = new HashSet&amp;lt;&amp;gt;();&lt;br/&gt;
+        &lt;br/&gt;
+        for (final Collection&amp;lt;?&amp;gt; list: providerLists) {&lt;br/&gt;
+            final Collection&amp;lt;ProviderInfo&amp;lt;?&amp;gt;&amp;gt; l2 = CastUtils.cast(list);&lt;br/&gt;
+            &lt;br/&gt;
+            for (final ProviderInfo&amp;lt;?&amp;gt; pi : l2) {&lt;br/&gt;
+                final Class&amp;lt;?&amp;gt; clazz = (unwrapper != null) &lt;br/&gt;
+                    ? unwrapper.getRealClass(pi.getProvider())&lt;br/&gt;
+                        : pi.getProvider().getClass();&lt;br/&gt;
+                    &lt;br/&gt;
+                if (providerClass.equals(clazz)) &lt;/p&gt;
{
+                    providers.add(pi);
+                }
&lt;p&gt;+            }&lt;br/&gt;
+        }&lt;br/&gt;
+        &lt;br/&gt;
+        return providers;&lt;br/&gt;
+    }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStorePreMatchingRequestFilter.java b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStorePreMatchingRequestFilter.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..7f82b284a46&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStorePreMatchingRequestFilter.java&lt;br/&gt;
@@ -0,0 +1,43 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.systests.cdi.base;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+&lt;br/&gt;
+import javax.enterprise.context.ApplicationScoped;&lt;br/&gt;
+import javax.ws.rs.container.ContainerRequestContext;&lt;br/&gt;
+import javax.ws.rs.container.ContainerRequestFilter;&lt;br/&gt;
+import javax.ws.rs.container.PreMatching;&lt;br/&gt;
+import javax.ws.rs.core.Context;&lt;br/&gt;
+import javax.ws.rs.core.Response;&lt;br/&gt;
+import javax.ws.rs.core.UriInfo;&lt;br/&gt;
+&lt;br/&gt;
+@ApplicationScoped @PreMatching&lt;br/&gt;
+public class BookStorePreMatchingRequestFilter implements ContainerRequestFilter {&lt;br/&gt;
+    @Context private UriInfo uriInfo;&lt;br/&gt;
+    &lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void filter(ContainerRequestContext requestContext) throws IOException {&lt;br/&gt;
+        // Contextual instances should be injected independently&lt;br/&gt;
+        if (uriInfo == null || uriInfo.getBaseUri() == null) &lt;/p&gt;
{
+            requestContext.abortWith(Response.serverError().entity(&quot;uriInfo is not set&quot;).build());
+        }
&lt;p&gt;+    }&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
index 309a5ea3a99..9aa26384c81 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
+++ b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
@@ -32,6 +32,7 @@ public boolean configure(FeatureContext context) &lt;/p&gt;
{
         context.register(AtomFeedProvider.class);
         context.register(BookStoreRequestFilter.class);
         context.register(BookStoreResponseFilter.class);
+        context.register(SampleNestedFeature.class);
         return false;
     }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..4e1e47ce7f6&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
@@ -0,0 +1,33 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs.cdi;&lt;br/&gt;
+&lt;br/&gt;
+import javax.ws.rs.core.Feature;&lt;br/&gt;
+import javax.ws.rs.core.FeatureContext;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStorePreMatchingRequestFilter;&lt;br/&gt;
+&lt;br/&gt;
+public class SampleNestedFeature implements Feature {&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public boolean configure(FeatureContext context) {
+        context.register(BookStorePreMatchingRequestFilter.class);
+        return false;
+    }&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
index 309a5ea3a99..9aa26384c81 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
+++ b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
@@ -32,6 +32,7 @@ public boolean configure(FeatureContext context) {         context.register(AtomFeedProvider.class);         context.register(BookStoreRequestFilter.class);         context.register(BookStoreResponseFilter.class);+        context.register(SampleNestedFeature.class);         return false;     }
&lt;p&gt; }&lt;br/&gt;
diff --git a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..4e1e47ce7f6&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
@@ -0,0 +1,33 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs.cdi;&lt;br/&gt;
+&lt;br/&gt;
+import javax.ws.rs.core.Feature;&lt;br/&gt;
+import javax.ws.rs.core.FeatureContext;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStorePreMatchingRequestFilter;&lt;br/&gt;
+&lt;br/&gt;
+public class SampleNestedFeature implements Feature {&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public boolean configure(FeatureContext context) &lt;/p&gt;
{
+        context.register(BookStorePreMatchingRequestFilter.class);
+        return false;
+    }
&lt;p&gt;+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16253597" author="githubbot" created="Wed, 15 Nov 2017 15:20:09 +0000"  >&lt;p&gt;sberyozkin commented on issue #339: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/339#issuecomment-344625021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/339#issuecomment-344625021&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Not my fault this PR has been closed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16254469" author="reta" created="Wed, 15 Nov 2017 23:46:26 +0000"  >&lt;p&gt;No no, not your fault &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;sergey_beryozkin&lt;/a&gt; :-D, I think the different approach with @AroundInvoke would be much safer and better option. It would be quite different from the current one, I think would be better to have a new PR for it.&lt;/p&gt;</comment>
                            <comment id="16265847" author="githubbot" created="Sat, 25 Nov 2017 20:46:34 +0000"  >&lt;p&gt;reta opened a new pull request #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The issue pop up as part of #330 discussion. In case when provider / feature / resource is a proxied CDI bean, the contextual class members (annotated with @context) are not injected.&lt;/p&gt;

&lt;p&gt;   More broadly, in some circumstances (like using @ApplicationScoped annotation for example) the CDI runtime will create a proxy class for a particular bean. As the result, the CXF side is going to bind the particular provider metadata to this proxy instance. It looks logical and unambiguous.&lt;/p&gt;

&lt;p&gt;   However, the interesting things are happening when CXF will try to inject contextual proxies (@Context annotations) into the provider instance. The injections are successful but the target object for them will be the proxy instance (not the real instance behind it). Consequently, at runtime, when the proxy delegates the call to a backing instance, all contextual proxies are null in there (simply put, not set).&lt;/p&gt;

&lt;p&gt;   @johnament @rmannibucau Addressing the issue requires a significant revamp of the CXF injection mechanism, it is turned out to be hard to solve even with `@AroundConstruct` or, previously, provifing custom `@Context` injectors. The good news is that the field-based injection could be easily workarounded using setter-based injection. After conversations with @sberyozkin, we decided that encapsulating CXF injection implementation and than delegating the hard work to appropriate strategy (CDI, Spring, ...) would be better time investment than trying to patch the existing one. Since we have simple workaround, it sounds like an acceptable tradeoff (&lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7571&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-7571&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;   This PR fixes the patterns in `CdiClassUnwrapper`, adds tests for it and fixes the `FilterProviderInfo` resource / service class resolution (to match it to the `ProviderInfo`)&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16265848" author="githubbot" created="Sat, 25 Nov 2017 20:48:12 +0000"  >&lt;p&gt;reta commented on a change in pull request #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#discussion_r153054114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#discussion_r153054114&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -211,7 +211,11 @@ protected void setProviders(boolean custom, boolean busGlobal, Object... provide&lt;br/&gt;
                 for (Object featureProvider : cfg.getInstances()) {&lt;br/&gt;
                     Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; contracts = cfg.getContracts(featureProvider.getClass());&lt;br/&gt;
                     if (contracts != null &amp;amp;&amp;amp; !contracts.isEmpty()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;allProviders.add(new FilterProviderInfo&amp;lt;Object&amp;gt;(featureProvider,&lt;br/&gt;
+                        Class&amp;lt;?&amp;gt; providerCls = ClassHelper.getRealClass(getBus(), featureProvider);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Turned out we handle `ProviderInfo` differently than `FilterProviderInfo`, this minors fixes will match the resource and service class resolution.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16265885" author="githubbot" created="Sun, 26 Nov 2017 00:30:54 +0000"  >&lt;p&gt;reta commented on a change in pull request #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#discussion_r153054114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#discussion_r153054114&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -211,7 +211,11 @@ protected void setProviders(boolean custom, boolean busGlobal, Object... provide&lt;br/&gt;
                 for (Object featureProvider : cfg.getInstances()) {&lt;br/&gt;
                     Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; contracts = cfg.getContracts(featureProvider.getClass());&lt;br/&gt;
                     if (contracts != null &amp;amp;&amp;amp; !contracts.isEmpty()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;allProviders.add(new FilterProviderInfo&amp;lt;Object&amp;gt;(featureProvider,&lt;br/&gt;
+                        Class&amp;lt;?&amp;gt; providerCls = ClassHelper.getRealClass(getBus(), featureProvider);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Turned out we handle `ProviderInfo` differently than `FilterProviderInfo`, these minors fixes will match the resource and service class resolution.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266001" author="githubbot" created="Sun, 26 Nov 2017 13:30:01 +0000"  >&lt;p&gt;rmannibucau commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347008794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347008794&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   +1 until &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7571&quot; title=&quot; Revamp of the CXF injection implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7571&quot;&gt;&lt;del&gt;CXF-7571&lt;/del&gt;&lt;/a&gt; is put in place with good defaults.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266686" author="githubbot" created="Mon, 27 Nov 2017 11:46:39 +0000"  >&lt;p&gt;reta closed pull request #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java b/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
index c32e6690981..ac54da90535 100644&lt;br/&gt;
&amp;#8212; a/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
+++ b/integration/cdi/src/main/java/org/apache/cxf/cdi/CdiClassUnwrapper.java&lt;br/&gt;
@@ -22,8 +22,18 @@&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.util.ClassUnwrapper;&lt;/p&gt;

&lt;p&gt;+/**&lt;br/&gt;
+ * Unwraps the CDI proxy classes into real classes.&lt;br/&gt;
+ */&lt;br/&gt;
 class CdiClassUnwrapper implements ClassUnwrapper {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$&lt;br class=&quot;atl-forced-newline&quot; /&gt;$.+Proxy&quot;);&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Known proxy patterns for OWB and Weld:&lt;br/&gt;
+     * &lt;br/&gt;
+     *  Xxx$$OwbNormalScopeProxy0&lt;br/&gt;
+     *  Xxx$Proxy$_$$_WeldClientProxy&lt;br/&gt;
+     *  &lt;br/&gt;
+     */&lt;br/&gt;
+    private static final Pattern PROXY_PATTERN = Pattern.compile(&quot;.+\\$\\$.+Proxy&lt;br class=&quot;atl-forced-newline&quot; /&gt;d*&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     CdiClassUnwrapper() {&lt;/p&gt;

&lt;p&gt;diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java&lt;br/&gt;
index f57401e635b..0f04b5e94c8 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/FilterProviderInfo.java&lt;br/&gt;
@@ -32,18 +32,23 @@&lt;br/&gt;
     private Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; supportedContracts;&lt;br/&gt;
     private boolean dynamic;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public FilterProviderInfo(T provider,&lt;br/&gt;
+    public FilterProviderInfo(Class&amp;lt;?&amp;gt; resourceClass, &lt;br/&gt;
+                              Class&amp;lt;?&amp;gt; serviceClass,&lt;br/&gt;
+                              T provider,&lt;br/&gt;
                               Bus bus,&lt;br/&gt;
                               Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; supportedContracts) 
{
-        this(provider, bus, ProviderFactory.DEFAULT_FILTER_NAME_BINDING, false, supportedContracts);
+        this(resourceClass, serviceClass, provider, bus, ProviderFactory.DEFAULT_FILTER_NAME_BINDING, 
+            false, supportedContracts);
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public FilterProviderInfo(T provider,&lt;br/&gt;
+    public FilterProviderInfo(Class&amp;lt;?&amp;gt; resourceClass, &lt;br/&gt;
+                              Class&amp;lt;?&amp;gt; serviceClass,&lt;br/&gt;
+                              T provider,&lt;br/&gt;
                               Bus bus,&lt;br/&gt;
                               String nameBinding,&lt;br/&gt;
                               boolean dynamic,&lt;br/&gt;
                               Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; supportedContracts) {&lt;/li&gt;
	&lt;li&gt;super(provider, bus, true);&lt;br/&gt;
+        super(resourceClass, serviceClass, provider, bus, true);&lt;br/&gt;
         this.nameBinding = Collections.singleton(nameBinding);&lt;br/&gt;
         this.supportedContracts = supportedContracts;&lt;br/&gt;
         this.dynamic = dynamic;&lt;br/&gt;
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ProviderInfo.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ProviderInfo.java&lt;br/&gt;
index 234a76091e9..73e7147b482 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ProviderInfo.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ProviderInfo.java&lt;br/&gt;
@@ -35,7 +35,16 @@ public ProviderInfo(T provider, Bus bus, boolean custom) {&lt;br/&gt;
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     public ProviderInfo(T provider, Bus bus, boolean checkContexts, boolean custom) &lt;/p&gt;
{
-        this(provider, null, bus, checkContexts, custom);
+        this(provider.getClass(), provider.getClass(), provider, bus, true, custom);
+    }
&lt;p&gt;+&lt;br/&gt;
+    public ProviderInfo(Class&amp;lt;?&amp;gt; resourceClass, Class&amp;lt;?&amp;gt; serviceClass, T provider, Bus bus, boolean custom) &lt;/p&gt;
{
+        this(resourceClass, serviceClass, provider, bus, true, custom);
+    }
&lt;p&gt;+&lt;br/&gt;
+    public ProviderInfo(Class&amp;lt;?&amp;gt; resourceClass, Class&amp;lt;?&amp;gt; serviceClass, T provider, Bus bus, &lt;br/&gt;
+            boolean checkContexts, boolean custom) &lt;/p&gt;
{
+        this(resourceClass, serviceClass, provider, null, bus, checkContexts, custom);
     }

&lt;p&gt;     public ProviderInfo(T provider,&lt;br/&gt;
@@ -45,14 +54,24 @@ public ProviderInfo(T provider,&lt;br/&gt;
         this(provider, constructorProxies, bus, true, custom);&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;+    public ProviderInfo(Class&amp;lt;?&amp;gt; resourceClass, &lt;br/&gt;
+            Class&amp;lt;?&amp;gt; serviceClass,&lt;br/&gt;
+            T provider,&lt;br/&gt;
+            Map&amp;lt;Class&amp;lt;?&amp;gt;, ThreadLocalProxy&amp;lt;?&amp;gt;&amp;gt; constructorProxies,&lt;br/&gt;
+            Bus bus,&lt;br/&gt;
+            boolean checkContexts,&lt;br/&gt;
+            boolean custom) &lt;/p&gt;
{
+        super(resourceClass, serviceClass, true, checkContexts, constructorProxies, bus, provider);
+        this.provider = provider;
+        this.custom = custom;
+    }
&lt;p&gt;+&lt;br/&gt;
     public ProviderInfo(T provider,&lt;br/&gt;
                         Map&amp;lt;Class&amp;lt;?&amp;gt;, ThreadLocalProxy&amp;lt;?&amp;gt;&amp;gt; constructorProxies,&lt;br/&gt;
                         Bus bus,&lt;br/&gt;
                         boolean checkContexts,&lt;br/&gt;
                         boolean custom) &lt;/p&gt;
{
-        super(provider.getClass(), provider.getClass(), true, checkContexts, constructorProxies, bus, provider);
-        this.provider = provider;
-        this.custom = custom;
+        this(provider.getClass(), provider.getClass(), provider, constructorProxies, bus, checkContexts, custom);
     }

&lt;p&gt;     @Override&lt;br/&gt;
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
index dda7ee290d3..2e859009012 100644&lt;br/&gt;
&amp;#8212; a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java&lt;br/&gt;
@@ -211,7 +211,11 @@ protected void setProviders(boolean custom, boolean busGlobal, Object... provide&lt;br/&gt;
                 for (Object featureProvider : cfg.getInstances()) {&lt;br/&gt;
                     Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; contracts = cfg.getContracts(featureProvider.getClass());&lt;br/&gt;
                     if (contracts != null &amp;amp;&amp;amp; !contracts.isEmpty()) &lt;/p&gt;
{
-                        allProviders.add(new FilterProviderInfo&amp;lt;Object&amp;gt;(featureProvider,
+                        Class&amp;lt;?&amp;gt; providerCls = ClassHelper.getRealClass(getBus(), featureProvider);
+                        
+                        allProviders.add(new FilterProviderInfo&amp;lt;Object&amp;gt;(featureProvider.getClass(),
+                                                                        providerCls,
+                                                                        featureProvider,
                                                                         getBus(),
                                                                         contracts));
                     }
&lt;p&gt; else {&lt;br/&gt;
@@ -373,7 +377,10 @@ private void doApplyDynamicFeatures(ClassResourceInfo cri) {&lt;br/&gt;
                 for (Object provider : cfg.getInstances()) {&lt;br/&gt;
                     Map&amp;lt;Class&amp;lt;?&amp;gt;, Integer&amp;gt; contracts = cfg.getContracts(provider.getClass());&lt;br/&gt;
                     if (contracts != null &amp;amp;&amp;amp; !contracts.isEmpty()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;registerUserProvider(new FilterProviderInfo&amp;lt;Object&amp;gt;(provider,&lt;br/&gt;
+                        Class&amp;lt;?&amp;gt; providerCls = ClassHelper.getRealClass(getBus(), provider);&lt;br/&gt;
+                        registerUserProvider(new FilterProviderInfo&amp;lt;Object&amp;gt;(provider.getClass(),&lt;br/&gt;
+                            providerCls,&lt;br/&gt;
+                            provider,&lt;br/&gt;
                             getBus(),&lt;br/&gt;
                             nameBinding,&lt;br/&gt;
                             true,&lt;br/&gt;
@@ -601,5 +608,4 @@ public int compare(ProviderInfo&amp;lt;?&amp;gt; p1, ProviderInfo&amp;lt;?&amp;gt; p2) 
{
             return result;
         }
&lt;p&gt;     }&lt;br/&gt;
-&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientImpl.java b/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientImpl.java&lt;br/&gt;
index 78f45f5d34f..61c465a26f2 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientImpl.java&lt;br/&gt;
+++ b/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/spec/ClientImpl.java&lt;br/&gt;
@@ -39,6 +39,7 @@&lt;br/&gt;
 import javax.ws.rs.core.MediaType;&lt;br/&gt;
 import javax.ws.rs.core.UriBuilder;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+import org.apache.cxf.common.util.ClassHelper;&lt;br/&gt;
 import org.apache.cxf.common.util.SystemPropertyAction;&lt;br/&gt;
 import org.apache.cxf.configuration.jsse.TLSClientParameters;&lt;br/&gt;
 import org.apache.cxf.jaxrs.client.AbstractClient;&lt;br/&gt;
@@ -274,8 +275,9 @@ public Builder request() {&lt;br/&gt;
                     if (contracts == null || contracts.isEmpty()) &lt;/p&gt;
{
                         providers.add(p);
                     }
&lt;p&gt; else &lt;/p&gt;
{
-                        providers.add(
-                            new FilterProviderInfo&amp;lt;Object&amp;gt;(p, pf.getBus(), contracts));
+                        final Class&amp;lt;?&amp;gt; providerCls = ClassHelper.getRealClass(pf.getBus(), p);
+                        providers.add(new FilterProviderInfo&amp;lt;Object&amp;gt;(p.getClass(), 
+                            providerCls, p, pf.getBus(), contracts));
                     }
&lt;p&gt;                 }&lt;br/&gt;
             }&lt;br/&gt;
diff --git a/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStorePreMatchingRequestFilter.java b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStorePreMatchingRequestFilter.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..ec1917837fe&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/base/src/main/java/org/apache/cxf/systests/cdi/base/BookStorePreMatchingRequestFilter.java&lt;br/&gt;
@@ -0,0 +1,48 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.systests.cdi.base;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+&lt;br/&gt;
+import javax.enterprise.context.ApplicationScoped;&lt;br/&gt;
+import javax.ws.rs.container.ContainerRequestContext;&lt;br/&gt;
+import javax.ws.rs.container.ContainerRequestFilter;&lt;br/&gt;
+import javax.ws.rs.container.PreMatching;&lt;br/&gt;
+import javax.ws.rs.core.Context;&lt;br/&gt;
+import javax.ws.rs.core.Response;&lt;br/&gt;
+import javax.ws.rs.core.UriInfo;&lt;br/&gt;
+&lt;br/&gt;
+@ApplicationScoped @PreMatching&lt;br/&gt;
+public class BookStorePreMatchingRequestFilter implements ContainerRequestFilter {&lt;br/&gt;
+    private UriInfo uriInfo;&lt;br/&gt;
+    &lt;br/&gt;
+    @Context &lt;br/&gt;
+    public void setUriInfo(UriInfo uriInfo) &lt;/p&gt;
{
+        this.uriInfo = uriInfo;
+    }
&lt;p&gt;+    &lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void filter(ContainerRequestContext requestContext) throws IOException {&lt;br/&gt;
+        // Contextual instances should be injected independently&lt;br/&gt;
+        if (uriInfo == null || uriInfo.getBaseUri() == null) &lt;/p&gt;
{
+            requestContext.abortWith(Response.serverError().entity(&quot;uriInfo is not set&quot;).build());
+        }
&lt;p&gt;+    }&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/systests/cdi/cdi-owb/cdi-producers-owb/pom.xml b/systests/cdi/cdi-owb/cdi-producers-owb/pom.xml&lt;br/&gt;
index 15f03fde42e..33962487f36 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/cdi-owb/cdi-producers-owb/pom.xml&lt;br/&gt;
+++ b/systests/cdi/cdi-owb/cdi-producers-owb/pom.xml&lt;br/&gt;
@@ -45,5 +45,11 @@&lt;br/&gt;
              &amp;lt;groupId&amp;gt;org.apache.abdera&amp;lt;/groupId&amp;gt;&lt;br/&gt;
              &amp;lt;artifactId&amp;gt;abdera-parser&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
         &amp;lt;/dependency&amp;gt;&lt;br/&gt;
+        &amp;lt;dependency&amp;gt;&lt;br/&gt;
+             &amp;lt;groupId&amp;gt;org.mockito&amp;lt;/groupId&amp;gt;&lt;br/&gt;
+             &amp;lt;artifactId&amp;gt;mockito-core&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
+             &amp;lt;version&amp;gt;2.7.14&amp;lt;/version&amp;gt;&lt;br/&gt;
+             &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br/&gt;
+        &amp;lt;/dependency&amp;gt;&lt;br/&gt;
     &amp;lt;/dependencies&amp;gt;&lt;br/&gt;
 &amp;lt;/project&amp;gt;&lt;br/&gt;
\ No newline at end of file&lt;br/&gt;
diff --git a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
index 309a5ea3a99..9aa26384c81 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
+++ b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
@@ -32,6 +32,7 @@ public boolean configure(FeatureContext context) &lt;/p&gt;
{
         context.register(AtomFeedProvider.class);
         context.register(BookStoreRequestFilter.class);
         context.register(BookStoreResponseFilter.class);
+        context.register(SampleNestedFeature.class);
         return false;
     }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..4e1e47ce7f6&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
@@ -0,0 +1,33 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs.cdi;&lt;br/&gt;
+&lt;br/&gt;
+import javax.ws.rs.core.Feature;&lt;br/&gt;
+import javax.ws.rs.core.FeatureContext;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStorePreMatchingRequestFilter;&lt;br/&gt;
+&lt;br/&gt;
+public class SampleNestedFeature implements Feature {&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public boolean configure(FeatureContext context) {
+        context.register(BookStorePreMatchingRequestFilter.class);
+        return false;
+    }&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/unwrapper/ClassUnwrapperTest.java b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/unwrapper/ClassUnwrapperTest.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..ae8d5732692&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/cdi-owb/cdi-producers-owb/src/test/java/org/apache/cxf/systest/jaxrs/cdi/unwrapper/ClassUnwrapperTest.java&lt;br/&gt;
@@ -0,0 +1,90 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs.cdi.unwrapper;&lt;br/&gt;
+&lt;br/&gt;
+import java.util.Set;&lt;br/&gt;
+&lt;br/&gt;
+import javax.enterprise.inject.spi.Bean;&lt;br/&gt;
+import javax.enterprise.inject.spi.BeanManager;&lt;br/&gt;
+import javax.servlet.ServletContext;&lt;br/&gt;
+import javax.servlet.ServletContextEvent;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.Bus;&lt;br/&gt;
+import org.apache.cxf.common.util.ClassUnwrapper;&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStorePreMatchingRequestFilter;&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStoreRequestFilter;&lt;br/&gt;
+import org.apache.webbeans.config.WebBeansContext;&lt;br/&gt;
+import org.apache.webbeans.spi.ContainerLifecycle;&lt;br/&gt;
+import org.junit.After;&lt;br/&gt;
+import org.junit.Before;&lt;br/&gt;
+import org.junit.Test;&lt;br/&gt;
+&lt;br/&gt;
+import static org.hamcrest.CoreMatchers.equalTo;&lt;br/&gt;
+import static org.hamcrest.CoreMatchers.not;&lt;br/&gt;
+import static org.hamcrest.CoreMatchers.notNullValue;&lt;br/&gt;
+import static org.junit.Assert.assertThat;&lt;br/&gt;
+import static org.mockito.Mockito.mock;&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+public class ClassUnwrapperTest {&lt;br/&gt;
+    private Bus bus;&lt;br/&gt;
+    private ContainerLifecycle lifecycle;&lt;br/&gt;
+    private ServletContextEvent event;&lt;br/&gt;
+    &lt;br/&gt;
+    @Before&lt;br/&gt;
+    public void setUp() {
+        event = new ServletContextEvent(mock(ServletContext.class));
+        lifecycle = WebBeansContext.currentInstance().getService(ContainerLifecycle.class);
+        lifecycle.startApplication(event);
+        bus = getBeanReference(Bus.class);
+    }&lt;br/&gt;
+&lt;br/&gt;
+    @SuppressWarnings(&quot;unchecked&quot;)&lt;br/&gt;
+    private&amp;lt;T&amp;gt; T getBeanReference(Class&amp;lt;T&amp;gt; clazz) {
+        final BeanManager beanManager = lifecycle.getBeanManager();
+        final Set&amp;lt;Bean&amp;lt;?&amp;gt;&amp;gt; beans = beanManager.getBeans(clazz);
+        final Bean&amp;lt;?&amp;gt; bean = beanManager.resolve(beans);
+        return (T)beanManager.getReference(bean, clazz, beanManager.createCreationalContext(bean));
+    }&lt;br/&gt;
+&lt;br/&gt;
+    @After&lt;br/&gt;
+    public void tearDown() {
+        lifecycle.stopApplication(event);
+    }&lt;br/&gt;
+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testProxyClassIsProperlyUnwrapped() {
+        final BookStorePreMatchingRequestFilter filter = getBeanReference(BookStorePreMatchingRequestFilter.class);
+        final ClassUnwrapper unwrapper = (ClassUnwrapper)bus.getProperty(ClassUnwrapper.class.getName());
+        
+        assertThat(unwrapper, notNullValue());
+        assertThat(filter.getClass(), not(equalTo(BookStorePreMatchingRequestFilter.class)));
+        assertThat(unwrapper.getRealClass(filter), equalTo(BookStorePreMatchingRequestFilter.class));
+    }&lt;br/&gt;
+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testRealClassIsProperlyUnwrapped() {
+        final BookStoreRequestFilter filter = getBeanReference(BookStoreRequestFilter.class);
+        final ClassUnwrapper unwrapper = (ClassUnwrapper)bus.getProperty(ClassUnwrapper.class.getName());
+        
+        assertThat(unwrapper, notNullValue());
+        assertThat(filter.getClass(), equalTo(BookStoreRequestFilter.class));
+        assertThat(unwrapper.getRealClass(filter), equalTo(BookStoreRequestFilter.class));
+    }&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/systests/cdi/cdi-weld/cdi-producers-weld/pom.xml b/systests/cdi/cdi-weld/cdi-producers-weld/pom.xml&lt;br/&gt;
index 1ed161a73ad..8f73095e01d 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/cdi-weld/cdi-producers-weld/pom.xml&lt;br/&gt;
+++ b/systests/cdi/cdi-weld/cdi-producers-weld/pom.xml&lt;br/&gt;
@@ -45,5 +45,11 @@&lt;br/&gt;
              &amp;lt;groupId&amp;gt;org.apache.abdera&amp;lt;/groupId&amp;gt;&lt;br/&gt;
              &amp;lt;artifactId&amp;gt;abdera-parser&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
         &amp;lt;/dependency&amp;gt;&lt;br/&gt;
+        &amp;lt;dependency&amp;gt;&lt;br/&gt;
+            &amp;lt;groupId&amp;gt;org.jboss.weld.se&amp;lt;/groupId&amp;gt;&lt;br/&gt;
+            &amp;lt;artifactId&amp;gt;weld-se-core&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
+            &amp;lt;version&amp;gt;${cxf.jboss.weld.version}&amp;lt;/version&amp;gt;&lt;br/&gt;
+            &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br/&gt;
+        &amp;lt;/dependency&amp;gt;&lt;br/&gt;
     &amp;lt;/dependencies&amp;gt;&lt;br/&gt;
 &amp;lt;/project&amp;gt;&lt;br/&gt;
diff --git a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
index 309a5ea3a99..9aa26384c81 100644&lt;br/&gt;
&amp;#8212; a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
+++ b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleFeature.java&lt;br/&gt;
@@ -32,6 +32,7 @@ public boolean configure(FeatureContext context) {         context.register(AtomFeedProvider.class);         context.register(BookStoreRequestFilter.class);         context.register(BookStoreResponseFilter.class);+        context.register(SampleNestedFeature.class);         return false;     }
&lt;p&gt; }&lt;br/&gt;
diff --git a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..4e1e47ce7f6&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/SampleNestedFeature.java&lt;br/&gt;
@@ -0,0 +1,33 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs.cdi;&lt;br/&gt;
+&lt;br/&gt;
+import javax.ws.rs.core.Feature;&lt;br/&gt;
+import javax.ws.rs.core.FeatureContext;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStorePreMatchingRequestFilter;&lt;br/&gt;
+&lt;br/&gt;
+public class SampleNestedFeature implements Feature {&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public boolean configure(FeatureContext context) &lt;/p&gt;
{
+        context.register(BookStorePreMatchingRequestFilter.class);
+        return false;
+    }
&lt;p&gt;+}&lt;br/&gt;
diff --git a/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/unwrapper/ClassUnwrapperTest.java b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/unwrapper/ClassUnwrapperTest.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..74056232e64&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/systests/cdi/cdi-weld/cdi-producers-weld/src/test/java/org/apache/cxf/systest/jaxrs/cdi/unwrapper/ClassUnwrapperTest.java&lt;br/&gt;
@@ -0,0 +1,75 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements. See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership. The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License. You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ * &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied. See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+package org.apache.cxf.systest.jaxrs.cdi.unwrapper;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.cxf.Bus;&lt;br/&gt;
+import org.apache.cxf.common.util.ClassUnwrapper;&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStorePreMatchingRequestFilter;&lt;br/&gt;
+import org.apache.cxf.systests.cdi.base.BookStoreRequestFilter;&lt;br/&gt;
+import org.jboss.weld.environment.se.Weld;&lt;br/&gt;
+import org.jboss.weld.environment.se.WeldContainer;&lt;br/&gt;
+import org.junit.After;&lt;br/&gt;
+import org.junit.Before;&lt;br/&gt;
+import org.junit.Test;&lt;br/&gt;
+&lt;br/&gt;
+import static org.hamcrest.CoreMatchers.equalTo;&lt;br/&gt;
+import static org.hamcrest.CoreMatchers.not;&lt;br/&gt;
+import static org.hamcrest.CoreMatchers.notNullValue;&lt;br/&gt;
+import static org.junit.Assert.assertThat;&lt;br/&gt;
+&lt;br/&gt;
+public class ClassUnwrapperTest {&lt;br/&gt;
+    private Bus bus;&lt;br/&gt;
+    private WeldContainer container;&lt;br/&gt;
+    &lt;br/&gt;
+    @Before&lt;br/&gt;
+    public void setUp() &lt;/p&gt;
{
+        final Weld weld = new Weld();
+        container = weld.initialize();
+        bus = getBeanReference(Bus.class);
+    }
&lt;p&gt;+&lt;br/&gt;
+    private&amp;lt;T&amp;gt; T getBeanReference(Class&amp;lt;T&amp;gt; clazz) &lt;/p&gt;
{
+        return container.select(clazz).get();
+    }
&lt;p&gt;+&lt;br/&gt;
+    @After&lt;br/&gt;
+    public void tearDown() &lt;/p&gt;
{
+        container.close();
+    }
&lt;p&gt;+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testProxyClassIsProperlyUnwrapped() &lt;/p&gt;
{
+        final BookStorePreMatchingRequestFilter filter = getBeanReference(BookStorePreMatchingRequestFilter.class);
+        final ClassUnwrapper unwrapper = (ClassUnwrapper)bus.getProperty(ClassUnwrapper.class.getName());
+        
+        assertThat(unwrapper, notNullValue());
+        assertThat(filter.getClass(), not(equalTo(BookStorePreMatchingRequestFilter.class)));
+        assertThat(unwrapper.getRealClass(filter), equalTo(BookStorePreMatchingRequestFilter.class));
+    }
&lt;p&gt;+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testRealClassIsProperlyUnwrapped() &lt;/p&gt;
{
+        final BookStoreRequestFilter filter = getBeanReference(BookStoreRequestFilter.class);
+        final ClassUnwrapper unwrapper = (ClassUnwrapper)bus.getProperty(ClassUnwrapper.class.getName());
+        
+        assertThat(unwrapper, notNullValue());
+        assertThat(filter.getClass(), equalTo(BookStoreRequestFilter.class));
+        assertThat(unwrapper.getRealClass(filter), equalTo(BookStoreRequestFilter.class));
+    }
&lt;p&gt;+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266732" author="githubbot" created="Mon, 27 Nov 2017 12:27:51 +0000"  >&lt;p&gt;sberyozkin commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347167548&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347167548&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Hi Andriy&lt;/p&gt;

&lt;p&gt;   Why this has been merged ?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266738" author="githubbot" created="Mon, 27 Nov 2017 12:39:44 +0000"  >&lt;p&gt;sberyozkin commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347170207&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347170207&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Sorry, just got confused given that the JIRA issue itself was closed as Won&apos;t fix&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266761" author="githubbot" created="Mon, 27 Nov 2017 13:03:53 +0000"  >&lt;p&gt;sberyozkin commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347175586&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347175586&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Andriy, will it make sense to merge to 3.1.x as well ?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266796" author="githubbot" created="Mon, 27 Nov 2017 13:24:02 +0000"  >&lt;p&gt;reta commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347180145&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347180145&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Yeah, sure, I will cherry-pick it to 3.1.x. Did you want to add / comment before merge? Or confusion is resolved? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266807" author="githubbot" created="Mon, 27 Nov 2017 13:31:50 +0000"  >&lt;p&gt;sberyozkin commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347182060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347182060&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Hi Andriy, indeed, the fix looks good, it&apos;s really about the filter providers also providing the real and service classes &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, thanks&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16266843" author="githubbot" created="Mon, 27 Nov 2017 14:01:48 +0000"  >&lt;p&gt;reta commented on issue #346: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7544&quot; title=&quot;Support @Context-based injection into proxied CDI beans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7544&quot;&gt;&lt;del&gt;CXF-7544&lt;/del&gt;&lt;/a&gt;: Support @Context-based injection into proxied CDI beans&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/346#issuecomment-347189823&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/346#issuecomment-347189823&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thanks! Yeah, that&apos;s right, also fixing CdiClassUwrapper proxy pattern for OWB, but aside from that, it is mostly about test cases.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13120745">CXF-7571</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3lufb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>