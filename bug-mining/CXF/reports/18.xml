<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:33:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-1587] Aegis Databinding cannot handle wildcard as a Map value type (ex: Map&lt;String, ?&gt;)</title>
                <link>https://issues.apache.org/jira/browse/CXF-1587</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;If an interface conatins a method which takes a param of type Map&amp;lt;String, ?&amp;gt; or returns a Map&amp;lt;String, ?&amp;gt; the following exception occurs with the following code:&lt;/p&gt;

&lt;p&gt;ServerFactoryBean svrFactory = new ServerFactoryBean();&lt;br/&gt;
svrFactory.setServiceClass(Tester.class);&lt;br/&gt;
svrFactory.setAddress(&quot;http://localhost:9090/cxfbug&quot;);&lt;br/&gt;
svrFactory.setServiceBean(new TesterImpl());&lt;br/&gt;
svrFactory.getServiceFactory().setDataBinding(new AegisDatabinding());&lt;br/&gt;
svrFactory.create();&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.ArrayIndexOutOfBoundsException: 1&lt;br/&gt;
        at org.apache.cxf.aegis.type.java5.Java5TypeCreator.getComponentType(Java5TypeCreator.java:184)&lt;br/&gt;
        at org.apache.cxf.aegis.type.java5.Java5TypeCreator.getOrCreateParameterizedType(Java5TypeCreator.java:134)&lt;br/&gt;
        at org.apache.cxf.aegis.type.java5.Java5TypeCreator.getOrCreateMapValueType(Java5TypeCreator.java:130)&lt;br/&gt;
        at org.apache.cxf.aegis.type.AbstractTypeCreator.getOrCreateMapValueType(AbstractTypeCreator.java:254)&lt;br/&gt;
        at org.apache.cxf.aegis.type.XMLTypeCreator.getOrCreateMapValueType(XMLTypeCreator.java:514)&lt;br/&gt;
        at org.apache.cxf.aegis.type.AbstractTypeCreator.createMapType(AbstractTypeCreator.java:268)&lt;br/&gt;
        at org.apache.cxf.aegis.type.AbstractTypeCreator.createTypeForClass(AbstractTypeCreator.java:111)&lt;br/&gt;
        at org.apache.cxf.aegis.databinding.AegisDatabinding.getParameterType(AegisDatabinding.java:593)&lt;br/&gt;
        at org.apache.cxf.aegis.databinding.AegisDatabinding.initializeMessage(AegisDatabinding.java:375)&lt;br/&gt;
        at org.apache.cxf.aegis.databinding.AegisDatabinding.initializeOperation(AegisDatabinding.java:339)&lt;br/&gt;
        at org.apache.cxf.aegis.databinding.AegisDatabinding.initialize(AegisDatabinding.java:303)&lt;br/&gt;
        at org.apache.cxf.service.factory.ReflectionServiceFactoryBean.buildServiceFromClass(ReflectionServiceFactoryBean.java:343)&lt;br/&gt;
        at org.apache.cxf.service.factory.ReflectionServiceFactoryBean.initializeServiceModel(ReflectionServiceFactoryBean.java:394)&lt;br/&gt;
        at org.apache.cxf.service.factory.ReflectionServiceFactoryBean.create(ReflectionServiceFactoryBean.java:180)&lt;br/&gt;
        at org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory.createEndpoint(AbstractWSDLBasedEndpointFactory.java:79)&lt;br/&gt;
        at org.apache.cxf.frontend.ServerFactoryBean.create(ServerFactoryBean.java:114)&lt;/p&gt;

&lt;p&gt;If you do not use the Aegis Databinding then the code works as expected.&lt;br/&gt;
The problem seems to stem from the org.apache.cxf.aegis.type.java5.Java5TypeCrestor class in the following method:&lt;br/&gt;
protected Class getComponentType(Object genericType, int index) {&lt;br/&gt;
        Class paramClass = null;&lt;/p&gt;

&lt;p&gt;        if (genericType instanceof ParameterizedType) {&lt;br/&gt;
            ParameterizedType type = (ParameterizedType)genericType;&lt;/p&gt;

&lt;p&gt;            if (type.getActualTypeArguments()&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt; instanceof Class) &lt;/p&gt;
{
                paramClass = (Class)type.getActualTypeArguments()[index];
            }
&lt;p&gt; else if (type.getActualTypeArguments()&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt; instanceof WildcardType) {&lt;br/&gt;
                WildcardType wildcardType = (WildcardType)type.getActualTypeArguments()&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt;;&lt;/p&gt;

&lt;p&gt;                if (wildcardType.getUpperBounds()&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt; instanceof Class) &lt;/p&gt;
{
                    paramClass = (Class)wildcardType.getUpperBounds()[index];
                }&lt;br/&gt;
            } else if (type.getActualTypeArguments()&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt; instanceof ParameterizedType) {
                ParameterizedType ptype = (ParameterizedType)type.getActualTypeArguments()[index];
                paramClass = (Class)ptype.getRawType();
            }&lt;br/&gt;
        }&lt;br/&gt;
        return paramClass;&lt;br/&gt;
    }&lt;br/&gt;
&lt;br/&gt;
I found if I change &lt;br/&gt;
if (wildcardType.getUpperBounds()&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt; instanceof Class) {                    paramClass = (Class)wildcardType.getUpperBounds()[index];                }
&lt;p&gt;to&lt;br/&gt;
if (wildcardType.getUpperBounds()&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; instanceof Class) &lt;/p&gt;
{
                    paramClass = (Class)wildcardType.getUpperBounds()[0];
                }
&lt;p&gt;it works in my case but not at all sure if this is the correct fix or if this should be expected to be supported.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Java 1.5.0_10; Windows&lt;/p&gt;</environment>
        <key id="12396044">CXF-1587</key>
            <summary>Aegis Databinding cannot handle wildcard as a Map value type (ex: Map&lt;String, ?&gt;)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bmargulies">Benson Margulies</assignee>
                                    <reporter username="brianga">Brian Gadwell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 May 2008 19:00:51 +0000</created>
                <updated>Thu, 3 Jul 2008 17:19:32 +0000</updated>
                            <resolved>Sun, 18 May 2008 02:14:55 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>2.1.1</fixVersion>
                                    <component>Aegis Databinding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12597775" author="bmargulies" created="Sun, 18 May 2008 02:14:55 +0000"  >&lt;p&gt;Added test, fixed bug.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>112378</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 28 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1abv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>268388</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>