<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:37:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2215] can&apos;t use  non-English character parameter, soap encoding are not consistent</title>
                <link>https://issues.apache.org/jira/browse/CXF-2215</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have use cxf 2.2 to publish a web service in tomcat 6, the only operation in which is &lt;/p&gt;

&lt;p&gt;public java.lang.String greetMe( String name);&lt;/p&gt;

&lt;p&gt;when invoke with a parameter in Chinese value, i couldn&apos;t get my result. &lt;br/&gt;
I use log interceptor to get the log below, you see the encoding and the charset is not consistent&lt;br/&gt;
I track the source code, and see the error when unmarshall invoked.&lt;br/&gt;
you can see the inbound message is parsed allright, but the outbound message is not, error  occurs.&lt;/p&gt;

&lt;p&gt;I have test there&apos;re no problem when i use English parameter.&lt;/p&gt;

&lt;p&gt;who can tell me the reason and fix the problem, thanks!&lt;/p&gt;


&lt;p&gt;Inbound Message &lt;br/&gt;
---------------------------- &lt;br/&gt;
Encoding: GB2312 &lt;br/&gt;
Content-Type: text/xml; charset=UTF-8 &lt;br/&gt;
Headers: &lt;/p&gt;
{cache-control=[no-cache], content-type=[text/xml; 
charset=UTF-8], connection=[keep-alive], host=[10.61.0.90:8080], 
content-length=[182], SOAPAction=[&quot;&quot;], user-agent=[Apache CXF 2.2], 
Accept=[*/*], pragma=[no-cache]}
&lt;p&gt; &lt;br/&gt;
Payload: &amp;lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/ &lt;br/&gt;
envelope/&quot;&amp;gt; &amp;lt;soap:Body&amp;gt; &amp;lt;ns2:greetMe xmlns:ns2=&quot;http://cxf/&quot;&amp;gt; &amp;lt;arg0&amp;gt;&#27979;&#35797; &amp;lt;/ &lt;br/&gt;
arg0&amp;gt; &amp;lt;/ns2:greetMe&amp;gt; &amp;lt;/soap:Body&amp;gt; &amp;lt;/soap:Envelope&amp;gt; &lt;/p&gt;


&lt;p&gt;Outbound Message &lt;br/&gt;
--------------------------- &lt;br/&gt;
Encoding: GB2312 &lt;br/&gt;
Content-Type: text/xml &lt;br/&gt;
Headers: {} &lt;br/&gt;
Payload: &amp;lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/ &lt;br/&gt;
envelope/&quot;&amp;gt; &amp;lt;soap:Body&amp;gt; &amp;lt;soap:Fault&amp;gt; &amp;lt;faultcode&amp;gt;soap:Client &amp;lt;/ &lt;br/&gt;
faultcode&amp;gt; &amp;lt;faultstring&amp;gt;Unmarshalling Error: Unexpected close tag &amp;lt;/ &lt;br/&gt;
ns2:greetMe&amp;gt;; expected &amp;lt;/arg0&amp;gt;.&amp;#xd; &lt;br/&gt;
at [row,col &lt;/p&gt;
{unknown-source}]: &lt;span class=&quot;error&quot;&gt;&amp;#91;1,148&amp;#93;&lt;/span&gt; &amp;lt;/faultstring&amp;gt; &amp;lt;/soap:Fault&amp;gt; &amp;lt;/ &lt;br/&gt;
soap:Body&amp;gt; &amp;lt;/soap:Envelope&amp;gt; &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
and the exception is below:&lt;br/&gt;
Interceptor has thrown exception, unwinding now &lt;br/&gt;
org.apache.cxf.interceptor.Fault: Unmarshalling Error: Unexpected &lt;br/&gt;
close tag &amp;lt;/ns2:greetMe&amp;gt;; expected &amp;lt;/arg0&amp;gt;. &lt;br/&gt;
at [row,col {unknown-source}
&lt;p&gt;]: &lt;span class=&quot;error&quot;&gt;&amp;#91;1,148&amp;#93;&lt;/span&gt; &lt;br/&gt;
        at org.apache.cxf.jaxb.JAXBEncoderDecoder.unmarshall &lt;br/&gt;
(JAXBEncoderDecoder.java:622) &lt;br/&gt;
        at org.apache.cxf.jaxb.JAXBEncoderDecoder.unmarshall &lt;br/&gt;
(JAXBEncoderDecoder.java:527) &lt;br/&gt;
        at org.apache.cxf.jaxb.io.DataReaderImpl.read(DataReaderImpl.java: &lt;br/&gt;
108) &lt;br/&gt;
        at org.apache.cxf.interceptor.DocLiteralInInterceptor.handleMessage &lt;br/&gt;
(DocLiteralInInterceptor.java:102) &lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept &lt;br/&gt;
(PhaseInterceptorChain.java:236) &lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage &lt;br/&gt;
(ChainInitiationObserver.java:89) &lt;br/&gt;
        at org.apache.cxf.transport.servlet.ServletDestination.invoke &lt;br/&gt;
(ServletDestination.java:99) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.cxf.transport.servlet.ServletController.invokeDestination &lt;br/&gt;
(ServletController.java:337) &lt;br/&gt;
        at org.apache.cxf.transport.servlet.ServletController.invoke &lt;br/&gt;
(ServletController.java:182) &lt;br/&gt;
        at org.apache.cxf.transport.servlet.AbstractCXFServlet.invoke &lt;br/&gt;
(AbstractCXFServlet.java:163) &lt;br/&gt;
        at org.apache.cxf.transport.servlet.AbstractCXFServlet.doPost &lt;br/&gt;
(AbstractCXFServlet.java:141) &lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:710) &lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803) &lt;br/&gt;
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter &lt;br/&gt;
(ApplicationFilterChain.java:269) &lt;br/&gt;
        at org.apache.catalina.core.ApplicationFilterChain.doFilter &lt;br/&gt;
(ApplicationFilterChain.java:188) &lt;br/&gt;
        at org.apache.struts2.dispatcher.FilterDispatcher.doFilter &lt;br/&gt;
(FilterDispatcher.java:413) &lt;br/&gt;
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter &lt;br/&gt;
(ApplicationFilterChain.java:215) &lt;br/&gt;
        at org.apache.catalina.core.ApplicationFilterChain.doFilter &lt;br/&gt;
(ApplicationFilterChain.java:188) &lt;br/&gt;
        at org.apache.catalina.core.StandardWrapperValve.invoke &lt;br/&gt;
(StandardWrapperValve.java:210) &lt;br/&gt;
        at org.apache.catalina.core.StandardContextValve.invoke &lt;br/&gt;
(StandardContextValve.java:174) &lt;br/&gt;
        at org.apache.catalina.core.StandardHostValve.invoke &lt;br/&gt;
(StandardHostValve.java:127) &lt;br/&gt;
        at org.apache.catalina.valves.ErrorReportValve.invoke &lt;br/&gt;
(ErrorReportValve.java:117) &lt;br/&gt;
        at org.apache.catalina.core.StandardEngineValve.invoke &lt;br/&gt;
(StandardEngineValve.java:108) &lt;br/&gt;
        at org.apache.catalina.connector.CoyoteAdapter.service &lt;br/&gt;
(CoyoteAdapter.java:151) &lt;br/&gt;
        at org.apache.coyote.http11.Http11Processor.process &lt;br/&gt;
(Http11Processor.java:870) &lt;br/&gt;
        at org.apache.coyote.http11.Http11BaseProtocol &lt;br/&gt;
$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java: &lt;br/&gt;
665) &lt;br/&gt;
        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket &lt;br/&gt;
(PoolTcpEndpoint.java:528) &lt;br/&gt;
        at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt &lt;br/&gt;
(LeaderFollowerWorkerThread.java:81) &lt;br/&gt;
        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run &lt;br/&gt;
(ThreadPool.java:685) &lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619) &lt;br/&gt;
Caused by: javax.xml.bind.UnmarshalException &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;with linked exception:&lt;br/&gt;
[com.ctc.wstx.exc.WstxParsingException: Unexpected close tag &amp;lt;/ &lt;br/&gt;
ns2:greetMe&amp;gt;; expected &amp;lt;/arg0&amp;gt;. &lt;br/&gt;
at [row,col 
{unknown-source}]: &lt;span class=&quot;error&quot;&gt;&amp;#91;1,148&amp;#93;&lt;/span&gt;] &lt;br/&gt;
        at &lt;br/&gt;
com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.handleStreamExcep&#173;tion &lt;br/&gt;
(UnmarshallerImpl.java:426) &lt;br/&gt;
        at &lt;br/&gt;
com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0 &lt;br/&gt;
(UnmarshallerImpl.java:362) &lt;br/&gt;
        at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal &lt;br/&gt;
(UnmarshallerImpl.java:339) &lt;br/&gt;
        at org.apache.cxf.jaxb.JAXBEncoderDecoder.unmarshall &lt;br/&gt;
(JAXBEncoderDecoder.java:607) &lt;br/&gt;
        ... 29 more &lt;br/&gt;
Caused by: com.ctc.wstx.exc.WstxParsingException: Unexpected close tag &lt;br/&gt;
&amp;lt;/ns2:greetMe&amp;gt;; expected &amp;lt;/arg0&amp;gt;. &lt;br/&gt;
at [row,col {unknown-source}
&lt;p&gt;]: &lt;span class=&quot;error&quot;&gt;&amp;#91;1,148&amp;#93;&lt;/span&gt; &lt;br/&gt;
        at com.ctc.wstx.sr.StreamScanner.constructWfcException &lt;br/&gt;
(StreamScanner.java:630) &lt;br/&gt;
        at com.ctc.wstx.sr.StreamScanner.throwParseError(StreamScanner.java: &lt;br/&gt;
461) &lt;br/&gt;
        at com.ctc.wstx.sr.BasicStreamReader.reportWrongEndElem &lt;br/&gt;
(BasicStreamReader.java:3256) &lt;br/&gt;
        at com.ctc.wstx.sr.BasicStreamReader.readEndElem &lt;br/&gt;
(BasicStreamReader.java:3198) &lt;br/&gt;
        at com.ctc.wstx.sr.BasicStreamReader.nextFromTree &lt;br/&gt;
(BasicStreamReader.java:2830) &lt;br/&gt;
        at com.ctc.wstx.sr.BasicStreamReader.next(BasicStreamReader.java: &lt;br/&gt;
1019) &lt;br/&gt;
        at org.apache.cxf.staxutils.DepthXMLStreamReader.next &lt;br/&gt;
(DepthXMLStreamReader.java:220) &lt;br/&gt;
        at com.sun.xml.bind.v2.runtime.unmarshaller.StAXStreamConnector.bridge &lt;br/&gt;
(StAXStreamConnector.java:225) &lt;br/&gt;
        at &lt;br/&gt;
com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0 &lt;br/&gt;
(UnmarshallerImpl.java:360) &lt;br/&gt;
        ... 31 more &lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>&lt;p&gt;windows xp, tomcat 6.0.18&lt;/p&gt;</environment>
        <key id="12425198">CXF-2215</key>
            <summary>can&apos;t use  non-English character parameter, soap encoding are not consistent</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dingweilong">DingWeilong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 May 2009 10:11:46 +0000</created>
                <updated>Thu, 4 Jun 2009 21:34:19 +0000</updated>
                            <resolved>Fri, 15 May 2009 05:29:27 +0000</resolved>
                                    <version>2.2</version>
                                    <fixVersion>Invalid</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12708424" author="bmargulies" created="Tue, 12 May 2009 13:05:39 +0000"  >&lt;p&gt;CXF generally is tested with messages in UTF-8. How did you persuade the code to use GB2312? Are you running the entire JVM with the encoding set that way?&lt;/p&gt;

&lt;p&gt;Can you post a runnable test case that will use GB2312 even when run on a default system configuration?&lt;/p&gt;</comment>
                            <comment id="12708601" author="dkulp" created="Tue, 12 May 2009 20:20:13 +0000"  >
&lt;p&gt;Any chance you could use wireshark or similar to get the raw bytes off the socket?   &lt;/p&gt;

&lt;p&gt;Like Benson, I&apos;m very curious how this could occur.   The &quot;Content-Type&quot;  is &quot;text/xml; charset=UTF-8&quot; and thus the encoding SHOULD be UTF-8.   I have no idea how it could be GB2312.   That may require you to dig in and debug the CXFServlet and figure out where that GB2312 is coming from.    &lt;/p&gt;</comment>
                            <comment id="12708721" author="dingweilong" created="Wed, 13 May 2009 01:56:07 +0000"  >&lt;p&gt;I have track the source code, i haven&apos;t got why the ENCODING was changed.&lt;br/&gt;
I find when the MessageSenderEndingInterceptor ( a inner class in org.apache.cxf.transport.Conduit.MessageSenderInterceptor)is called the encoding is changed, who can tell me the rationale.&lt;/p&gt;

&lt;p&gt;my test case is simple:&lt;br/&gt;
@Test&lt;br/&gt;
public void testGreetMe() throws Exception&lt;br/&gt;
{&lt;br/&gt;
	String name=&quot;&#27979;&#35797;&quot;;&lt;br/&gt;
	String r=greeter.greetMe(name);&lt;br/&gt;
	log.info(r);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;server side is also simple:&lt;br/&gt;
public String greetMe(String user)&lt;/p&gt;
    {
    	return &quot;Hello &quot;+user;
    }

&lt;p&gt;Where and how is the chance that encoding is changed?&lt;br/&gt;
thanks.&lt;/p&gt;</comment>
                            <comment id="12708722" author="bmargulies" created="Wed, 13 May 2009 02:10:05 +0000"  >&lt;p&gt;I think you need to tell us about the larger context in which your code is launched. Is it a standalone? Inside an app server?&lt;/p&gt;

&lt;p&gt;Add a line of code to inspect the system property &apos;file.encoding&apos; and see if it&apos;s GB2312.&lt;/p&gt;

&lt;p&gt;Again, what we need here is a complete test case that we can compile and run.&lt;/p&gt;</comment>
                            <comment id="12708730" author="dingweilong" created="Wed, 13 May 2009 02:38:53 +0000"  >&lt;p&gt;The service is published by Tomcat 6 container&lt;/p&gt;

&lt;p&gt;the web.xml is shown below:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;web-app version=&quot;2.4&quot; xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;&lt;br/&gt;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee &lt;br/&gt;
	&lt;a href=&quot;http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&lt;/a&gt;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;listener&amp;gt;&lt;br/&gt;
		&amp;lt;listener-class&amp;gt;&lt;br/&gt;
			org.springframework.web.context.ContextLoaderListener&lt;br/&gt;
		&amp;lt;/listener-class&amp;gt;&lt;br/&gt;
	&amp;lt;/listener&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;context-param&amp;gt;&lt;br/&gt;
		&amp;lt;param-name&amp;gt;contextConfigLocation&amp;lt;/param-name&amp;gt;&lt;br/&gt;
		&amp;lt;param-value&amp;gt;&lt;br/&gt;
			bean.xml,WEB-INF/classes/services.xml&amp;lt;/param-value&amp;gt;&lt;br/&gt;
	&amp;lt;/context-param&amp;gt;&lt;/p&gt;


&lt;p&gt;	&amp;lt;servlet&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;CXFServlet&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-class&amp;gt;&lt;br/&gt;
			org.apache.cxf.transport.servlet.CXFServlet&lt;br/&gt;
		&amp;lt;/servlet-class&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;servlet-mapping&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;CXFServlet&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;url-pattern&amp;gt;/services/*&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet-mapping&amp;gt;&lt;/p&gt;


&lt;p&gt;&amp;lt;/web-app&amp;gt;&lt;/p&gt;

&lt;p&gt;the cxf config file service.xml in Spring is shown below:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;&lt;br/&gt;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
	xmlns:jaxws=&quot;http://cxf.apache.org/jaxws&quot;&lt;br/&gt;
	xsi:schemaLocation=&quot;&lt;br/&gt;
	&lt;a href=&quot;http://www.springframework.org/schema/beans&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.springframework.org/schema/beans&lt;/a&gt; &lt;br/&gt;
	&lt;a href=&quot;http://www.springframework.org/schema/beans/spring-beans.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.springframework.org/schema/beans/spring-beans.xsd&lt;/a&gt;&lt;br/&gt;
	&lt;a href=&quot;http://cxf.apache.org/jaxws&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/jaxws&lt;/a&gt; &lt;br/&gt;
	&lt;a href=&quot;http://cxf.apache.org/schemas/jaxws.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/schemas/jaxws.xsd&lt;/a&gt;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;import resource=&quot;classpath:META-INF/cxf/cxf.xml&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;import resource=&quot;classpath:META-INF/cxf/cxf-extension-soap.xml&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;import resource=&quot;classpath:META-INF/cxf/cxf-servlet.xml&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;import resource=&quot;classpath:META-INF/cxf/cxf-extension-http-binding.xml&quot;/&amp;gt;&lt;/p&gt;


&lt;p&gt;	&amp;lt;bean id=&quot;CXFGreeter&quot; class=&quot;cxf.CXFGreeter&quot;&amp;gt;&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;LoggingInInterceptor&quot;&lt;br/&gt;
		class=&quot;org.apache.cxf.interceptor.LoggingInInterceptor&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;LoggingOutInterceptor&quot;&lt;br/&gt;
		class=&quot;org.apache.cxf.interceptor.LoggingOutInterceptor&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;jaxws:endpoint id=&quot;CXFGreeterService&quot; implementor=&quot;#CXFGreeter&quot;&lt;br/&gt;
		address=&quot;/Greeter&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;jaxws:features&amp;gt;&lt;br/&gt;
			&amp;lt;bean class=&quot;org.apache.cxf.feature.LoggingFeature&quot; /&amp;gt;&lt;br/&gt;
		&amp;lt;/jaxws:features&amp;gt;&lt;br/&gt;
	&amp;lt;/jaxws:endpoint&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;


&lt;p&gt;by the way, i find the properties in Java environment , there&apos;re 2 properties related the encoding:&lt;br/&gt;
sun.jnu.encoding=GBK&lt;br/&gt;
file.encoding=GBK&lt;/p&gt;

&lt;p&gt;but none of them is GB2312, I was so CONFUSED!&lt;/p&gt;</comment>
                            <comment id="12708876" author="bmargulies" created="Wed, 13 May 2009 10:39:37 +0000"  >&lt;p&gt;Just to confirm: Are these settings live:&lt;/p&gt;

&lt;p&gt;sun.jnu.encoding=GBK&lt;br/&gt;
file.encoding=GBK&lt;/p&gt;

&lt;p&gt;?&lt;/p&gt;

&lt;p&gt;We can set up a test case and see what happens&#8805;&lt;/p&gt;</comment>
                            <comment id="12709247" author="dingweilong" created="Thu, 14 May 2009 02:31:45 +0000"  >&lt;p&gt;Thanks for your reply.&lt;br/&gt;
I don&apos;t think the jvm encoding setting is working. Because of messages&apos;  encoding is GB2312.&lt;br/&gt;
Where can the encoding be set? &lt;/p&gt;</comment>
                            <comment id="12709365" author="bmargulies" created="Thu, 14 May 2009 11:07:46 +0000"  >&lt;p&gt;Generally, it cannot be set. We don&apos;t know yet why it is GB2312 for you and not UTF-8. I&apos;ve tried some experiments.&lt;/p&gt;

&lt;p&gt;Again, I think a full test case is needed here. I need to know your full classpath and I need to be able to reproduce the problem.&lt;/p&gt;</comment>
                            <comment id="12709584" author="dkulp" created="Thu, 14 May 2009 20:53:13 +0000"  >

&lt;p&gt;Any chance you could write a simple servlet that does:&lt;/p&gt;

&lt;p&gt;System.out.println(httpReq.getCharacterEncoding());&lt;br/&gt;
System.out.println(httpReq.getContentType());&lt;/p&gt;

&lt;p&gt;I&apos;d like to know if the two match or not.   If not, that&apos;s the first thing we need to tackle/figure out.  &lt;/p&gt;</comment>
                            <comment id="12709589" author="bmargulies" created="Thu, 14 May 2009 21:01:08 +0000"  >&lt;p&gt;In my view, you shouldn&apos;t be able to get CXF to use an encoding other than UTF-8 without some explicit configuration &amp;#8211; NOT file.encoding. I suppose the http content type of a request might be respected for the response, but I&apos;m not entirely sold.&lt;/p&gt;</comment>
                            <comment id="12709668" author="dkulp" created="Fri, 15 May 2009 02:02:07 +0000"  >&lt;p&gt;&lt;br/&gt;
I THINK I may have fixed this.   My &quot;gut feeling&quot; is that the version of tomcat you are using is returning the wrong value from request.getCharacterEncoding().    I&apos;ve flipped the code over to using the charset found in the Content-Type header (which is what getCharacterEncoding should do, but in your case obviously isn&apos;t).   That SHOULD fix this as your initial logs shows that the charset=UTF-8 which is what should work for this case.&lt;/p&gt;</comment>
                            <comment id="12709670" author="dkulp" created="Fri, 15 May 2009 02:06:12 +0000"  >&lt;p&gt;&lt;br/&gt;
I just forced a new deploy of snapshots.   Thus, in an hour or so, a new snapshot should be deployed.   It would be great if you could try it and let me know if it works out for you.&lt;/p&gt;</comment>
                            <comment id="12709711" author="dingweilong" created="Fri, 15 May 2009 05:29:27 +0000"  >&lt;p&gt;I&apos;ve resovled my problem.&lt;br/&gt;
In my Web project, there is Struts2 configuration in web.xml as a filter&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;web-app version=&quot;2.4&quot; xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;&lt;br/&gt;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee &lt;br/&gt;
	&lt;a href=&quot;http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&lt;/a&gt;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;listener&amp;gt;&lt;br/&gt;
		&amp;lt;listener-class&amp;gt;&lt;br/&gt;
			org.springframework.web.context.ContextLoaderListener&lt;br/&gt;
		&amp;lt;/listener-class&amp;gt;&lt;br/&gt;
	&amp;lt;/listener&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;context-param&amp;gt;&lt;br/&gt;
		&amp;lt;param-name&amp;gt;contextConfigLocation&amp;lt;/param-name&amp;gt;&lt;br/&gt;
		&amp;lt;param-value&amp;gt;&lt;br/&gt;
			bean.xml,WEB-INF/classes/Struts2_context.xml,WEB-INF/classes/dwr_context.xml,WEB-INF/classes/services.xml&amp;lt;/param-value&amp;gt;&lt;br/&gt;
	&amp;lt;/context-param&amp;gt;&lt;/p&gt;



&lt;p&gt;	&amp;lt;!-- Strurts2 &#37197;&#32622; --&amp;gt;&lt;br/&gt;
	&amp;lt;filter&amp;gt;&lt;br/&gt;
		&amp;lt;filter-name&amp;gt;struts2&amp;lt;/filter-name&amp;gt;&lt;br/&gt;
		&amp;lt;filter-class&amp;gt;&lt;br/&gt;
			org.apache.struts2.dispatcher.FilterDispatcher&lt;br/&gt;
		&amp;lt;/filter-class&amp;gt;&lt;br/&gt;
	&amp;lt;/filter&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;filter-mapping&amp;gt;&lt;br/&gt;
		&amp;lt;filter-name&amp;gt;struts2&amp;lt;/filter-name&amp;gt;&lt;br/&gt;
		&amp;lt;url-pattern&amp;gt;/*&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
	&amp;lt;/filter-mapping&amp;gt;&lt;/p&gt;


&lt;p&gt;	&amp;lt;!-- DWR &#37197;&#32622; --&amp;gt;&lt;br/&gt;
	&amp;lt;servlet&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;dwr&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-class&amp;gt;&lt;br/&gt;
			org.directwebremoting.spring.DwrSpringServlet&lt;br/&gt;
		&amp;lt;/servlet-class&amp;gt;&lt;br/&gt;
		&amp;lt;init-param&amp;gt;&lt;br/&gt;
			&amp;lt;param-name&amp;gt;debug&amp;lt;/param-name&amp;gt;&lt;br/&gt;
			&amp;lt;param-value&amp;gt;true&amp;lt;/param-value&amp;gt;&lt;br/&gt;
		&amp;lt;/init-param&amp;gt;&lt;br/&gt;
		&amp;lt;load-on-startup&amp;gt;1&amp;lt;/load-on-startup&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet&amp;gt;&lt;br/&gt;
	&amp;lt;servlet-mapping&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;dwr&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;url-pattern&amp;gt;/dwr/*&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet-mapping&amp;gt;&lt;/p&gt;


&lt;p&gt;	&amp;lt;!-- CXF &#37197;&#32622; --&amp;gt;&lt;br/&gt;
	&amp;lt;servlet&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;CXFServlet&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-class&amp;gt;&lt;br/&gt;
			org.apache.cxf.transport.servlet.CXFServlet&lt;br/&gt;
		&amp;lt;/servlet-class&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;servlet-mapping&amp;gt;&lt;br/&gt;
		&amp;lt;servlet-name&amp;gt;CXFServlet&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
		&amp;lt;url-pattern&amp;gt;/services/*&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
	&amp;lt;/servlet-mapping&amp;gt;&lt;/p&gt;


&lt;p&gt;&amp;lt;/web-app&amp;gt;&lt;/p&gt;

&lt;p&gt;and there is a struts.properties config file, where I write in one line as follow:&lt;br/&gt;
struts.i18n.encoding=GB2312&lt;br/&gt;
I refer some articles about about struts.i18n.encoding, &lt;br/&gt;
find that this property set the CharacterEncoding of request AND response.&lt;/p&gt;

&lt;p&gt;So my the problem is clear now. I should do some modifications about my struts config file. And I did, so it works!&lt;/p&gt;

&lt;p&gt;By the way, if the struts.i18n.encoding property is not set in the struts.xml, the default encoding will be the JVM encoding( for example , GBK in my environement ), but only UTF-8 can work well in unmarshall process by CXF. I think we should be attentive when we use non-English character in parameters of CXF Web Service.&lt;/p&gt;


&lt;p&gt;In addition, THANK you ALL for your paient answers in time. I appreciate so much all the work in this active community!&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>113653</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178720</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>