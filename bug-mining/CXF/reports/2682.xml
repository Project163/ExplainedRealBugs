<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:18:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6632] Memory leak due to literal keys in WSDLDefinition map</title>
                <link>https://issues.apache.org/jira/browse/CXF-6632</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Looks like the definitionsMap in WSDLManagerImpl holds the WSDLDefinitions against a weak key, again relying&lt;br/&gt;
on the WeakHashMap semantics for removal.&lt;/p&gt;

&lt;p&gt;The loadDefinition(String) method loads the WSDLDef and puts this in a map&lt;br/&gt;
against a String key even if it was passed as a URL through getDefinition(URL). &lt;/p&gt;

&lt;p&gt;Like the &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-1639&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-1639&lt;/a&gt; this causes a memory leak.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12903417">CXF-6632</key>
            <summary>Memory leak due to literal keys in WSDLDefinition map</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="Gio">Giovanni Borelli</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Oct 2015 17:03:29 +0000</created>
                <updated>Fri, 14 Oct 2016 14:12:11 +0000</updated>
                            <resolved>Mon, 12 Oct 2015 19:42:56 +0000</resolved>
                                    <version>2.7.17</version>
                                    <fixVersion>2.7.18</fixVersion>
                    <fixVersion>3.0.7</fixVersion>
                    <fixVersion>3.1.4</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14949008" author="dkulp" created="Thu, 8 Oct 2015 17:21:10 +0000"  >&lt;p&gt;Is there an actual test case for this or is this &quot;theory&quot;?&lt;/p&gt;

&lt;p&gt;In CXF&apos;s EndpointImpl, the passed in string for the wsdlLocation is explicitly reset to a non-static and unique String object specifically to avoid this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;wsdlLocation = wsdl == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(wsdl);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the unique location is the one that is used for the lookup.   That string is only held onto by that specific EndpointImpl so when that EndpointImpl goes out of scope, the string should be released and the wsdl discarded.   &lt;/p&gt;

&lt;p&gt;So the question specifically is: please describe the FULL scenario where this is a problem.  A test case is preferred. &lt;/p&gt;</comment>
                            <comment id="14949043" author="gio" created="Thu, 8 Oct 2015 17:48:22 +0000"  >&lt;p&gt;Sorry, I am new to this and I don&apos;t have an actual test case to provide to you right now.&lt;/p&gt;

&lt;p&gt;I am mantaining a legacy web application and this is the evidence I can provide:&lt;/p&gt;

&lt;p&gt;StackTrace that generates memory leak:&lt;br/&gt;
org.apache.cxf.jaxws.spi.ProviderImpl line 101&lt;br/&gt;
org.apache.cxf.jaxws.ServiceImpl line 158&lt;br/&gt;
org.apache.cxf.wsdl11.WSDLManagerImpl line 267&lt;/p&gt;

&lt;p&gt;Here is a snapshot of the leak (goes on until OutOfMemory): &lt;a href=&quot;https://drive.google.com/file/d/0B5LMTi_mp6SeUm93MDlPajQ0YmM/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B5LMTi_mp6SeUm93MDlPajQ0YmM/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Changing line 267 in WSDLManagerImpl to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;           definitionsMap.put(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(url), def);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;eliminates the leak issue.&lt;/p&gt;

&lt;p&gt;Another point of intervention could be changing line 145 in org.apache.cxf.jaxws.ServiceImpl (and any other similar statements) in an EndpointImpl kind of way.&lt;/p&gt;</comment>
                            <comment id="14949067" author="dkulp" created="Thu, 8 Oct 2015 18:03:31 +0000"  >&lt;p&gt;Line 145 does:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; wsdlURL = url == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; : url.toString();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the code internal to url.toString() ends up also creating a new String object that would be unique for that ServiceImpl.   Thus, that also shouldn&apos;t be an issue.&lt;/p&gt;
</comment>
                            <comment id="14949981" author="gio" created="Fri, 9 Oct 2015 06:42:17 +0000"  >&lt;p&gt;Correct, so we must be missing something since changing line 267 in WSDLManagerImpl to:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;           definitionsMap.put(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(url), def);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;fixes the leak issue.&lt;/p&gt;

&lt;p&gt;Here is the complete stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.cxf.wsdl11.WSDLManagerImpl.loadDefinition(WSDLManagerImpl.java:265),
 org.apache.cxf.wsdl11.WSDLManagerImpl.getDefinition(WSDLManagerImpl.java:205),
 org.apache.cxf.jaxws.ServiceImpl.initializePorts(ServiceImpl.java:158),
 org.apache.cxf.jaxws.ServiceImpl.&amp;lt;init&amp;gt;(ServiceImpl.java:149),
 org.apache.cxf.jaxws.spi.ProviderImpl.createServiceDelegate(ProviderImpl.java:101),
 javax.xml.ws.Service.&amp;lt;init&amp;gt;(Service.java:77),
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="14950315" author="gio" created="Fri, 9 Oct 2015 12:39:10 +0000"  >&lt;p&gt;I managed to create a test case:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; urlStr = &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//my_server_url/path/to/wsdl&amp;amp;=&quot;&lt;/span&gt;;
&lt;/span&gt;		
Random rand = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Random();
		
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;){
	URL url = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URL(urlStr+rand.nextInt());
	Service.create(url, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QName(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//schemas.microsoft.com/sharepoint/soap/&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Lists&quot;&lt;/span&gt;));
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This creates a noticeable memory leak: &lt;a href=&quot;https://drive.google.com/file/d/0B5LMTi_mp6SedDlNTHpOT3RCSms/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B5LMTi_mp6SedDlNTHpOT3RCSms/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Fixing the WSDLManagerImpl this way:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;FixedWSDLManagerImpl &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; WSDLManagerImpl{
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; FixedWSDLManagerImpl() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; BusException {
  	&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;();
  }

  @Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Definition getDefinition(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; url) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; WSDLException {
  	&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.getDefinition(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(url));
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and using it in my test case:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; urlStr = &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//my_server_url/path/to/wsdl&amp;amp;=&quot;&lt;/span&gt;;
&lt;/span&gt;		
Random rand = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Random();

&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;){
	URL url = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URL(urlStr+rand.nextInt());
	BusFactory.getThreadDefaultBus().setExtension(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FixedWSDLManagerImpl(), WSDLManager.class);
	Service.create(url, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QName(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//schemas.microsoft.com/sharepoint/soap/&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Lists&quot;&lt;/span&gt;));
&lt;/span&gt;}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;completely fixes the leak: &lt;a href=&quot;https://drive.google.com/file/d/0B5LMTi_mp6SeaDB5dWFPNTRGc28/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B5LMTi_mp6SeaDB5dWFPNTRGc28/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hope this helps&lt;/p&gt;</comment>
                            <comment id="14950391" author="dkulp" created="Fri, 9 Oct 2015 13:35:25 +0000"  >
&lt;p&gt;That completely defeats the entire purpose of the cache in the WSDL manager though.    By creating a new string like that that is NOT held onto at all by the client that is requesting the WSDL, the WSDL would be cleared from the cache almost immediately (first garbage collect) and thus would not be available when a second/third/forth client asks for the WSDL.   Thus, that is NOT a fix.   &lt;/p&gt;

&lt;p&gt;We need a test case that can be profiled to figure out what is holding onto the string strongly which is preventing it from being garbage collected.  &lt;/p&gt;
</comment>
                            <comment id="14950401" author="gio" created="Fri, 9 Oct 2015 13:42:55 +0000"  >&lt;p&gt;I totally agree with you, my &quot;fix&quot; is just a proof of concept that I am using to prevent the production environment to crash every 10 minutes because of an OutOfMemory Exception.&lt;/p&gt;

&lt;p&gt;Anyway in my case there is no need for a WSDL cache: the application uses a single WSDL one or two times in it&apos;s entire life cycle.&lt;br/&gt;
Is there a way to completely disable it?&lt;/p&gt;</comment>
                            <comment id="14950544" author="dkulp" created="Fri, 9 Oct 2015 15:16:31 +0000"  >&lt;p&gt;Created a testcase that creates a client using a unique WSDL and makes a single call.   It does that 10,000 times so 10K clients created from unique wsdl URL&apos;s&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testMemoryLeak() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

        URL wurl = getClass().getResource(&lt;span class=&quot;code-quote&quot;&gt;&quot;/wsdl/hello_world.wsdl&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; wsdl[] = IOUtils.readBytesFromStream(wurl.openStream());
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; max = 10000;
        
        List&amp;lt;URL&amp;gt; urls = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;URL&amp;gt;(max); 
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; x = 0; x &amp;lt; max; x++) {
            File f = FileUtils.createTempFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;memtest&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;.wsdl&quot;&lt;/span&gt;, FileUtils.createTmpDir(), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            FileOutputStream fout = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(f);
            fout.write(wsdl);
            fout.close();
            urls.add(f.toURI().toURL());
        }
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; count = 0;
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (URL url : urls) {
            count++;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (count == 500) {
                count = 0;
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.gc();
                &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; used = &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt;.getRuntime().totalMemory() - &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt;.getRuntime().freeMemory();
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Total used: &quot;&lt;/span&gt; + used);
            }
            org.apache.hello_world_soap_http.SOAPService service 
                = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.hello_world_soap_http.SOAPService(url);
            Greeter greeter = service.getSoapPort();
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; response = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;Bonjour&quot;&lt;/span&gt;);
            ((BindingProvider)greeter).getRequestContext()
                .put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY,
                     &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:&quot;&lt;/span&gt; + PORT + &lt;span class=&quot;code-quote&quot;&gt;&quot;/SoapContext/SoapPort&quot;&lt;/span&gt;);
&lt;/span&gt;            greeter.greetMe(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; reply = greeter.sayHi();
            assertNotNull(&lt;span class=&quot;code-quote&quot;&gt;&quot;no response received from service&quot;&lt;/span&gt;, reply);
            assertEquals(response, reply);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Total used: 158922560
Total used: 59764504
Total used: 53929024
Total used: 129572720
Total used: 116012352
Total used: 94773152
Total used: 75239248
Total used: 51025808
Total used: 31055768
Total used: 241753480
Total used: 30674872
Total used: 45508056
Total used: 52308928
Total used: 54434632
Total used: 55705784
Total used: 57832832
Total used: 56131208
Total used: 55707680
Total used: 56984672
Total used: 54434480
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All values are within the same ballpark (not progressively increasing) so I&apos;m not seeing any sort of memory leak using normal use cases.     The URL&apos;s for the WSDL&apos;s are held onto strongly in the list so if that was the issue, it should be seen here as well.&lt;/p&gt;</comment>
                            <comment id="14951644" author="gio" created="Sat, 10 Oct 2015 06:28:09 +0000"  >&lt;p&gt;I can confirm your test cases result: no memory leak there.&lt;/p&gt;

&lt;p&gt;Just to add some more real world complexity I created a simple servlet (running on a different JVM) that streams local file content to requestor, and I used it in your test case instead of reading WSDL from fs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
        List&amp;lt;URL&amp;gt; urls = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;URL&amp;gt;(max); 
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; x = 0; x &amp;lt; max; x++) {
            File f = FileUtils.createTempFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;memtest&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;.wsdl&quot;&lt;/span&gt;, FileUtils.createTmpDir(), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            FileOutputStream fout = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(f);
            fout.write(wsdl);
            fout.close();
            urls.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URL(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8080/testweb/GetFile?path=&quot;&lt;/span&gt;+f.getAbsolutePath()));
&lt;/span&gt;        }
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;this is my result:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Total used: 165609968
Total used: 303695992
Total used: 444959136
Total used: 586214952
Total used: 730550224
Total used: 869786704
Total used: 1012532344
Total used: 1151427424
Total used: 1292696288
Total used: 1433952648
Total used: 1575213840
Total used: 1719920184
Total used: 1857696448
Total used: 2002497848
Total used: 2140335368
Total used: 2285109960
Total used: 2426403888
Total used: 2564113000
Total used: 2708663696
Total used: 2846651736
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the leak: WSDLDefinition map guilty again.&lt;/p&gt;

&lt;p&gt;Using my p.o.c. &quot;fix&quot;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Total used: 20945352
Total used: 20971648
Total used: 20962768
Total used: 20977368
Total used: 20977832
Total used: 20964664
Total used: 20966448
Total used: 20961080
Total used: 21549656
Total used: 21537400
Total used: 21543616
Total used: 21529872
Total used: 21551968
Total used: 21546600
Total used: 21541760
Total used: 21544120
Total used: 21544112
Total used: 21551776
Total used: 21534288
Total used: 21543784
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;no leak.&lt;/p&gt;

&lt;p&gt;Is there a chance that the problem is in the &quot;value&quot; part of the WeakHashMap (the Definition) and not in the &quot;key&quot; map (the url)?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12397904">CXF-1639</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mrfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>