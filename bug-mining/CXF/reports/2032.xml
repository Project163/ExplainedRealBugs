<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:06:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5390] AbstractSamlBase64InHandler goes into infinite loop when processing bad header value.</title>
                <link>https://issues.apache.org/jira/browse/CXF-5390</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Let&apos;s say I protect my JAX-RS service using SamlHeaderInHandler. The service expects me to include a valid deflate encoded (compressed) then base 64 encoded token in the Authorization of my RESTful call like this:&lt;/p&gt;

&lt;p&gt;SAML &amp;lt;TOKEN GOES HERE&amp;gt;&lt;/p&gt;

&lt;p&gt;However if instead of inserting a token, I insert the following string &quot;invalid_grant&quot; in the Authrorization header like so:&lt;/p&gt;

&lt;p&gt;SAML invalid_grant&lt;/p&gt;

&lt;p&gt;The following will happen:&lt;br/&gt;
1. SamlHeaderInHandler splits the header into it&apos;s two parts and sends what it thinks is the assertion (the &quot;invalid_grant&quot; string) AbstractSamlBase64InHandler.handleToken&lt;br/&gt;
2. AbstractSamlBase64InHandler.handleToken first base 64 decodes the string. This completes with no error.&lt;br/&gt;
3. AbstractSamlBase64InHandler.handleToken then tries to inflate the assertion.&lt;/p&gt;

&lt;p&gt;It is during this last step that CXF goes into an infinite loop. Here is the code involved:&lt;/p&gt;

&lt;p&gt;        while (!inflater.finished()) {&lt;br/&gt;
            inputLen = inflater.inflate(input);&lt;br/&gt;
            if (!inflater.finished()) &lt;/p&gt;
{
                inflatedToken = new byte[input.length + inflatedLen];
                System.arraycopy(input, 0, inflatedToken, inflatedLen, inputLen);
                inflatedLen += inputLen;
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;When the input is the following byte array:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;94, -27, -122, 110, 16, 59, 41, 43, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;(which is the result from base 64 decoding the string &quot;invalid_grant&quot;)&lt;/p&gt;

&lt;p&gt;The loop never breaks because the test inflater.finished() is never true even if inputLen is 0. Thus the service hangs indefinitely.&lt;/p&gt;

&lt;p&gt;I am classifying this as Critical because, essentially, by crafting a certain type of request, I can execute a denial of service attack against the service.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Linux or Mac, Karaf 2.3.1 container, CXF 2.7.3&lt;/p&gt;</environment>
        <key id="12679491">CXF-5390</key>
            <summary>AbstractSamlBase64InHandler goes into infinite loop when processing bad header value.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="geecxf">Dario Amiri</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Nov 2013 21:17:49 +0000</created>
                <updated>Tue, 26 Nov 2013 17:40:01 +0000</updated>
                            <resolved>Mon, 18 Nov 2013 14:18:25 +0000</resolved>
                                    <version>2.7.3</version>
                                    <fixVersion>3.0.0-milestone1</fixVersion>
                    <fixVersion>2.7.8</fixVersion>
                    <fixVersion>2.6.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13825340" author="sergey_beryozkin" created="Mon, 18 Nov 2013 14:18:25 +0000"  >&lt;p&gt;Thanks for reporting it and actually identifying the source of the problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358851</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1puzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>359141</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>