<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:15:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6317] Authorization not possible with multiple service beans</title>
                <link>https://issues.apache.org/jira/browse/CXF-6317</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Given a jaxrs:server with more than one serviceBean it is not possible to secure them both.&lt;/p&gt;

&lt;p&gt;Take the following configuration (it&apos;s in blueprint, but it shouldn&apos;t matter):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;blueprint xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.osgi.org/xmlns/blueprint/v1.0.0&quot;&lt;/span&gt;
           &lt;span class=&quot;code-keyword&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
           &lt;span class=&quot;code-keyword&quot;&gt;xmlns:jaxrs&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://cxf.apache.org/blueprint/jaxrs&quot;&lt;/span&gt;
           xsi:schemaLocation=&quot;http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
           http://cxf.apache.org/blueprint/jaxrs http://cxf.apache.org/schemas/blueprint/jaxrs.xsd&quot;&amp;gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:server id=&lt;span class=&quot;code-quote&quot;&gt;&quot;myservice&quot;&lt;/span&gt; address=&lt;span class=&quot;code-quote&quot;&gt;&quot;/service&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:inInterceptors&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1AuthorizationInterceptor&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2AuthorizationInterceptor&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:inInterceptors&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:serviceBeans&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:serviceBeans&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:providers&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;authenticationFilter&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:providers&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:server&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1WebService&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.example.Part1WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2WebService&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.example.Part2WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1AuthorizationInterceptor&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.cxf.interceptor.security.SecureAnnotationsInterceptor&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;securedObject&quot;&lt;/span&gt; ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2AuthorizationInterceptor&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.cxf.interceptor.security.SecureAnnotationsInterceptor&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;securedObject&quot;&lt;/span&gt; ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;

&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/blueprint&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since &lt;tt&gt;org.apache.cxf.interceptor.security.SecureAnnotationsInterceptor&lt;/tt&gt; only secures one object, we need two instances, one for each service bean.&lt;/p&gt;

&lt;p&gt;If you walk up &lt;tt&gt;SecureAnnotationsInterceptor&lt;/tt&gt; constructor chain, you&apos;ll end up in &lt;a href=&quot;https://github.com/apache/cxf/blob/cxf-2.7.15/api/src/main/java/org/apache/cxf/phase/AbstractPhaseInterceptor.java#L89-L91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;org.apache.cxf.phase.AbstractPhaseInterceptor&lt;/a&gt; (github link) where the interceptor&apos;s &lt;tt&gt;id&lt;/tt&gt; is set to &lt;tt&gt;getClass().getName()&lt;/tt&gt;. So now we have two interceptors with the same id. When the interceptor chain is built in &lt;a href=&quot;https://github.com/apache/cxf/blob/cxf-2.7.15/api/src/main/java/org/apache/cxf/phase/PhaseInterceptorChain.java#L589-L596&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;org.apache.cxf.phase.PhaseInterceptorChain&lt;/a&gt; the second interceptor is ignored since it has the same id as the first one.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12785197">CXF-6317</key>
            <summary>Authorization not possible with multiple service beans</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="jgogstad">Jostein Gogstad</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Mar 2015 15:36:16 +0000</created>
                <updated>Fri, 14 Oct 2016 14:23:42 +0000</updated>
                            <resolved>Thu, 2 Apr 2015 11:45:35 +0000</resolved>
                                    <version>2.7.15</version>
                                    <fixVersion>3.1</fixVersion>
                    <fixVersion>2.7.16</fixVersion>
                    <fixVersion>3.0.5</fixVersion>
                                    <component>JAX-RS Security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14381643" author="sergey_beryozkin" created="Thu, 26 Mar 2015 09:59:17 +0000"  >&lt;p&gt;Suppose we add the ability to get unique IDs allocated, how would it work afterwards ?&lt;br/&gt;
Say you have one bean covering &quot;a/b&quot; and another one - &quot;a/c&quot;. We do not know in which order the requests will arrive and hence we don&apos;t know which interceptor should run first. &lt;/p&gt;

&lt;p&gt;FYI - I&apos;m off till next Wed.&lt;/p&gt;</comment>
                            <comment id="14381646" author="sergey_beryozkin" created="Thu, 26 Mar 2015 10:03:10 +0000"  >&lt;p&gt;For the record: IMHO the interceptor might need to be enhanced to accept a list of objects instead for it to allocate a class specific RBAC map when it gets the selected Method to be invoked.&lt;/p&gt;</comment>
                            <comment id="14383780" author="jgogstad" created="Fri, 27 Mar 2015 12:46:11 +0000"  >&lt;p&gt;I agree that accepting a list of objects is the best solution, it requires a bit more coding than the simple solution of unique ids, but the resulting API is better to work with.&lt;/p&gt;

&lt;p&gt;Our current solution invokes all authorization interceptors on every request, and it works fine. I expect the same behaviour if you assign unique ids. I don&apos;t know if it&apos;s by design or accident, but the &lt;tt&gt;SimpleAuthorizingInterceptor&lt;/tt&gt; (superclass) returns an empty map of expected roles if the targetMethod doesn&apos;t match the RBAC map, this causes &lt;tt&gt;AbstractAuthorizingInInterceptor&lt;/tt&gt; to pass the request if no &quot;denyRoles&quot; are present.&lt;/p&gt;

&lt;p&gt;In code that translates to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;SecureAnnotationsInterceptorChain.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SecureAnnotationsInterceptorChain &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; AbstractPhaseInterceptor&amp;lt;Message&amp;gt; {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;SecureAnnotationsInterceptor&amp;gt; interceptors;

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; SecureAnnotationsInterceptorChain() {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(Phase.PRE_INVOKE);
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void handleMessage(Message message) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Fault {
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (SecureAnnotationsInterceptor interceptor : interceptors) {
            interceptor.handleMessage(message);
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;SecureAnnotationsInterceptor&amp;gt; getInterceptors() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; interceptors;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setInterceptors(List&amp;lt;SecureAnnotationsInterceptor&amp;gt; interceptors) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.interceptors = interceptors;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;blueprint.xml&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:server id=&lt;span class=&quot;code-quote&quot;&gt;&quot;myservice&quot;&lt;/span&gt; address=&lt;span class=&quot;code-quote&quot;&gt;&quot;/service&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:inInterceptors&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;secureAnnotationsInterceptorChain&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:inInterceptors&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:serviceBeans&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2WebService&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:serviceBeans&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;jaxrs:providers&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;authenticationFilter&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:providers&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/jaxrs:server&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;! -- code from description here --&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bean class=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.example.security.cxf.SecureAnnotationsInterceptorChain&quot;&lt;/span&gt; id=&lt;span class=&quot;code-quote&quot;&gt;&quot;secureAnnotationsInterceptorChain&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;interceptors&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;list&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part1AuthorizationInterceptor&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;ref component-id=&lt;span class=&quot;code-quote&quot;&gt;&quot;part2AuthorizationInterceptor&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/list&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14390457" author="sergey_beryozkin" created="Wed, 1 Apr 2015 11:51:06 +0000"  >&lt;p&gt;That was by design, if a given method is not explicitly restricted then any authenticated user can access it.&lt;/p&gt;

&lt;p&gt;Right, I see now why having multiple interceptors is simpler. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 34 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27a7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>