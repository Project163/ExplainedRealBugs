<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:01:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5056] EndorsingSupportingTokens with both transport security and message layer security applied</title>
                <link>https://issues.apache.org/jira/browse/CXF-5056</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;According to WS-SecurityPolicy, EndorsingSupportingTokens signs timestamp if using transport security, and sign main message signature if using message layer security. &lt;/p&gt;

&lt;p&gt;In CXF WS-Security,   if TLS is used (regardless of Transport policy applied or not), it always requires timestamp be signed, without checking if message layer security is configured and main message signature is endorsed.&lt;/p&gt;

&lt;p&gt;AbstractSupportingTokenPolicyValidator.java&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Check the endorsing supporting token policy. If we&apos;re using the Transport Binding then&lt;/li&gt;
	&lt;li&gt;check that the Timestamp is signed. Otherwise, check that the signature is signed.&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;@return true if the endorsed supporting token policy is correct&lt;br/&gt;
     */&lt;br/&gt;
    private boolean checkEndorsed(List&amp;lt;WSSecurityEngineResult&amp;gt; tokenResults) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {        if (isTLSInUse()) {
            return checkTimestampIsSigned(tokenResults);
        }        return checkSignatureIsSigned(tokenResults);    }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Say  we have a ws-security policy which requires main message signature be endorsed, timestamp itself is not signed by endorsing token, and transport policy is not applied/attached.&lt;br/&gt;
If we run the test case over plain HTTP, the test case passes.&lt;br/&gt;
If we run the test case over HTTPS, the test case fails.&lt;/p&gt;

&lt;p&gt;This raises following questions:&lt;br/&gt;
1. If you have both transport security and message layer security, which one to check? or which one first? or both?&lt;br/&gt;
2. When enforcing EndorsingSupportingToken, does &quot;Transport security&quot; in EndorsingSupportingToken means &quot;Transport Policy Applied&quot; or  &quot;SSL applied regardless of  Transport policy applied&quot;.&lt;/p&gt;

&lt;p&gt;I just want to bring this up for discussion first. If we have a conclusion on how it should work, I will submit a patch.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</description>
                <environment></environment>
        <key id="12651143">CXF-5056</key>
            <summary>EndorsingSupportingTokens with both transport security and message layer security applied</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="chance bj">Chance BJ</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Wed, 5 Jun 2013 16:00:58 +0000</created>
                <updated>Wed, 14 Aug 2013 15:49:24 +0000</updated>
                            <resolved>Fri, 14 Jun 2013 15:53:28 +0000</resolved>
                                    <version>2.6.2</version>
                                    <fixVersion>2.6.9</fixVersion>
                    <fixVersion>2.7.6</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13677040" author="coheigea" created="Thu, 6 Jun 2013 14:06:01 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;What is the use-case of a non-TransportBinding with TLS? If you are using TLS then why not just use a TransportBinding policy?&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="13682313" author="chance bj" created="Thu, 13 Jun 2013 14:58:03 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;Thanks for reply. I hit this problem by accident. When tested endorsing token with message level security/symmetric binding, and it works. Because the web container has TLS support, we just change endpoint to SSL without modifying policy, and test fails due to endorsing checking. &lt;/p&gt;

&lt;p&gt;If we always expect TransportBinding for TLS, should we emit a warning if TransportBinding is not configured?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Chance&lt;/p&gt;</comment>
                            <comment id="13682345" author="sawadood" created="Thu, 13 Jun 2013 15:32:30 +0000"  >&lt;p&gt;If we have an existing application that does not use TransportBinding and we just want to protect it using TLS, do we have to reconfigure the WSPolicy to use TransportBinding?  Does CXF require TransportBinding to be configured if TLS is used?&lt;/p&gt;</comment>
                            <comment id="13683421" author="coheigea" created="Fri, 14 Jun 2013 14:59:45 +0000"  >
&lt;p&gt;I will relax the Endorsing requirement so that it first checks whether a Timestamp is signed (if TLS is in use), and falls back to checking whether a Signature is signed. Just bear in mind that CXF considers a token &quot;signed&quot; if it is received over TLS, which is quite different to how it works on the Message level.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;

&lt;p&gt;Ps. No, CXF does not require the TransportBinding to be used with TLS, although it depends on the use-case.&lt;/p&gt;</comment>
                            <comment id="13688118" author="chance bj" created="Wed, 19 Jun 2013 16:21:49 +0000"  >&lt;p&gt;Hi Colm,&lt;/p&gt;

&lt;p&gt;Thanks! The proposed fix should solve the problem.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Chance&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12653190">CXF-5083</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331469</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l6n3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331801</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>