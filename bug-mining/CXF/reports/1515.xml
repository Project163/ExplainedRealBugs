<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:56:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4595] RequireClientCertificate is not validated</title>
                <link>https://issues.apache.org/jira/browse/CXF-4595</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I can execute a web service which has a RequireClientCertificate=&quot;true&quot; policy in the transport binding, the problem is that my client is not providing a certificate.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12613089">CXF-4595</key>
            <summary>RequireClientCertificate is not validated</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="pellcorp">Jason Pell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Oct 2012 02:19:22 +0000</created>
                <updated>Wed, 19 Dec 2012 14:38:38 +0000</updated>
                            <resolved>Wed, 24 Oct 2012 18:17:54 +0000</resolved>
                                    <version>2.7</version>
                                    <fixVersion>2.5.7</fixVersion>
                    <fixVersion>2.6.4</fixVersion>
                    <fixVersion>2.7.1</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13482065" author="pellcorp" created="Tue, 23 Oct 2012 02:39:58 +0000"  >&lt;p&gt;Run the test case SecurityServiceTest, the test fails because no Policy Exception is returned even though i do have a RequireClientCertificate=&quot;true&quot;&lt;/p&gt;
</comment>
                            <comment id="13482066" author="pellcorp" created="Tue, 23 Oct 2012 02:41:19 +0000"  >&lt;p&gt;Related email trail&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cxf.547215.n5.nabble.com/RequireClientCertificate-confusion-td5717199.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.547215.n5.nabble.com/RequireClientCertificate-confusion-td5717199.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I am happy to contribute a patch as discussed in the email, but I need some advice from the devs as to why the code is in TransportBindingPolicyValidator&lt;/p&gt;</comment>
                            <comment id="13482112" author="pellcorp" created="Tue, 23 Oct 2012 04:54:33 +0000"  >&lt;p&gt;The HttpsTokenInInterceptor is PRE-STREAM&lt;br/&gt;
The PolicyBasedWSS4JInInterceptor is PRE-PROTOCOL&lt;/p&gt;

&lt;p&gt;So according to &lt;a href=&quot;http://cxf.apache.org/docs/interceptors.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cxf.apache.org/docs/interceptors.html&lt;/a&gt;, the HttpsTokenInInterceptor executes first.  So TransportBindingPolicyValidator is definately&lt;br/&gt;
overriding what has already been set in HttpsTokenInInterceptor.&lt;/p&gt;

&lt;p&gt;Should it not be ignoring anything that has already been checked by HttpsTokenInInterceptor?&lt;/p&gt;

&lt;p&gt;In fact should the following code:&lt;/p&gt;

&lt;p&gt;if (binding.getTransportToken() != null) &lt;/p&gt;
{
                assertPolicy(aim, binding.getTransportToken());
                assertPolicy(aim, binding.getTransportToken().getToken());
            }

&lt;p&gt;be removed from TransportBindingPolicyValidator????&lt;/p&gt;</comment>
                            <comment id="13482137" author="pellcorp" created="Tue, 23 Oct 2012 06:05:28 +0000"  >&lt;p&gt;To provide further clarification.  The binding.getTransportToken().getToken() returns the HttpsToken&lt;/p&gt;</comment>
                            <comment id="13482157" author="pellcorp" created="Tue, 23 Oct 2012 06:29:50 +0000"  >&lt;p&gt;This is the code in HttpsTokenInInterceptor that does actually check for the client certificate.  And in my case, my debugging tells me that the setAsserted is false, which is a good thing, but then gets overriden.&lt;/p&gt;


&lt;p&gt;TLSSessionInfo tlsInfo = message.get(TLSSessionInfo.class);                &lt;br/&gt;
                if (tlsInfo != null) {&lt;br/&gt;
                    if (token.isRequireClientCertificate()&lt;br/&gt;
                        &amp;amp;&amp;amp; (tlsInfo.getPeerCertificates() == null &lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; tlsInfo.getPeerCertificates().length == 0)) 
{
                        asserted = false;
                    }
&lt;p&gt;                } else &lt;/p&gt;
{
                    asserted = false;
                }&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;                ai.setAsserted(asserted);&lt;/p&gt;
</comment>
                            <comment id="13482170" author="pellcorp" created="Tue, 23 Oct 2012 07:15:54 +0000"  >&lt;p&gt;I can see that the HttpsTokenOutInterceptor actually throwns an exception upon a policy error.  So should this bit of code be at the bottom of the the assertHttps in HttpsTokenInInterceptor?&lt;/p&gt;

&lt;p&gt;if (!ai.isAsserted()) {&lt;br/&gt;
    throw new PolicyException(ai);&lt;br/&gt;
}&lt;/p&gt;

</comment>
                            <comment id="13482175" author="pellcorp" created="Tue, 23 Oct 2012 07:36:08 +0000"  >&lt;p&gt;proposed patch to HttpsTokenInInterceptor to behave like the HttpsTokenOutInterceptor.&lt;/p&gt;

&lt;p&gt;I will add test cases around this patch if it is acceptable.  No point doing that until developers indicate the approach is ok.&lt;/p&gt;</comment>
                            <comment id="13482197" author="coheigea" created="Tue, 23 Oct 2012 08:25:08 +0000"  >&lt;p&gt;Hi Jason,&lt;/p&gt;

&lt;p&gt;I don&apos;t like the approach you&apos;ve taken in the patch - the HttpsTokenInInterceptor should not throw an exception in case there are other policy alternatives that may work.&lt;/p&gt;

&lt;p&gt;I think the best approach is just to remove the assertPolicy(aim, binding.getTransportToken().getToken()); line from the TransportBindingPolicyValidator.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="13482201" author="pellcorp" created="Tue, 23 Oct 2012 08:35:32 +0000"  >&lt;p&gt;cool i will provide patch and test cases for option you have indicated&lt;/p&gt;</comment>
                            <comment id="13482838" author="pellcorp" created="Tue, 23 Oct 2012 23:53:16 +0000"  >&lt;p&gt;Patch based on Colm feedback plus system test&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12550403" name="PolicySample.tar.gz" size="6627" author="pellcorp" created="Tue, 23 Oct 2012 02:39:58 +0000"/>
                            <attachment id="12550554" name="patch.txt" size="7427" author="pellcorp" created="Tue, 23 Oct 2012 23:53:16 +0000"/>
                            <attachment id="12550420" name="patch.txt" size="2609" author="pellcorp" created="Tue, 23 Oct 2012 07:36:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250489</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ayvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61923</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>