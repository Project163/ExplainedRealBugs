<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:52:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4231] Incorrect handling of &quot;If-None-Match&quot; and &quot;If-Modified-Since&quot; request header combination</title>
                <link>https://issues.apache.org/jira/browse/CXF-4231</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have a case where I set both a (weak) &quot;ETag&quot; and a &quot;Last-Modified&quot; response header. I noticed&lt;br/&gt;
that javax.ws.rs.core.Request.evaluatePreconditions(Date, EntityTag) unexpectedly returns a&lt;br/&gt;
response builder with status code 304 when the ETags differ but the last modified dates are&lt;br/&gt;
identical. This is because after the failing check against the ETag the current code simply performs&lt;br/&gt;
the check against the timestamp. According to RFC 2616, section 14.26 (&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html):&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html):&lt;/a&gt;&lt;br/&gt;
&quot;If none of the entity tags match, then the server MAY perform the requested method as if the If-None-Match header field did not exist, but MUST also ignore any If-Modified-Since header field(s) in the request. That is, if no entity tags match, then the server MUST NOT return a 304 (Not Modified) response.&quot;&lt;br/&gt;
This is currently not the case.&lt;/p&gt;

&lt;p&gt;This code change works for my case, but some deeper thought needs to be given to possible&lt;br/&gt;
request header combinations (If-Match/If-None-Match and If-Modified-Since):&lt;/p&gt;

&lt;p&gt;    public ResponseBuilder evaluatePreconditions(Date lastModified, EntityTag eTag) {&lt;br/&gt;
        final ResponseBuilder rb = evaluatePreconditions(eTag);&lt;br/&gt;
        if (rb != null) &lt;/p&gt;
{
            // the ETag conditions match; so now conditions for last modified must match
            return evaluatePreconditions(lastModified);
        }
&lt;p&gt; else &lt;/p&gt;
{
            // the ETag conditions do not match, so last modified should be ignored
            // see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html (section 14.26 for
            // &quot;If-None-Match&quot;, behavior not specified for &quot;If-Match&quot;, section 14.24)
            return null;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;I assume that the most typical behavior for a browser is to send If-None-Match and If-Modified-Since,&lt;br/&gt;
and this case is currently not working.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12549791">CXF-4231</key>
            <summary>Incorrect handling of &quot;If-None-Match&quot; and &quot;If-Modified-Since&quot; request header combination</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="jengehau">Jan Engehausen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Apr 2012 20:50:21 +0000</created>
                <updated>Mon, 23 Apr 2012 16:45:45 +0000</updated>
                            <resolved>Fri, 6 Apr 2012 09:28:04 +0000</resolved>
                                    <version>2.5</version>
                                    <fixVersion>2.3.10</fixVersion>
                    <fixVersion>2.4.7</fixVersion>
                    <fixVersion>2.5.3</fixVersion>
                    <fixVersion>2.6</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13248210" author="sergey_beryozkin" created="Fri, 6 Apr 2012 09:28:04 +0000"  >&lt;p&gt;Jan, thanks for the patch, applied to the trunk and all the active branches.&lt;/p&gt;</comment>
                            <comment id="13248224" author="jengehau" created="Fri, 6 Apr 2012 10:22:35 +0000"  >&lt;p&gt;Hi Sergey, thanks for putting the patch in. As I said this now works as I expect, but I am not totally sure about other combinations.&lt;/p&gt;</comment>
                            <comment id="13248431" author="sergey_beryozkin" created="Fri, 6 Apr 2012 15:58:04 +0000"  >&lt;p&gt;It appears to me that &quot;the compare the tags first, and check the dates only if the tags match&quot; is very reasonable and as you said it&apos;s the most typical case where the pair of these headers is used, we can definitely enhance the code if there is a more accepted approach toward handling the other combinations &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234782</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b6a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63130</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>