<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:33:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-1560] EndpointReferenceUtils.getSchema threading issue</title>
                <link>https://issues.apache.org/jira/browse/CXF-1560</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;After the first time the service is started and the service is invoked in parallel with multiple threads I get the following&lt;br/&gt;
stacktrace and the service returns a soap-fault:&lt;/p&gt;

&lt;p&gt;30.04.2008 10:24:30 org.apache.cxf.phase.PhaseInterceptorChain doIntercept&lt;br/&gt;
INFO: Interceptor has thrown exception, unwinding now&lt;br/&gt;
java.lang.ArrayIndexOutOfBoundsException: 2 &amp;gt;= 0&lt;br/&gt;
        at java.util.Vector.elementAt(Vector.java:427)&lt;br/&gt;
        at org.apache.xerces.dom.DeferredDocumentImpl.getNodeValueString(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.dom.DeferredDocumentImpl.getNodeValueString(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.dom.DeferredTextImpl.synchronizeData(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.dom.CharacterDataImpl.getNodeValue(Unknown Source)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeDocumentation(XmlSchemaSerializer.java:2002)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeAnnotation(XmlSchemaSerializer.java:1904)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeElement(XmlSchemaSerializer.java:582)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeChoice(XmlSchemaSerializer.java:1229)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeComplexType(XmlSchemaSerializer.java:917)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSchemaChild(XmlSchemaSerializer.java:254)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSchemaElement(XmlSchemaSerializer.java:192)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSchema(XmlSchemaSerializer.java:83)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchema.serialize_internal(XmlSchema.java:452)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchema.write(XmlSchema.java:426)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchema.write(XmlSchema.java:382)&lt;br/&gt;
        at org.apache.cxf.service.model.SchemaInfo.getElement(SchemaInfo.java:82)&lt;br/&gt;
        at org.apache.cxf.wsdl.EndpointReferenceUtils.getSchema(EndpointReferenceUtils.java:541)&lt;br/&gt;
        at org.apache.cxf.interceptor.AbstractInDatabindingInterceptor.setSchemaInMessage(AbstractInDatabindingInterceptor.java:104)&lt;br/&gt;
        at org.apache.cxf.interceptor.AbstractInDatabindingInterceptor.getDataReader(AbstractInDatabindingInterceptor.java:86)&lt;br/&gt;
        at org.apache.cxf.interceptor.AbstractInDatabindingInterceptor.getDataReader(AbstractInDatabindingInterceptor.java:93)&lt;br/&gt;
        at org.apache.cxf.interceptor.DocLiteralInInterceptor.handleMessage(DocLiteralInInterceptor.java:69)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:221)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:77)&lt;br/&gt;
        at org.apache.cxf.transport.local.LocalConduit.dispatchDirect(LocalConduit.java:100)&lt;br/&gt;
        at org.apache.cxf.transport.local.LocalConduit.close(LocalConduit.java:71)&lt;br/&gt;
        at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:221)&lt;br/&gt;
        at org.apache.camel.component.cxf.invoker.CxfClient.invokeWithMessageStream(CxfClient.java:130)&lt;br/&gt;
        at org.apache.camel.component.cxf.invoker.CxfClient.dispatch(CxfClient.java:75)&lt;br/&gt;
        at org.apache.camel.component.cxf.CxfProducer.process(CxfProducer.java:248)&lt;br/&gt;
        at org.apache.camel.component.cxf.CxfProducer.process(CxfProducer.java:170)&lt;br/&gt;
        at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:59)&lt;br/&gt;
        at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:53)&lt;br/&gt;
        at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsynProcessorBridge.process(AsyncProcessorTypeConverter.java:44)&lt;br/&gt;
        at org.apache.camel.processor.DeadLetterChannel.process(DeadLetterChannel.java:143)&lt;br/&gt;
        at org.apache.camel.processor.DeadLetterChannel.process(DeadLetterChannel.java:87)&lt;br/&gt;
        at org.apache.camel.processor.Pipeline.process(Pipeline.java:101)&lt;br/&gt;
        at org.apache.camel.processor.Pipeline.process(Pipeline.java:85)&lt;br/&gt;
        at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:40)&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:44)&lt;br/&gt;
        at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:68)&lt;br/&gt;
        at org.apache.camel.component.cxf.CamelInvoker.invoke(CamelInvoker.java:59)&lt;br/&gt;
        at org.apache.camel.component.cxf.feature.MessageInvokerInterceptor$1.run(MessageInvokerInterceptor.java:51)&lt;br/&gt;
        at org.apache.cxf.workqueue.SynchronousExecutor.execute(SynchronousExecutor.java:37)&lt;br/&gt;
        at org.apache.camel.component.cxf.feature.MessageInvokerInterceptor.handleMessage(MessageInvokerInterceptor.java:71)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:221)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:77)&lt;br/&gt;
        at org.apache.cxf.transport.servlet.ServletDestination.invoke(ServletDestination.java:92)&lt;br/&gt;
        at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:214)&lt;br/&gt;
        at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:151)&lt;br/&gt;
        at org.apache.cxf.transport.servlet.AbstractCXFServlet.invoke(AbstractCXFServlet.java:170)&lt;br/&gt;
        at org.apache.cxf.transport.servlet.AbstractCXFServlet.doPost(AbstractCXFServlet.java:148)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)&lt;br/&gt;
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)&lt;br/&gt;
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)&lt;br/&gt;
        at org.mortbay.jetty.Server.handle(Server.java:324)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:842)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:730)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)&lt;br/&gt;
        at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)&lt;br/&gt;
        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:450)&lt;br/&gt;
30.04.2008 10:24:30 org.apache.cxf.phase.PhaseInterceptorChain doIntercept&lt;br/&gt;
INFO: Interceptor has thrown exception, unwinding now&lt;br/&gt;
java.lang.ArrayIndexOutOfBoundsException: 6 &amp;gt;= 0&lt;br/&gt;
        at java.util.Vector.elementAt(Vector.java:427)&lt;br/&gt;
        at org.apache.xerces.dom.DeferredDocumentImpl.getNodeValueString(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.dom.DeferredDocumentImpl.getNodeValueString(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.dom.DeferredTextImpl.synchronizeData(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.dom.CharacterDataImpl.getNodeValue(Unknown Source)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeDocumentation(XmlSchemaSerializer.java:2002)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeAnnotation(XmlSchemaSerializer.java:1904)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeElement(XmlSchemaSerializer.java:582)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSequence(XmlSchemaSerializer.java:989)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeComplexType(XmlSchemaSerializer.java:913)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSchemaChild(XmlSchemaSerializer.java:254)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSchemaElement(XmlSchemaSerializer.java:192)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchemaSerializer.serializeSchema(XmlSchemaSerializer.java:83)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchema.serialize_internal(XmlSchema.java:452)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchema.write(XmlSchema.java:426)&lt;br/&gt;
        at org.apache.ws.commons.schema.XmlSchema.write(XmlSchema.java:382)&lt;br/&gt;
        at org.apache.cxf.service.model.SchemaInfo.getElement(SchemaInfo.java:82)&lt;br/&gt;
        at org.apache.cxf.wsdl.EndpointReferenceUtils.getSchema(EndpointReferenceUtils.java:541)&lt;br/&gt;
        at org.apache.cxf.interceptor.AbstractInDatabindingInterceptor.setSchemaInMessage(AbstractInDatabindingInterceptor.java:104)&lt;br/&gt;
        at org.apache.cxf.interceptor.AbstractInDatabindingInterceptor.getDataReader(AbstractInDatabindingInterceptor.java:86)&lt;br/&gt;
        at org.apache.cxf.interceptor.AbstractInDatabindingInterceptor.getDataReader(AbstractInDatabindingInterceptor.java:93)&lt;br/&gt;
        at org.apache.cxf.interceptor.DocLiteralInInterceptor.handleMessage(DocLiteralInInterceptor.java:69)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:221)&lt;br/&gt;
...&lt;br/&gt;
...&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;If I invoke a fresh started service once with a single thread and after that with multiple threads it works fine.&lt;/p&gt;

&lt;p&gt;The attached patch fixes that but I&apos;m not sure if it&apos;s the right place and who is at fault here. The overhead by this patch should be minimal.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12395055">CXF-1560</key>
            <summary>EndpointReferenceUtils.getSchema threading issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="gigerstyle">Marc Giger</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Apr 2008 09:35:16 +0000</created>
                <updated>Thu, 3 Jul 2008 17:19:29 +0000</updated>
                            <resolved>Thu, 1 May 2008 12:53:44 +0000</resolved>
                                    <version>2.0.6</version>
                                    <fixVersion>2.1.1</fixVersion>
                    <fixVersion>2.0.7</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12593366" author="dkulp" created="Wed, 30 Apr 2008 16:16:50 +0000"  >
&lt;p&gt;The patch is a bit heavyweight (adds a sync block along the critical message path, even if not needed) so I&apos;m going to change that a bit.   However, it&apos;s also only &quot;part&quot; of the problem.   There are a couple other places in the code where schema&amp;lt;--&amp;gt;doc stuff occurs that may also break with this.   I&apos;m going to go ahead and add a couple other sync blocks and stuff to hopefully fix this.&lt;/p&gt;

&lt;p&gt;Unforunately, svn at apache is down again so I cannot commit it for you to test.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;    I&apos;m going to attach a patch with my changes.   If you could give that a try, that would be great.&lt;/p&gt;
</comment>
                            <comment id="12593410" author="gigerstyle" created="Wed, 30 Apr 2008 19:10:23 +0000"  >&lt;p&gt;Hi Daniel,&lt;br/&gt;
My patch was not meant to apply as is. It just should show the problematic code part, and the possible solution&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Your patch works as expected.&lt;/p&gt;

&lt;p&gt;Is your patch against cxf-2.1? I&apos;ve tested it with cxf-2.0.6&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12593412" author="dkulp" created="Wed, 30 Apr 2008 19:16:37 +0000"  >
&lt;p&gt;Yea, my patch is against 2.1 as I pretty much always fix things there and then merge the fixes back to 2.0.x.  &lt;/p&gt;

&lt;p&gt;Thanks for the report.  Once svn is back up, I&apos;ll get it committed and merged back 2.0.x.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12381196" name="cxf-1560.patch" size="11966" author="dkulp" created="Wed, 30 Apr 2008 16:16:50 +0000"/>
                            <attachment id="12381175" name="cxf-2.0.6-threading-issue.patch" size="722" author="gigerstyle" created="Wed, 30 Apr 2008 09:36:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>112352</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sylz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>167084</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>