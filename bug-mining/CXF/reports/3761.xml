<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:40:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-9093] Client does not send entire payload (if size ~&gt; 2500 bytes) when hc5, TLS1.3 are used</title>
                <link>https://issues.apache.org/jira/browse/CXF-9093</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;With two different servers (one from ServiceNow and one from Zendesk), if my CXF client uses HC5 (cxf-rt-transports-http-hc5-4.1.0.jar is in classpath), the size of the JSON payload + HTTP headers ~&amp;gt; 2500 bytes, and TLS 1.3 is used, then the client would not send the entire payload to server.&#160; Both sides would idle after the SSL handshake and client sends a small packet until either the server closes the connection (resulting connectionClosedException) or client times out, depending on the server configuration.&lt;/p&gt;

&lt;p&gt;If any of the three conditions is changed, i.e., 1) not using hc5, 2) reducing the payload size so that payload+headers &amp;lt; 2000 bytes, or 3) forcing the use of TLS1.2, the problem would go away.&#160;&#160;&lt;/p&gt;

&lt;p&gt;This does not happen with every TLS1.3 server.&#160; For some TLS1.3 servers, I have not encountered the issue.&lt;/p&gt;

&lt;p&gt;I am not sure if this is a CXF client problem, but since it happens against two different servers, I thought I should report it to CXF.&#160; My Wireshark log does not reveal much info given that the data are encrypted and I do not have the server&apos;s private key.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</description>
                <environment></environment>
        <key id="13603486">CXF-9093</key>
            <summary>Client does not send entire payload (if size ~&gt; 2500 bytes) when hc5, TLS1.3 are used</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10005">Workaround</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bocamel">John Yin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 31 Dec 2024 15:16:41 +0000</created>
                <updated>Thu, 9 Jan 2025 18:02:24 +0000</updated>
                            <resolved>Thu, 9 Jan 2025 02:07:17 +0000</resolved>
                                    <version>4.1.0</version>
                                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17909078" author="bocamel" created="Tue, 31 Dec 2024 15:25:49 +0000"  >&lt;p&gt;Here is the stacktrace when the server closed the connection exactly 1 minute after waiting for client&apos;s payload:&lt;/p&gt;

&lt;p&gt;org.apache.cxf.interceptor.Fault: Could not send Message.&lt;br/&gt;
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:67) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient.doRunInterceptorChain(AbstractClient.java:717) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doChainedInvocation(WebClient.java:1085) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:931) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.doInvoke(WebClient.java:900) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.WebClient.invoke(WebClient.java:363) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.cxf.jaxrs.CxfRsProducer.invokeHttpClient(CxfRsProducer.java:339) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-cxf-rest-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.cxf.jaxrs.CxfRsProducer.process(CxfRsProducer.java:103) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-cxf-rest-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.support.SynchronousDelegateProducer.process(SynchronousDelegateProducer.java:48) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-support-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:65) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-support-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:208) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:323) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:95) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:323) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:115) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.doRun(DefaultReactiveExecutor.java:199) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.executeReactiveWork(DefaultReactiveExecutor.java:189) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.tryExecuteReactiveWork(DefaultReactiveExecutor.java:166) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.processor.Pipeline.process(Pipeline.java:163) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-processor-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:323) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-base-engine-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.seda.SedaConsumer.sendToConsumers(SedaConsumer.java:291) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-seda-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.seda.SedaConsumer.doRun(SedaConsumer.java:191) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-seda-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.camel.component.seda.SedaConsumer.run(SedaConsumer.java:129) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-seda-4.8.2.jar:4.8.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.Thread.run(Unknown Source) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: org.apache.hc.core5.http.ConnectionClosedException: ConnectionClosedException invoking &lt;a href=&quot;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident/INC41941300:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://siemensfuturenowprod.service-now.com:443/api/sieag/siam/incident/INC41941300:&lt;/a&gt; Connection closed by peer&lt;br/&gt;
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1452) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1433) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.asyncclient.hc5.AsyncHTTPConduit$AsyncWrappedOutputStream.close(AsyncHTTPConduit.java:440) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-hc5-4.1.0.jar!/:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.io.AbstractWrappedOutputStream.close(AbstractWrappedOutputStream.java:77) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.io.CacheAndWriteOutputStream.postClose(CacheAndWriteOutputStream.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.io.CachedOutputStream.close(CachedOutputStream.java:232) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:717) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HttpClientHTTPConduit.close(HttpClientHTTPConduit.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:63) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; ... 31 more&lt;br/&gt;
Caused by: org.apache.hc.core5.http.ConnectionClosedException: Connection closed by peer&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1StreamDuplexer.onInput(AbstractHttp1StreamDuplexer.java:353) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1IOEventHandler.inputReady(AbstractHttp1IOEventHandler.java:64) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.ClientHttp1IOEventHandler.inputReady(ClientHttp1IOEventHandler.java:41) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.client5.http.impl.async.LoggingIOSession$1.inputReady(LoggingIOSession.java:238) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient5-5.4.1.jar:5.4.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession.decryptData(SSLIOSession.java:641) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession.access$200(SSLIOSession.java:74) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession$1.inputReady(SSLIOSession.java:202) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.InternalDataChannel.onIOEvent(InternalDataChannel.java:143) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.InternalChannel.handleIOEvent(InternalChannel.java:51) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.processEvents(SingleCoreIOReactor.java:176) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.doExecute(SingleCoreIOReactor.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.AbstractSingleCoreIOReactor.execute(AbstractSingleCoreIOReactor.java:92) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.IOReactorWorker.run(IOReactorWorker.java:44) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; ... 1 more&lt;/p&gt;</comment>
                            <comment id="17909434" author="reta" created="Thu, 2 Jan 2025 23:35:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; I am wondering if it is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-2328&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HTTPCLIENT-2328&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="17909449" author="reta" created="Fri, 3 Jan 2025 02:50:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; I am able to reproduce the behavior only when chunking is disabled:&lt;/p&gt;

&lt;p&gt;        HTTPConduit http = (HTTPConduit) client.getConduit();&lt;br/&gt;
        http.getClient().setAllowChunking(false);&lt;/p&gt;

&lt;p&gt;Could you please help me out with chunking enabled:&lt;br/&gt;
&#160;&lt;br/&gt;
        HTTPConduit http = (HTTPConduit) client.getConduit();&lt;br/&gt;
        http.getClient().setAllowChunking(true);&lt;/p&gt;</comment>
                            <comment id="17909620" author="bocamel" created="Fri, 3 Jan 2025 16:14:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, thanks for taking the time and effort to reproduce the issue!&lt;/p&gt;

&lt;p&gt;I did try setting AllowChunking=&quot;true&quot; (in my XML bean config).&#160; For the test against a ServiceNow server, I did not encounter the issue.&#160; I only encountered the connectionClosedException when AllowChunking=&quot;false&quot;.&#160; You are correct.&lt;/p&gt;

&lt;p&gt;I also tried this with a Zendesk server.&#160; I received a timeout exception in both cases (with AllowChunking set to true or false) after the CXF client refused to send the message payload to the server.&#160; The timeout was triggered by the CXF client which was configured to timeout after 300 seconds.&#160; If I change it to TLS 1.2, everything works fine.&#160; Here is the timeout stacktrace:&lt;/p&gt;

&lt;p&gt;jakarta.ws.rs.ProcessingException: java.net.SocketTimeoutException: 300000 MILLISECONDS&lt;br/&gt;
&#160; &#160; at org.apache.cxf.jaxrs.client.AbstractClient$ConnectionFaultInterceptor.handleMessage(AbstractClient.java:1266) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-rs-client-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:307) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.interceptor.AbstractFaultChainInitiatorObserver.onMessage(AbstractFaultChainInitiatorObserver.java:112) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream$1.run(HTTPConduit.java:1250) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-rt-transports-http-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.workqueue.AutomaticWorkQueueImpl$3.run(AutomaticWorkQueueImpl.java:413) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.cxf.workqueue.AutomaticWorkQueueImpl$AWQThreadFactory$1.run(AutomaticWorkQueueImpl.java:346) &lt;span class=&quot;error&quot;&gt;&amp;#91;cxf-core-4.1.0.jar:4.1.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at java.base/java.lang.Thread.run(Thread.java:840) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: 300000 MILLISECONDS&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.io.SocketTimeoutExceptionFactory.create(SocketTimeoutExceptionFactory.java:50) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1StreamDuplexer.onTimeout(AbstractHttp1StreamDuplexer.java:402) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.AbstractHttp1IOEventHandler.timeout(AbstractHttp1IOEventHandler.java:82) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.http.impl.nio.ClientHttp1IOEventHandler.timeout(ClientHttp1IOEventHandler.java:41) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.client5.http.impl.async.LoggingIOSession$1.timeout(LoggingIOSession.java:248) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient5-5.4.1.jar:5.4.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.ssl.SSLIOSession$1.timeout(SSLIOSession.java:223) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.InternalDataChannel.onTimeout(InternalDataChannel.java:170) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.InternalChannel.checkTimeout(InternalChannel.java:67) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.checkTimeout(SingleCoreIOReactor.java:239) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.validateActiveChannels(SingleCoreIOReactor.java:166) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.SingleCoreIOReactor.doExecute(SingleCoreIOReactor.java:128) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.AbstractSingleCoreIOReactor.execute(AbstractSingleCoreIOReactor.java:92) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&#160; &#160; at org.apache.hc.core5.reactor.IOReactorWorker.run(IOReactorWorker.java:44) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore5-5.3.1.jar:5.3.1&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17909942" author="reta" created="Sun, 5 Jan 2025 18:13:39 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt;, the timeout I see consistently reproducible, will be looking into the cause.&lt;/p&gt;</comment>
                            <comment id="17910917" author="reta" created="Wed, 8 Jan 2025 03:16:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; I figured out the problem (I think), could you please try to run your client applications with this JVM system property set: -Djsse.SSLEngine.acceptLargeFragments=true&lt;/p&gt;</comment>
                            <comment id="17911151" author="ffang" created="Wed, 8 Jan 2025 16:01:22 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Just FYI, in my environment I see both ClientAuthTest#testDirectTrustTls13LargeChunking and ClientAuthTest#testDirectTrustTls13LargeNoChunking hang(so seems there is no difference between chunking and no chunking for me), but with -Djsse.SSLEngine.acceptLargeFragments=true they both passed.&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="17911157" author="reta" created="Wed, 8 Jan 2025 16:20:49 +0000"  >&lt;p&gt;Thanks a lot, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ffang&quot; class=&quot;user-hover&quot; rel=&quot;ffang&quot;&gt;ffang&lt;/a&gt;! &lt;/p&gt;</comment>
                            <comment id="17911247" author="bocamel" created="Wed, 8 Jan 2025 22:19:55 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, I tried -Djsse.SSLEngine.acceptLargeFragments=true (by adding&#160;environment(&quot;jsse.SSLEngine.acceptLargeFragments&quot;, &quot;true&quot;) to my gradle task) against both servers that I had problems with.&#160; Unfortunately, it did not help.&#160; The sessions still hang.&#160; Again, if I force the client to use TLS1.2, everything would work.&#160; I am using JDK 17 (the Amazon Corretto which is based on Hotspot).&#160;&#160;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="17911249" author="reta" created="Wed, 8 Jan 2025 22:26:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt; it should be systemProperty(&quot;jsse.SSLEngine.acceptLargeFragments&quot;, &quot;true&quot;) , not enviroment&lt;/p&gt;</comment>
                            <comment id="17911270" author="bocamel" created="Thu, 9 Jan 2025 00:16:11 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reta&quot; class=&quot;user-hover&quot; rel=&quot;reta&quot;&gt;reta&lt;/a&gt;, yes, it worked!&#160; Thanks!&lt;/p&gt;</comment>
                            <comment id="17911291" author="reta" created="Thu, 9 Jan 2025 02:06:59 +0000"  >&lt;p&gt;Awesome, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bocamel&quot; class=&quot;user-hover&quot; rel=&quot;bocamel&quot;&gt;bocamel&lt;/a&gt;, I am closing this issue, we have a workaround but the fix is needed in HttpCore (linked issue).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="13604314">HTTPCORE-775</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            43 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tcxs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>