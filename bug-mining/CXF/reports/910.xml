<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:46:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-3470] WildcardTypeImpl cannot be cast to java.lang.Class - Class Cast exception thrown after upgrading from 2.2.3 to 2.4.0</title>
                <link>https://issues.apache.org/jira/browse/CXF-3470</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;My project was working fine with CXF version 2.2.3. After trying to upgrade to 2.3.2 and 2.4.0, in both cases I&apos;m getting the following exception:&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: sun.reflect.generics.reflectiveObjects.WildcardTypeImpl cannot be cast to java.lang.Class&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.InjectionUtils.getActualType(InjectionUtils.java:204)&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.InjectionUtils.getActualType(InjectionUtils.java:209)&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.InjectionUtils.getActualType(InjectionUtils.java:209)&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.InjectionUtils.getActualType(InjectionUtils.java:192)&lt;br/&gt;
	at org.apache.cxf.jaxrs.provider.ProviderFactory.compareClasses(ProviderFactory.java:778)&lt;br/&gt;
	at org.apache.cxf.jaxrs.provider.ProviderFactory.access$400(ProviderFactory.java:61)&lt;br/&gt;
	at org.apache.cxf.jaxrs.provider.ProviderFactory$ClassComparator.compare(ProviderFactory.java:760)&lt;br/&gt;
	at java.util.Arrays.mergeSort(Arrays.java:1270)&lt;br/&gt;
	at java.util.Arrays.sort(Arrays.java:1210)&lt;br/&gt;
	at java.util.Collections.sort(Collections.java:159)&lt;br/&gt;
	at org.apache.cxf.jaxrs.provider.ProviderFactory.chooseMessageReader(ProviderFactory.java:508)&lt;br/&gt;
	at org.apache.cxf.jaxrs.provider.ProviderFactory.createMessageBodyReader(ProviderFactory.java:304)&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.JAXRSUtils.readFromMessageBody(JAXRSUtils.java:1004)&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.JAXRSUtils.processParameter(JAXRSUtils.java:594)&lt;br/&gt;
	at org.apache.cxf.jaxrs.utils.JAXRSUtils.processParameters(JAXRSUtils.java:559)&lt;br/&gt;
	at org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor.processRequest(JAXRSInInterceptor.java:230)&lt;br/&gt;
	at org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor.handleMessage(JAXRSInInterceptor.java:88)&lt;br/&gt;
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)&lt;br/&gt;
	at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:118)&lt;br/&gt;
	at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:208)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invokeDestination(ServletController.java:223)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.ServletController.invoke(ServletController.java:166)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.CXFNonSpringServlet.invoke(CXFNonSpringServlet.java:113)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:184)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doPost(AbstractHTTPServlet.java:107)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)&lt;br/&gt;
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:163)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)&lt;br/&gt;
...&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:563)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)&lt;br/&gt;
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)&lt;br/&gt;
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:680)&lt;/p&gt;




&lt;p&gt;Method declaration is like (not working in CXF v2.4.0... but worked fine in v2.2.3):&lt;/p&gt;

&lt;p&gt;    @POST&lt;br/&gt;
    @Path(&quot;mypath&quot;)&lt;br/&gt;
    @Consumes(&lt;/p&gt;
{&quot;application/json&quot;, &quot;application/xml&quot;})&lt;br/&gt;
    public JAXBElement&amp;lt;MyElement&amp;gt; methodName(JAXBElement&amp;lt;? extends ParentClass&amp;gt; zzz)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Workaround is to declare method like:&lt;br/&gt;
&lt;br/&gt;
    @POST&lt;br/&gt;
    @Path(&quot;mypath&quot;)&lt;br/&gt;
    @Consumes({&quot;application/json&quot;, &quot;application/xml&quot;}
&lt;p&gt;)&lt;br/&gt;
    public JAXBElement&amp;lt;MyElement&amp;gt; methodName(ParentClass zzz)&lt;/p&gt;</description>
                <environment>&lt;p&gt;java version &quot;1.6.0_24&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_24-b07-334-10M3326)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 19.1-b02-334, mixed mode)&lt;/p&gt;

&lt;p&gt;Apache Tomcat/6.0.32&lt;/p&gt;

&lt;p&gt;Darwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011; root:xnu-1504.9.37~1/RELEASE_I386 i386&lt;/p&gt;</environment>
        <key id="12505122">CXF-3470</key>
            <summary>WildcardTypeImpl cannot be cast to java.lang.Class - Class Cast exception thrown after upgrading from 2.2.3 to 2.4.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="carlos.marin">Carlos Marin</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Apr 2011 16:51:55 +0000</created>
                <updated>Mon, 8 Aug 2011 14:43:39 +0000</updated>
                            <resolved>Wed, 27 Apr 2011 10:34:02 +0000</resolved>
                                    <version>2.3.2</version>
                    <version>2.4</version>
                                    <fixVersion>2.4.1</fixVersion>
                    <fixVersion>2.3.5</fixVersion>
                                    <component>JAX-RS</component>
                    <component>JAXB Databinding</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13024929" author="carlos.marin" created="Mon, 25 Apr 2011 19:52:57 +0000"  >&lt;p&gt;Please consider the following to fix the issue.&lt;/p&gt;</comment>
                            <comment id="13024931" author="carlos.marin" created="Mon, 25 Apr 2011 19:54:39 +0000"  >&lt;p&gt;Please consider the following to fix:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
 Index: src/main/java/org/apache/cxf/jaxrs/utils/InjectionUtils.java
 ===================================================================
 --- src/main/java/org/apache/cxf/jaxrs/utils/InjectionUtils.java	(revision 1095513)
 +++ src/main/java/org/apache/cxf/jaxrs/utils/InjectionUtils.java	(working copy)
 @@ -30,6 +30,7 @@
  import java.lang.reflect.Proxy;
  import java.lang.reflect.Type;
  import java.lang.reflect.TypeVariable;
 +import java.lang.reflect.WildcardType;
  import java.security.AccessController;
  import java.security.PrivilegedAction;
  import java.util.ArrayList;
 @@ -197,10 +198,18 @@
         if (genericType == null) {
             return null;
         }
 -        if (!ParameterizedType.class.isAssignableFrom(genericType.getClass())) {
 +        if (!ParameterizedType.class.isAssignableFrom(genericType.getClass())) { 
             if (genericType instanceof TypeVariable) {
                 genericType = getType(((TypeVariable)genericType).getBounds(), pos);
 +            } else if (genericType instanceof WildcardType) { 
 +                WildcardType wildcardType = (WildcardType)genericType;
 +                Type[] bounds = wildcardType.getLowerBounds(); // &apos;? extends Number&apos;
 +                if (bounds.length == 0) { 
 +                    bounds = wildcardType.getUpperBounds(); // &apos;? super Integer&apos;
 +                }
 +                genericType = getType(bounds, pos);
             }
 +            
             Class&amp;lt;?&amp;gt; cls = (Class&amp;lt;?&amp;gt;)genericType;
             return cls.isArray() ? cls.getComponentType() : cls;
         }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13025721" author="sergey_beryozkin" created="Wed, 27 Apr 2011 10:34:02 +0000"  >&lt;p&gt;Carlos - your patch has been applied, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12477328" name="patch.txt" size="1551" author="carlos.marin" created="Mon, 25 Apr 2011 19:52:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5838</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b9an:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63618</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>