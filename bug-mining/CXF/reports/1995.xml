<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:04:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5335] Incorrect handle of ws-policy 1.1 (Incorrect inclusion value: null)</title>
                <link>https://issues.apache.org/jira/browse/CXF-5335</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I created of JAX-WS client for working with &quot;third-party&quot; web service.&lt;br/&gt;
Web service provides the WSDL with ws-policy settings:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;sp:AsymmetricBinding
	&lt;span class=&quot;code-keyword&quot;&gt;xmlns:sp&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://schemas.xmlsoap.org/ws/2005/07/securitypolicy&quot;&lt;/span&gt;&amp;gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;wsp:Policy&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sp:InitiatorToken&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;wsp:Policy&amp;gt;&lt;/span&gt;
				&amp;lt;sp:X509Token
					sp:IncludeToken=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient&quot;&lt;/span&gt;&amp;gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;wsp:Policy&amp;gt;&lt;/span&gt;
						&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sp:WssX509V3Token10 /&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/wsp:Policy&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/sp:X509Token&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/wsp:Policy&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/sp:InitiatorToken&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sp:RecipientToken&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;wsp:Policy&amp;gt;&lt;/span&gt;
				&amp;lt;sp:X509Token
					sp:IncludeToken=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToInitiator&quot;&lt;/span&gt;&amp;gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;wsp:Policy&amp;gt;&lt;/span&gt;
						&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sp:WssX509V3Token10 /&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/wsp:Policy&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/sp:X509Token&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/wsp:Policy&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/sp:RecipientToken&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sp:AlgorithmSuite&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;During of the client execution I got next exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.cxf.binding.soap.SoapFault: Incorrect inclusion value: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
Caused by: java.lang.RuntimeException: Incorrect inclusion value: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	at org.apache.cxf.ws.security.policy.model.Token.setInclusion(Token.java:70)
	at org.apache.cxf.ws.security.policy.builders.X509TokenBuilder.build(X509TokenBuilder.java:69)
	at org.apache.cxf.ws.security.policy.builders.X509TokenBuilder.build(X509TokenBuilder.java:40)
	at org.apache.neethi.AssertionBuilderFactoryImpl.invokeBuilder(AssertionBuilderFactoryImpl.java:138)
	at org.apache.neethi.AssertionBuilderFactoryImpl.build(AssertionBuilderFactoryImpl.java:117)
	at org.apache.neethi.PolicyBuilder.processOperationElement(PolicyBuilder.java:224)
	at org.apache.neethi.PolicyBuilder.getPolicyOperator(PolicyBuilder.java:174)
	at org.apache.neethi.PolicyBuilder.getPolicy(PolicyBuilder.java:124)
. . .
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After examining the documentation for WS-Policy specification v.1.1, I found a difference in the list of X.509 token inclusions. Specification Errata contains token inclusion as in WSDL: &amp;lt;...&amp;gt;/AlwaysToInitiator. &quot;Base&quot; specification is not contains of that inclusion.&lt;/p&gt;

&lt;p&gt;CXF implementation of ws-policy 1.1 is not contains the constant for &quot;Errata&quot; version of the specification (i.e. not contains constant for &lt;a href=&quot;http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToInitiator&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToInitiator&lt;/a&gt;) and as result the code throw RuntimeException.&lt;/p&gt;

&lt;p&gt;In runtime after executing the method from class org.apache.cxf.ws.security.policy.SP11Constants:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; IncludeTokenType getInclusionFromAttributeValue(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value) {
   
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (INCLUDE_ALWAYS.equals(value)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; IncludeTokenType.INCLUDE_TOKEN_ALWAYS;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (INCLUDE_ALWAYS_TO_RECIPIENT.equals(value)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_RECIPIENT;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (INCLUDE_NEVER.equals(value)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; IncludeTokenType.INCLUDE_TOKEN_NEVER;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (INCLUDE_ONCE.equals(value)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; IncludeTokenType.INCLUDE_TOKEN_ONCE;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; StringUtils.isEmpty(value) ? IncludeTokenType.INCLUDE_TOKEN_ALWAYS : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;return result is NULL and next code from class org.apache.cxf.ws.security.policy.model.Token:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setInclusion(IncludeTokenType inclusion) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (IncludeTokenType.INCLUDE_TOKEN_ALWAYS == inclusion
            || IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_RECIPIENT == inclusion
            || IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_INITIATOR == inclusion
            || IncludeTokenType.INCLUDE_TOKEN_NEVER == inclusion 
            || IncludeTokenType.INCLUDE_TOKEN_ONCE == inclusion) {
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.inclusion = inclusion;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-comment&quot;&gt;// TODO replace &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; with a proper (WSSPolicyException) exception
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Incorrect inclusion value: &quot;&lt;/span&gt; + inclusion);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;throws of RuntimeException...&lt;/p&gt;

&lt;p&gt;Please help me solve this problem!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12673702">CXF-5335</key>
            <summary>Incorrect handle of ws-policy 1.1 (Incorrect inclusion value: null)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coheigea">Colm O hEigeartaigh</assignee>
                                    <reporter username="Guhbers">Kirill Sokolov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Oct 2013 14:55:49 +0000</created>
                <updated>Tue, 26 Nov 2013 17:40:07 +0000</updated>
                            <resolved>Tue, 15 Oct 2013 10:36:47 +0000</resolved>
                                    <version>2.7.6</version>
                                    <fixVersion>2.7.8</fixVersion>
                    <fixVersion>2.6.11</fixVersion>
                                    <component>WS-* Components</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353325</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 6 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ox0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353618</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>