<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:39:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8812] Content-Type header created with collection containing &quot;null&quot; value</title>
                <link>https://issues.apache.org/jira/browse/CXF-8812</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have a simple REST web service method, deployed in tomcat, as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@GET
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void someMethod(@Context HttpHeaders httpHeaders) {
...
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When calling it, I get the following injected:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13054695/13054695_image-2023-01-22-13-04-32-164.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I am expecting to get NO &quot;Content-Type&quot; header at all, because it hasn&apos;t been sent (verified by tcp dump).&lt;/p&gt;

&lt;p&gt;Btw. httpHeaders.getMediaType() works as expected (returning null) because it can cope with this situation.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OpenJDK 1.8.0_352&lt;/p&gt;

&lt;p&gt;CentOS 7&lt;/p&gt;

&lt;p&gt;Tomcat 8.5.57&lt;/p&gt;

&lt;p&gt;Spring 4.3.30.RELEASE&lt;/p&gt;

&lt;p&gt;CXF 3.5.5&lt;/p&gt;</environment>
        <key id="13520922">CXF-8812</key>
            <summary>Content-Type header created with collection containing &quot;null&quot; value</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="reta">Andriy Redko</assignee>
                                    <reporter username="enrice">Erich Mauerb&#246;ck</reporter>
                        <labels>
                    </labels>
                <created>Sun, 22 Jan 2023 12:19:28 +0000</created>
                <updated>Mon, 22 Jan 2024 19:37:58 +0000</updated>
                            <resolved>Fri, 19 Jan 2024 15:52:55 +0000</resolved>
                                    <version>3.5.5</version>
                                    <fixVersion>3.5.8</fixVersion>
                    <fixVersion>3.6.3</fixVersion>
                    <fixVersion>4.0.4</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17807007" author="reta" created="Tue, 16 Jan 2024 02:02:15 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enrice&quot; class=&quot;user-hover&quot; rel=&quot;enrice&quot;&gt;enrice&lt;/a&gt; ,&lt;/p&gt;

&lt;p&gt;Thanks for reporting this behavior, what looked like a bug turned out to be quite a designed behavior, there are 2 parts to this:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the Content-Type header is indeed not sent in the request, and the CXF sets the header to &quot;null&quot; (since headers are multivalues, it is represented as a singleton list with &quot;null&quot; value)&lt;/li&gt;
	&lt;li&gt;it is logical to assume that if header is not present, it should not be in the list of headers (or at least have a &quot;null&quot; value), but the Content-Type is used in many places and large number of critical paths rely on the presence of the Content-Type header (not its value) for historical reasons, so removing it breaks the existing applications&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;At the end, the value of the header is still &quot;null&quot;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; requestHeader = httpHeaders.getRequestHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt;).get(0) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So the fact it is present as a collection with single &quot;null&quot; (even if not sent in the request) could be a bit confusing / annoying at first, but it should not lead to any behavior change.&lt;/p&gt;</comment>
                            <comment id="17807077" author="JIRAUSER298723" created="Tue, 16 Jan 2024 07:32:06 +0000"  >&lt;p&gt;It does, actually. I &quot;forward&quot; this request to another service, so as a workaround I have to manually remove the header for the target service to work as expected. (I use Spring&apos;s RestTemplate and don&apos;t have control over the target service&apos;s implementation)&lt;/p&gt;</comment>
                            <comment id="17807236" author="reta" created="Tue, 16 Jan 2024 13:29:09 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enrice&quot; class=&quot;user-hover&quot; rel=&quot;enrice&quot;&gt;enrice&lt;/a&gt; , could you please elaborate why &quot;null&quot; value of the header does cause the issues for you?&#160; May be some examples of the code how you do that may help (just trying to figure out if we have an opportunity to improve the APIs there). Thank you.&lt;/p&gt;</comment>
                            <comment id="17807281" author="JIRAUSER298723" created="Tue, 16 Jan 2024 14:49:01 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@GET
@Produces(MediaType.APPLICATION_JSON)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Response getMethod(@Context Request request, @Context HttpHeaders httpHeaders) {
	&lt;span class=&quot;code-comment&quot;&gt;// workaround (bug in CXF?): remove content-type header &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; GET request
&lt;/span&gt;	MultivaluedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; headersCopy = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MetadataMap&amp;lt;&amp;gt;(httpHeaders.getRequestHeaders(), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
	headersCopy.remove(HttpHeaders.CONTENT_TYPE);

	RequestEntity&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; requestEntity = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RequestEntity&amp;lt;&amp;gt;(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, CollectionUtils.toMultiValueMap(headersCopy), HttpMethod.resolve(request.getMethod()), UriComponentsBuilder.fromHttpUrl(&lt;span class=&quot;code-quote&quot;&gt;&quot;target url&quot;&lt;/span&gt;).build().toUri());
	ResponseEntity&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; responseEntity;
	RestTemplate restTemplate = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RestTemplate();

	&lt;span class=&quot;code-comment&quot;&gt;// works but fails without workaround because target service doesn&apos;t accept available content-type header (which is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; however) on GET request
&lt;/span&gt;	responseEntity = restTemplate.exchange(requestEntity, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class);
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17807923" author="reta" created="Wed, 17 Jan 2024 22:36:53 +0000"  >&lt;p&gt;Thank you, I think I figured out the right place to have the headers filtered out (limiting it to JAX-RS only), the pull request is out (if you could give it a try before we merge it, would be much appreciated). Thank you.&lt;/p&gt;</comment>
                            <comment id="17808307" author="JIRAUSER298723" created="Thu, 18 Jan 2024 17:03:45 +0000"  >&lt;p&gt;actually no, I am afraid. Cannot get it to build on windows. can you provide a binary replacement for the 3.5.x baseline (Java 8 compatible)?&lt;/p&gt;</comment>
                            <comment id="17808713" author="reta" created="Fri, 19 Jan 2024 15:52:48 +0000"  >&lt;p&gt;The new 3.5.8 snapshosts should be available now, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enrice&quot; class=&quot;user-hover&quot; rel=&quot;enrice&quot;&gt;enrice&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17809512" author="JIRAUSER298723" created="Mon, 22 Jan 2024 15:31:55 +0000"  >&lt;p&gt;tested with 3.5.8-SNAPSHOT, seems to work OK now.&lt;/p&gt;</comment>
                            <comment id="17809616" author="reta" created="Mon, 22 Jan 2024 19:37:58 +0000"  >&lt;p&gt;Thank you for confirming&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13054695" name="image-2023-01-22-13-04-32-164.png" size="26340" author="enrice" created="Sun, 22 Jan 2023 12:04:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1faco:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>