<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:57:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-4482] AttachmentSerializer puts an extra new line</title>
                <link>https://issues.apache.org/jira/browse/CXF-4482</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;&lt;em&gt;AttachmentSerializer&lt;/em&gt; always puts an extra new line before writing the root attachment boundary and headers. Because of that the HTTP request which contains only attachments has two line breaks after request headers. That is not understood by some service providers and they do not process the request.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
Pragma: no-cache
Connection: keep-alive
Content-Length: 92010
&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; line&amp;gt;
&amp;lt;another &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; line&amp;gt;
--uuid:467a6f94-55c4-43fe-9e4a-09d63b0bc589
Content-Type: application/xml
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12604332">CXF-4482</key>
            <summary>AttachmentSerializer puts an extra new line</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="lsassexe">Kirill Kadyrko</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Aug 2012 06:23:47 +0000</created>
                <updated>Wed, 4 Feb 2015 05:45:55 +0000</updated>
                            <resolved>Tue, 20 Nov 2012 07:03:11 +0000</resolved>
                                    <version>2.6.1</version>
                                    <fixVersion>2.5.7</fixVersion>
                    <fixVersion>2.6.4</fixVersion>
                    <fixVersion>2.7.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13440032" author="ffang" created="Thu, 23 Aug 2012 03:58:28 +0000"  >&lt;p&gt;commit fix&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1375972&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1375972&amp;amp;view=rev&lt;/a&gt; for trunk&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1375978&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1375978&amp;amp;view=rev&lt;/a&gt; for 2.6.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1376357&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1376357&amp;amp;view=rev&lt;/a&gt; for 2.5.x branch&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1376358&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1376358&amp;amp;view=rev&lt;/a&gt; for 2.4.x branch&lt;/p&gt;</comment>
                            <comment id="13500523" author="hraab" created="Mon, 19 Nov 2012 19:20:41 +0000"  >&lt;p&gt;This fix introduces a new problem. The LF (w/o CR) leads to problems with .NET SOAP clients (talking to CXF servers with with fix). .NET refuses the SOAP message. I think it&apos;s because the lonely LF. (tested with MTOM, SOAP12 binding)&lt;/p&gt;

&lt;p&gt;I also think that replacing a CRLF by LF in the header is not valid HTTP. &lt;/p&gt;</comment>
                            <comment id="13500765" author="ffang" created="Tue, 20 Nov 2012 01:11:46 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Thanks for pointing out this issue.&lt;/p&gt;

&lt;p&gt;This is caused by different platform interpret CRLF with different way, on windows, it need both \r\n.&lt;br/&gt;
Anyway we can use System.lineSeparator() method which will returns the system-dependent line separator string.&lt;br/&gt;
On UNIX systems, it returns \n, on Microsoft Windows systems it returns \r\n&lt;/p&gt;


&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="13500769" author="ffang" created="Tue, 20 Nov 2012 01:17:57 +0000"  >&lt;p&gt;As System.lineSeparator() method get introduced since JDK7, we need use some more general way like&lt;br/&gt;
lineSeparator = java.security.AccessController.doPrivileged(&lt;br/&gt;
            new sun.security.action.GetPropertyAction(&quot;line.separator&quot;));&lt;br/&gt;
ensure it works with JDK6(even JDK5)&lt;/p&gt;</comment>
                            <comment id="13500899" author="lsassexe" created="Tue, 20 Nov 2012 07:55:13 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I think we should definitely use CRLFCRLF to separate HTTP headers and a body. What took place before the fix, was actually THREE line breaks after HTTP headers (CRLFCRLFCRLF). Maybe the most reasonable fix is to just remove the last CRLF? I&apos;ve attached a screenshot.&lt;/p&gt;
</comment>
                            <comment id="13500927" author="ffang" created="Tue, 20 Nov 2012 08:58:21 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Yeah, what we&apos;ve done is remove the latest two CRLF.&lt;br/&gt;
You can try the latest snapshot tomorrow.&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="13500928" author="ay" created="Tue, 20 Nov 2012 09:01:54 +0000"  >&lt;p&gt;Hi Freeman,&lt;br/&gt;
could the problem be in the code that is reading the data back?&lt;br/&gt;
In the wire-format, we should be using CRLF for each line-break independently of the platform.&lt;br/&gt;
&lt;a href=&quot;http://www.rfc-editor.org/rfc/rfc1521.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.rfc-editor.org/rfc/rfc1521.txt&lt;/a&gt;&lt;br/&gt;
So, I think the writing part is correct.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13500933" author="ffang" created="Tue, 20 Nov 2012 09:14:29 +0000"  >&lt;p&gt;Hi Aki,&lt;/p&gt;

&lt;p&gt;Thanks for the link. And you&apos;re right, we should have CRLF.&lt;br/&gt;
Actually after discussed with Dan, I realized that AttachmentSerializer.writeProlog() method is used to write the very first boundary and headers which means the underlying HTTP transport already has output the CRLF after the HTTP header. &lt;br/&gt;
So we needn&apos;t have any other one.&lt;/p&gt;

&lt;p&gt;Freeman&lt;/p&gt;</comment>
                            <comment id="13501075" author="akiy" created="Tue, 20 Nov 2012 10:58:57 +0000"  >&lt;p&gt;Hi Freeman,&lt;br/&gt;
good to hear the root cause has been identified and fixed.&lt;br/&gt;
&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
regards, aki&lt;/p&gt;
</comment>
                            <comment id="14303670" author="ashwin74268" created="Tue, 3 Feb 2015 17:51:59 +0000"  >&lt;p&gt;Hi Freeman,&lt;br/&gt;
The AttachmentSerializer.java in 2.4.3-fuse-04-16 still shows &quot;\n&quot; line #125. We are using cxf-bundle 2.4.3-fuse-04-16 which does not have this fix. Can we please have a new version of cxf-bundle for 2.4.3-fuse with latest code?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ashwin Sharma &lt;/p&gt;</comment>
                            <comment id="14304664" author="ffang" created="Wed, 4 Feb 2015 05:34:44 +0000"  >&lt;p&gt;Hi, &lt;/p&gt;

&lt;p&gt;As you are talking about the fuse version so please use fuse channel to ask for help.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="14304673" author="ashwin74268" created="Wed, 4 Feb 2015 05:45:55 +0000"  >&lt;p&gt;Thanks Freeman, I posted on Jboss.org as well.&lt;/p&gt;

&lt;p&gt;Link: &lt;a href=&quot;https://developer.jboss.org/thread/252082?start=0&amp;amp;tstart=0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.jboss.org/thread/252082?start=0&amp;amp;tstart=0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ashwin&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12554303" name="crlf.jpg" size="64140" author="lsassexe" created="Tue, 20 Nov 2012 07:56:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00ulb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2888</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>