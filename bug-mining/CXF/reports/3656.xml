<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:38:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-8702] Graceful shutdown : Error 404 with &quot;Can&apos;t find the request for XXXXX&apos;s Observer&quot; on - Springboot + CXF Server</title>
                <link>https://issues.apache.org/jira/browse/CXF-8702</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;h2&gt;&lt;a name=&quot;GeneralDescription%3A&quot;&gt;&lt;/a&gt;General Description :&lt;/h2&gt;

&lt;p&gt;Issue happens on all our Springboot (tomcat) + CXF app.&lt;br/&gt;
Spring boot version : 2.4.13 (same on 2.6.7) / CXF version : 3.5.1 (same on 3.4.4, 3.5.2)&lt;br/&gt;
Java 1.8.0_312 and Java 11.0.15&lt;br/&gt;
&#160;&lt;br/&gt;
Integration is done with &lt;tt&gt;org.apache.cxf.cxf-spring-boot-starter-jaxrs-3.5.1.jar&lt;/tt&gt; and &lt;tt&gt;org.apache.cxf.cxf-spring-boot-autoconfigure-3.5.1.jar&lt;/tt&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
On each graceful shutdown that is happening under a moderate load, a few requests are being rejected in 404 by the service.&lt;br/&gt;
The corresponding log is &lt;tt&gt;&quot;Can&apos;t find the request for XXXXX&apos;s Observer&quot;&lt;/tt&gt; XXXXX is the full request that has been rejected.&lt;br/&gt;
The http response body answer for the call is &lt;tt&gt;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;No service was found.&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/tt&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a name=&quot;Integration%3A&quot;&gt;&lt;/a&gt;Integration :&lt;/h2&gt;

&lt;p&gt;&#160;&lt;br/&gt;
CXF server is started like this :&lt;br/&gt;
&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Bean
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Server flowManagementServiceRsServer() {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; JAXRSServerFactoryBean endpoint = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JAXRSServerFactoryBean();
        endpoint.setBus(bus);
        endpoint.setAddress(&lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;);
        endpoint.setServiceBean(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Service());
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; endpoint.create();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
Shutdown is managed by spring boot with &quot;new&quot; graceful shutdown &lt;tt&gt;server.shutdown=graceful&lt;/tt&gt; and &lt;tt&gt;spring.lifecycle.timeout-per-shutdown-phase=25s&lt;/tt&gt;&lt;br/&gt;
&#160;&lt;/p&gt;
&lt;h2&gt;&lt;a name=&quot;Reproduction%3A&quot;&gt;&lt;/a&gt;Reproduction :&lt;/h2&gt;

&lt;p&gt;Having a performance test on an endpoint (for example &lt;a href=&quot;http://localhost:8080/services/request&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/services/request&lt;/a&gt;) and stopping gracefully, the app allow to reproduce the issue at will.&lt;/p&gt;

&lt;p&gt;See cxf-shutdown.zip project to reproduce.&lt;br/&gt;
&#160;&lt;br/&gt;
Use the following command just before trying to shutdown :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
seq 1 2000 | xargs -I $ -n1 -P10 &#160;curl [http:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:8080/services/request]&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;Or see the JMeter project to do the same.&lt;/p&gt;
&lt;h2&gt;&lt;a name=&quot;Logsandtrace%3A&quot;&gt;&lt;/a&gt;Logs and trace :&lt;/h2&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;
&#160; . &#160; ____ &#160; &#160; &#160; &#160; &#160;_ &#160; &#160; &#160; &#160; &#160; &#160;__ _ _
&#160;/
/ __{_}&apos;{_} __ _ {_}({_})_ __ &#160;__ _ \ \ \ \
( ( )___ | &lt;span class=&quot;code-quote&quot;&gt;&apos;_ | &apos;&lt;/span&gt;{_}| | &apos;{_} \/ _` | \ \ \ \
&#160;
/ &#160;__{_})| |{_})| | | | | || (_| | &#160;) ) ) )
&#160; &apos; &#160;|___{_}| .{_}{_}|{_}| |{_}|{_}| |{_}_{_}, | / / / /
&#160;=========|{_}|==============|{_}_{_}/=/{_}/{_}/{_}/
&#160;:: Spring Boot :: &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;(v2.6.7)

2022-05-09 18:00:05.456 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] org.example.Application &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;: Starting Application using Java 11.0.15 on LT-XXX with PID 706858 (/home/user/workspace/git/cxf-shutdown/target/classes started by user in /home/user/workspace/git/cxf-shutdown)
2022-05-09 18:00:05.459 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] org.example.Application &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;: No active profile set, falling back to 1 &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; profile: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;
2022-05-09 18:00:06.719 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] o.s.b.w.embedded.tomcat.TomcatWebServer &#160;: Tomcat initialized with port(s): 8080 (http)
2022-05-09 18:00:06.728 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] o.apache.catalina.core.StandardService &#160; : Starting service [Tomcat]
2022-05-09 18:00:06.729 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] org.apache.catalina.core.StandardEngine &#160;: Starting Servlet engine: [Apache Tomcat/9.0.62]
2022-05-09 18:00:06.795 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] o.a.c.c.C.[Tomcat].[localhost].[/] &#160; &#160; &#160; : Initializing Spring embedded WebApplicationContext
2022-05-09 18:00:06.795 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1285 ms
2022-05-09 18:00:07.042 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] org.apache.cxf.endpoint.ServerImpl &#160; &#160; &#160; : Setting the server&apos;s publish address to be /
2022-05-09 18:00:07.400 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] o.s.b.w.embedded.tomcat.TomcatWebServer &#160;: Tomcat started on port(s): 8080 (http) with context path &apos;&apos;
2022-05-09 18:00:07.444 &#160;INFO 706858 &#8212; [ &#160; &#160; &#160; &#160; &#160; main] org.example.Application &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;: Started Application in 2.393 seconds (JVM running &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 3.103)
2022-05-09 18:00:18.867 &#160;INFO 706858 &#8212; [ionShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown &#160; &#160; &#160; &#160;: Commencing graceful shutdown. Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; active requests to complete
2022-05-09 18:00:18.867 &#160;WARN 706858 &#8212; [io-8080-exec-10] o.a.c.t.servlet.ServletController &#160; &#160; &#160; &#160;: Can&lt;span class=&quot;code-quote&quot;&gt;&apos;t find the request &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; [http:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:8080/services/request&apos;&lt;/span&gt;s] Observer
&lt;/span&gt;2022-05-09 18:00:18.873 &#160;INFO 706858 &#8212; [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown &#160; &#160; &#160; &#160;: Graceful shutdown complete

&lt;span class=&quot;code-object&quot;&gt;Process&lt;/span&gt; finished with exit code 130 (interrupted by signal 2: SIGINT)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13444166">CXF-8702</key>
            <summary>Graceful shutdown : Error 404 with &quot;Can&apos;t find the request for XXXXX&apos;s Observer&quot; on - Springboot + CXF Server</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="Thom-x">Thomas MAUGIN</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 May 2022 12:18:34 +0000</created>
                <updated>Mon, 18 Sep 2023 18:48:17 +0000</updated>
                            <resolved>Tue, 10 May 2022 18:44:00 +0000</resolved>
                                    <version>3.5.2</version>
                                    <fixVersion>3.5.3</fixVersion>
                                    <component>JAX-RS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                        <attachments>
                            <attachment id="13043472" name="cxf-shutdown.zip" size="3479" author="Thom-x" created="Tue, 10 May 2022 12:16:22 +0000"/>
                            <attachment id="13043471" name="flood_requests.jmx" size="9785" author="Thom-x" created="Tue, 10 May 2022 12:16:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1288o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>