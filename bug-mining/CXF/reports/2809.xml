<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:20:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-6908] Prefix &quot;SOAP-ENV&quot; for element &quot;SOAP-ENV:Fault&quot; is not bound</title>
                <link>https://issues.apache.org/jira/browse/CXF-6908</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;I have an endpoint as follows:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;@WebServiceProvider(wsdlLocation = &quot;WEB-INF/FaultService.wsdl&quot;, targetNamespace = &quot;http://signencrypt.foo.github.com/&quot;)
@ServiceMode(Mode.MESSAGE)
@BindingType(SOAPBinding.SOAP11HTTP_BINDING)
public class FaultService implements Provider&amp;lt;SOAPMessage&amp;gt;
{
   @Resource
   private WebServiceContext _wsContext;

   @Override
   public SOAPMessage invoke(SOAPMessage request)
   {
      try
      {
         MessageFactory messageFactory = MessageFactory.newInstance();
         SOAPMessage msg = messageFactory.createMessage();
         msg.getSOAPBody().addFault(new QName(&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;, &quot;Server&quot;),
               &quot;Reason: cos I&apos;m hungry&quot;);
         return msg;
      }
      catch (Exception e)
      {
         e.printStackTrace();
      }
      return null;
   }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The client fails in processing the ws-security soap message that&apos;s returned by the endpoint above:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;...
Caused by: org.apache.xml.security.encryption.XMLEncryptionException: The prefix &quot;SOAP-ENV&quot; for element &quot;SOAP-ENV:Fault&quot; is not bound.
      [java] Original Exception was org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 212; The prefix &quot;SOAP-ENV&quot; for element &quot;SOAP-ENV:Fault&quot; is not bound.
      [java]     at org.apache.xml.security.encryption.DocumentSerializer.deserialize(DocumentSerializer.java:93)
      [java]     at org.apache.xml.security.encryption.DocumentSerializer.deserialize(DocumentSerializer.java:49)
      [java]     at org.apache.xml.security.encryption.XMLCipher.decryptElement(XMLCipher.java:1685)
      [java]     at org.apache.xml.security.encryption.XMLCipher.decryptElementContent(XMLCipher.java:1716)
      [java]     at org.apache.xml.security.encryption.XMLCipher.doFinal(XMLCipher.java:990)
      [java]     at org.apache.ws.security.processor.ReferenceListProcessor.decryptEncryptedData(ReferenceListProcessor.java:340)
      [java]     ... 27 more
      [java] Caused by: org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 212; The prefix &quot;SOAP-ENV&quot; for element &quot;SOAP-ENV:Fault&quot; is not bound.
      [java]     at org.apache.xerces.parsers.DOMParser.parse(DOMParser.java:244) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It seems that when the soap fault in the endpoint is created with no explicit ns prefix for the envelope, the code in SoapOutInterceptor::writeSoapEnvelopeStart modifies the namespace prefixes and basically turns a message like&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&amp;lt;SOAP-ENV:Header/&amp;gt;&amp;lt;SOAP-ENV:Body/&amp;gt;&amp;lt;/SOAP-ENV:Envelope&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;into&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&amp;lt;SOAP-ENV:Header xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&amp;gt;&amp;lt;soap:Body/&amp;gt;&amp;lt;/soap:Envelope&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(SOAP-ENV is the saaj impl default value for missing explicit soap envelope prefix)&lt;br/&gt;
This is probably causing a problem with the fault later added in the body because of the ns prefix SOAP-ENV not being bound anymore in the envelope.&lt;br/&gt;
The problem is avoided by explicitly setting the fault prefix in the endpoint:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;msg.getSOAPPart().getEnvelope().setPrefix(&quot;fooe&quot;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12970411">CXF-6908</key>
            <summary>Prefix &quot;SOAP-ENV&quot; for element &quot;SOAP-ENV:Fault&quot; is not bound</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="asoldano">Alessio Soldano</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 May 2016 15:50:51 +0000</created>
                <updated>Fri, 14 Oct 2016 14:21:59 +0000</updated>
                            <resolved>Wed, 25 May 2016 15:48:02 +0000</resolved>
                                                    <fixVersion>3.1.7</fixVersion>
                    <fixVersion>3.2.0</fixVersion>
                                    <component>Soap Binding</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15286898" author="githubbot" created="Tue, 17 May 2016 15:56:25 +0000"  >&lt;p&gt;GitHub user asoldano opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6908&quot; title=&quot;Prefix &amp;quot;SOAP-ENV&amp;quot; for element &amp;quot;SOAP-ENV:Fault&amp;quot; is not bound&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6908&quot;&gt;&lt;del&gt;CXF-6908&lt;/del&gt;&lt;/a&gt; Fallback to getting the envelope ns prefix from the SOAP p&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;art in the SAAJStreamWriter if the context can&apos;t provide it&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/asoldano/cxf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/asoldano/cxf&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6908&quot; title=&quot;Prefix &amp;quot;SOAP-ENV&amp;quot; for element &amp;quot;SOAP-ENV:Fault&amp;quot; is not bound&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6908&quot;&gt;&lt;del&gt;CXF-6908&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/136.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/136.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #136&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 6ff15867e8f9da07ba689b3448d99511cfff1cc4&lt;br/&gt;
Author: Alessio Soldano &amp;lt;asoldano@redhat.com&amp;gt;&lt;br/&gt;
Date:   2016-05-17T15:52:24Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-6908&quot; title=&quot;Prefix &amp;quot;SOAP-ENV&amp;quot; for element &amp;quot;SOAP-ENV:Fault&amp;quot; is not bound&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-6908&quot;&gt;&lt;del&gt;CXF-6908&lt;/del&gt;&lt;/a&gt; Fallback to getting the envelope ns prefix from the SOAP part in the SAAJStreamWriter if the context can&apos;t provide it&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15294460" author="githubbot" created="Fri, 20 May 2016 23:03:58 +0000"  >&lt;p&gt;Github user asoldano closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/136&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15402042" author="j_ri" created="Mon, 1 Aug 2016 13:40:53 +0000"  >&lt;p&gt;Please backport this fix to 2.7.x&lt;/p&gt;</comment>
                            <comment id="15403635" author="coheigea" created="Tue, 2 Aug 2016 08:47:41 +0000"  >&lt;p&gt;CXF 2.7.x is no longer maintained, there will be no more releases.&lt;/p&gt;

&lt;p&gt;Colm.&lt;/p&gt;</comment>
                            <comment id="15403688" author="j_ri" created="Tue, 2 Aug 2016 09:47:47 +0000"  >&lt;p&gt;Thank you very much for that information.&lt;br/&gt;
I&apos;ll ask the customer support of our commercially supported product how they get bugfixes into their products that are based on CXF 2.7.x.&lt;br/&gt;
Eventually the CXF based product stack is still supported for several years....&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2y33z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>