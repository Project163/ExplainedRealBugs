<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:07:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-5434] IllegalStateException calling Oneway method using JMS and WSA</title>
                <link>https://issues.apache.org/jira/browse/CXF-5434</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When a client is calling a oneway method, the endpoint method is never called due to an IllegalStateException, when the endpoint has WS-Addressing policy enabled and the endpoint is called through JMS (activeMQ)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.IllegalStateException: IllegalStateException invoking http:&lt;span class=&quot;code-comment&quot;&gt;//www.w3.org/2005/08/addressing/none: Already connected
&lt;/span&gt;	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
	at java.lang.reflect.Constructor.newInstance(Unknown Source)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1338)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1327)
	at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
	at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:622)
	at org.apache.cxf.interceptor.OneWayProcessorInterceptor.handleMessage(OneWayProcessorInterceptor.java:126)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
	at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)
	at org.apache.cxf.transport.jms.JMSDestination.onMessage(JMSDestination.java:235)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:536)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:496)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:325)
	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:263)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1059)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1051)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:948)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(Unknown Source)
Caused by: java.lang.IllegalStateException: Already connected
	at java.net.HttpURLConnection.setFixedLengthStreamingMode(Unknown Source)
	at org.apache.cxf.transport.http.URLConnectionHTTPConduit$URLConnectionWrappedOutputStream.setFixedLengthStreamingMode(URLConnectionHTTPConduit.java:272)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.thresholdNotReached(HTTPConduit.java:1085)
	at org.apache.cxf.io.AbstractThresholdOutputStream.close(AbstractThresholdOutputStream.java:99)
	at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1301)
	... 15 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12682880">CXF-5434</key>
            <summary>IllegalStateException calling Oneway method using JMS and WSA</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="wouter.dhaeze">Wouter Dhaeze</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Dec 2013 11:20:41 +0000</created>
                <updated>Mon, 16 Feb 2015 16:09:41 +0000</updated>
                            <resolved>Mon, 5 May 2014 19:59:04 +0000</resolved>
                                    <version>2.7.5</version>
                    <version>2.7.7</version>
                                    <fixVersion>2.6.15</fixVersion>
                    <fixVersion>2.7.12</fixVersion>
                                    <component>JAX-WS Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13840457" author="dkulp" created="Thu, 5 Dec 2013 19:29:51 +0000"  >&lt;p&gt;Can we possibly get a testcase?  I checked one of our system tests and it&apos;s working fine.   &lt;/p&gt;

&lt;p&gt;The curious thing about your stack trace is the HTTP conduit on the response.   A bit strange if this is JMS.   Can you also log the incoming message and describe the reply-to headers?   &lt;/p&gt;</comment>
                            <comment id="13841115" author="wouter.dhaeze" created="Fri, 6 Dec 2013 09:07:01 +0000"  >&lt;p&gt;Dear mr. Kulp, thanks for the quick response.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached three files:&lt;br/&gt;
1. I attached my eclipse project which you can use to reproduce the problem. &lt;br/&gt;
It defines a oneway endpoint which listens to a queue (activeMQ 5.7.0). &lt;br/&gt;
I&apos;m compiling and running using java7 (u45) and deploying on tomcat 7.0.35. &lt;br/&gt;
I&apos;m using a reference to the default cxf distribution 2.7.8.&lt;br/&gt;
It also contains a unit test which creates a cxf client that will publish a message to the queue.&lt;br/&gt;
2. A log trace of my server in which the CXF stack is printed as well as the error message&lt;br/&gt;
3. I filtered the incoming soap message. It contains a header field with ReplyTo &quot;none&quot; which is normal I guess since we call a oneway method. &lt;/p&gt;

&lt;p&gt;Please be aware that the method is annotated with &quot;javax.jws.Oneway&quot; and not &quot;import org.apache.cxf.jaxrs.ext.Oneway&quot;. But I&apos;m quite sure this is correct since the latter annotation is for REST services.&lt;/p&gt;

&lt;p&gt;If you remove the wsa:addressing feature from the client, the server consumes the message perfectly. The biggest difference however is the cxf stack. In the failing test there are a lot more filters that are applied.&lt;/p&gt;</comment>
                            <comment id="13893293" author="ashakirin" created="Thu, 6 Feb 2014 11:55:42 +0000"  >&lt;p&gt;Hi Dan,&lt;/p&gt;

&lt;p&gt;I am afraid the issue is fixed only for RPC style in RPCOutInterceptor:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (operation.getOutput() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
 	 	 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It is still reproducible for the document binding style.&lt;/p&gt;

&lt;p&gt;Are rebasing of the response and creation of decoupled destination make sense for oneWay at all?  &lt;br/&gt;
MAPAggregator:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isOneway
                    || !ContextUtils.isGenericAddress(maps.getReplyTo())) {
                    InternalContextUtils.rebaseResponse(maps.getReplyTo(),
                                                maps,
                                                message);
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do we really need any rebasement for oneWay on the service side for JMS if we do not send any response?&lt;/p&gt;</comment>
                            <comment id="13945206" author="wouter.dhaeze" created="Mon, 24 Mar 2014 15:20:39 +0000"  >&lt;p&gt;Dear Daniel, dear Andrei,&lt;/p&gt;


&lt;p&gt;Is there any progress on this issue? Could you give me a date when the problem would be fixed?&lt;/p&gt;


&lt;p&gt;Best regards&lt;/p&gt;

&lt;p&gt;Wouter&lt;/p&gt;</comment>
                            <comment id="13982820" author="apoltavtsev" created="Mon, 28 Apr 2014 07:56:42 +0000"  >&lt;p&gt;Hello All,&lt;/p&gt;

&lt;p&gt;I have verified this issue (with document binding style) in cxf-2.7.11 . I see that oneway request is successfully delivered to service side using JMS transport and incoming message is delivered in message handler correctly (there is no &quot;IllegalStateException&quot; anymore). So, original problem is solved, but I see that service intiates sending of response to &quot;none&quot; destination and this response is processed by set of outgoing interceptors (we can also see outgoing message in logs), but sending of response is not performed due to update for org.apache.cxf.ws.addressing.impl.InternalContextUtils:&lt;/p&gt;

&lt;p&gt;&#1089;xf 2.7.8:&lt;/p&gt;

&lt;p&gt;        public Conduit getBackChannel(Message inMessage,&lt;br/&gt;
                                      Message partialResponse,&lt;br/&gt;
                                      EndpointReferenceType address)&lt;br/&gt;
            throws IOException {&lt;br/&gt;
            Bus bus = inMessage.getExchange().get(Bus.class);&lt;br/&gt;
            ....&lt;/p&gt;

&lt;p&gt;cxf 2.7.11:&lt;/p&gt;

&lt;p&gt;        public Conduit getBackChannel(Message inMessage,&lt;br/&gt;
                                      Message partialResponse,&lt;br/&gt;
                                      EndpointReferenceType address)&lt;br/&gt;
            throws IOException {&lt;br/&gt;
            if (ContextUtils.isNoneAddress(reference)) &lt;/p&gt;
{
                return null;
            }
&lt;p&gt;            Bus bus = inMessage.getExchange().get(Bus.class);&lt;br/&gt;
            ...&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12693128">CXF-5539</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12617359" name="CXFTestServer.zip" size="5232065" author="wouter.dhaeze" created="Fri, 6 Dec 2013 08:55:40 +0000"/>
                            <attachment id="12617361" name="incoming_soap_message_01.txt" size="873" author="wouter.dhaeze" created="Fri, 6 Dec 2013 08:55:40 +0000"/>
                            <attachment id="12617360" name="server_logs_01.log" size="42916" author="wouter.dhaeze" created="Fri, 6 Dec 2013 08:55:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 30 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qf9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362432</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>