<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:30:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7653] Null pointer in JaxwsResponseCallback</title>
                <link>https://issues.apache.org/jira/browse/CXF-7653</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;Occasionally we&apos;ll get a null pointer in the JAXWS code.&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;br/&gt;
 at org.apache.cxf.jaxws.JaxwsResponseCallback.get(JaxwsResponseCallback.java:49)&lt;/p&gt;

&lt;p&gt;When we receive a SOAP message with an empty body (example below) the&#160;(T)callback.get()&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; line in JaxwsResponseCallback throws a null pointer exception. We&apos;re still unsure why we&apos;re getting a message with an empty body in the first place, and if that&apos;s AIX related or we&apos;re just lucky in other operating systems.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&amp;lt;soap:Envelope xmlns:soap=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&#160; &#160;&amp;lt;soap:Header&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&#160; &#160;&amp;lt;!-- Stuff in here that I&apos;ve removed. --&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&#160; &#160;&amp;lt;/soap:Header&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&#160; &#160;&amp;lt;soap:Body /&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&amp;lt;/soap:Envelope&amp;gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;We did some debugging and checked where our code diverged between the two types of messages.&#160; The below chunk of code is where it starts to unravel.&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;Code from within DocLiteralInInterceptor.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

MessageContentsList parameters = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MessageContentsList();

Exchange exchange = message.getExchange();
BindingOperationInfo bop = exchange.getBindingOperationInfo();

&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; client = isRequestor(message);

&lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; body is empty and we have BindingOperationInfo, we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not need to match
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//operation anymore, just &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (bop != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !StaxUtils.toNextElement(xmlReader)) {
&#160; &#160;&lt;span class=&quot;code-comment&quot;&gt;// body may be empty &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partial response to decoupled request
&lt;/span&gt;&#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
}
...
&lt;span class=&quot;code-comment&quot;&gt;// Lots of logic
&lt;/span&gt;...
message.setContent(List.class, parameters);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;~~~~~~~&lt;/p&gt;

&lt;p&gt;When we do a StaxUtils.toNextElement that returns false, as it hits the end of the body immediately. This causes it to return without setting the MessageContentsList as a list on the message. Later, when the code tries to do a .getContent(List) it doesn&apos;t find anything, and this leads to it setting null as the first element returned on callback.get()&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.&lt;/p&gt;</description>
                <environment>&lt;p&gt;AIX&lt;/p&gt;</environment>
        <key id="13139752">CXF-7653</key>
            <summary>Null pointer in JaxwsResponseCallback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="NealJohnson">Neal Johnson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Feb 2018 19:59:02 +0000</created>
                <updated>Fri, 4 May 2018 15:33:28 +0000</updated>
                            <resolved>Mon, 26 Feb 2018 18:07:48 +0000</resolved>
                                    <version>3.0.10</version>
                                    <fixVersion>3.1.15</fixVersion>
                    <fixVersion>3.2.3</fixVersion>
                    <fixVersion>3.2.4</fixVersion>
                                    <component>JAX-WS Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16371710" author="coheigea" created="Wed, 21 Feb 2018 17:27:35 +0000"  >&lt;p&gt;Do you have a test-case to reproduce the problem?&lt;/p&gt;</comment>
                            <comment id="16371791" author="nealjohnson" created="Wed, 21 Feb 2018 18:13:08 +0000"  >&lt;p&gt;We&apos;re talking to an endpoint that is occasionally sending us an empty SOAP body. We can reproduce this by setting up a test endpoint that will automatically return that same empty SOAP body but I&apos;m not sure of how this should be made generic for external testing outside of our use. I don&apos;t know if this issue happens everywhere for empty SOAP bodies or if something we&apos;re doing is different from normal.&lt;/p&gt;</comment>
                            <comment id="16371927" author="dkulp" created="Wed, 21 Feb 2018 20:01:21 +0000"  >&lt;p&gt;Is a soap message with an empty body valid at this point?   If not, then an exception should be raised.  Whether that should be an NPE or other is a good question, but an exception is the correct behavior.  &lt;/p&gt;
</comment>
                            <comment id="16371932" author="nealjohnson" created="Wed, 21 Feb 2018 20:06:56 +0000"  >&lt;p&gt;I&apos;m actually unclear on the validity of an empty body. It&apos;s not what we&apos;re expecting certainly, but I haven&apos;t been able to tell if this violates spec or if it&apos;s technically fine.&lt;/p&gt;

&lt;p&gt;If it doesn&apos;t violate spec then I&apos;m assuming we shouldn&apos;t NPE out.&#160;&lt;/p&gt;</comment>
                            <comment id="16371937" author="nealjohnson" created="Wed, 21 Feb 2018 20:10:50 +0000"  >&lt;p&gt;We&apos;re actually getting this NPE on a client site where we&apos;re not able to actually verify the message itself. We were able to replicate it internally, and found that when it replicated it was due to an empty SOAP body. The stack trace is the same on the client site but it is worth mentioning that we haven&apos;t been able to confirm the client is getting this from an empty body.&lt;/p&gt;</comment>
                            <comment id="16373150" author="coheigea" created="Thu, 22 Feb 2018 17:47:15 +0000"  >&lt;p&gt;I could reproduce the NPE with a testcase locally. It&apos;s possible to get further with setting the parameters List on the message in the DocLiteralInInterceptor, but you keep on running into NPEs after that. I got as far as:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
&#160;&#160;&#160; at com.sun.proxy.$Proxy55.doubleIt(Unknown Source)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16373211" author="nealjohnson" created="Thu, 22 Feb 2018 18:14:29 +0000"  >&lt;p&gt;Good to know. I&apos;m curious how an empty body&#160;&lt;em&gt;should&lt;/em&gt; be handled in these cases.&#160;&lt;/p&gt;</comment>
                            <comment id="16373890" author="dkulp" created="Fri, 23 Feb 2018 04:02:08 +0000"  >&lt;p&gt;If the WSDL for the operation states that the body should have content, than an exception should be thrown.   Probably some sort of validation exception or IllegalArguementException or something.   An NPE is probably not ideal, or if it is an NPE, at least put a better description in the message.&lt;/p&gt;</comment>
                            <comment id="16374202" author="coheigea" created="Fri, 23 Feb 2018 10:41:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkulp&quot; class=&quot;user-hover&quot; rel=&quot;dkulp&quot;&gt;dkulp&lt;/a&gt;, where should this exception be thrown?&lt;/p&gt;</comment>
                            <comment id="16374230" author="coheigea" created="Fri, 23 Feb 2018 11:20:04 +0000"  >&lt;p&gt;I added an Ignore&apos;d test to reproduce the issue here. The SOAP client invokes on a REST service that echoes back a SOAP Envelope with an empty SOAP Body:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cxf/commit/65f119d0904b25690600fd70fd751462cbd5113f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/commit/65f119d0904b25690600fd70fd751462cbd5113f&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16376942" author="coheigea" created="Mon, 26 Feb 2018 14:25:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dkulp&quot; class=&quot;user-hover&quot; rel=&quot;dkulp&quot;&gt;dkulp&lt;/a&gt;, looks like the fix for this broke this test:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Running org.apache.cxf.systest.ws.rm.ManagedEndpointsTest&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Tests run: 3, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 18.867 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.cxf.systest.ws.rm.ManagedEndpointsTest&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; testManagedEndpointsOneway12(org.apache.cxf.systest.ws.rm.ManagedEndpointsTest)&#160; Time elapsed: 3.285 s&#160; &amp;lt;&amp;lt;&amp;lt; ERROR!&lt;br/&gt;
javax.management.MBeanException: Exception thrown in RequiredModelMBean while trying to invoke operation terminateDestinationSequence&lt;br/&gt;
&#160;&#160; &#160;at org.apache.cxf.systest.ws.rm.ManagedEndpointsTest.testManagedEndpointsOneway12(ManagedEndpointsTest.java:237)&lt;br/&gt;
Caused by: javax.management.JMException: Error terminating sequence: Failed to send RM protocol message {&lt;a href=&quot;http://docs.oasis-open.org/ws-rx/wsrm/200702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/ws-rx/wsrm/200702&lt;/a&gt;}TerminateSequence.&lt;br/&gt;
&#160;&#160; &#160;at org.apache.cxf.systest.ws.rm.ManagedEndpointsTest.testManagedEndpointsOneway12(ManagedEndpointsTest.java:237)&lt;/p&gt;</comment>
                            <comment id="16378389" author="coheigea" created="Tue, 27 Feb 2018 10:51:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=NealJohnson&quot; class=&quot;user-hover&quot; rel=&quot;NealJohnson&quot;&gt;NealJohnson&lt;/a&gt;, for the record, instead of a NPE you should now see an error along the lines of:&lt;/p&gt;

&lt;p&gt;javax.xml.ws.soap.SOAPFaultException: Response message did not contain proper response data. Expected: {&lt;a href=&quot;http://www.example.org/schema/DoubleIt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.example.org/schema/DoubleIt&lt;/a&gt;}DoubleItResponse&lt;br/&gt;
&#160;&#160;&#160; at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:161)&lt;/p&gt;</comment>
                            <comment id="16379073" author="nealjohnson" created="Tue, 27 Feb 2018 18:14:10 +0000"  >&lt;p&gt;That was actually our internal workaround as well. We caught the null pointer and threw a soap fault.&lt;/p&gt;

&lt;p&gt;Thanks for the quick response and fix.&lt;/p&gt;</comment>
                            <comment id="16387750" author="ffang" created="Tue, 6 Mar 2018 13:21:38 +0000"  >&lt;p&gt;Hi Dan,&lt;/p&gt;

&lt;p&gt;I think this fix may introduce a problem.&lt;/p&gt;

&lt;p&gt;I just committed an ignored testcase to expose it(d2814e391f1d651e7d09774e02e6f4a0ec809ef3).&lt;/p&gt;

&lt;p&gt;Would you please take a look?&lt;br/&gt;
Thanks&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="16387900" author="dkulp" created="Tue, 6 Mar 2018 14:58:20 +0000"  >&lt;p&gt;Freeman,  the issue is that the ClientProxyFactoryBean, not being JAX-WS, doesn&apos;t support the @SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE) annotation. Thus, it&apos;s properly expecting a response.   If you change the test to use the JaxWsProxyFactoryBean which does handle that annotation, the test passes.  &lt;/p&gt;</comment>
                            <comment id="16389022" author="ffang" created="Wed, 7 Mar 2018 04:44:42 +0000"  >&lt;p&gt;Ah, great.&lt;br/&gt;
Thanks Dan!&lt;/p&gt;</comment>
                            <comment id="16460590" author="githubbot" created="Wed, 2 May 2018 06:49:31 +0000"  >&lt;p&gt;jimma opened a new pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Add system property to enable/disable check empty response&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &#8230; from provider endpoint&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16460592" author="githubbot" created="Wed, 2 May 2018 06:53:10 +0000"  >&lt;p&gt;rmannibucau commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Add system property to enable/disable check empty response&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r185406356&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r185406356&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -658,7 +659,7 @@ private void enrichFault(Fault fault) &lt;/p&gt;
{
             throw ex;
         }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (resList == null&lt;br/&gt;
+        if (Boolean.getBoolean(CHECK_EMTPY_RESPONSE) &amp;amp;&amp;amp; resList == null   &lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   it goes through a Properties access so it is synchronized, maybe read it once per client instance to avoid an useless locking?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16460638" author="githubbot" created="Wed, 2 May 2018 07:42:58 +0000"  >&lt;p&gt;jimma commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Add system property to enable/disable check empty response&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-385891859&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-385891859&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @rmannibucau  Thanks for review. You are right. I improved the code a bit, please check if it&apos;s good now. &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16460698" author="githubbot" created="Wed, 2 May 2018 08:23:54 +0000"  >&lt;p&gt;rmannibucau commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Add system property to enable/disable check empty response&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-385901522&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-385901522&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Was more thinking about doing it in the constructor but works for me&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16461234" author="githubbot" created="Wed, 2 May 2018 16:07:43 +0000"  >&lt;p&gt;coheigea commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Add system property to enable/disable check empty response&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-386031806&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-386031806&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The problem with this patch is that the default behaviour is still to throw a NPE in CXF - i.e. remove the change to the test in systests/uncategorized and you get a NPE. Perhaps instead we need to revisit the original fix.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16462028" author="githubbot" created="Thu, 3 May 2018 07:06:13 +0000"  >&lt;p&gt;jimma commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in JaxWsClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-386207714&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-386207714&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @coheigea  I wrongly thought this was an specific issue and it isn&apos;t.  Looked at again and found this is actually caused by the null value return for primitive type in InvocationHandler(JaxWsClientProxy) : &lt;/p&gt;

&lt;p&gt;   &amp;gt;  If the value returned by this method is &lt;/p&gt;
{@code null}
&lt;p&gt; and the interface method&apos;s return type is&lt;br/&gt;
      primitive, then a &lt;/p&gt;
{@code NullPointerException}
&lt;p&gt; will be thrown by the method invocation on the proxy instance. &lt;/p&gt;

&lt;p&gt;   Please review again. Thanks. &lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16462047" author="githubbot" created="Thu, 3 May 2018 07:27:39 +0000"  >&lt;p&gt;jimma commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-386207714&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-386207714&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @coheigea  I wrongly thought this was an specific issue and it isn&apos;t.  Looked at again and found this is actually caused by the null value return for primitive type in InvocationHandler(ClientProxy) : &lt;/p&gt;

&lt;p&gt;   &amp;gt;  If the value returned by this method is &lt;/p&gt;
{@code null}
&lt;p&gt; and the interface method&apos;s return type is&lt;br/&gt;
      primitive, then a &lt;/p&gt;
{@code NullPointerException}
&lt;p&gt; will be thrown by the method invocation on the proxy instance. &lt;/p&gt;

&lt;p&gt;   Please review again. Thanks. &lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16462220" author="githubbot" created="Thu, 3 May 2018 09:52:37 +0000"  >&lt;p&gt;andrei-ivanov commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r185747119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r185747119&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/JaxWsClientProxy.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,6 +138,10 @@ public Object invoke(Object proxy, Method method, Object[] args) throws Throwabl&lt;br/&gt;
             } else &lt;/p&gt;
{
                 result = invokeSync(method, oi, params);
             }
&lt;p&gt;+            if (result == null &amp;amp;&amp;amp; !method.getReturnType().equals(Void.TYPE)&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   nitpick: you can use == to check class equality&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16462221" author="githubbot" created="Thu, 3 May 2018 09:52:54 +0000"  >&lt;p&gt;andrei-ivanov commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r185747189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r185747189&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ClientProxy.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -79,6 +79,9 @@ public Object invoke(Object proxy, Method method, Object[] args) throws Throwabl&lt;br/&gt;
         }&lt;/p&gt;

&lt;p&gt;         Object o = invokeSync(method, oi, params);&lt;br/&gt;
+        if (o == null &amp;amp;&amp;amp; !method.getReturnType().equals(Void.TYPE) &amp;amp;&amp;amp; method.getReturnType().isPrimitive()) {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   nitpick: you can use == to check class equality&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16462404" author="githubbot" created="Thu, 3 May 2018 13:06:41 +0000"  >&lt;p&gt;dkulp commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r185790182&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r185790182&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -657,24 +657,9 @@ private void enrichFault(Fault fault) {&lt;br/&gt;
         if (ex != null) &lt;/p&gt;
{
             throw ex;
         }
&lt;p&gt;-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (resList == null&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; oi != null &amp;amp;&amp;amp; !oi.getOperationInfo().isOneWay()) {&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;BindingOperationInfo boi = oi;&lt;/li&gt;
	&lt;li&gt;if (boi.isUnwrapped()) 
{
-                boi = boi.getWrappedOperation();
-            }&lt;/li&gt;
	&lt;li&gt;if (!boi.getOutput().getMessageParts().isEmpty()) 
{
-                //we were supposed to get some output, but didn&apos;t
-                throw new IllegalStateException(&quot;Response message did not contain proper response data. Expected: &quot;
-                    + boi.getOutput().getMessageParts().get(0).getConcreteName());
-            }&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Why is all this code removed?    If the WSDL states that there should be a response and there isn&apos;t, an exception should be thrown.  The above is correct.   By pushing some of this down into the ClientProxy&apos;s, anything that doesn&apos;t use the client proxies (like Camel endpoints) wouldn&apos;t have this check in place.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16462551" author="githubbot" created="Thu, 3 May 2018 14:51:31 +0000"  >&lt;p&gt;jimma commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r185826292&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r185826292&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -657,24 +657,9 @@ private void enrichFault(Fault fault) {&lt;br/&gt;
         if (ex != null) &lt;/p&gt;
{
             throw ex;
         }
&lt;p&gt;-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (resList == null&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; oi != null &amp;amp;&amp;amp; !oi.getOperationInfo().isOneWay()) {&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;BindingOperationInfo boi = oi;&lt;/li&gt;
	&lt;li&gt;if (boi.isUnwrapped()) 
{
-                boi = boi.getWrappedOperation();
-            }&lt;/li&gt;
	&lt;li&gt;if (!boi.getOutput().getMessageParts().isEmpty()) 
{
-                //we were supposed to get some output, but didn&apos;t
-                throw new IllegalStateException(&quot;Response message did not contain proper response data. Expected: &quot;
-                    + boi.getOutput().getMessageParts().get(0).getConcreteName());
-            }&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   &amp;gt; Why is all this code removed? If the WSDL states that there should be a response and there isn&apos;t, an exception should be thrown. The above is correct. &lt;/p&gt;

&lt;p&gt;   When I ran reproducer EmptySoapBodyTest and found the NPE is thrown from Proxy class and root cause for this NPE is a null return value for a primitive type in InvocationHandler(ClientProxy), that&apos;s why I remove this and add this check in ClientProxy.  I only looked at EmptySoapBodayTest , any other reproducer I need to have a look for &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; ?&lt;/p&gt;

&lt;p&gt;   Another reason why I remove these lines is this check doesn&apos;t work for this case: for example we have a simple wsdl which generates the following operation : &lt;br/&gt;
   ```&lt;br/&gt;
   public HelloResponse doSomething(HelloRequest request);&lt;br/&gt;
   ```&lt;br/&gt;
   To work with Dispatch/Provider ,  a provider class created to simply return an empty StreamSource like:&lt;br/&gt;
   ```&lt;br/&gt;
   @WebServiceProvider(&lt;br/&gt;
             serviceName=&quot;HelloService&quot;,&lt;br/&gt;
             portName=&quot;HelloPort&quot;,&lt;br/&gt;
             targetNamespace=&quot;http://cxf.apache.org/provider&quot;,&lt;br/&gt;
             wsdlLocation=&quot;WEB-INF/hello.wsdl&quot;&lt;br/&gt;
     )&lt;br/&gt;
   @BindingType(value=javax.xml.ws.soap.SOAPBinding.SOAP11HTTP_BINDING)&lt;br/&gt;
   @ServiceMode (value=javax.xml.ws.Service.Mode.PAYLOAD)&lt;br/&gt;
   public class HelloProvider implements Provider&amp;lt;Source&amp;gt; {&lt;br/&gt;
     public Source invoke(Source req)  &lt;/p&gt;
{
         return new StreamSource();
     }
&lt;p&gt;   }&lt;br/&gt;
   ```&lt;br/&gt;
   The client dispatch expects receiving a null value. Add this check in ClientImpl throws  IllegalStateException instead of return a null result.&lt;/p&gt;

&lt;p&gt;   &amp;gt; By pushing some of this down into the ClientProxy&apos;s, anything that doesn&apos;t use the client proxies (like Camel endpoints) wouldn&apos;t have this check in place.&lt;/p&gt;

&lt;p&gt;   For the caml endpoints without using the client proxy, it gets a null value result. Is the null value a problem for ClientCallback and something else ?  &lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16464016" author="githubbot" created="Fri, 4 May 2018 15:22:31 +0000"  >&lt;p&gt;jimma commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r186116780&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r186116780&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/JaxWsClientProxy.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,6 +138,10 @@ public Object invoke(Object proxy, Method method, Object[] args) throws Throwabl&lt;br/&gt;
             } else &lt;/p&gt;
{
                 result = invokeSync(method, oi, params);
             }
&lt;p&gt;+            if (result == null &amp;amp;&amp;amp; !method.getReturnType().equals(Void.TYPE)&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Thanks for review. @andrei-ivanov  . I agree with you,  == is more direct for class equality. &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16464018" author="githubbot" created="Fri, 4 May 2018 15:23:14 +0000"  >&lt;p&gt;jimma commented on a change in pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#discussion_r186116984&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#discussion_r186116984&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ClientProxy.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -79,6 +79,9 @@ public Object invoke(Object proxy, Method method, Object[] args) throws Throwabl&lt;br/&gt;
         }&lt;/p&gt;

&lt;p&gt;         Object o = invokeSync(method, oi, params);&lt;br/&gt;
+        if (o == null &amp;amp;&amp;amp; !method.getReturnType().equals(Void.TYPE) &amp;amp;&amp;amp; method.getReturnType().isPrimitive()) {&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   +1 .  &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16464028" author="githubbot" created="Fri, 4 May 2018 15:32:12 +0000"  >&lt;p&gt;jimma commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-386638360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-386638360&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   After talked with @dkulp  and @coheigea , looked at more details . This PR possibly doesn&apos;t fix &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; completely and probably has other side effect. I&apos;ll close this PR and fix the issue after &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; with another PR &lt;a href=&quot;https://github.com/apache/cxf/pull/417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/417&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16464029" author="githubbot" created="Fri, 4 May 2018 15:32:49 +0000"  >&lt;p&gt;jimma commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-386638360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-386638360&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   After talked with @dkulp  and @coheigea , looked at more details . This PR possibly doesn&apos;t fix &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; completely and probably has other side effect. I&apos;ll close this PR and fix the issue after &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; with another PR &lt;a href=&quot;https://github.com/apache/cxf/pull/417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/417&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16464030" author="githubbot" created="Fri, 4 May 2018 15:33:27 +0000"  >&lt;p&gt;jimma commented on issue #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414#issuecomment-386638747&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414#issuecomment-386638747&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   After talked with @dkulp and @coheigea , looked at more details . This PR possibly doesn&apos;t fix &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; completely and probably has other side effect. I&apos;ll close this PR and fix the issue after &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt; with another PR #417.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16464031" author="githubbot" created="Fri, 4 May 2018 15:33:28 +0000"  >&lt;p&gt;jimma closed pull request #414: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7653&quot; title=&quot;Null pointer in JaxwsResponseCallback&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7653&quot;&gt;&lt;del&gt;CXF-7653&lt;/del&gt;&lt;/a&gt;:Fix NPE in ClientProxy&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/414&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java b/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java&lt;br/&gt;
index 799c26e0593..1cd330a8be9 100644&lt;br/&gt;
&amp;#8212; a/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java&lt;br/&gt;
+++ b/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java&lt;br/&gt;
@@ -657,24 +657,9 @@ private void enrichFault(Fault fault) {&lt;br/&gt;
         if (ex != null) &lt;/p&gt;
{
             throw ex;
         }
&lt;p&gt;-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (resList == null&lt;/li&gt;
	&lt;li&gt;&amp;amp;&amp;amp; oi != null &amp;amp;&amp;amp; !oi.getOperationInfo().isOneWay()) {&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;BindingOperationInfo boi = oi;&lt;/li&gt;
	&lt;li&gt;if (boi.isUnwrapped()) 
{
-                boi = boi.getWrappedOperation();
-            }&lt;/li&gt;
	&lt;li&gt;if (!boi.getOutput().getMessageParts().isEmpty()) 
{
-                //we were supposed to get some output, but didn&apos;t
-                throw new IllegalStateException(&quot;Response message did not contain proper response data. Expected: &quot;
-                    + boi.getOutput().getMessageParts().get(0).getConcreteName());
-            }&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
         if (resList != null) 
{
             return resList.toArray();
         }
&lt;p&gt;-&lt;br/&gt;
         return null;&lt;br/&gt;
     }&lt;br/&gt;
     protected Exception getException(Exchange exchange) &lt;/p&gt;
{
diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/JaxWsClientProxy.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/JaxWsClientProxy.java
index 5048af1818c..d89be942a84 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/JaxWsClientProxy.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/JaxWsClientProxy.java
@@ -138,6 +138,10 @@ public Object invoke(Object proxy, Method method, Object[] args) throws Throwabl
             }
&lt;p&gt; else &lt;/p&gt;
{
                 result = invokeSync(method, oi, params);
             }
&lt;p&gt;+            if (result == null &amp;amp;&amp;amp; !method.getReturnType().equals(Void.TYPE)&lt;br/&gt;
+                &amp;amp;&amp;amp; method.getReturnType().isPrimitive()) &lt;/p&gt;
{
+                throw new IllegalStateException(&quot;Response message did not contain proper response data&quot;);
+            }
&lt;p&gt;         } catch (WebServiceException wex) &lt;/p&gt;
{
             throw wex;
         }
&lt;p&gt; catch (Exception ex) &lt;/p&gt;
{
diff --git a/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ClientProxy.java b/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ClientProxy.java
index d0670ca4031..2fb7bb65e47 100644
--- a/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ClientProxy.java
+++ b/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ClientProxy.java
@@ -79,6 +79,9 @@ public Object invoke(Object proxy, Method method, Object[] args) throws Throwabl
         }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         Object o = invokeSync(method, oi, params);&lt;br/&gt;
+        if (o == null &amp;amp;&amp;amp; !method.getReturnType().equals(Void.TYPE) &amp;amp;&amp;amp; method.getReturnType().isPrimitive()) &lt;/p&gt;
{
+            throw new IllegalStateException(&quot;Response message did not contain proper response data&quot;);
+        }
&lt;p&gt;         //call a virtual method passing the object.  This causes the IBM JDK&lt;br/&gt;
         //to keep the &quot;this&quot; pointer references and thus &quot;this&quot; doesn&apos;t get&lt;br/&gt;
         //finalized in the midst of an invoke operation&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qe8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>