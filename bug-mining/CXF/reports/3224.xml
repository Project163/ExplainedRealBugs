<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 12:30:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-7023] SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter</title>
                <link>https://issues.apache.org/jira/browse/CXF-7023</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;When using Websphere MQ resource adapter&lt;br/&gt;
Inbound one-way service does not uses XA transactions.&lt;br/&gt;
This is because WMQ adapter decides to use XA transaction when creates jms connection, but connection opened in JMSDestination, and transaction started in PollingMessageListnerContainer after connection created.&lt;br/&gt;
Futhermore WMQ adapter holds only one session per connection.&lt;br/&gt;
I have patched XAPoller to hold connection for each thread, it works, but may be there are better way to provide support for WMQ adapter? &lt;/p&gt;
</description>
                <environment></environment>
        <key id="13000031">CXF-7023</key>
            <summary>SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cschneider">Christian Schneider</assignee>
                                    <reporter username="nikolobok">Nikolay Boklaschuk</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Aug 2016 14:27:55 +0000</created>
                <updated>Wed, 7 Feb 2018 14:52:02 +0000</updated>
                            <resolved>Sun, 28 Jan 2018 14:10:11 +0000</resolved>
                                    <version>3.1.7</version>
                                    <fixVersion>3.2.2</fixVersion>
                                    <component>JMS</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15473707" author="githubbot" created="Thu, 8 Sep 2016 12:16:07 +0000"  >&lt;p&gt;GitHub user nikolobok opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; JMS transport new parameter &quot;oneSessionPerConnection&quot; need&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;ed when using WMQ resource adapter&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/nikolobok/cxf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nikolobok/cxf&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #166&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a8b7fd5a8d23c0493a4c35941a76e0994525592a&lt;br/&gt;
Author: Nikolay Boklaschuk &amp;lt;boklaschuk@yandex.ru&amp;gt;&lt;br/&gt;
Date:   2016-09-08T11:59:10Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; JMS transport new parameter &quot;oneSessionPerConnection&quot; needed when using WMQ resource adapter&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15592627" author="rainer.mueller" created="Thu, 20 Oct 2016 18:42:25 +0000"  >&lt;p&gt;Patch fixed our issue with WebSphere MQ Resource Adapter 7.5.0.5 running in JBoss EAP 7.0.2.GA and Apache CXF version 3.1.6.&lt;/p&gt;

&lt;p&gt;Any plans when the fix will be release with Apache CXF?&lt;/p&gt;

&lt;p&gt;Closed the duplicate issue &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7094&quot; title=&quot;MQJCA1018: Only one session per connection is allowed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7094&quot;&gt;&lt;del&gt;CXF-7094&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15594239" author="nikolobok" created="Fri, 21 Oct 2016 06:30:23 +0000"  >&lt;p&gt;Glad to see that my patch come useful for you.&lt;br/&gt;
There is no any response from cxf team, so I am waiting.&lt;br/&gt;
One more thing: the whole jms transport implementation not good because based on pooling. &lt;br/&gt;
There is outdated implementation by Benoit from OW2 JOnAS project based on mdb.&lt;br/&gt;
But I did not tried it, because our project has been stopped.&lt;br/&gt;
I think it could be merged in mainline with some improvements alongside with current transport.&lt;/p&gt;</comment>
                            <comment id="15594356" author="rainer.mueller" created="Fri, 21 Oct 2016 07:35:57 +0000"  >&lt;p&gt;Your last commit (7301fd2) breaks a test in the transport-jms testsuite.&lt;br/&gt;
In SoapJmsSpecTest, line 109&lt;br/&gt;
&lt;tt&gt;Assert.assertEquals(null, responseHeader.getSOAPJMSSOAPAction());&lt;/tt&gt;&lt;br/&gt;
should be&lt;br/&gt;
&lt;tt&gt;Assert.assertEquals(&quot;\&quot;test\&quot;&quot;, responseHeader.getSOAPJMSSOAPAction());&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Could you please fix this to increase the probability to get the pull request merged?&lt;/p&gt;</comment>
                            <comment id="15594400" author="nikolobok" created="Fri, 21 Oct 2016 07:51:38 +0000"  >&lt;p&gt;Thanks, Rainer.&lt;br/&gt;
Done.&lt;/p&gt;</comment>
                            <comment id="15621461" author="githubbot" created="Mon, 31 Oct 2016 07:01:26 +0000"  >&lt;p&gt;Github user nikolobok commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Could anyone review and push this PR to upstream?&lt;/p&gt;</comment>
                            <comment id="15976911" author="chris@die-schneider.net" created="Thu, 20 Apr 2017 15:37:14 +0000"  >&lt;p&gt;If I understand the PR correctly then it is creating a new connection for every received message. Is that really necessary for WMQ?&lt;br/&gt;
This makes the whole code a lot more complicated. I would really like to avoid this.&lt;/p&gt;

&lt;p&gt;I wonder if there is some documentation about this behaviour. Maybe WMQ can be used in a different way to behave more like the other providers.&lt;/p&gt;

</comment>
                            <comment id="15977240" author="nikolobok" created="Thu, 20 Apr 2017 18:37:56 +0000"  >&lt;p&gt;As I can remember, it only holds one session per connection, there could be many connections but only with one session in each, so there will be the same count of simultaneously threads how many connections is.&lt;br/&gt;
One thread can dispatch only one message (or packet) in time, but it should not close a connection after each message as i can remember.&lt;br/&gt;
There is no another way to use wmq brand adaptor. &lt;br/&gt;
And it not makes code or architecture more complecated, just cuts some multitasking when turned on.&lt;br/&gt;
The commit has been done for a half a year ago, and was fully working. &lt;br/&gt;
May be it needs some merge for now.&lt;/p&gt;</comment>
                            <comment id="15992910" author="rainer.mueller" created="Tue, 2 May 2017 13:39:24 +0000"  >&lt;p&gt;See class &lt;tt&gt;com.ibm.mq.connector.jar!/com/ibm/mq/connector/outbound/ConnectionWrapper.class&lt;/tt&gt; from WebSphere MQ resource adapter &lt;tt&gt;wmq.jmsra.rar&lt;/tt&gt; version &lt;tt&gt;7.5.0.5&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Session createSession(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; arg0, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; arg1)
    &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; JMSException
  {
    JCATraceAdapter.traceEntry(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ConnectionWrapper&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;createSession(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] { &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;(arg0), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;(arg1) });
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
    {
      assertOpen();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.theSessionWrapper == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.theSessionWrapper = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SessionWrapper(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.theManagedConnection.getPhysicalSession());
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ((JMSException)JCAExceptionBuilder.buildException(3, &lt;span class=&quot;code-quote&quot;&gt;&quot;MQJCA1018&quot;&lt;/span&gt;));
      }
      JCATraceAdapter.traceData(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ConnectionWrapper&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;createSession(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Session&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.theSessionWrapper);
      
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.theSessionWrapper;
    }
    &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt;
    {
      JCATraceAdapter.traceExit(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ConnectionWrapper&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;createSession(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)&quot;&lt;/span&gt;);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Resource &lt;tt&gt;com.ibm.mq.connector.jar!/com/ibm/mq/connector/services/resources/MQJCA_MessageResourceBundle.properties&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# Cannot create more than one Session per Connection
MQJCA1018 = Only one session per connection is allowed.
MQJCA1018.explanation = The application attempted to create more than one JMS session on the same JMS connection. This exception occurs only if the application is running in a managed environment.
MQJCA1018.useraction = Modify the application so that it creates only one JMS session on a JMS connection.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="16040917" author="githubbot" created="Wed, 7 Jun 2017 14:01:25 +0000"  >&lt;p&gt;Github user deki commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166#discussion_r120632894&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166#discussion_r120632894&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java &amp;#8212;&lt;br/&gt;
    @@ -76,14 +76,14 @@ public void testRequestQueueResponseStaticQueue() throws Exception &lt;/p&gt;
{
             sendAndReceiveMessages(ei, false);
         }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test&lt;br/&gt;
         public void testRequestTopicResponseTempQueue() throws Exception 
{
             EndpointInfo ei = setupServiceInfo(&quot;http://cxf.apache.org/jms_simple&quot;, &quot;/wsdl/jms_spec_testsuite.wsdl&quot;,
                              &quot;JMSSimpleService002X&quot;, &quot;SimplePortTopicRequest&quot;);
             sendAndReceiveMessages(ei, true);
         }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    why is it necessary to disable this test?&lt;/p&gt;</comment>
                            <comment id="16040918" author="githubbot" created="Wed, 7 Jun 2017 14:01:25 +0000"  >&lt;p&gt;Github user deki commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166#discussion_r120632841&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166#discussion_r120632841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java &amp;#8212;&lt;br/&gt;
    @@ -76,14 +76,14 @@ public void testRequestQueueResponseStaticQueue() throws Exception &lt;/p&gt;
{
             sendAndReceiveMessages(ei, false);
         }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    why is it necessary to disable this test?&lt;/p&gt;</comment>
                            <comment id="16041213" author="githubbot" created="Wed, 7 Jun 2017 16:59:02 +0000"  >&lt;p&gt;Github user nikolobok commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166#discussion_r120685283&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166#discussion_r120685283&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java &amp;#8212;&lt;br/&gt;
    @@ -76,14 +76,14 @@ public void testRequestQueueResponseStaticQueue() throws Exception &lt;/p&gt;
{
             sendAndReceiveMessages(ei, false);
         }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test&lt;br/&gt;
         public void testRequestTopicResponseTempQueue() throws Exception 
{
             EndpointInfo ei = setupServiceInfo(&quot;http://cxf.apache.org/jms_simple&quot;, &quot;/wsdl/jms_spec_testsuite.wsdl&quot;,
                              &quot;JMSSimpleService002X&quot;, &quot;SimplePortTopicRequest&quot;);
             sendAndReceiveMessages(ei, true);
         }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    because it did not worked in master branch, and I have no time to fix that old bug, and all unit test did not pass.&lt;br/&gt;
    Too much time passed from PR...&lt;/p&gt;</comment>
                            <comment id="16041248" author="githubbot" created="Wed, 7 Jun 2017 17:20:29 +0000"  >&lt;p&gt;Github user deki commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/cxf/pull/166#discussion_r120690383&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166#discussion_r120690383&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java &amp;#8212;&lt;br/&gt;
    @@ -76,14 +76,14 @@ public void testRequestQueueResponseStaticQueue() throws Exception &lt;/p&gt;
{
             sendAndReceiveMessages(ei, false);
         }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test&lt;br/&gt;
         public void testRequestTopicResponseTempQueue() throws Exception 
{
             EndpointInfo ei = setupServiceInfo(&quot;http://cxf.apache.org/jms_simple&quot;, &quot;/wsdl/jms_spec_testsuite.wsdl&quot;,
                              &quot;JMSSimpleService002X&quot;, &quot;SimplePortTopicRequest&quot;);
             sendAndReceiveMessages(ei, true);
         }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
    +    //@Test
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Just leave it as it is. Don&apos;t worry about the failing build.&lt;/p&gt;</comment>
                            <comment id="16289204" author="dalbotex" created="Wed, 13 Dec 2017 12:31:23 +0000"  >&lt;p&gt;I am currently in the process of updating nikolobok&apos;s changes for the current &lt;tt&gt;master&lt;/tt&gt;&#160;branch and will submit a new pull request as soon as I had a chance to properly test the changes.&lt;/p&gt;

&lt;p&gt;We are already running a patched version (&lt;a href=&quot;https://github.com/inventage/cxf/commits/CXF-7023-3.1.10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/inventage/cxf/commits/CXF-7023-3.1.10&lt;/a&gt;) of CXF 3.1.10 in a testing environment and have not encountered any issues this far. Eventually this patch might result in a pull request to the &lt;tt&gt;3.1.x-fixes&lt;/tt&gt;&#160;branch.&lt;/p&gt;</comment>
                            <comment id="16290866" author="githubbot" created="Thu, 14 Dec 2017 13:55:54 +0000"  >&lt;p&gt;sadimusi opened a new pull request #358: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; Add oneSessionPerConnection property to JMS transport&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/358&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/358&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This is an updated and slightly modified version of pull request #166 which aims to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CXF-7023&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;   It introduces a new `oneSessionPerConnection` JMS property which prevents the reuse of JMS connections for multiple sessions. This is required with IBM WebSphere MQ which only allows one session per connection.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16342532" author="githubbot" created="Sun, 28 Jan 2018 11:19:08 +0000"  >&lt;p&gt;cschneider commented on issue #358: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; Add oneSessionPerConnection property to JMS transport&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/358#issuecomment-361055265&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/358#issuecomment-361055265&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Looks .. good I merged it&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16342533" author="githubbot" created="Sun, 28 Jan 2018 11:19:09 +0000"  >&lt;p&gt;cschneider closed pull request #358: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; Add oneSessionPerConnection property to JMS transport&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/358&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/358&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java&lt;br/&gt;
index a83984b8f99..5a9550181eb 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java&lt;br/&gt;
@@ -54,14 +54,19 @@&lt;br/&gt;
     private static final Logger LOG = LogUtils.getL7dLogger(BackChannelConduit.class);&lt;br/&gt;
     private JMSConfiguration jmsConfig;&lt;br/&gt;
     private Message inMessage;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private Connection connection;&lt;br/&gt;
+    private Connection persistentConnection;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     BackChannelConduit(Message inMessage, JMSConfiguration jmsConfig, Connection connection) &lt;/p&gt;
{
         super(EndpointReferenceUtils.getAnonymousEndpointReference());
         this.inMessage = inMessage;
         this.jmsConfig = jmsConfig;
-        this.connection = connection;
+        this.persistentConnection = connection;
     }
&lt;p&gt;+&lt;br/&gt;
+    BackChannelConduit(Message inMessage, JMSConfiguration jmsConfig) &lt;/p&gt;
{
+        this(inMessage, jmsConfig, null);
+    }
&lt;p&gt;+&lt;br/&gt;
     @Override&lt;br/&gt;
     public void close(Message msg) throws IOException {&lt;br/&gt;
         MessageStreamUtil.closeStreams(msg);&lt;br/&gt;
@@ -121,6 +126,14 @@ public void sendExchange(Exchange exchange, final Object replyObj) {&lt;/p&gt;

&lt;p&gt;     private void send(final Message outMessage, final Object replyObj, ResourceCloser closer)&lt;br/&gt;
         throws JMSException {&lt;br/&gt;
+        Connection connection;&lt;br/&gt;
+&lt;br/&gt;
+        if (persistentConnection == null) &lt;/p&gt;
{
+            connection = closer.register(JMSFactory.createConnection(jmsConfig));
+        }
&lt;p&gt; else &lt;/p&gt;
{
+            connection = this.persistentConnection;
+        }
&lt;p&gt;+&lt;br/&gt;
         Session session = closer.register(connection.createSession(false, Session.AUTO_ACKNOWLEDGE));&lt;/p&gt;

&lt;p&gt;         JMSMessageHeadersType outProps = (JMSMessageHeadersType)outMessage.get(JMS_SERVER_RESPONSE_HEADERS);&lt;br/&gt;
@@ -178,6 +191,7 @@ public static void initResponseMessageProperties(JMSMessageHeadersType messagePr&lt;br/&gt;
         messageProperties.setJMSDeliveryMode(inMessageProperties.getJMSDeliveryMode());&lt;br/&gt;
         messageProperties.setJMSPriority(inMessageProperties.getJMSPriority());&lt;br/&gt;
         messageProperties.setSOAPJMSRequestURI(inMessageProperties.getSOAPJMSRequestURI());&lt;br/&gt;
+        messageProperties.setSOAPJMSSOAPAction(inMessageProperties.getSOAPJMSSOAPAction());&lt;br/&gt;
         messageProperties.setSOAPJMSBindingVersion(&quot;1.0&quot;);&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;@@ -220,4 +234,4 @@ public String determineCorrelationID(javax.jms.Message request) throws JMSExcept&lt;br/&gt;
             : request.getJMSCorrelationID();&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;-}&lt;br/&gt;
\ No newline at end of file&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java&lt;br/&gt;
index 50db27d0875..d627c1621c0 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java&lt;br/&gt;
@@ -47,10 +47,12 @@&lt;br/&gt;
 import org.apache.cxf.message.MessageUtils;&lt;br/&gt;
 import org.apache.cxf.security.SecurityContext;&lt;br/&gt;
 import org.apache.cxf.transport.AbstractConduit;&lt;br/&gt;
+import org.apache.cxf.transport.jms.util.AbstractMessageListenerContainer;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.JMSListenerContainer;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.JMSSender;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.JMSUtil;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.MessageListenerContainer;&lt;br/&gt;
+import org.apache.cxf.transport.jms.util.PollingMessageListenerContainer;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.ResourceCloser;&lt;br/&gt;
 import org.apache.cxf.ws.addressing.EndpointReferenceType;&lt;/p&gt;

&lt;p&gt;@@ -157,8 +159,16 @@ public void sendExchange(final Exchange exchange, final Object request) {&lt;br/&gt;
         assertIsNotTextMessageAndMtom(outMessage);&lt;/p&gt;

&lt;p&gt;         try (ResourceCloser closer = new ResourceCloser()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connection c = getConnection();&lt;/li&gt;
	&lt;li&gt;Session session = closer.register(c.createSession(false,&lt;br/&gt;
+            Connection c;&lt;br/&gt;
+&lt;br/&gt;
+            if (jmsConfig.isOneSessionPerConnection()) 
{
+                c = closer.register(JMSFactory.createConnection(jmsConfig));
+                c.start();
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                c = getConnection();
+            }
&lt;p&gt;+&lt;br/&gt;
+            Session session = closer.register(c.createSession(false, &lt;br/&gt;
                                                               Session.AUTO_ACKNOWLEDGE));&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;             if (exchange.isOneWay()) {&lt;br/&gt;
@@ -168,9 +178,11 @@ public void sendExchange(final Exchange exchange, final Object request) {&lt;br/&gt;
             }&lt;br/&gt;
         } catch (JMSException e) {&lt;br/&gt;
             // Close connection so it will be refreshed on next try&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ResourceCloser.close(connection);&lt;/li&gt;
	&lt;li&gt;this.connection = null;&lt;/li&gt;
	&lt;li&gt;jmsConfig.resetCachedReplyDestination();&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) 
{
+                ResourceCloser.close(connection);
+                this.connection = null;
+                jmsConfig.resetCachedReplyDestination();
+            }
&lt;p&gt;             this.staticReplyDestination = null;&lt;br/&gt;
             if (this.jmsListener != null) {&lt;br/&gt;
                 this.jmsListener.shutdown();&lt;br/&gt;
@@ -192,14 +204,27 @@ private void setupReplyDestination(Session session) throws JMSException {&lt;br/&gt;
                     staticReplyDestination = jmsConfig.getReplyDestination(session);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;                     String messageSelector = JMSFactory.getMessageSelector(jmsConfig, conduitId);&lt;br/&gt;
+                    if (jmsConfig.getMessageSelector() != null) &lt;/p&gt;
{
+                        messageSelector += (messageSelector != null &amp;amp;&amp;amp; !messageSelector.isEmpty() ? &quot; AND &quot; : &quot;&quot;)
+                                + jmsConfig.getMessageSelector();
+                    }
&lt;p&gt;                     if (messageSelector == null &amp;amp;&amp;amp; !jmsConfig.isPubSubDomain()) &lt;/p&gt;
{
                         // Do not open listener without selector on a queue as we then can not share the queue.
                         // An option for this might be a good idea for people who do not plan to share queues.
                         return;
                     }
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MessageListenerContainer container = new MessageListenerContainer(getConnection(),&lt;/li&gt;
	&lt;li&gt;staticReplyDestination,&lt;/li&gt;
	&lt;li&gt;this);&lt;br/&gt;
+&lt;br/&gt;
+                    AbstractMessageListenerContainer container;&lt;br/&gt;
+&lt;br/&gt;
+                    if (jmsConfig.isOneSessionPerConnection()) 
{
+                        container = new PollingMessageListenerContainer(jmsConfig, true, this);
+                    }
&lt;p&gt; else &lt;/p&gt;
{
+                        container = new MessageListenerContainer(getConnection(), staticReplyDestination, this);
+                    }
&lt;p&gt;+&lt;br/&gt;
+                    container.setTransactionManager(jmsConfig.getTransactionManager());&lt;br/&gt;
+                    container.setTransacted(jmsConfig.isSessionTransacted());&lt;br/&gt;
+                    container.setDurableSubscriptionName(jmsConfig.getDurableSubscriptionName());&lt;br/&gt;
                     container.setMessageSelector(messageSelector);&lt;br/&gt;
                     Object executor = bus.getProperty(JMSFactory.JMS_CONDUIT_EXECUTOR);&lt;br/&gt;
                     if (executor instanceof Executor) {&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java&lt;br/&gt;
index 48953f53f53..b7866cf1af2 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java&lt;br/&gt;
@@ -86,6 +86,8 @@ public static JMSConfiguration createFromEndpoint(Bus bus, JMSEndpoint endpoint)&lt;br/&gt;
         jmsConfig.setUserName(endpoint.getUsername());&lt;br/&gt;
         jmsConfig.setPassword(endpoint.getPassword());&lt;br/&gt;
         jmsConfig.setConcurrentConsumers(endpoint.getConcurrentConsumers());&lt;br/&gt;
+        jmsConfig.setOneSessionPerConnection(endpoint.isOneSessionPerConnection());&lt;br/&gt;
+        jmsConfig.setMessageSelector(endpoint.getMessageSelector());&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         TransactionManager tm = getTransactionManager(bus, endpoint);&lt;br/&gt;
         jmsConfig.setTransactionManager(tm);&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java&lt;br/&gt;
index 434cb0cd295..bead3e7746b 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java&lt;br/&gt;
@@ -91,6 +91,7 @@&lt;br/&gt;
     private boolean useConduitIdSelector = true;&lt;br/&gt;
     private String conduitSelectorPrefix;&lt;br/&gt;
     private boolean jmsProviderTibcoEms;&lt;br/&gt;
+    private boolean oneSessionPerConnection;&lt;/p&gt;

&lt;p&gt;     private TransactionManager transactionManager;&lt;/p&gt;

&lt;p&gt;@@ -432,6 +433,14 @@ public void setJmsProviderTibcoEms(boolean jmsProviderTibcoEms) &lt;/p&gt;
{
         this.jmsProviderTibcoEms = jmsProviderTibcoEms;
     }

&lt;p&gt;+    public boolean isOneSessionPerConnection() &lt;/p&gt;
{
+        return oneSessionPerConnection;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    public void setOneSessionPerConnection(boolean oneSessionPerConnection) {
+        this.oneSessionPerConnection = oneSessionPerConnection;
+    }&lt;br/&gt;
+&lt;br/&gt;
     public static Destination resolveOrCreateDestination(final Session session,&lt;br/&gt;
                                                          final DestinationResolver resolver,&lt;br/&gt;
                                                          final String replyToDestinationName,&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java&lt;br/&gt;
index b85411e3f7c..c72931bcf5b 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java&lt;br/&gt;
@@ -90,7 +90,13 @@ protected Conduit getInbuiltBackChannel(Message inMessage) {&lt;br/&gt;
             &amp;amp;&amp;amp; !robust) {
             return null;
         }&lt;br/&gt;
-        return new BackChannelConduit(inMessage, jmsConfig, connection);&lt;br/&gt;
+&lt;br/&gt;
+        if (jmsConfig.isOneSessionPerConnection()) {
+            return new BackChannelConduit(inMessage, jmsConfig);
+        } else {
+            return new BackChannelConduit(inMessage, jmsConfig, connection);
+        }&lt;br/&gt;
+&lt;br/&gt;
     }&lt;br/&gt;
 &lt;br/&gt;
     /**&lt;br/&gt;
@@ -105,14 +111,15 @@ public void activate() {&lt;br/&gt;
             if (e.getCause() != null &amp;amp;&amp;amp; InvalidClientIDException.class.isInstance(e.getCause())) {
                 throw e;
             }&lt;br/&gt;
-            // If first connect fails we will try to establish the connection in the background &lt;br/&gt;
-            new Thread(new Runnable() {&lt;br/&gt;
-&lt;br/&gt;
-                @Override&lt;br/&gt;
-                public void run() {
-                    restartConnection();
-                }&lt;br/&gt;
-            }).start();&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) {&lt;br/&gt;
+                // If first connect fails we will try to establish the connection in the background&lt;br/&gt;
+                new Thread(new Runnable() {&lt;br/&gt;
+                    @Override&lt;br/&gt;
+                    public void run() {
+                        restartConnection();
+                    }&lt;br/&gt;
+                }).start();&lt;br/&gt;
+            }&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;br/&gt;
 &lt;br/&gt;
@@ -120,7 +127,6 @@ public void run() {&lt;br/&gt;
     private JMSListenerContainer createTargetDestinationListener() {&lt;br/&gt;
         Session session = null;&lt;br/&gt;
         try {&lt;br/&gt;
-            connection = JMSFactory.createConnection(jmsConfig);&lt;br/&gt;
             ExceptionListener exListener = new ExceptionListener() {&lt;br/&gt;
                 public void onException(JMSException exception) {&lt;br/&gt;
                     if (!shutdown) {&lt;br/&gt;
@@ -129,12 +135,17 @@ public void onException(JMSException exception) {&lt;br/&gt;
                     }&lt;br/&gt;
                 }&lt;br/&gt;
             };&lt;br/&gt;
-            session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);&lt;br/&gt;
-            Destination destination = jmsConfig.getTargetDestination(session);&lt;br/&gt;
+            &lt;br/&gt;
+            PollingMessageListenerContainer container;&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) {
+                connection = JMSFactory.createConnection(jmsConfig);
+                session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+                Destination destination = jmsConfig.getTargetDestination(session);
+                container = new PollingMessageListenerContainer(connection, destination, this, exListener);
+            } else {
+                container = new PollingMessageListenerContainer(jmsConfig, false, this);
+            }&lt;br/&gt;
 &lt;br/&gt;
-            PollingMessageListenerContainer container = new PollingMessageListenerContainer(connection,&lt;br/&gt;
-                                                                                            destination, &lt;br/&gt;
-                                                                                            this, exListener);&lt;br/&gt;
             container.setConcurrentConsumers(jmsConfig.getConcurrentConsumers());&lt;br/&gt;
             container.setTransactionManager(jmsConfig.getTransactionManager());&lt;br/&gt;
             container.setMessageSelector(jmsConfig.getMessageSelector());&lt;br/&gt;
@@ -149,7 +160,10 @@ public void onException(JMSException exception) {&lt;br/&gt;
             container.setJndiEnvironment(jmsConfig.getJndiEnvironment());&lt;br/&gt;
             container.start();&lt;br/&gt;
             suspendedContinuations.setListenerContainer(container);&lt;br/&gt;
-            connection.start();&lt;br/&gt;
+&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) {
+                connection.start();
+            }&lt;br/&gt;
             return container;&lt;br/&gt;
         } catch (JMSException e) {&lt;br/&gt;
             ResourceCloser.close(connection);&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java&lt;br/&gt;
index 89c12fb50bb..dd004b80011 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java&lt;br/&gt;
@@ -88,6 +88,7 @@&lt;br/&gt;
     private int concurrentConsumers = 1;&lt;br/&gt;
     private String messageSelector;&lt;br/&gt;
     private int retryInterval = 5000;&lt;br/&gt;
+    private boolean oneSessionPerConnection;&lt;br/&gt;
 &lt;br/&gt;
     /**&lt;br/&gt;
      * @param uri&lt;br/&gt;
@@ -499,4 +500,16 @@ public void setRetryInterval(String retryInterval) {
         this.retryInterval = Integer.valueOf(retryInterval);
     }&lt;br/&gt;
     &lt;br/&gt;
+    public boolean isOneSessionPerConnection() {+        return oneSessionPerConnection;+    }
&lt;p&gt;+    &lt;br/&gt;
+    public void setOneSessionPerConnection(String oneSessionPerConnection) &lt;/p&gt;
{
+        this.oneSessionPerConnection = Boolean.valueOf(oneSessionPerConnection);
+    }
&lt;p&gt;+    &lt;br/&gt;
+    public void setOneSessionPerConnection(boolean oneSessionPerConnection) &lt;/p&gt;
{
+        this.oneSessionPerConnection = oneSessionPerConnection;
+    }
&lt;p&gt;+&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java&lt;br/&gt;
index 9edd0dac136..de2c57fa255 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java&lt;br/&gt;
@@ -34,11 +34,23 @@&lt;br/&gt;
 import javax.transaction.Transaction;&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.logging.LogUtils;&lt;br/&gt;
+import org.apache.cxf.transport.jms.JMSConfiguration;&lt;br/&gt;
+import org.apache.cxf.transport.jms.JMSFactory;&lt;/p&gt;

&lt;p&gt; public class PollingMessageListenerContainer extends AbstractMessageListenerContainer {&lt;br/&gt;
     private static final Logger LOG = LogUtils.getL7dLogger(PollingMessageListenerContainer.class);&lt;br/&gt;
     private ExceptionListener exceptionListener;&lt;/p&gt;

&lt;p&gt;+    private JMSConfiguration jmsConfig;&lt;br/&gt;
+    private boolean reply;&lt;br/&gt;
+&lt;br/&gt;
+    public PollingMessageListenerContainer(JMSConfiguration jmsConfig, boolean isReply,&lt;br/&gt;
+                                           MessageListener listenerHandler) &lt;/p&gt;
{
+        this.jmsConfig = jmsConfig;
+        this.reply = isReply;
+        this.listenerHandler = listenerHandler;
+    }
&lt;p&gt;+&lt;br/&gt;
     public PollingMessageListenerContainer(Connection connection, Destination destination,&lt;br/&gt;
                                            MessageListener listenerHandler, ExceptionListener exceptionListener) {&lt;br/&gt;
         this.connection = connection;&lt;br/&gt;
@@ -55,9 +67,16 @@ public void run() {&lt;br/&gt;
             while (running) {&lt;br/&gt;
                 try (ResourceCloser closer = new ResourceCloser()) {&lt;br/&gt;
                     closer.register(createInitialContext());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Create session early to optimize performance                // In&lt;br/&gt;
+                    Connection connection;&lt;br/&gt;
+                    if (jmsConfig != null &amp;amp;&amp;amp; jmsConfig.isOneSessionPerConnection()) 
{
+                        connection = closer.register(createConnection());
+                    } else {
+                        connection = PollingMessageListenerContainer.this.connection;
+                    }&lt;br/&gt;
+                    // Create session early to optimize performance&lt;br/&gt;
                     session = closer.register(connection.createSession(transacted, acknowledgeMode));&lt;br/&gt;
-                    MessageConsumer consumer = closer.register(createConsumer(session));&lt;br/&gt;
+                    MessageConsumer consumer = closer.register(createConsumer(connection, session));&lt;br/&gt;
+&lt;br/&gt;
                     while (running) {&lt;br/&gt;
                         Message message = consumer.receive(1000);&lt;br/&gt;
                         try {&lt;br/&gt;
@@ -108,12 +127,20 @@ public void run() {
                         throw new IllegalStateException(&quot;External transactions are not supported in XAPoller&quot;);
                     }&lt;br/&gt;
                     transactionManager.begin();&lt;br/&gt;
+&lt;br/&gt;
+                    Connection connection;&lt;br/&gt;
+                    if (getConnection() == null) {+                        connection = closer.register(createConnection());+                    }
&lt;p&gt; else &lt;/p&gt;
{
+                        connection = getConnection();
+                    }
&lt;p&gt;+&lt;br/&gt;
                     /*&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Create session inside transaction to give it the&lt;/li&gt;
	&lt;li&gt;chance to enlist itself as a resource&lt;br/&gt;
                      */&lt;br/&gt;
                     Session session = closer.register(connection.createSession(transacted, acknowledgeMode));&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MessageConsumer consumer = closer.register(createConsumer(session));&lt;br/&gt;
+                    MessageConsumer consumer = closer.register(createConsumer(connection, session));&lt;br/&gt;
                     Message message = consumer.receive(1000);&lt;br/&gt;
                     try {&lt;br/&gt;
                         if (message != null) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {@@ -122,7 +149,7 @@ public void run() {
                         transactionManager.commit();
                     } catch (Throwable e) {
                         LOG.log(Level.WARNING, &quot;Exception while processing jms message in cxf. Rolling back&quot;, e);
-                        safeRollBack(session);
+                        safeRollBack();
                     }                 }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; catch (Throwable e) {&lt;br/&gt;
                     handleException(e);&lt;br/&gt;
@@ -131,7 +158,7 @@ public void run() {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected void safeRollBack(Session session) {&lt;br/&gt;
+        private void safeRollBack() {&lt;br/&gt;
             try 
{
                 transactionManager.rollback();
             }
&lt;p&gt; catch (Throwable e) {&lt;br/&gt;
@@ -141,7 +168,31 @@ protected void safeRollBack(Session session) {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     }&lt;/p&gt;

&lt;p&gt;+    private MessageConsumer createConsumer(final Connection connection, final Session session)&lt;br/&gt;
+            throws JMSException {&lt;br/&gt;
+        final MessageConsumer consumer;&lt;br/&gt;
+        &lt;br/&gt;
+        if (jmsConfig != null &amp;amp;&amp;amp; jmsConfig.isOneSessionPerConnection()) {&lt;br/&gt;
+            Destination destination;&lt;br/&gt;
+            if (!isReply()) &lt;/p&gt;
{
+                destination = jmsConfig.getTargetDestination(session);
+            }
&lt;p&gt; else &lt;/p&gt;
{
+                destination = jmsConfig.getReplyDestination(session);
+            }
&lt;p&gt;+            consumer = createConsumer(destination, session);&lt;br/&gt;
+            connection.start();&lt;br/&gt;
+        } else &lt;/p&gt;
{
+            consumer = createConsumer(session);
+        }
&lt;p&gt;+        &lt;br/&gt;
+        return consumer;&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
     private MessageConsumer createConsumer(Session session) throws JMSException &lt;/p&gt;
{
+        return createConsumer(this.destination, session);
+    }
&lt;p&gt;+&lt;br/&gt;
+    private MessageConsumer createConsumer(Destination destination, Session session) throws JMSException {&lt;br/&gt;
         if (durableSubscriptionName != null &amp;amp;&amp;amp; destination instanceof Topic) {&lt;br/&gt;
             return session.createDurableSubscriber((Topic)destination, durableSubscriptionName,&lt;br/&gt;
                                                    messageSelector, pubSubNoLocal);&lt;br/&gt;
@@ -161,6 +212,19 @@ protected void handleException(Throwable e) &lt;/p&gt;
{
         this.exceptionListener.onException(wrapped);
     }

&lt;p&gt;+    private boolean isReply() &lt;/p&gt;
{
+        return reply;
+    }
&lt;p&gt;+&lt;br/&gt;
+    private Connection createConnection() {&lt;br/&gt;
+        try &lt;/p&gt;
{
+            return JMSFactory.createConnection(jmsConfig);
+        }
&lt;p&gt; catch (JMSException e) &lt;/p&gt;
{
+            handleException(e);
+            throw JMSUtil.convertJmsException(e);
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
     @Override&lt;br/&gt;
     public void start() {&lt;br/&gt;
         if (running) {&lt;br/&gt;
diff --git a/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java b/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java&lt;br/&gt;
index 609ce2c75b4..3492f32df83 100644&lt;br/&gt;
&amp;#8212; a/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java&lt;br/&gt;
+++ b/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java&lt;br/&gt;
@@ -106,7 +106,7 @@ public void testWsdlExtensionSpecJMS() throws Exception &lt;/p&gt;
{
         JMSMessageHeadersType responseHeader = (JMSMessageHeadersType)responseContext
             .get(JMSConstants.JMS_CLIENT_RESPONSE_HEADERS);
         Assert.assertEquals(&quot;1.0&quot;, responseHeader.getSOAPJMSBindingVersion());
-        Assert.assertEquals(null, responseHeader.getSOAPJMSSOAPAction());
+        Assert.assertEquals(&quot;\&quot;test\&quot;&quot;, responseHeader.getSOAPJMSSOAPAction());
         Assert.assertEquals(DeliveryMode.PERSISTENT, responseHeader.getJMSDeliveryMode());
         Assert.assertEquals(7, responseHeader.getJMSPriority());
     }




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16342574" author="githubbot" created="Sun, 28 Jan 2018 14:05:34 +0000"  >&lt;p&gt;deki commented on issue #166: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; JMS transport new parameter &quot;oneSessionPerConnection&quot; need&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/166#issuecomment-361065432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166#issuecomment-361065432&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   #358 has been merged, so this is obsolet.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16342575" author="githubbot" created="Sun, 28 Jan 2018 14:05:35 +0000"  >&lt;p&gt;deki closed pull request #166: &lt;a href=&quot;https://issues.apache.org/jira/browse/CXF-7023&quot; title=&quot;SOAP over JMS transport does not use XA transactions with Websphere MQ resource adapter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CXF-7023&quot;&gt;&lt;del&gt;CXF-7023&lt;/del&gt;&lt;/a&gt; JMS transport new parameter &quot;oneSessionPerConnection&quot; need&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/cxf/pull/166&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cxf/pull/166&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java&lt;br/&gt;
index cb6746018c1..8a3a8606d9b 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/BackChannelConduit.java&lt;br/&gt;
@@ -64,6 +64,13 @@&lt;br/&gt;
         this.jmsConfig = jmsConfig;&lt;br/&gt;
         this.connection = connection;&lt;br/&gt;
     }&lt;br/&gt;
+    &lt;br/&gt;
+    BackChannelConduit(Message inMessage, JMSConfiguration jmsConfig) &lt;/p&gt;
{
+        super(EndpointReferenceUtils.getAnonymousEndpointReference());
+        this.inMessage = inMessage;
+        this.jmsConfig = jmsConfig;
+    }
&lt;p&gt;+    &lt;br/&gt;
     @Override&lt;br/&gt;
     public void close(Message msg) throws IOException {&lt;br/&gt;
         MessageStreamUtil.closeStreams(msg);&lt;br/&gt;
@@ -123,7 +130,14 @@ public void sendExchange(Exchange exchange, final Object replyObj) {&lt;/p&gt;

&lt;p&gt;     private void send(final Message outMessage, final Object replyObj, ResourceCloser closer)&lt;br/&gt;
         throws JMSException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Session session = closer.register(connection.createSession(false, Session.AUTO_ACKNOWLEDGE));&lt;br/&gt;
+&lt;br/&gt;
+        Connection c;&lt;br/&gt;
+        if (jmsConfig.isOneSessionPerConnection()) 
{
+            c = closer.register(JMSFactory.createConnection(jmsConfig));
+        }
&lt;p&gt; else &lt;/p&gt;
{
+            c = this.connection;
+        }
&lt;p&gt;+        Session session = closer.register(c.createSession(false, Session.AUTO_ACKNOWLEDGE));&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         JMSMessageHeadersType outProps = (JMSMessageHeadersType)outMessage.get(JMS_SERVER_RESPONSE_HEADERS);&lt;br/&gt;
         JMSMessageHeadersType inProps = (JMSMessageHeadersType)inMessage.get(JMS_SERVER_REQUEST_HEADERS);&lt;br/&gt;
@@ -180,6 +194,7 @@ public static void initResponseMessageProperties(JMSMessageHeadersType messagePr&lt;br/&gt;
         messageProperties.setJMSDeliveryMode(inMessageProperties.getJMSDeliveryMode());&lt;br/&gt;
         messageProperties.setJMSPriority(inMessageProperties.getJMSPriority());&lt;br/&gt;
         messageProperties.setSOAPJMSRequestURI(inMessageProperties.getSOAPJMSRequestURI());&lt;br/&gt;
+        messageProperties.setSOAPJMSSOAPAction(inMessageProperties.getSOAPJMSSOAPAction());&lt;br/&gt;
         messageProperties.setSOAPJMSBindingVersion(&quot;1.0&quot;);&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java&lt;br/&gt;
index 9a0f4be0344..0bc50979515 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConduit.java&lt;br/&gt;
@@ -46,10 +46,12 @@&lt;br/&gt;
 import org.apache.cxf.message.MessageUtils;&lt;br/&gt;
 import org.apache.cxf.security.SecurityContext;&lt;br/&gt;
 import org.apache.cxf.transport.AbstractConduit;&lt;br/&gt;
+import org.apache.cxf.transport.jms.util.AbstractMessageListenerContainer;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.JMSListenerContainer;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.JMSSender;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.JMSUtil;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.MessageListenerContainer;&lt;br/&gt;
+import org.apache.cxf.transport.jms.util.PollingMessageListenerContainer;&lt;br/&gt;
 import org.apache.cxf.transport.jms.util.ResourceCloser;&lt;br/&gt;
 import org.apache.cxf.ws.addressing.EndpointReferenceType;&lt;/p&gt;

&lt;p&gt;@@ -135,7 +137,17 @@ public void sendExchange(final Exchange exchange, final Object request) {&lt;br/&gt;
         assertIsNotTextMessageAndMtom(outMessage);&lt;/p&gt;

&lt;p&gt;         try (ResourceCloser closer = new ResourceCloser()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Connection c = getConnection();&lt;br/&gt;
+            Connection c;&lt;br/&gt;
+            if (jmsConfig.isOneSessionPerConnection()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                try {
+                    c = closer.register(JMSFactory.createConnection(jmsConfig));
+                } catch (JMSException e) {
+                    throw JMSUtil.convertJmsException(e);
+                }+                c.start();+            }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else &lt;/p&gt;
{
+                c = getConnection();
+            }
&lt;p&gt;             Session session = closer.register(c.createSession(false, &lt;br/&gt;
                                                               Session.AUTO_ACKNOWLEDGE));&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -146,8 +158,10 @@ public void sendExchange(final Exchange exchange, final Object request) {&lt;br/&gt;
             }&lt;br/&gt;
         } catch (JMSException e) {&lt;br/&gt;
             // Close connection so it will be refreshed on next try&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ResourceCloser.close(connection);&lt;/li&gt;
	&lt;li&gt;this.connection = null;&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) 
{
+                ResourceCloser.close(connection);
+                this.connection = null;
+            }
&lt;p&gt;             this.staticReplyDestination = null;&lt;br/&gt;
             if (this.jmsListener != null) {&lt;br/&gt;
                 this.jmsListener.shutdown();&lt;br/&gt;
@@ -169,14 +183,28 @@ private void setupReplyDestination(Session session) throws JMSException {&lt;br/&gt;
                     staticReplyDestination = jmsConfig.getReplyDestination(session);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;                     String messageSelector = JMSFactory.getMessageSelector(jmsConfig, conduitId);&lt;br/&gt;
+                    if (jmsConfig.getMessageSelector() != null) &lt;/p&gt;
{
+                        messageSelector += (messageSelector != null &amp;amp;&amp;amp; !messageSelector.isEmpty() ? &quot; AND &quot; : &quot;&quot;)
+                                + jmsConfig.getMessageSelector();
+                    }
&lt;p&gt;                     if (messageSelector == null &amp;amp;&amp;amp; !jmsConfig.isPubSubDomain()) &lt;/p&gt;
{
                         // Do not open listener without selector on a queue as we then can not share the queue.
                         // An option for this might be a good idea for people who do not plan to share queues.
                         return;
                     }
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MessageListenerContainer container = new MessageListenerContainer(getConnection(),&lt;/li&gt;
	&lt;li&gt;staticReplyDestination,&lt;/li&gt;
	&lt;li&gt;this);&lt;br/&gt;
+&lt;br/&gt;
+                    AbstractMessageListenerContainer container;&lt;br/&gt;
+&lt;br/&gt;
+                    if (jmsConfig.isOneSessionPerConnection()) 
{
+                        container = new PollingMessageListenerContainer(jmsConfig, true, this);
+                    }
&lt;p&gt; else &lt;/p&gt;
{
+                        container = new MessageListenerContainer(getConnection(), staticReplyDestination, this);
+                    }
&lt;p&gt;+&lt;br/&gt;
+                    container.setConcurrentConsumers(jmsConfig.getConcurrentConsumers());&lt;br/&gt;
+                    container.setTransactionManager(jmsConfig.getTransactionManager());&lt;br/&gt;
+                    container.setTransacted(jmsConfig.isSessionTransacted());&lt;br/&gt;
+                    container.setDurableSubscriptionName(jmsConfig.getDurableSubscriptionName());&lt;br/&gt;
                     container.setMessageSelector(messageSelector);&lt;br/&gt;
                     Object executor = bus.getProperty(JMSFactory.JMS_CONDUIT_EXECUTOR);&lt;br/&gt;
                     if (executor instanceof Executor) {&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java&lt;br/&gt;
index 464fc7a42ab..ae70b36e7e6 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfigFactory.java&lt;br/&gt;
@@ -86,6 +86,8 @@ public static JMSConfiguration createFromEndpoint(Bus bus, JMSEndpoint endpoint)&lt;br/&gt;
         jmsConfig.setUserName(endpoint.getUsername());&lt;br/&gt;
         jmsConfig.setPassword(endpoint.getPassword());&lt;br/&gt;
         jmsConfig.setConcurrentConsumers(endpoint.getConcurrentConsumers());&lt;br/&gt;
+        jmsConfig.setOneSessionPerConnection(endpoint.isOneSessionPerConnection());&lt;br/&gt;
+        jmsConfig.setMessageSelector(endpoint.getMessageSelector());&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         TransactionManager tm = getTransactionManager(bus, endpoint);&lt;br/&gt;
         jmsConfig.setTransactionManager(tm);&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java&lt;br/&gt;
index 607956dbc59..80fe5357c26 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSConfiguration.java&lt;br/&gt;
@@ -90,6 +90,7 @@&lt;br/&gt;
     private boolean useConduitIdSelector = true;&lt;br/&gt;
     private String conduitSelectorPrefix;&lt;br/&gt;
     private boolean jmsProviderTibcoEms;&lt;br/&gt;
+    private boolean oneSessionPerConnection;&lt;/p&gt;

&lt;p&gt;     private TransactionManager transactionManager;&lt;/p&gt;

&lt;p&gt;@@ -433,6 +434,14 @@ public void setJmsProviderTibcoEms(boolean jmsProviderTibcoEms) &lt;/p&gt;
{
         this.jmsProviderTibcoEms = jmsProviderTibcoEms;
     }

&lt;p&gt;+    public boolean isOneSessionPerConnection() &lt;/p&gt;
{
+        return oneSessionPerConnection;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    public void setOneSessionPerConnection(boolean oneSessionPerConnection) {
+        this.oneSessionPerConnection = oneSessionPerConnection;
+    }&lt;br/&gt;
+    &lt;br/&gt;
     public static Destination resolveOrCreateDestination(final Session session,&lt;br/&gt;
                                                          final DestinationResolver resolver,&lt;br/&gt;
                                                          final String replyToDestinationName,&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java&lt;br/&gt;
index 2b5d8cd4b6b..5ac5be2ab50 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/JMSDestination.java&lt;br/&gt;
@@ -93,7 +93,13 @@ protected Conduit getInbuiltBackChannel(Message inMessage) {&lt;br/&gt;
             &amp;amp;&amp;amp; !robust) {
             return null;
         }&lt;br/&gt;
-        return new BackChannelConduit(inMessage, jmsConfig, connection);&lt;br/&gt;
+&lt;br/&gt;
+        if (jmsConfig.isOneSessionPerConnection()) {
+            return new BackChannelConduit(inMessage, jmsConfig);
+        } else {
+            return new BackChannelConduit(inMessage, jmsConfig, connection);
+        }&lt;br/&gt;
+&lt;br/&gt;
     }&lt;br/&gt;
 &lt;br/&gt;
     /**&lt;br/&gt;
@@ -105,14 +111,17 @@ public void activate() {&lt;br/&gt;
         try {
             this.jmsListener = createTargetDestinationListener();
         } catch (Exception e) {&lt;br/&gt;
-            // If first connect fails we will try to establish the connection in the background &lt;br/&gt;
-            new Thread(new Runnable() {&lt;br/&gt;
-                &lt;br/&gt;
-                @Override&lt;br/&gt;
-                public void run() {
-                    restartConnection();
-                }&lt;br/&gt;
-            }).start();&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) {&lt;br/&gt;
+                // If first connect fails we will try to establish the connection in the background&lt;br/&gt;
+                new Thread(new Runnable() {&lt;br/&gt;
+&lt;br/&gt;
+                    @Override&lt;br/&gt;
+                    public void run() {
+                        restartConnection();
+
+                    }&lt;br/&gt;
+                }).start();&lt;br/&gt;
+            }&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;br/&gt;
     &lt;br/&gt;
@@ -120,20 +129,25 @@ public void run() {&lt;br/&gt;
     private JMSListenerContainer createTargetDestinationListener() {&lt;br/&gt;
         Session session = null;&lt;br/&gt;
         try {&lt;br/&gt;
-            connection = JMSFactory.createConnection(jmsConfig);&lt;br/&gt;
-            connection.setExceptionListener(new ExceptionListener() {&lt;br/&gt;
-                public void onException(JMSException exception) {&lt;br/&gt;
-                    if (!shutdown) {&lt;br/&gt;
-                        LOG.log(Level.WARNING, &quot;Exception on JMS connection. Trying to reconnect&quot;, exception);&lt;br/&gt;
-                        restartConnection();&lt;br/&gt;
+            PollingMessageListenerContainer container;&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) {&lt;br/&gt;
+                connection = JMSFactory.createConnection(jmsConfig);&lt;br/&gt;
+                connection.setExceptionListener(new ExceptionListener() {&lt;br/&gt;
+                    public void onException(JMSException exception) {&lt;br/&gt;
+                        if (!shutdown) {
+                            LOG.log(Level.WARNING, &quot;Exception on JMS connection. Trying to reconnect&quot;, exception);
+                            restartConnection();
+                        }&lt;br/&gt;
                     }&lt;br/&gt;
-                }&lt;br/&gt;
-            });&lt;br/&gt;
-            session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);&lt;br/&gt;
-            Destination destination = jmsConfig.getTargetDestination(session);&lt;br/&gt;
+                });&lt;br/&gt;
+                session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);&lt;br/&gt;
+                Destination destination = jmsConfig.getTargetDestination(session);&lt;br/&gt;
+&lt;br/&gt;
+                container = new PollingMessageListenerContainer(connection, destination, this);&lt;br/&gt;
+            } else {
+                container = new PollingMessageListenerContainer(jmsConfig, false, this);
+            }&lt;br/&gt;
 &lt;br/&gt;
-            PollingMessageListenerContainer container = new PollingMessageListenerContainer(connection, &lt;br/&gt;
-                                                                                            destination, this);&lt;br/&gt;
             container.setConcurrentConsumers(jmsConfig.getConcurrentConsumers());&lt;br/&gt;
             container.setTransactionManager(jmsConfig.getTransactionManager());&lt;br/&gt;
             container.setMessageSelector(jmsConfig.getMessageSelector());&lt;br/&gt;
@@ -147,7 +161,9 @@ public void onException(JMSException exception) {&lt;br/&gt;
             container.setJndiEnvironment(jmsConfig.getJndiEnvironment());&lt;br/&gt;
             container.start();&lt;br/&gt;
             suspendedContinuations.setListenerContainer(container);&lt;br/&gt;
-            connection.start();&lt;br/&gt;
+            if (!jmsConfig.isOneSessionPerConnection()) {
+                connection.start();
+            }&lt;br/&gt;
             return container;&lt;br/&gt;
         } catch (JMSException e) {&lt;br/&gt;
             throw JMSUtil.convertJmsException(e);&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java&lt;br/&gt;
index f5e9d0322a5..ccd2cd85900 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/uri/JMSEndpoint.java&lt;br/&gt;
@@ -85,6 +85,8 @@&lt;br/&gt;
     private boolean useConduitIdSelector = true;&lt;br/&gt;
     private String username;&lt;br/&gt;
     private int concurrentConsumers = 1;&lt;br/&gt;
+    private boolean oneSessionPerConnection;&lt;br/&gt;
+    private String messageSelector;&lt;br/&gt;
 &lt;br/&gt;
     /**&lt;br/&gt;
      * @param uri&lt;br/&gt;
@@ -476,4 +478,24 @@ public static MessageType fromValue(String v) {&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;br/&gt;
     &lt;br/&gt;
+    public boolean isOneSessionPerConnection() {+        return oneSessionPerConnection;+    }
&lt;p&gt;+    &lt;br/&gt;
+    public void setOneSessionPerConnection(String oneSessionPerConnection) &lt;/p&gt;
{
+        this.oneSessionPerConnection = Boolean.valueOf(oneSessionPerConnection);
+    }
&lt;p&gt;+    &lt;br/&gt;
+    public void setOneSessionPerConnection(boolean oneSessionPerConnection) &lt;/p&gt;
{
+        this.oneSessionPerConnection = oneSessionPerConnection;
+    }
&lt;p&gt;+&lt;br/&gt;
+    public String getMessageSelector() &lt;/p&gt;
{
+        return messageSelector;
+    }
&lt;p&gt;+&lt;br/&gt;
+    public void setMessageSelector(String messageSelector) &lt;/p&gt;
{
+        this.messageSelector = messageSelector;
+    }
&lt;p&gt;+&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java&lt;br/&gt;
index 9f8fcb2ebb8..570c627b268 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java&lt;br/&gt;
+++ b/rt/transports/jms/src/main/java/org/apache/cxf/transport/jms/util/PollingMessageListenerContainer.java&lt;br/&gt;
@@ -33,10 +33,22 @@&lt;br/&gt;
 import javax.transaction.Transaction;&lt;/p&gt;

&lt;p&gt; import org.apache.cxf.common.logging.LogUtils;&lt;br/&gt;
+import org.apache.cxf.transport.jms.JMSConfiguration;&lt;br/&gt;
+import org.apache.cxf.transport.jms.JMSFactory;&lt;/p&gt;

&lt;p&gt; public class PollingMessageListenerContainer extends AbstractMessageListenerContainer {&lt;br/&gt;
     private static final Logger LOG = LogUtils.getL7dLogger(PollingMessageListenerContainer.class);&lt;/p&gt;

&lt;p&gt;+    private JMSConfiguration jmsConfig;&lt;br/&gt;
+    private boolean reply;&lt;br/&gt;
+&lt;br/&gt;
+    public PollingMessageListenerContainer(JMSConfiguration jmsConfig, boolean isReply,&lt;br/&gt;
+                                           MessageListener listenerHandler) &lt;/p&gt;
{
+        this.jmsConfig = jmsConfig;
+        this.reply = isReply;
+        this.listenerHandler = listenerHandler;
+    }
&lt;p&gt;+&lt;br/&gt;
     public PollingMessageListenerContainer(Connection connection, Destination destination,&lt;br/&gt;
                                            MessageListener listenerHandler) &lt;/p&gt;
{
         this.connection = connection;
@@ -44,6 +56,18 @@ public PollingMessageListenerContainer(Connection connection, Destination destin
         this.listenerHandler = listenerHandler;
     }

&lt;p&gt;+    private boolean isReply() &lt;/p&gt;
{
+        return reply;
+    }
&lt;p&gt;+&lt;br/&gt;
+    private Connection createConnection() {&lt;br/&gt;
+        try &lt;/p&gt;
{
+            return JMSFactory.createConnection(jmsConfig);
+        }
&lt;p&gt; catch (JMSException e) &lt;/p&gt;
{
+            throw JMSUtil.convertJmsException(e);
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
     private class Poller implements Runnable {&lt;/p&gt;

&lt;p&gt;         @Override&lt;br/&gt;
@@ -51,9 +75,28 @@ public void run() {&lt;br/&gt;
             while (running) {&lt;br/&gt;
                 try (ResourceCloser closer = new ResourceCloser()) {&lt;br/&gt;
                     closer.register(createInitialContext());&lt;br/&gt;
+                    Connection connection;&lt;br/&gt;
+                    if (jmsConfig != null &amp;amp;&amp;amp; jmsConfig.isOneSessionPerConnection()) &lt;/p&gt;
{
+                        connection = closer.register(createConnection());
+                    }
&lt;p&gt; else &lt;/p&gt;
{
+                        connection = PollingMessageListenerContainer.this.connection;
+                    }
&lt;p&gt;                     // Create session early to optimize performance&lt;br/&gt;
                     Session session = closer.register(connection.createSession(transacted, acknowledgeMode));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MessageConsumer consumer = closer.register(createConsumer(session));&lt;br/&gt;
+                    MessageConsumer consumer;&lt;br/&gt;
+                    if (jmsConfig != null &amp;amp;&amp;amp; jmsConfig.isOneSessionPerConnection()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                        Destination destination;+                        if (!isReply()) {
+                            destination = jmsConfig.getTargetDestination(session);
+                        } else {
+                            destination = jmsConfig.getReplyDestination(session);
+                        }+                        consumer = closer.register(createConsumer(destination, session));+                        connection.start();+                    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else &lt;/p&gt;
{
+                        consumer = closer.register(createConsumer(session));
+                    }
&lt;p&gt;+&lt;br/&gt;
                     while (running) {&lt;br/&gt;
                         Message message = consumer.receive(1000);&lt;br/&gt;
                         try {&lt;br/&gt;
@@ -100,21 +143,43 @@ public void run() &lt;/p&gt;
{
                         throw new IllegalStateException(&quot;External transactions are not supported in XAPoller&quot;);
                     }
&lt;p&gt;                     transactionManager.begin();&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;/*&lt;/li&gt;
	&lt;li&gt;* Create session inside transaction to give it the&lt;/li&gt;
	&lt;li&gt;* chance to enlist itself as a resource&lt;/li&gt;
	&lt;li&gt;*/&lt;/li&gt;
	&lt;li&gt;Session session = closer.register(connection.createSession(transacted, acknowledgeMode));&lt;/li&gt;
	&lt;li&gt;MessageConsumer consumer = closer.register(createConsumer(session));&lt;/li&gt;
	&lt;li&gt;Message message = consumer.receive(1000);&lt;br/&gt;
+&lt;br/&gt;
                     try {&lt;br/&gt;
+                        Connection connection;&lt;br/&gt;
+                        if (jmsConfig != null &amp;amp;&amp;amp; jmsConfig.isOneSessionPerConnection()) 
{
+                            connection = closer.register(createConnection());
+                        }
&lt;p&gt; else &lt;/p&gt;
{
+                            connection = PollingMessageListenerContainer.this.connection;
+                        }
&lt;p&gt;+&lt;br/&gt;
+                        /*&lt;br/&gt;
+                         * Create session inside transaction to give it the&lt;br/&gt;
+                         * chance to enlist itself as a resource&lt;br/&gt;
+                         */&lt;br/&gt;
+                        Session session = closer.register(connection.createSession(transacted, acknowledgeMode));&lt;br/&gt;
+                        MessageConsumer consumer;&lt;br/&gt;
+                        if (jmsConfig != null &amp;amp;&amp;amp; jmsConfig.isOneSessionPerConnection()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                            Destination destination;+                            if (!isReply()) {
+                                destination = jmsConfig.getTargetDestination(session);
+                            } else {
+                                destination = jmsConfig.getReplyDestination(session);
+                            }+                            consumer = closer.register(createConsumer(destination, session));+                            connection.start();+                        }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else &lt;/p&gt;
{
+                            consumer = closer.register(createConsumer(session));
+                        }
&lt;p&gt;+&lt;br/&gt;
+                        Message message = consumer.receive(1000);&lt;br/&gt;
+&lt;br/&gt;
                         if (message != null) &lt;/p&gt;
{
                             listenerHandler.onMessage(message);
                         }
&lt;p&gt;                         transactionManager.commit();&lt;br/&gt;
                     } catch (Throwable e) &lt;/p&gt;
{
                         LOG.log(Level.WARNING, &quot;Exception while processing jms message in cxf. Rolling back&quot;, e);
-                        safeRollBack(session);
+                        safeRollBack();
                     }
&lt;p&gt;                 } catch (Exception e) {&lt;br/&gt;
                     LOG.log(Level.WARNING, &quot;Unexpected exception. Restarting session and consumer&quot;, e);&lt;br/&gt;
@@ -124,7 +189,7 @@ public void run() {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void safeRollBack(Session session) {&lt;br/&gt;
+        private void safeRollBack() {&lt;br/&gt;
             try 
{
                 transactionManager.rollback();
             }
&lt;p&gt; catch (Exception e) {&lt;br/&gt;
@@ -135,6 +200,10 @@ private void safeRollBack(Session session) {&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private MessageConsumer createConsumer(Session session) throws JMSException &lt;/p&gt;
{
+        return createConsumer(this.destination, session);
+    }
&lt;p&gt;+&lt;br/&gt;
+    private MessageConsumer createConsumer(Destination destination, Session session) throws JMSException {&lt;br/&gt;
         if (durableSubscriptionName != null &amp;amp;&amp;amp; destination instanceof Topic) {&lt;br/&gt;
             return session.createDurableSubscriber((Topic)destination, durableSubscriptionName,&lt;br/&gt;
                                                    messageSelector, pubSubNoLocal);&lt;br/&gt;
diff --git a/rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java b/rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java&lt;br/&gt;
index c44179c0813..8b6559fa59f 100644&lt;br/&gt;
&amp;#8212; a/rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java&lt;br/&gt;
+++ b/rt/transports/jms/src/test/java/org/apache/cxf/transport/jms/RequestResponseTest.java&lt;br/&gt;
@@ -76,14 +76,14 @@ public void testRequestQueueResponseStaticQueue() throws Exception &lt;/p&gt;
{
         sendAndReceiveMessages(ei, false);
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
+    //@Test&lt;br/&gt;
     public void testRequestTopicResponseTempQueue() throws Exception 
{
         EndpointInfo ei = setupServiceInfo(&quot;http://cxf.apache.org/jms_simple&quot;, &quot;/wsdl/jms_spec_testsuite.wsdl&quot;,
                          &quot;JMSSimpleService002X&quot;, &quot;SimplePortTopicRequest&quot;);
         sendAndReceiveMessages(ei, true);
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
+    //@Test&lt;br/&gt;
     public void testRequestTopicResponseStaticQueue() throws Exception {&lt;br/&gt;
         EndpointInfo ei = setupServiceInfo(&quot;http://cxf.apache.org/jms_simple&quot;, &quot;/wsdl/jms_spec_testsuite.wsdl&quot;,&lt;br/&gt;
                          &quot;JMSSimpleService002X&quot;, &quot;SimplePortTopicRequestQueueResponse&quot;);&lt;br/&gt;
diff --git a/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java b/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java&lt;br/&gt;
index b8aad09f9b3..6479c558efe 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java&lt;br/&gt;
+++ b/systests/transport-jms/src/test/java/org/apache/cxf/jms/testsuite/testcases/SoapJmsSpecTest.java&lt;br/&gt;
@@ -106,7 +106,7 @@ public void testWsdlExtensionSpecJMS() throws Exception 
{
         JMSMessageHeadersType responseHeader = (JMSMessageHeadersType)responseContext
             .get(JMSConstants.JMS_CLIENT_RESPONSE_HEADERS);
         Assert.assertEquals(&quot;1.0&quot;, responseHeader.getSOAPJMSBindingVersion());
-        Assert.assertEquals(null, responseHeader.getSOAPJMSSOAPAction());
+        Assert.assertEquals(&quot;\&quot;test\&quot;&quot;, responseHeader.getSOAPJMSSOAPAction());
         Assert.assertEquals(DeliveryMode.PERSISTENT, responseHeader.getJMSDeliveryMode());
         Assert.assertEquals(7, responseHeader.getJMSPriority());
     }&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16342577" author="deki" created="Sun, 28 Jan 2018 14:10:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nikolobok&quot; class=&quot;user-hover&quot; rel=&quot;nikolobok&quot;&gt;nikolobok&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rainer.mueller&quot; class=&quot;user-hover&quot; rel=&quot;rainer.mueller&quot;&gt;rainer.mueller&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vrlgohel&quot; class=&quot;user-hover&quot; rel=&quot;vrlgohel&quot;&gt;vrlgohel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dalbotex&quot; class=&quot;user-hover&quot; rel=&quot;dalbotex&quot;&gt;dalbotex&lt;/a&gt; could you please check the latest version from master? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chris%40die-schneider.net&quot; class=&quot;user-hover&quot; rel=&quot;chris@die-schneider.net&quot;&gt;chris@die-schneider.net&lt;/a&gt; merged a PR today. Please reopen this issue, if it&apos;s still not working for you...&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13013087">CXF-7094</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 42 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32sdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>