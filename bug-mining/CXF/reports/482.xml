<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:40:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CXF-2550] transactions don&apos;t work in jaxws Endpoint  with jms transport</title>
                <link>https://issues.apache.org/jira/browse/CXF-2550</link>
                <project id="12310511" key="CXF">CXF</project>
                    <description>&lt;p&gt;i&apos;m trying cxf with jms transport with transaction to process a message and it is dequeued  when the implementor object  throw an error .&lt;/p&gt;

&lt;p&gt;the message is inonly and the code is:&lt;/p&gt;

&lt;p&gt;	EndpointImpl endpoint = new EndpointImpl(new ObjectImpl());&lt;br/&gt;
	endpoint.setAddress(&quot;jms://&quot;);&lt;br/&gt;
        ActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;tcp://localhost:61616&quot;);&lt;br/&gt;
        JMSConfiguration jmsConfig = new JMSConfiguration();&lt;/p&gt;

&lt;p&gt;        jmsConfig.setConnectionFactory(connectionFactory);&lt;br/&gt;
        jmsConfig.setTargetDestination(&quot;sso2&quot;);&lt;br/&gt;
	jmsConfig.setSessionTransacted(true);&lt;br/&gt;
	jmsConfig.setPubSubDomain(false);&lt;br/&gt;
	jmsConfig.setUseJms11(true);&lt;br/&gt;
	jmsConfig.setTransactionManager(new JmsTransactionManager(connectionFactory));&lt;/p&gt;

&lt;p&gt;	JMSConfigFeature jmsConfigFeature = new JMSConfigFeature();&lt;br/&gt;
	jmsConfigFeature.setJmsConfig(jmsConfig);&lt;br/&gt;
	endpoint.getFeatures().add(jmsConfigFeature);&lt;br/&gt;
	endpoint.publish();&lt;/p&gt;

&lt;p&gt;seems that the exception never arrive to  AbstractMessageListenerContainer.doExecuteListener but it is catched inside&lt;/p&gt;</description>
                <environment></environment>
        <key id="12441219">CXF-2550</key>
            <summary>transactions don&apos;t work in jaxws Endpoint  with jms transport</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="javier">Javier Puerto</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Nov 2009 19:29:38 +0000</created>
                <updated>Fri, 31 Mar 2017 19:37:46 +0000</updated>
                            <resolved>Wed, 22 Mar 2017 18:07:59 +0000</resolved>
                                    <version>2.2.4</version>
                    <version>2.2.5</version>
                                    <fixVersion>Invalid</fixVersion>
                                    <component>Transports</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12780902" author="dkulp" created="Sat, 21 Nov 2009 03:09:34 +0000"  >&lt;p&gt;&lt;br/&gt;
Can I ask what version of ActiveMQ?   There is definitely a bug in 5.2 around the transaction stuff.   We couldn&apos;t use 5.2 in our unit tests due to the transaction tests failing.   5.3 did fix it and 5.1 worked fine as well.&lt;/p&gt;</comment>
                            <comment id="12781300" author="javier" created="Mon, 23 Nov 2009 04:25:43 +0000"  >&lt;p&gt;project with TransactionSample class to test error using transactions&lt;/p&gt;</comment>
                            <comment id="12781302" author="javier" created="Mon, 23 Nov 2009 04:29:30 +0000"  >&lt;p&gt;hi daniel,&lt;/p&gt;

&lt;p&gt;i&apos;m using activemq 5.3, so i&apos;ve attached a project to show you the error, please have a look&lt;/p&gt;</comment>
                            <comment id="12838500" author="javier" created="Thu, 25 Feb 2010 19:37:52 +0000"  >&lt;p&gt;hi Daniel,&lt;/p&gt;

&lt;p&gt;now the exceptions are propagated and transactions works fine when we are using a transaction manager (JmsTransactionManager or JtaTransactionManager) for transactional wrapping of message but they aren&apos;t  propagated if we use sessionTransacted = true and transactionManager = null (just local transactions of activemq)&lt;/p&gt;
</comment>
                            <comment id="12904522" author="javier" created="Tue, 31 Aug 2010 05:43:56 +0000"  >&lt;p&gt;Hi Daniel,&lt;/p&gt;

&lt;p&gt;Is it possible modify JMSDestination. Modify the onMessage method to propagate the exception without consider TransactionManager. Throw the exception to Spring if there is an exception. &quot;Local resource transactions can simply be activated through the sessionTransacted &quot; according &lt;a href=&quot;http://static.springsource.org/spring/docs/2.5.x/reference/jms.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://static.springsource.org/spring/docs/2.5.x/reference/jms.html&lt;/a&gt;. Can work with local resource transaction or with a transaction manager. &lt;/p&gt;

&lt;p&gt;instead &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; 
            //need to propagate any exceptions back to Spring container 
            //so transactions can occur
            if (inMessage.getContent(Exception.class) != null &amp;amp;&amp;amp; session != null) {
            	
     
            	PlatformTransactionManager m = jmsConfig.getTransactionManager();
                if (m != null) {
                    TransactionStatus status = m.getTransaction(null);
                    JmsResourceHolder resourceHolder =
                        (JmsResourceHolder) TransactionSynchronizationManager
                            .getResource(jmsConfig.getConnectionFactory());
                    boolean trans = resourceHolder == null 
                        || !resourceHolder.containsSession(session);
                    if (status != null &amp;amp;&amp;amp; !status.isCompleted() &amp;amp;&amp;amp; trans) {
                        Exception ex = inMessage.getContent(Exception.class);
                        if (ex.getCause() instanceof RuntimeException) {
                            throw (RuntimeException)ex.getCause();
                        } else {
                            throw new RuntimeException(ex);
                        }
                    }
                }
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;use&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; 
            //need to propagate any exceptions back to Spring container 
            //so transactions can occur
            if (inMessage.getContent(Exception.class) != null &amp;amp;&amp;amp; session != null) {
            	
                Exception ex = inMessage.getContent(Exception.class);
                if (ex.getCause() instanceof RuntimeException) {
                    throw (RuntimeException)ex.getCause();
                } else {
                    throw new RuntimeException(ex);
                }
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="15936827" author="dkulp" created="Wed, 22 Mar 2017 18:07:59 +0000"  >&lt;p&gt;This is an ancient issue is an area of code that has been completely re-written.   If the new JMS transport still has an issue, please re-open with a new test case.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12716861">CXF-5769</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12425798" name="jms_queue.zip" size="14894" author="javier" created="Mon, 23 Nov 2009 04:25:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>113960</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14dzr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233730</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>