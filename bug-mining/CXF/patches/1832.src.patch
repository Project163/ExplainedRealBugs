diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ClassResourceInfo.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ClassResourceInfo.java
index 67f5757c72..0c84447e36 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ClassResourceInfo.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/ClassResourceInfo.java
@@ -286,4 +286,8 @@ public class ClassResourceInfo extends BeanResourceInfo {
     public void setParent(ClassResourceInfo parent) {
         this.parent = parent;
     }
+    
+    public ClassResourceInfo getParent() {
+        return parent;
+    }
 }
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/ResourceUtils.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/ResourceUtils.java
index 6cbb92e6c4..812e7e211e 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/ResourceUtils.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/ResourceUtils.java
@@ -270,7 +270,8 @@ public final class ResourceUtils {
                     if (enableStatic) {
                         ClassResourceInfo subCri = cri.findResource(subClass, subClass);
                         if (subCri == null) {
-                            subCri = subClass == cri.getServiceClass() ? cri
+                            ClassResourceInfo ancestor = getAncestorWithSameServiceClass(cri, subClass);
+                            subCri = ancestor != null ? ancestor
                                      : createClassResourceInfo(subClass, subClass, cri, false, enableStatic,
                                                                cri.getBus());
                         }
@@ -285,6 +286,16 @@ public final class ResourceUtils {
         cri.setMethodDispatcher(md);
     }
     
+    private static ClassResourceInfo getAncestorWithSameServiceClass(ClassResourceInfo parent, Class<?> subClass) {
+        if (parent == null) {
+            return null;
+        }
+        if (parent.getServiceClass() == subClass) {
+            return parent;
+        }
+        return getAncestorWithSameServiceClass(parent.getParent(), subClass);
+    }
+    
     public static Constructor<?> findResourceConstructor(Class<?> resourceClass, boolean perRequest) {
         List<Constructor<?>> cs = new LinkedList<Constructor<?>>();
         for (Constructor<?> c : resourceClass.getConstructors()) {
@@ -552,7 +563,7 @@ public final class ResourceUtils {
         }
         
         for (ClassResourceInfo sub : resource.getSubResources()) {
-            if (sub != resource) {
+            if (resource != sub) {
                 getAllTypesForResource(sub, types, jaxbOnly);
             }
         }
diff --git a/rt/rs/client/src/test/java/org/apache/cxf/jaxrs/client/JAXRSClientFactoryBeanTest.java b/rt/rs/client/src/test/java/org/apache/cxf/jaxrs/client/JAXRSClientFactoryBeanTest.java
index a222dba01f..bd6eb6ea86 100644
--- a/rt/rs/client/src/test/java/org/apache/cxf/jaxrs/client/JAXRSClientFactoryBeanTest.java
+++ b/rt/rs/client/src/test/java/org/apache/cxf/jaxrs/client/JAXRSClientFactoryBeanTest.java
@@ -23,6 +23,9 @@ import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
 
+import javax.ws.rs.Path;
+import javax.ws.rs.PathParam;
+
 import org.apache.cxf.Bus;
 import org.apache.cxf.feature.AbstractFeature;
 import org.apache.cxf.feature.Feature;
@@ -180,6 +183,16 @@ public class JAXRSClientFactoryBeanTest extends Assert {
                      WebClient.client(store2).getCurrentURI().toString());
     }
     
+    @Test 
+    public void testComplexProxy() throws Exception {
+        IProductResource productResource = JAXRSClientFactory.create("http://localhost:9000", 
+                                                                     IProductResource.class);
+        assertNotNull(productResource);
+        IPartsResource parts = productResource.getParts();
+        assertNotNull(parts);
+        IProductResource productResourceElement = parts.elementAt("1");
+        assertNotNull(productResourceElement);
+    }
     
     private class TestFeature extends AbstractFeature {
         private TestInterceptor testInterceptor;
@@ -218,4 +231,15 @@ public class JAXRSClientFactoryBeanTest extends Assert {
     
 
     
+    public interface IProductResource {
+        @Path("/parts")
+        public IPartsResource getParts();
+    }
+    
+    public interface IPartsResource {
+    @Path("/{i}/")
+    public IProductResource elementAt(@PathParam("i") String i);
+        String get();
+    }
+    
 }
\ No newline at end of file
