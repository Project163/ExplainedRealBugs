diff --git a/tools/common/src/main/java/org/apache/cxf/tools/util/URIParserUtil.java b/tools/common/src/main/java/org/apache/cxf/tools/util/URIParserUtil.java
index 8de3043ce4..7c023a237f 100644
--- a/tools/common/src/main/java/org/apache/cxf/tools/util/URIParserUtil.java
+++ b/tools/common/src/main/java/org/apache/cxf/tools/util/URIParserUtil.java
@@ -248,18 +248,15 @@ public final class URIParserUtil {
     }
     public static String normalize(final String uri) {
         URL url = null;
+        String result = null;
         try {
             url = new URL(uri);
-            return escapeChars(url.toString().replace("\\", "/"));
+            result = escapeChars(url.toURI().normalize().toString().replace("\\", "/"));
         } catch (MalformedURLException e1) {
             try {
-                if (uri.startsWith("classpath:")) {
-                    
+                if (uri.startsWith("classpath:")) {                  
                     url = ClassLoaderUtils.getResource(uri.substring(10), URIParserUtil.class);
-                    if (url != null) {
-                        return url.toExternalForm();
-                    }
-                    return uri;
+                    return url != null ? url.toExternalForm() : uri;
                 }
                 File file = new File(uri);
                 if (file.exists()) {
@@ -276,7 +273,12 @@ public final class URIParserUtil {
             } catch (Exception e2) {
                 return escapeChars(uri.replace("\\", "/"));
             }
+        } catch (URISyntaxException e) {
+            if (url != null) {
+                result = escapeChars(url.toString().replace("\\", "/"));
+            }
         }
+        return result;
     }
 
     public static String getAbsoluteURI(final String arg) {
diff --git a/tools/common/src/test/java/org/apache/cxf/tools/util/URIParserUtilTest.java b/tools/common/src/test/java/org/apache/cxf/tools/util/URIParserUtilTest.java
index 882224e1fd..e85e4ba981 100644
--- a/tools/common/src/test/java/org/apache/cxf/tools/util/URIParserUtilTest.java
+++ b/tools/common/src/test/java/org/apache/cxf/tools/util/URIParserUtilTest.java
@@ -56,6 +56,9 @@ public class URIParserUtilTest extends Assert {
 
         uri = "/c:\\hello.wsdl";
         assertEquals("file:/c:/hello.wsdl", URIParserUtil.normalize(uri));
+        
+        uri = "file:/home/john/test/all/../../alltest";
+        assertEquals("file:/home/john/alltest", URIParserUtil.normalize(uri));
     }
 
     @Test
