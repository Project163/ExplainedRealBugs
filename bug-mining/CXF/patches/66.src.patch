diff --git a/common/common/src/main/java/org/apache/cxf/resource/ExtendedURIResolver.java b/common/common/src/main/java/org/apache/cxf/resource/ExtendedURIResolver.java
index edbf59c8c1..2c7d5a03ee 100644
--- a/common/common/src/main/java/org/apache/cxf/resource/ExtendedURIResolver.java
+++ b/common/common/src/main/java/org/apache/cxf/resource/ExtendedURIResolver.java
@@ -38,7 +38,6 @@ public class ExtendedURIResolver {
 
     public InputSource resolve(String curUri, String baseUri) {
         try {
-            lastestImportUri = curUri;
             currentResolver.resolve(baseUri, curUri, getClass());
             if (currentResolver.isResolved()) {
                 if (currentResolver.getURI() != null && currentResolver.getURI().isAbsolute()) {
@@ -60,6 +59,10 @@ public class ExtendedURIResolver {
             }
         } catch (IOException e) {
             // move on...
+        } finally {
+            lastestImportUri = curUri;
+            // the uri may have been updated since we were called
+            // so only store it away when everything else is done
         }
         return null;
         // return new InputSource(schemaLocation);
diff --git a/common/common/src/main/java/org/apache/cxf/resource/URIResolver.java b/common/common/src/main/java/org/apache/cxf/resource/URIResolver.java
index ad07b5fb53..6abe177e25 100644
--- a/common/common/src/main/java/org/apache/cxf/resource/URIResolver.java
+++ b/common/common/src/main/java/org/apache/cxf/resource/URIResolver.java
@@ -64,10 +64,10 @@ public class URIResolver {
         this.calling = (calling != null) ? calling : getClass();
         if (uriStr.startsWith("classpath:")) {
             tryClasspath(uriStr);
-        } else if (baseUriStr != null && baseUriStr.startsWith("jar:")) {
-            tryJar(baseUriStr, uriStr);
-        } else if (uriStr.startsWith("jar:")) {
-            tryJar(uriStr);
+        } else if (baseUriStr != null && (baseUriStr.startsWith("jar:") || baseUriStr.startsWith("zip:"))) {
+            tryArchive(baseUriStr, uriStr);
+        } else if (uriStr.startsWith("jar:") || uriStr.startsWith("zip:")) {
+            tryArchive(uriStr);
         } else {
             tryFileSystem(baseUriStr, uriStr);
         }
@@ -83,10 +83,10 @@ public class URIResolver {
 
         if (uriStr.startsWith("classpath:")) {
             tryClasspath(uriStr);
-        } else if (baseUriStr != null && baseUriStr.startsWith("jar:")) {
-            tryJar(baseUriStr, uriStr);
-        } else if (uriStr.startsWith("jar:")) {
-            tryJar(uriStr);
+        } else if (baseUriStr != null && (baseUriStr.startsWith("jar:") || baseUriStr.startsWith("zip:"))) {
+            tryArchive(baseUriStr, uriStr);
+        } else if (uriStr.startsWith("jar:") || uriStr.startsWith("zip:")) {
+            tryArchive(uriStr);
         } else {
             tryFileSystem(baseUriStr, uriStr);
         }
@@ -193,18 +193,18 @@ public class URIResolver {
         }
     }
     
-    private void tryJar(String baseStr, String uriStr) throws IOException {
+    private void tryArchive(String baseStr, String uriStr) throws IOException {
         int i = baseStr.indexOf('!');
         if (i == -1) {
             tryFileSystem(baseStr, uriStr);
         }
 
-        String jarBase = baseStr.substring(0, i + 1);
-        String jarEntry = baseStr.substring(i + 1);
+        String archiveBase = baseStr.substring(0, i + 1);
+        String archiveEntry = baseStr.substring(i + 1);
         try {
-            URI u = new URI(jarEntry).resolve(uriStr);
+            URI u = new URI(archiveEntry).resolve(uriStr);
 
-            tryJar(jarBase + u.toString());
+            tryArchive(archiveBase + u.toString());
 
             if (is != null) {
                 if (u.isAbsolute()) {
@@ -219,7 +219,7 @@ public class URIResolver {
         tryFileSystem("", uriStr);
     }
     
-    private void tryJar(String uriStr) throws IOException {
+    private void tryArchive(String uriStr) throws IOException {
         int i = uriStr.indexOf('!');
         if (i == -1) {
             return;
@@ -252,7 +252,7 @@ public class URIResolver {
             } catch (URISyntaxException e) {
                 // processing the jar:file:/ type value
                 String urlStr = url.toString();
-                if (urlStr.startsWith("jar:")) {
+                if (urlStr.startsWith("jar:") || urlStr.startsWith("zip:")) {
                     int pos = urlStr.indexOf('!');
                     if (pos != -1) {
                         try {
diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java
new file mode 100644
index 0000000000..73595daa5a
--- /dev/null
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java
@@ -0,0 +1,93 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+package org.apache.cxf.maven_plugin;
+
+import java.io.File;
+import java.util.ArrayList;
+import java.util.List;
+
+public class Option {
+
+    protected List<String> packagenames;
+    protected List<String> extraargs = new ArrayList<String>();
+    protected File outputDir;
+    File dependencies[];
+    File redundantDirs[];
+    String bindingFiles[] = new String[0];
+
+    public Option() {
+        super();
+    }
+
+    public List<String> getExtraargs() {
+        return extraargs;
+    }
+
+    public void setExtraargs(List<String> ea) {
+        this.extraargs = ea;
+    }
+
+    public List<String> getPackagenames() {
+        return packagenames;
+    }
+
+    public void setPackagenames(List<String> pn) {
+        this.packagenames = pn;
+    }
+
+    public void setDependencies(File files[]) {
+        dependencies = files;
+    }
+
+    public File[] getDependencies() {
+        return dependencies;
+    }
+
+    public void setDeleteDirs(File files[]) {
+        redundantDirs = files;
+    }
+
+    public File[] getDeleteDirs() {
+        return redundantDirs;
+    }
+
+    public File getOutputDir() {
+        return outputDir;
+    }
+
+    public void setOutputDir(File f) {
+        outputDir = f;
+    }
+    
+    public void setBindingFiles(String files[]) {
+        bindingFiles = files;
+    }
+    public String[] getBindingFiles() {
+        return bindingFiles;
+    }
+    public void addBindingFile(File file) {
+        String tmp[] = new String[bindingFiles.length + 1];
+        System.arraycopy(bindingFiles, 0, tmp, 0, bindingFiles.length);
+        bindingFiles = tmp;
+        bindingFiles[bindingFiles.length - 1] = file.toURI().toString();
+    }
+    
+
+}
diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java
index 469f114cde..9561bd49d6 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java
@@ -70,6 +70,11 @@ public class WSDL2JavaMojo extends AbstractMojo {
      */
     MavenProject project;
 
+    /**
+     * Default options to be used when a wsdl has not had it's options explicitly specified.
+     * @parameter
+     */
+    Option defaultOptions;
 
     /**
      * @parameter
@@ -116,7 +121,7 @@ public class WSDL2JavaMojo extends AbstractMojo {
                                                    final File output)
         throws MojoExecutionException {
         List<WsdlOption> options = new ArrayList<WsdlOption>();
-        for (WsdlOption o : new WsdlOptionLoader().load(root, includes, excludes)) {
+        for (WsdlOption o : new WsdlOptionLoader().load(root, includes, excludes, defaultOptions)) {
             if (o.getOutputDir() == null) {
                 o.setOutputDir(output);
             }
@@ -326,17 +331,40 @@ public class WSDL2JavaMojo extends AbstractMojo {
                     list.add(it.next().toString());
                 }
             }
-            // -d specify the dir for generated source code
-            //list.add("-verbose");
+            if (getLog().isDebugEnabled()) {
+                list.add("-verbose");            
+            }
+            // -d specify the dir for generated source code            
             list.add("-d");
             list.add(outputDirFile.toString());
 
+            for (String binding : wsdlOption.getBindingFiles()) {
+                File bindingFile = new File(binding);
+                URI bindingURI;
+                if (bindingFile.exists()) {
+                    bindingURI = bindingFile.toURI();
+                } else {
+                    bindingURI = basedir.resolve(binding);
+                }
+                list.add("-b");
+                list.add(bindingURI.toString());
+            }
+            
             if (wsdlOption.getExtraargs() != null) {
                 Iterator it = wsdlOption.getExtraargs().iterator();
                 while (it.hasNext()) {
-                    list.add(it.next().toString());
+                    Object value = it.next();
+                    if (value == null) {
+                        value = ""; // Maven make empty tags into null
+                                    // instead of empty strings.
+                    }
+                    list.add(value.toString());
                 }
             }
+            if (wsdlOption.isSetWsdlLocation()) {
+                list.add("-wsdlLocation");
+                list.add(wsdlOption.getWsdlLocation() == null ? "" : wsdlOption.getWsdlLocation());
+            }
             list.add(wsdlURI.toString());
 
             getLog().debug("Calling wsdl2java with args: " + list);
diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOption.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOption.java
index eaee07b88c..32834c0df8 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOption.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOption.java
@@ -19,34 +19,12 @@
 
 package org.apache.cxf.maven_plugin;
 
-import java.io.File;
-import java.util.ArrayList;
-import java.util.List;
 
-public class WsdlOption {
+public class WsdlOption extends Option {
     String wsdl;
-    List<String> packagenames;
-    List<String> extraargs = new ArrayList<String>();
-    File outputDir;
-    File dependencies[];
-    File redundantDirs[];
-
-    public List<String> getExtraargs() {
-        return extraargs;
-    }
-
-    public void setExtraargs(List<String> ea) {
-        this.extraargs = ea;
-    }
-
-    public List<String> getPackagenames() {
-        return packagenames;
-    }
-
-    public void setPackagenames(List<String> pn) {
-        this.packagenames = pn;
-    }
-
+    String wsdlLocation;
+    boolean wsdlLocationSet;
+    
     public String getWsdl() {
         return wsdl;
     }
@@ -54,24 +32,17 @@ public class WsdlOption {
     public void setWsdl(String w) {
         wsdl = w;
     }
-    public void setDependencies(File files[]) {
-        dependencies = files;
-    }
-    public File[] getDependencies() {
-        return dependencies;
-    }    
-    public void setDeleteDirs(File files[]) {
-        redundantDirs = files;
+    
+    public void setWsdlLocation(String s) {
+        wsdlLocationSet = true;
+        wsdlLocation = s;
     }
-    public File[] getDeleteDirs() {
-        return redundantDirs;
+    public String getWsdlLocation() {
+        return wsdlLocation;
     }
     
-    public File getOutputDir() {
-        return outputDir;
-    }
-    public void setOutputDir(File f) {
-        outputDir = f;
+    public boolean isSetWsdlLocation() {
+        return wsdlLocationSet;
     }
     
     public int hashCode() {
diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOptionLoader.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOptionLoader.java
index 5e3024ac21..2a993a3eb3 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOptionLoader.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WsdlOptionLoader.java
@@ -57,10 +57,13 @@ public final class WsdlOptionLoader {
     }
     
     public List<WsdlOption> load(String wsdlRoot) throws MojoExecutionException {
-        return load(new File(wsdlRoot), new String[] {"*.wsdl"}, null);
+        return load(new File(wsdlRoot), new String[] {"*.wsdl"}, null, null);
     }
 
-    public List<WsdlOption> load(File wsdlBasedir, String includes[], String excludes[])
+    public List<WsdlOption> load(File wsdlBasedir,
+                                 String includes[],
+                                 String excludes[],
+                                 Option defaultOptions)
         throws MojoExecutionException {
         
         if (wsdlBasedir == null) {
@@ -68,10 +71,10 @@ public final class WsdlOptionLoader {
         }
 
         if (!wsdlBasedir.exists()) {
-            throw new MojoExecutionException(wsdlBasedir + " not exists");
+            throw new MojoExecutionException(wsdlBasedir + " does not exist");
         }
 
-        return findJobs(wsdlBasedir, getWsdlFiles(wsdlBasedir, includes, excludes));
+        return findJobs(wsdlBasedir, getWsdlFiles(wsdlBasedir, includes, excludes), defaultOptions);
     }
 
     private List<File> getWsdlFiles(File dir, String includes[], String excludes[])
@@ -106,7 +109,7 @@ public final class WsdlOptionLoader {
         return FileUtils.getFiles(dir, pattern);
     }
 
-    protected List<WsdlOption> findJobs(File dir, List<File> wsdlFiles) {
+    protected List<WsdlOption> findJobs(File dir, List<File> wsdlFiles, Option defaultOptions) {
         List<WsdlOption> jobs = new ArrayList<WsdlOption>();
 
         for (File wsdl : wsdlFiles) {
@@ -119,23 +122,17 @@ public final class WsdlOptionLoader {
             File options = getOptions(dir, wsdlName + WSDL_OPTIONS);
             List<File> bindings = getBindingFiles(dir, wsdlName + WSDL_BINDINGS);
 
-            jobs.add(generateWsdlOption(wsdl, bindings, options));
+            jobs.add(generateWsdlOption(wsdl, bindings, options, defaultOptions));
         }
         return jobs;
     }
 
     protected WsdlOption generateWsdlOption(final File wsdl, 
                                             final List<File> bindingFiles, 
-                                            final File options) {
+                                            final File options,
+                                            final Option defaultOptions) {
         WsdlOption wsdlOption = new WsdlOption();
 
-        if (bindingFiles != null) {
-            for (File binding : bindingFiles) {
-                wsdlOption.getExtraargs().add("-b");
-                wsdlOption.getExtraargs().add(binding.toString());
-            }
-        }
-
         if (options != null && options.exists()) {
             try {
                 List<String> lines = FileUtils.readLines(options);
@@ -145,8 +142,22 @@ public final class WsdlOptionLoader {
             } catch (Exception e) {
                 e.printStackTrace();
             }
+        } else if (defaultOptions != null) {
+            // no options specified use the defaults
+            wsdlOption.setPackagenames(defaultOptions.getPackagenames());
+            wsdlOption.setExtraargs(defaultOptions.getExtraargs());
+            wsdlOption.setOutputDir(defaultOptions.getOutputDir());
+            wsdlOption.setDeleteDirs(defaultOptions.getDeleteDirs());
+            wsdlOption.setDependencies(defaultOptions.getDependencies());
+            wsdlOption.setBindingFiles(defaultOptions.getBindingFiles());
+        }
+        
+        if (bindingFiles != null) {
+            for (File binding : bindingFiles) {
+                wsdlOption.addBindingFile(binding);
+            }
         }
-        wsdlOption.setWsdl(wsdl.toString());
+        wsdlOption.setWsdl(wsdl.toURI().toString());
         
         return wsdlOption;
     }
diff --git a/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/CustomizationParser.java b/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/CustomizationParser.java
index 4523a69c6b..bf5771dd91 100644
--- a/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/CustomizationParser.java
+++ b/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/CustomizationParser.java
@@ -452,7 +452,7 @@ public final class CustomizationParser {
             }
 
         } else {
-            Message msg = new Message("UNKNOWN_BINDING_FILE", LOG, bindingFile);
+            Message msg = new Message("UNKNOWN_BINDING_FILE", LOG, bindingFile, reader.getName());
             throw new ToolException(msg);
         }
     }
diff --git a/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/Messages.properties b/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/Messages.properties
index dba2fee667..b27967922b 100644
--- a/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/Messages.properties
+++ b/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/customization/Messages.properties
@@ -19,7 +19,7 @@
 #
 #
 STAX_PARSER_ERROR = StAX parser error, check your external binding file(s)
-UNKNOWN_BINDING_FILE= Unknown external binding files: {0}
+UNKNOWN_BINDING_FILE= Unknown external binding file: {0}  Found unknown QName {1}
 CAN_NOT_FIND_BINDING_WSDL = Can not read the specified wsdl {0} that external binding file {1} points to
 BINDING_LOC_ERROR = Attribute wsdlLocation/schemaLocation value {0} in jaxws binding element is not an URI
 ERROR_TARGETNODE_WITH_XPATH = XPath query {0} is identifying either multiple or no target nodes.
