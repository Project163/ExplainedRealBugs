diff --git a/common/schemas/src/main/resources/schemas/wsdl/ws-addr-wsdl.xjb b/common/schemas/src/main/resources/schemas/wsdl/ws-addr-wsdl.xjb
index 3d1f9b68d1..1ba982c0f6 100644
--- a/common/schemas/src/main/resources/schemas/wsdl/ws-addr-wsdl.xjb
+++ b/common/schemas/src/main/resources/schemas/wsdl/ws-addr-wsdl.xjb
@@ -28,6 +28,6 @@
         </jaxb:schemaBindings>
     </jaxb:bindings>
     <jaxb:bindings schemaLocation="ws-addr-wsdl.xsd" node="/xs:schema/xs:element[@name='UsingAddressing']">
-      <jaxb:class ref="org.apache.cxf.ws.addressing.wsdl.UsingAddressingImpl"/>
+      <jaxb:class ref="org.apache.cxf.ws.addressing.wsdl.UsingAddressing"/>
     </jaxb:bindings>
 </jaxb:bindings>
diff --git a/rt/core/src/main/java/org/apache/cxf/transport/http/QueryMessages.properties b/rt/core/src/main/java/org/apache/cxf/transport/http/QueryMessages.properties
index 27581863d4..8969ba3d68 100644
--- a/rt/core/src/main/java/org/apache/cxf/transport/http/QueryMessages.properties
+++ b/rt/core/src/main/java/org/apache/cxf/transport/http/QueryMessages.properties
@@ -19,3 +19,5 @@
 #
 #
 COULD_NOT_PROVIDE_WSDL = Exception occurred while trying to process {0}
+WSDL_NOT_FOUND = Could not find wsdl {0}
+SCHEMA_NOT_FOUND = Could not find xsd {0}
diff --git a/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java b/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java
index c87fd296d3..f9b558515d 100644
--- a/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java
+++ b/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java
@@ -145,7 +145,12 @@ public class WSDLQueryHandler implements StemMatchingQueryHandler {
                     String wsdl2 = resolveWithCatalogs(OASISCatalogManager.getCatalogManager(bus),
                                                        wsdl,
                                                        base);
-                    def = mp.get(wsdl2);
+                    if (wsdl2 != null) {
+                        def = mp.get(wsdl2);
+                    }
+                }
+                if (def == null) {
+                    throw new WSDLQueryException(new Message("WSDL_NOT_FOUND", LOG, wsdl), null);
                 }
                 
                 synchronized (def) {
@@ -168,7 +173,12 @@ public class WSDLQueryHandler implements StemMatchingQueryHandler {
                     String xsd2 = resolveWithCatalogs(OASISCatalogManager.getCatalogManager(bus),
                                                        xsd,
                                                        base);
-                    si = smp.get(xsd2);
+                    if (xsd2 != null) { 
+                        si = smp.get(xsd2);
+                    }
+                }
+                if (si == null) {
+                    throw new WSDLQueryException(new Message("SCHEMA_NOT_FOUND", LOG, wsdl), null);
                 }
                 
                 String uri = si.getReferencedSchema().getDocumentBaseURI();
@@ -185,37 +195,7 @@ public class WSDLQueryHandler implements StemMatchingQueryHandler {
                 doc = XMLUtils.getParser().parse(src);
             }
             
-            NodeList nl = doc.getDocumentElement()
-                .getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema",
-                                        "import");
-            for (int x = 0; x < nl.getLength(); x++) {
-                Element el = (Element)nl.item(x);
-                String sl = el.getAttribute("schemaLocation");
-                if (smp.containsKey(sl)) {
-                    el.setAttribute("schemaLocation", base + "?xsd=" + sl);
-                }
-            }
-            nl = doc.getDocumentElement()
-                .getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema",
-                                        "include");
-            for (int x = 0; x < nl.getLength(); x++) {
-                Element el = (Element)nl.item(x);
-                String sl = el.getAttribute("schemaLocation");
-                if (smp.containsKey(sl)) {
-                    el.setAttribute("schemaLocation", base + "?xsd=" + sl);
-                }
-            }
-            nl = doc.getDocumentElement()
-                .getElementsByTagNameNS("http://schemas.xmlsoap.org/wsdl/",
-                                    "import");
-            for (int x = 0; x < nl.getLength(); x++) {
-                Element el = (Element)nl.item(x);
-                String sl = el.getAttribute("location");
-                if (mp.containsKey(sl)) {
-                    el.setAttribute("location", base + "?wsdl=" + sl);
-                }
-            }
-            doc.setXmlStandalone(true);
+            updateDoc(doc, base, mp, smp);
             String enc = doc.getXmlEncoding();
             if (enc == null) {
                 enc = "utf-8";
@@ -225,12 +205,50 @@ public class WSDLQueryHandler implements StemMatchingQueryHandler {
                                                                      enc);
             StaxUtils.writeNode(doc, writer, true);
             writer.flush();
+        } catch (WSDLQueryException wex) {
+            throw wex;
         } catch (Exception wex) {
             throw new WSDLQueryException(new Message("COULD_NOT_PROVIDE_WSDL",
                                                      LOG,
                                                      baseUri), wex);
         }
     }
+    
+    private void updateDoc(Document doc, String base,
+                           Map<String, Definition> mp,
+                           Map<String, SchemaReference> smp) {
+        NodeList nl = doc.getDocumentElement()
+            .getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema",
+                                    "import");
+        for (int x = 0; x < nl.getLength(); x++) {
+            Element el = (Element)nl.item(x);
+            String sl = el.getAttribute("schemaLocation");
+            if (smp.containsKey(sl)) {
+                el.setAttribute("schemaLocation", base + "?xsd=" + sl);
+            }
+        }
+        nl = doc.getDocumentElement()
+            .getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema",
+                                    "include");
+        for (int x = 0; x < nl.getLength(); x++) {
+            Element el = (Element)nl.item(x);
+            String sl = el.getAttribute("schemaLocation");
+            if (smp.containsKey(sl)) {
+                el.setAttribute("schemaLocation", base + "?xsd=" + sl);
+            }
+        }
+        nl = doc.getDocumentElement()
+            .getElementsByTagNameNS("http://schemas.xmlsoap.org/wsdl/",
+                                "import");
+        for (int x = 0; x < nl.getLength(); x++) {
+            Element el = (Element)nl.item(x);
+            String sl = el.getAttribute("location");
+            if (mp.containsKey(sl)) {
+                el.setAttribute("location", base + "?wsdl=" + sl);
+            }
+        }
+        doc.setXmlStandalone(true);
+    }
 
     static String resolveWithCatalogs(OASISCatalogManager catalogs, String start, String base) {
         String resolvedSchemaLocation = null;
diff --git a/rt/transports/http-jetty/src/main/java/org/apache/cxf/transport/http_jetty/JettyHTTPDestination.java b/rt/transports/http-jetty/src/main/java/org/apache/cxf/transport/http_jetty/JettyHTTPDestination.java
index 6934214247..d6105e821f 100644
--- a/rt/transports/http-jetty/src/main/java/org/apache/cxf/transport/http_jetty/JettyHTTPDestination.java
+++ b/rt/transports/http-jetty/src/main/java/org/apache/cxf/transport/http_jetty/JettyHTTPDestination.java
@@ -230,6 +230,11 @@ public class JettyHTTPDestination extends AbstractHTTPDestination {
                             qh.writeResponse(requestURL, pathInfo, endpointInfo, resp.getOutputStream());
                         } catch (Exception ex) {
                             LOG.log(Level.WARNING, "writeResponse failed: ", ex);
+                            try {
+                                resp.sendError(500, ex.getMessage());
+                            } catch (IOException ioe) {
+                                //ignore
+                            }
                         }
                         endpointInfo.setAddress(oldAddress);
                         resp.getOutputStream().flush();                     
diff --git a/systests/src/test/java/org/apache/cxf/systest/http/PublishedEndpointUrlTest.java b/systests/src/test/java/org/apache/cxf/systest/http/PublishedEndpointUrlTest.java
index 820511cff1..af67f72125 100644
--- a/systests/src/test/java/org/apache/cxf/systest/http/PublishedEndpointUrlTest.java
+++ b/systests/src/test/java/org/apache/cxf/systest/http/PublishedEndpointUrlTest.java
@@ -18,6 +18,8 @@
  */
 package org.apache.cxf.systest.http;
 
+import java.net.HttpURLConnection;
+import java.net.URL;
 import java.util.Collection;
 import java.util.List;
 
@@ -55,6 +57,11 @@ public class PublishedEndpointUrlTest extends Assert {
 
         WSDLReader wsdlReader = WSDLFactory.newInstance().newWSDLReader();
         wsdlReader.setFeature("javax.wsdl.verbose", false);
+        
+        URL url = new URL(svrFactory.getAddress() + "?wsdl=1");
+        HttpURLConnection connect = (HttpURLConnection)url.openConnection();
+        assertEquals(500, connect.getResponseCode());
+        
         Definition wsdl = wsdlReader.readWSDL(svrFactory.getAddress() + "?wsdl");
         assertNotNull(wsdl);
         
