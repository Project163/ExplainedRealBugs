diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/CodeGeneratorProvider.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/CodeGeneratorProvider.java
index 6163ad86be..5a439d0c23 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/CodeGeneratorProvider.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/CodeGeneratorProvider.java
@@ -40,6 +40,7 @@ import javax.ws.rs.core.Response;
 import javax.ws.rs.core.UriBuilder;
 import javax.ws.rs.core.UriInfo;
 
+import org.apache.cxf.Bus;
 import org.apache.cxf.common.logging.LogUtils;
 import org.apache.cxf.helpers.FileUtils;
 import org.apache.cxf.helpers.IOUtils;
@@ -67,14 +68,20 @@ public class CodeGeneratorProvider implements RequestHandler {
     
     private Comparator<String> importsComparator;
     private UriInfo ui;
+    private String resourcePackageName;
+    private String resourceName;
     private boolean generateInterfaces = true;
-    
+    private Bus bus;
     
     @Context
     public void setUriInfo(UriInfo uriInfo) {
         this.ui = uriInfo;
     }
     
+    public void setBus(Bus bus) {
+        this.bus = bus;
+    }
+    
     public Response handleRequest(Message m, ClassResourceInfo resourceClass) {
         
         if (!"GET".equals(m.get(Message.HTTP_REQUEST_METHOD))) {
@@ -126,6 +133,9 @@ public class CodeGeneratorProvider implements RequestHandler {
                 SourceGenerator sg = new SourceGenerator(properties);
                 sg.setGenerateInterfaces(generateInterfaces);
                 sg.setImportsComparator(importsComparator);
+                sg.setResourceName(resourceName);
+                sg.setPackageName(resourcePackageName);
+                sg.setBus(bus);
                 sg.generateSource(wadl, srcDir, codeType);
                 
                 zipSource(srcDir, zipDir);
@@ -260,4 +270,11 @@ public class CodeGeneratorProvider implements RequestHandler {
         this.generateInterfaces = generateInterfaces;
     }
     
+    public void setPackageName(String name) {
+        this.resourcePackageName = name;
+    }
+    
+    public void setResourceName(String name) {
+        this.resourceName = name;
+    }
 }
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/SourceGenerator.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/SourceGenerator.java
index d92dcffdf5..3d2d16a732 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/SourceGenerator.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/codegen/SourceGenerator.java
@@ -253,14 +253,11 @@ public class SourceGenerator {
         if (resourceId.length() == 0) {
             resourceId = DEFAULT_RESOURCE_NAME;
         }
-        //TODO: if it's expanded QName then use PackageUtils.getPackageNameByNameSpaceURI
-        // otherwise assume the last segment after the last dot is the name of the class
-        // and the package name is before the last dot
-        QName qname = JAXRSUtils.convertStringToQName(resourceId);
-        String namespaceURI = qname.getNamespaceURI();
-        
-        if (getSchemaClassName(PackageUtils.getPackageNameByNameSpaceURI(namespaceURI), 
-                               gInfo, qname.getLocalPart(), typeClassNames) != null) {
+        boolean expandedQName = resourceId.startsWith("{") ? true : false;
+        QName qname = convertToQName(resourceId, expandedQName);
+        String namespaceURI = possiblyConvertNamespaceURI(qname.getNamespaceURI(), expandedQName);
+        
+        if (getSchemaClassName(namespaceURI, gInfo, qname.getLocalPart(), typeClassNames) != null) {
             return; 
         }
         
@@ -303,12 +300,26 @@ public class SourceGenerator {
         
         for (Element subEl : childEls) {
             String id = subEl.getAttribute("id");
-            if (id.length() > 0 && !resourceId.equals(id) && !id.startsWith("{java")) {
+            if (id.length() > 0 && !resourceId.equals(id) && !id.startsWith("{java")
+                && !id.startsWith("java")) {
                 writeResourceClass(subEl, typeClassNames, gInfo, src, false, interfaceIsGenerated);
             }
         }
     }
     
+    private QName convertToQName(String resourceId, boolean expandedQName) {
+        QName qname = null;
+        if (expandedQName) {
+            qname = JAXRSUtils.convertStringToQName(resourceId);
+        } else {
+            int lastIndex = resourceId.lastIndexOf(".");
+            qname = lastIndex == -1 ? new QName(resourceId) 
+                                    : new QName(resourceId.substring(0, lastIndex),
+                                                resourceId.substring(lastIndex + 1));
+        }
+        return qname;
+    }
+    
     private String getClassType(boolean interfaceIsGenerated) {
         return interfaceIsGenerated ? "interface" : "class";
     }
@@ -444,13 +455,15 @@ public class SourceGenerator {
             responseTypeAvailable = writeResponseType(responseEls, sbCode, imports, typeClassNames, gInfo);
             sbCode.append(id);
         } else {
-            QName qname = JAXRSUtils.convertStringToQName(id);
-            String packageName = PackageUtils.getPackageNameByNameSpaceURI(qname.getNamespaceURI());
+            boolean expandedQName = id.startsWith("{");
+            QName qname = convertToQName(id, expandedQName);
+            String packageName = possiblyConvertNamespaceURI(qname.getNamespaceURI(), expandedQName);
+            
             String clsSimpleName = getSchemaClassName(packageName, gInfo, qname.getLocalPart(), 
                                                       typeClassNames);
             String localName = clsSimpleName == null ? qname.getLocalPart() 
                 : clsSimpleName.substring(packageName.length() + 1);
-            String subResponseNs = clsSimpleName == null ? getClassPackageName(qname.getNamespaceURI()) 
+            String subResponseNs = clsSimpleName == null ? getClassPackageName(packageName) 
                 : clsSimpleName.substring(0, packageName.length());
             String parentId = ((Element)resourceEl.getParentNode()).getAttribute("id");
             writeSubResponseType(id.equals(parentId), subResponseNs, localName, sbCode, imports);
@@ -476,6 +489,10 @@ public class SourceGenerator {
         sbCode.append(getLineSep()).append(getLineSep());
     }
 
+    private String possiblyConvertNamespaceURI(String nsURI, boolean expandedQName) {
+        return expandedQName ? PackageUtils.getPackageNameByNameSpaceURI(nsURI) : nsURI;
+    }
+    
     private void generateEmptyMethodBody(StringBuilder sbCode, boolean responseTypeAvailable) {
         sbCode.append(" {");
         sbCode.append(getLineSep()).append(TAB).append(TAB);
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/wadl/WadlGenerator.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/wadl/WadlGenerator.java
index c131729555..085a9ff885 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/wadl/WadlGenerator.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/wadl/WadlGenerator.java
@@ -272,7 +272,8 @@ public class WadlGenerator implements RequestHandler {
                 : jaxbQname.getNamespaceURI();
             String localName = jaxbQname == null ? serviceClass.getSimpleName()
                 : jaxbQname.getLocalPart();
-            sb.append(" id=\"").append("{" + pName + "}" + localName).append("\"");
+            String finalName = jaxbQname == null ? pName + "." : "{" + pName + "}";
+            sb.append(" id=\"").append(finalName + localName).append("\"");
         }
         sb.append(">");
     }
diff --git a/tools/wadlto/jaxrs/src/test/resources/wadl/bookstore.xml b/tools/wadlto/jaxrs/src/test/resources/wadl/bookstore.xml
index fd8a2be162..981a84415f 100644
--- a/tools/wadlto/jaxrs/src/test/resources/wadl/bookstore.xml
+++ b/tools/wadlto/jaxrs/src/test/resources/wadl/bookstore.xml
@@ -46,7 +46,7 @@
   </xs:schema>
  </grammars>
  <resources base="http://localhost:8080/baz">
-   <resource path="/bookstore/{id}" id="{org.apache.cxf.jaxrs.model.wadl}BookStore">
+   <resource path="/bookstore/{id}" id="org.apache.cxf.jaxrs.model.wadl.BookStore">
      <doc xml:lang="en-us" title="book store resource">super resource</doc>
      <param name="id" style="template" type="xs:long"/>
 
@@ -145,7 +145,7 @@
    </resource>
 
    <!-- Dynamic subresource -->
-   <resource path="/books/{bookid}" id="{java.lang}Object">
+   <resource path="/books/{bookid}" id="java.lang.Object">
     <param name="id" style="template" type="xs:int"/>
     <param name="bookid" style="template" type="xs:int"/>
     <param name="mid" style="matrix" type="xs:int"/>
@@ -207,7 +207,7 @@
    </resource>
  </resource>
  
- <resource path="/form" id="{org.apache.cxf.jaxrs.model.wadl}FormInterface">
+ <resource path="/form" id="org.apache.cxf.jaxrs.model.wadl.FormInterface">
   
   <resource path="/form1">
    <method name="POST" id="form1">
@@ -235,7 +235,7 @@
  </resource>
 
  <!-- Recursive subresource -->
- <resource path="/itself" id="{org.apache.cxf.jaxrs.model.wadl}BookStore">
+ <resource path="/itself" id="org.apache.cxf.jaxrs.model.wadl.BookStore">
  </resource>
  
  </resource>
diff --git a/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImport.xml b/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImport.xml
index a57153f596..24ee5b2323 100644
--- a/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImport.xml
+++ b/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImport.xml
@@ -23,7 +23,7 @@
     <include href="schemas/book.xsd"/>
  </grammars>
  <resources base="http://localhost:8080/baz">
-   <resource path="/bookstore" id="{org.apache.cxf.jaxrs.model.wadl}BookStore">
+   <resource path="/bookstore" id="{wadl.model.jaxrs.cxf.apache.org}BookStore">
     
     <resource path="/books/{bookid}">
      <param name="bookid" style="template" type="xs:int"/>
diff --git a/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImportCatalog.xml b/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImportCatalog.xml
index 9434f0e59c..2cb82d9ce9 100644
--- a/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImportCatalog.xml
+++ b/tools/wadlto/jaxrs/src/test/resources/wadl/bookstoreImportCatalog.xml
@@ -23,7 +23,7 @@
     <include href="http://schemas/books/book.xsd"/>
  </grammars>
  <resources base="http://localhost:8080/baz">
-   <resource path="/bookstore" id="{org.apache.cxf.jaxrs.model.wadl}BookStore">
+   <resource path="/bookstore" id="{http://wadl.model.jaxrs.cxf.apache.org}BookStore">
     
     <resource path="/books/{bookid}">
      <param name="bookid" style="template" type="xs:int"/>
