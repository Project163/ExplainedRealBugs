diff --git a/core/src/main/java/org/apache/cxf/attachment/LazyAttachmentCollection.java b/core/src/main/java/org/apache/cxf/attachment/LazyAttachmentCollection.java
index 0c698b352a..aaec8ed937 100644
--- a/core/src/main/java/org/apache/cxf/attachment/LazyAttachmentCollection.java
+++ b/core/src/main/java/org/apache/cxf/attachment/LazyAttachmentCollection.java
@@ -83,6 +83,7 @@ public class LazyAttachmentCollection
     public Iterator<Attachment> iterator() {
         return new Iterator<Attachment>() {
             int current;
+            boolean removed;
             
             public boolean hasNext() {
                 if (attachments.size() > current) {
@@ -106,11 +107,16 @@ public class LazyAttachmentCollection
             public Attachment next() {
                 Attachment a = attachments.get(current);
                 current++;
+                removed = false;
                 return a;
             }
 
             public void remove() {
-                attachments.remove(current);
+                if (removed) {
+                    throw new IllegalStateException();
+                }
+                attachments.remove(--current);
+                removed = true;
             }
             
         };
diff --git a/core/src/test/java/org/apache/cxf/attachment/AttachmentDeserializerTest.java b/core/src/test/java/org/apache/cxf/attachment/AttachmentDeserializerTest.java
index 54e1df9908..3abcb7e68d 100644
--- a/core/src/test/java/org/apache/cxf/attachment/AttachmentDeserializerTest.java
+++ b/core/src/test/java/org/apache/cxf/attachment/AttachmentDeserializerTest.java
@@ -23,9 +23,11 @@ import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 import java.io.InputStream;
 import java.io.PushbackInputStream;
+import java.util.ArrayList;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.Iterator;
+import java.util.List;
 import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
@@ -108,6 +110,17 @@ public class AttachmentDeserializerTest extends Assert {
         assertTrue(attBody instanceof DelegatingInputStream);
         attBody.close();
         assertEquals(2, msg.getAttachments().size());
+        List<String> cidlist = new ArrayList<String>();
+        cidlist.add("xfire_logo.jpg");
+        cidlist.add("xfire_logo2.jpg");
+        
+        for (Iterator<Attachment> it = msg.getAttachments().iterator(); it.hasNext();) {
+            Attachment a = it.next();
+            assertTrue(cidlist.remove(a.getId()));
+            it.remove();
+        }
+        assertEquals(0, cidlist.size());
+        assertEquals(0, msg.getAttachments().size());
     }
     
     @Test
