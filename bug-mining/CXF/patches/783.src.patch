diff --git a/api/src/main/java/org/apache/cxf/ws/policy/PolicyBuilder.java b/api/src/main/java/org/apache/cxf/ws/policy/PolicyBuilder.java
index 7c4cb87d6c..73a8b10b6d 100644
--- a/api/src/main/java/org/apache/cxf/ws/policy/PolicyBuilder.java
+++ b/api/src/main/java/org/apache/cxf/ws/policy/PolicyBuilder.java
@@ -30,6 +30,7 @@ import org.xml.sax.SAXException;
 
 import org.apache.neethi.Policy;
 import org.apache.neethi.PolicyReference;
+import org.apache.neethi.PolicyRegistry;
 
 
 /**
@@ -62,4 +63,12 @@ public interface PolicyBuilder {
      */
     Policy getPolicy(InputStream stream)
         throws IOException, ParserConfigurationException, SAXException;
+    
+    
+    /**
+     * Return the PolicyRegistry associated with the builder
+     * @return
+     */
+    PolicyRegistry getPolicyRegistry();
+    
 }
diff --git a/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertion.java b/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertion.java
index d8ede873a0..bb8daf7f92 100644
--- a/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertion.java
+++ b/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertion.java
@@ -55,15 +55,24 @@ public class NestedPrimitiveAssertion extends PrimitiveAssertion {
     private static final ResourceBundle BUNDLE = BundleUtils.getBundle(NestedPrimitiveAssertion.class);    
     private Policy nested;
     private boolean assertionRequired = true;
+    private PolicyBuilder builder;
+    
+    @Deprecated
     public NestedPrimitiveAssertion(QName name, boolean optional) {
-        this(name, optional, null, true);
+        this(name, optional, null, true, null);
+    }
+    
+    public NestedPrimitiveAssertion(QName name, boolean optional, PolicyBuilder b) {
+        this(name, optional, null, true, b);
     }
     
     public NestedPrimitiveAssertion(QName name, boolean optional, 
-                                    Policy p, boolean assertionRequired) {
+                                    Policy p, boolean assertionRequired,
+                                    PolicyBuilder b) {
         super(name, optional);
         this.assertionRequired = assertionRequired;
         this.nested = p;
+        builder = b;
     }
 
     public NestedPrimitiveAssertion(Element elem, PolicyBuilder builder) {
@@ -72,6 +81,7 @@ public class NestedPrimitiveAssertion extends PrimitiveAssertion {
     
     public NestedPrimitiveAssertion(Element elem, PolicyBuilder builder, boolean assertionRequired) {
         super(elem);
+        this.builder = builder;
         this.assertionRequired = assertionRequired;
         
         // expect exactly one child element of type Policy
@@ -98,7 +108,9 @@ public class NestedPrimitiveAssertion extends PrimitiveAssertion {
     }
     
     public PolicyComponent normalize() {
-        Policy normalisedNested = (Policy)nested.normalize(true);
+        Policy normalisedNested 
+            = (Policy)nested.normalize(builder == null ? null : builder.getPolicyRegistry(),
+                                       true);
         
         Policy p = new Policy();
         ExactlyOne ea = new ExactlyOne();
@@ -112,7 +124,7 @@ public class NestedPrimitiveAssertion extends PrimitiveAssertion {
             All all = new All();
             List<PolicyAssertion> alternative = 
                 CastUtils.cast((List)alternatives.next(), PolicyAssertion.class);
-            NestedPrimitiveAssertion a = new NestedPrimitiveAssertion(getName(), false);
+            NestedPrimitiveAssertion a = new NestedPrimitiveAssertion(getName(), false, builder);
             a.nested = new Policy();
             ExactlyOne nea = new ExactlyOne();
             a.nested.addPolicyComponent(nea);
diff --git a/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionBuilder.java b/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionBuilder.java
index 4e8c7bb96f..0e3a69d9ad 100644
--- a/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionBuilder.java
+++ b/api/src/main/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionBuilder.java
@@ -72,7 +72,8 @@ public class NestedPrimitiveAssertionBuilder extends PrimitiveAssertionBuilder {
         }
         
         NestedPrimitiveAssertion compatible = 
-            new NestedPrimitiveAssertion(a.getName(), a.isOptional() && b.isOptional());
+            new NestedPrimitiveAssertion(a.getName(), a.isOptional() && b.isOptional(),
+                                         null, true, builder);
         compatible.setPolicy(nested);
         
         return compatible;
diff --git a/api/src/test/java/org/apache/cxf/ws/policy/AssertionInfoMapTest.java b/api/src/test/java/org/apache/cxf/ws/policy/AssertionInfoMapTest.java
index 85b2413659..a7164cc910 100644
--- a/api/src/test/java/org/apache/cxf/ws/policy/AssertionInfoMapTest.java
+++ b/api/src/test/java/org/apache/cxf/ws/policy/AssertionInfoMapTest.java
@@ -175,7 +175,8 @@ public class AssertionInfoMapTest extends Assert {
         PolicyAssertion b = new PrimitiveAssertion(
                                 new QName("http://x.y.z", "b"));
         PolicyAssertion c = new NestedPrimitiveAssertion(
-                               new QName("http://x.y.z", "c"), false, nested, true);
+                               new QName("http://x.y.z", "c"), false, nested, true,
+                               null);
         
         All alt1 = new All();
         alt1.addAssertion(a1);
diff --git a/api/src/test/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionTest.java b/api/src/test/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionTest.java
index 50a5914f47..4f4d7f9a77 100644
--- a/api/src/test/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionTest.java
+++ b/api/src/test/java/org/apache/cxf/ws/policy/builder/primitive/NestedPrimitiveAssertionTest.java
@@ -77,14 +77,16 @@ public class NestedPrimitiveAssertionTest extends Assert {
     @Test
     public void testNoNeedToAssertWithEmptyPolicy() {
         PolicyAssertion a = new NestedPrimitiveAssertion(
-                                new QName("abc"), false, null, false);
+                                new QName("abc"), false, null, false,
+                                null);
         AssertionInfoMap aim = new AssertionInfoMap(
                                 Collections.singletonList(a));
         assertTrue("No need to assert", a.isAsserted(aim));
         a = new NestedPrimitiveAssertion(new QName("abc"), 
                                          false, 
                                          null, 
-                                         false);
+                                         false,
+                                         null);
         assertTrue("No need to assert", a.isAsserted(aim));
     }
     
@@ -92,7 +94,8 @@ public class NestedPrimitiveAssertionTest extends Assert {
     @Test
     public void testNoNeedToAssertWithNonEmptyPolicy() {
         PolicyAssertion a = new NestedPrimitiveAssertion(
-                                new QName("abc"), false, null, false);
+                                new QName("abc"), false, null, false,
+                                null);
         AssertionInfoMap aim = new AssertionInfoMap(
                                 Collections.singletonList(a));
         assertTrue("No need to assert", a.isAsserted(aim));
@@ -101,7 +104,8 @@ public class NestedPrimitiveAssertionTest extends Assert {
         a = new NestedPrimitiveAssertion(new QName("abc"), 
                                          false, 
                                          p, 
-                                         false);
+                                         false,
+                                         null);
         assertFalse("Primitive Assertions need to be asserted", 
                     a.isAsserted(aim));
         
@@ -109,11 +113,13 @@ public class NestedPrimitiveAssertionTest extends Assert {
         p.addAssertion(new NestedPrimitiveAssertion(new QName("abc"), 
                                          false, 
                                          null, 
-                                         false));
+                                         false,
+                                         null));
         a = new NestedPrimitiveAssertion(new QName("abc"), 
                                          false, 
                                          p, 
-                                         false);
+                                         false,
+                                         null);
         assertTrue("No need to assert", a.isAsserted(aim));
     }
     
@@ -132,7 +138,8 @@ public class NestedPrimitiveAssertionTest extends Assert {
         NestedPrimitiveAssertion na = new NestedPrimitiveAssertion(new QName("nested"), 
                                          false, 
                                          nested,
-                                         true);
+                                         true,
+                                         null);
         List<PolicyAssertion> ais = 
             new ArrayList<PolicyAssertion>();
         
@@ -211,19 +218,22 @@ public class NestedPrimitiveAssertionTest extends Assert {
         int i = 0;
         
         p[i] = new Policy();
-        NestedPrimitiveAssertion a = new NestedPrimitiveAssertion(TEST_NAME1, true);
+        NestedPrimitiveAssertion a = new NestedPrimitiveAssertion(TEST_NAME1, true,
+                                                                  null);
         Policy nested = new Policy();
         a.setPolicy(nested);
         p[i++].addPolicyComponent(a);
         
         p[i] = new Policy();
-        a = new NestedPrimitiveAssertion(TEST_NAME1, false);
+        a = new NestedPrimitiveAssertion(TEST_NAME1, false,
+                                         null);
         nested = new Policy();
         a.setPolicy(nested);
         p[i++].addPolicyComponent(a);
         
         p[i] = new Policy();
-        a = new NestedPrimitiveAssertion(TEST_NAME1, false);
+        a = new NestedPrimitiveAssertion(TEST_NAME1, false,
+                                         null);
         nested = new Policy();
         a.setPolicy(nested);
         nested.addPolicyComponent(new PrimitiveAssertion(TEST_NAME2, true));
@@ -231,7 +241,8 @@ public class NestedPrimitiveAssertionTest extends Assert {
         p[i++].addPolicyComponent(a);
         
         p[i] = new Policy();
-        a = new NestedPrimitiveAssertion(TEST_NAME1, false);
+        a = new NestedPrimitiveAssertion(TEST_NAME1, false,
+                                         null);
         nested = new Policy();
         a.setPolicy(nested);
         ExactlyOne eo = new ExactlyOne();
@@ -241,7 +252,8 @@ public class NestedPrimitiveAssertionTest extends Assert {
         p[i++].addPolicyComponent(a);
         
         p[i] = new Policy();
-        a = new NestedPrimitiveAssertion(TEST_NAME1, false);
+        a = new NestedPrimitiveAssertion(TEST_NAME1, false,
+                                         null);
         nested = new Policy();
         a.setPolicy(nested);
         nested.addPolicyComponent(new PrimitiveAssertion(TEST_NAME3));  
diff --git a/rt/ws/policy/src/main/java/org/apache/cxf/ws/policy/PolicyBuilderImpl.java b/rt/ws/policy/src/main/java/org/apache/cxf/ws/policy/PolicyBuilderImpl.java
index 194e8fcc6c..bd92782638 100644
--- a/rt/ws/policy/src/main/java/org/apache/cxf/ws/policy/PolicyBuilderImpl.java
+++ b/rt/ws/policy/src/main/java/org/apache/cxf/ws/policy/PolicyBuilderImpl.java
@@ -44,6 +44,7 @@ import org.apache.neethi.ExactlyOne;
 import org.apache.neethi.Policy;
 import org.apache.neethi.PolicyOperator;
 import org.apache.neethi.PolicyReference;
+import org.apache.neethi.PolicyRegistry;
 
 
 /**
@@ -198,5 +199,10 @@ public class PolicyBuilderImpl implements PolicyBuilder, BusExtension {
             return operator;
         }
     }
+
+    public PolicyRegistry getPolicyRegistry() {
+        PolicyEngine e = bus.getExtension(PolicyEngine.class);
+        return e == null ? null : e.getRegistry();
+    }
     
 }
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/AsymmetricBindingBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/AsymmetricBindingBuilder.java
index 58e1b59e7b..ad303ca90f 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/AsymmetricBindingBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/AsymmetricBindingBuilder.java
@@ -60,10 +60,10 @@ public class AsymmetricBindingBuilder implements AssertionBuilder {
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
 
         
-        AsymmetricBinding asymmetricBinding = new AsymmetricBinding(consts);
+        AsymmetricBinding asymmetricBinding = new AsymmetricBinding(consts, builder);
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternative((List)iterator.next(), asymmetricBinding, consts);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/InitiatorTokenBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/InitiatorTokenBuilder.java
index ea7bb57d0a..b24e87b01d 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/InitiatorTokenBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/InitiatorTokenBuilder.java
@@ -58,11 +58,11 @@ public class InitiatorTokenBuilder implements AssertionBuilder {
         SPConstants consts = SP11Constants.SP_NS.equals(element.getNamespaceURI())
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
 
-        InitiatorToken initiatorToken = new InitiatorToken(consts);
+        InitiatorToken initiatorToken = new InitiatorToken(consts, builder);
         initiatorToken.setOptional(PolicyConstants.isOptional(element));
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternative((List)iterator.next(), initiatorToken);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/IssuedTokenBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/IssuedTokenBuilder.java
index a75bdb07e6..b7e2d6203d 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/IssuedTokenBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/IssuedTokenBuilder.java
@@ -104,7 +104,7 @@ public class IssuedTokenBuilder implements AssertionBuilder {
                 issuedToken.setRstTemplate(child);
             } else if (org.apache.neethi.Constants.ELEM_POLICY.equals(ln)) {
                 Policy policy = builder.getPolicy(child);
-                policy = (Policy)policy.normalize(false);
+                policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
                 for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
                     processAlternative((List)iterator.next(), issuedToken);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/ProtectionTokenBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/ProtectionTokenBuilder.java
index ebaf2e18bf..0c643d3781 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/ProtectionTokenBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/ProtectionTokenBuilder.java
@@ -57,10 +57,10 @@ public class ProtectionTokenBuilder implements AssertionBuilder {
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
         
         
-        ProtectionToken protectionToken = new ProtectionToken(consts);
+        ProtectionToken protectionToken = new ProtectionToken(consts, builder);
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternative((List)iterator.next(), protectionToken);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/RecipientTokenBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/RecipientTokenBuilder.java
index de6cb916b2..c2a74922a0 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/RecipientTokenBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/RecipientTokenBuilder.java
@@ -58,10 +58,10 @@ public class RecipientTokenBuilder implements AssertionBuilder {
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
     
 
-        RecipientToken recipientToken = new RecipientToken(consts);
+        RecipientToken recipientToken = new RecipientToken(consts, builder);
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternative((List)iterator.next(), recipientToken);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokens12Builder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokens12Builder.java
index 0742e96c46..b1d8658f39 100755
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokens12Builder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokens12Builder.java
@@ -69,32 +69,48 @@ public class SupportingTokens12Builder implements AssertionBuilder {
 
         if (SP12Constants.SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_SUPPORTING, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_SUPPORTING,
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.SIGNED_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_SIGNED, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_SIGNED, 
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.ENDORSING_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_ENDORSING, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_ENDORSING, 
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.SIGNED_ENDORSING_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENDORSING, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENDORSING, 
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.ENCRYPTED_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_ENCRYPTED, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_ENCRYPTED, 
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.SIGNED_ENCRYPTED_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENCRYPTED, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENCRYPTED, 
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.ENDORSING_ENCRYPTED_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_ENDORSING_ENCRYPTED, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_ENDORSING_ENCRYPTED, 
+                    SP12Constants.INSTANCE,
+                    builder);
         } else if (SP12Constants.SIGNED_ENDORSING_ENCRYPTED_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(
-                    SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENDORSING_ENCRYPTED, SP12Constants.INSTANCE);
+                    SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENDORSING_ENCRYPTED, 
+                    SP12Constants.INSTANCE,
+                    builder);
         }
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy) policy.normalize(false);
+        policy = (Policy) policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternative((List) iterator.next(), supportingToken);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokensBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokensBuilder.java
index cd1f901642..7ee82f2540 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokensBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SupportingTokensBuilder.java
@@ -67,20 +67,24 @@ public class SupportingTokensBuilder implements AssertionBuilder {
 
         if (SP11Constants.SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(SupportTokenType.SUPPORTING_TOKEN_SUPPORTING,
-                                                  SP11Constants.INSTANCE);
+                                                  SP11Constants.INSTANCE,
+                                                  builder);
         } else if (SP11Constants.SIGNED_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(SupportTokenType.SUPPORTING_TOKEN_SIGNED, 
-                                                  SP11Constants.INSTANCE);
+                                                  SP11Constants.INSTANCE,
+                                                  builder);
         } else if (SP11Constants.ENDORSING_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(SupportTokenType.SUPPORTING_TOKEN_ENDORSING, 
-                                                  SP11Constants.INSTANCE);
+                                                  SP11Constants.INSTANCE,
+                                                  builder);
         } else if (SP11Constants.SIGNED_ENDORSING_SUPPORTING_TOKENS.equals(name)) {
             supportingToken = new SupportingToken(SupportTokenType.SUPPORTING_TOKEN_SIGNED_ENDORSING,
-                                                  SP11Constants.INSTANCE);
+                                                  SP11Constants.INSTANCE,
+                                                  builder);
         }
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternative((List)iterator.next(), supportingToken);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SymmetricBindingBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SymmetricBindingBuilder.java
index 65e4f29b3b..e844d7f9fa 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SymmetricBindingBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/SymmetricBindingBuilder.java
@@ -59,10 +59,10 @@ public class SymmetricBindingBuilder implements AssertionBuilder {
         SPConstants consts = SP11Constants.SP_NS.equals(element.getNamespaceURI())
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
 
-        SymmetricBinding symmetricBinding = new SymmetricBinding(consts);
+        SymmetricBinding symmetricBinding = new SymmetricBinding(consts, builder);
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             processAlternatives((List)iterator.next(), symmetricBinding, consts);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportBindingBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportBindingBuilder.java
index dc7174c34b..0911b3cbb4 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportBindingBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportBindingBuilder.java
@@ -55,7 +55,7 @@ public class TransportBindingBuilder implements AssertionBuilder {
         SPConstants consts = SP11Constants.SP_NS.equals(element.getNamespaceURI())
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
 
-        TransportBinding transportBinding = new TransportBinding(consts);
+        TransportBinding transportBinding = new TransportBinding(consts, builder);
         processAlternative(element, transportBinding, consts);
 
         return transportBinding;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportTokenBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportTokenBuilder.java
index 0da6934581..91b9dc6356 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportTokenBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/TransportTokenBuilder.java
@@ -56,10 +56,10 @@ public class TransportTokenBuilder implements AssertionBuilder {
             ? SP11Constants.INSTANCE : SP12Constants.INSTANCE;
 
         
-        TransportToken transportToken = new TransportToken(consts);
+        TransportToken transportToken = new TransportToken(consts, builder);
 
         Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-        policy = (Policy)policy.normalize(false);
+        policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
         for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
             transportToken.setToken((Token)(((List)iterator.next()).get(0)));
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/X509TokenBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/X509TokenBuilder.java
index aca2757f88..73b161f4fa 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/X509TokenBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/builders/X509TokenBuilder.java
@@ -81,7 +81,7 @@ public class X509TokenBuilder implements AssertionBuilder {
 
 
             Policy policy = builder.getPolicy(DOMUtils.getFirstElement(element));
-            policy = (Policy)policy.normalize(false);
+            policy = (Policy)policy.normalize(builder.getPolicyRegistry(), false);
 
             for (Iterator iterator = policy.getAlternatives(); iterator.hasNext();) {
                 processAlternative((List)iterator.next(), x509Token, consts);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationInInterceptor.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationInInterceptor.java
index 237960ee62..e199d1b1fc 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationInInterceptor.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationInInterceptor.java
@@ -58,6 +58,7 @@ import org.apache.cxf.ws.policy.AssertionInfo;
 import org.apache.cxf.ws.policy.AssertionInfoMap;
 import org.apache.cxf.ws.policy.EndpointPolicy;
 import org.apache.cxf.ws.policy.PolicyAssertion;
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.policy.PolicyEngine;
 import org.apache.cxf.ws.security.SecurityConstants;
 import org.apache.cxf.ws.security.policy.SP12Constants;
@@ -160,9 +161,11 @@ class SecureConversationInInterceptor extends AbstractPhaseInterceptor<SoapMessa
                         .getAddressingPolicy(aim, false);
                     all.addPolicyComponent(ass);
                     ea.addPolicyComponent(all);
-                    SymmetricBinding binding = new SymmetricBinding(SP12Constants.INSTANCE);
+                    PolicyBuilder pbuilder = message.getExchange().getBus()
+                        .getExtension(PolicyBuilder.class);
+                    SymmetricBinding binding = new SymmetricBinding(SP12Constants.INSTANCE, pbuilder);
                     binding.setIncludeTimestamp(true);
-                    ProtectionToken token = new ProtectionToken(SP12Constants.INSTANCE);
+                    ProtectionToken token = new ProtectionToken(SP12Constants.INSTANCE, pbuilder);
                     token.setToken(new SecureConversationToken(SP12Constants.INSTANCE));
                     binding.setProtectionToken(token);
                     binding.setEntireHeadersAndBodySignatures(true);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationTokenInterceptorProvider.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationTokenInterceptorProvider.java
index 0328ea2a89..8e2f0464d4 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationTokenInterceptorProvider.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/SecureConversationTokenInterceptorProvider.java
@@ -43,6 +43,7 @@ import org.apache.cxf.ws.policy.AbstractPolicyInterceptorProvider;
 import org.apache.cxf.ws.policy.AssertionInfo;
 import org.apache.cxf.ws.policy.AssertionInfoMap;
 import org.apache.cxf.ws.policy.PolicyAssertion;
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.policy.builder.primitive.PrimitiveAssertion;
 import org.apache.cxf.ws.security.SecurityConstants;
 import org.apache.cxf.ws.security.policy.SP11Constants;
@@ -158,7 +159,9 @@ public class SecureConversationTokenInterceptorProvider extends AbstractPolicyIn
         
         if (endorse) {
             SupportingToken st = new SupportingToken(SupportTokenType.SUPPORTING_TOKEN_ENDORSING,
-                                                     SP12Constants.INSTANCE);
+                                                     SP12Constants.INSTANCE,
+                                                     message.getExchange()
+                                                         .getBus().getExtension(PolicyBuilder.class));
             st.addToken(itok);
             all.addPolicyComponent(st);
         }
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/AsymmetricBinding.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/AsymmetricBinding.java
index 56b13d52aa..586dc9b944 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/AsymmetricBinding.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/AsymmetricBinding.java
@@ -23,6 +23,7 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.policy.builder.primitive.PrimitiveAssertion;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
@@ -37,8 +38,8 @@ public class AsymmetricBinding extends SymmetricAsymmetricBindingBase {
 
     private RecipientToken recipientToken;
 
-    public AsymmetricBinding(SPConstants version) {
-        super(version);
+    public AsymmetricBinding(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
@@ -109,7 +110,7 @@ public class AsymmetricBinding extends SymmetricAsymmetricBindingBase {
             all.addPolicyComponent(getLayout());
         }
         ea.addPolicyComponent(all);
-        PolicyComponent pc = p.normalize(true);
+        PolicyComponent pc = p.normalize(builder.getPolicyRegistry(), true);
         if (pc instanceof Policy) {
             return (Policy)pc;
         } else {
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/Binding.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/Binding.java
index e518e39ede..b0e5249584 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/Binding.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/Binding.java
@@ -18,20 +18,24 @@
  */
 package org.apache.cxf.ws.security.policy.model;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public abstract class Binding extends AbstractSecurityAssertion implements AlgorithmWrapper {
-
+    protected PolicyBuilder builder;
+    
     private AlgorithmSuite algorithmSuite;
     private boolean includeTimestamp;
     private Layout layout;
     private SupportingToken signedSupportingToken;
     private SupportingToken signedEndorsingSupportingTokens;
     private boolean tokenProtection;
+    
 
-    public Binding(SPConstants version) {
+    public Binding(SPConstants version, PolicyBuilder b) {
         super(version);
         layout = new Layout(version);
+        builder = b;
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/EncryptionToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/EncryptionToken.java
index 5f6d7539a9..b11befb9e7 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/EncryptionToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/EncryptionToken.java
@@ -22,13 +22,14 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public class EncryptionToken extends TokenWrapper {
 
-    public EncryptionToken(SPConstants version) {
-        super(version);
+    public EncryptionToken(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/InitiatorToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/InitiatorToken.java
index 1d1c01d40e..135eef52c8 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/InitiatorToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/InitiatorToken.java
@@ -22,13 +22,14 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public class InitiatorToken extends TokenWrapper {
 
-    public InitiatorToken(SPConstants version) {
-        super(version);
+    public InitiatorToken(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/ProtectionToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/ProtectionToken.java
index 17373e3bdd..e25cb0ff60 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/ProtectionToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/ProtectionToken.java
@@ -22,16 +22,17 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public class ProtectionToken extends TokenWrapper {
 
-    public ProtectionToken() {
-        super(SP12Constants.INSTANCE);
+    public ProtectionToken(PolicyBuilder b) {
+        super(SP12Constants.INSTANCE, b);
     }
-    public ProtectionToken(SPConstants version) {
-        super(version);
+    public ProtectionToken(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/RecipientToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/RecipientToken.java
index bf291388f5..22d01943f0 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/RecipientToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/RecipientToken.java
@@ -22,13 +22,14 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public class RecipientToken extends TokenWrapper {
 
-    public RecipientToken(SPConstants version) {
-        super(version);
+    public RecipientToken(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SignatureToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SignatureToken.java
index 907dafa6d5..1d219492c3 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SignatureToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SignatureToken.java
@@ -22,13 +22,14 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public class SignatureToken extends TokenWrapper {
 
-    public SignatureToken(SPConstants version) {
-        super(version);
+    public SignatureToken(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SupportingToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SupportingToken.java
index 3613603cd4..36af103ce9 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SupportingToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SupportingToken.java
@@ -25,6 +25,7 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.SPConstants.SupportTokenType;
@@ -57,8 +58,8 @@ public class SupportingToken extends TokenWrapper implements AlgorithmWrapper {
 
     private SignedEncryptedParts encryptedParts;
 
-    public SupportingToken(SupportTokenType type, SPConstants version) {
-        super(version);
+    public SupportingToken(SupportTokenType type, SPConstants version, PolicyBuilder b) {
+        super(version, b);
         this.type = type;
     }
 
@@ -327,7 +328,7 @@ public class SupportingToken extends TokenWrapper implements AlgorithmWrapper {
         }        
         
         ea.addPolicyComponent(all);
-        PolicyComponent pc = p.normalize(true);
+        PolicyComponent pc = p.normalize(builder.getPolicyRegistry(), true);
         if (pc instanceof Policy) {
             return (Policy)pc;
         } else {
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricAsymmetricBindingBase.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricAsymmetricBindingBase.java
index 318cbad8f3..d728212948 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricAsymmetricBindingBase.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricAsymmetricBindingBase.java
@@ -18,6 +18,7 @@
  */
 package org.apache.cxf.ws.security.policy.model;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public abstract class SymmetricAsymmetricBindingBase extends Binding {
@@ -28,8 +29,8 @@ public abstract class SymmetricAsymmetricBindingBase extends Binding {
 
     private boolean entireHeadersAndBodySignatures;
 
-    public SymmetricAsymmetricBindingBase(SPConstants version) {
-        super(version);
+    public SymmetricAsymmetricBindingBase(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricBinding.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricBinding.java
index deee060c3f..07c2f76d1e 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricBinding.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/SymmetricBinding.java
@@ -22,6 +22,7 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.policy.builder.primitive.PrimitiveAssertion;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
@@ -36,11 +37,11 @@ public class SymmetricBinding extends SymmetricAsymmetricBindingBase {
     private SignatureToken signatureToken;
     private ProtectionToken protectionToken;
 
-    public SymmetricBinding() {
-        super(SP12Constants.INSTANCE);
+    public SymmetricBinding(PolicyBuilder b) {
+        super(SP12Constants.INSTANCE, b);
     }
-    public SymmetricBinding(SPConstants version) {
-        super(version);
+    public SymmetricBinding(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
@@ -135,7 +136,7 @@ public class SymmetricBinding extends SymmetricAsymmetricBindingBase {
 
         
         ea.addPolicyComponent(all);
-        PolicyComponent pc = p.normalize(true);
+        PolicyComponent pc = p.normalize(builder.getPolicyRegistry(), true);
         if (pc instanceof Policy) {
             return (Policy)pc;
         } else {
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TokenWrapper.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TokenWrapper.java
index 45a5feba4b..96dbd698ef 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TokenWrapper.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TokenWrapper.java
@@ -20,6 +20,7 @@ package org.apache.cxf.ws.security.policy.model;
 
 
 import org.apache.cxf.ws.policy.PolicyAssertion;
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.neethi.All;
 import org.apache.neethi.ExactlyOne;
@@ -27,10 +28,12 @@ import org.apache.neethi.Policy;
 import org.apache.neethi.PolicyComponent;
 
 public abstract class TokenWrapper extends AbstractSecurityAssertion implements PolicyAssertion {
+    protected PolicyBuilder builder;
     protected Token token;
 
-    public TokenWrapper(SPConstants version) {
+    public TokenWrapper(SPConstants version, PolicyBuilder b) {
         super(version);
+        builder = b;
     }
     
     public void setToken(Token tok) {
@@ -58,7 +61,7 @@ public abstract class TokenWrapper extends AbstractSecurityAssertion implements
             All all = new All();
             all.addPolicyComponent(token);
             ea.addPolicyComponent(all);
-            PolicyComponent pc = p.normalize(true);
+            PolicyComponent pc = p.normalize(builder.getPolicyRegistry(), true);
             if (pc instanceof Policy) {
                 return (Policy)pc;
             } else {
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportBinding.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportBinding.java
index c6a01a3070..031ee72378 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportBinding.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportBinding.java
@@ -22,6 +22,7 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.policy.builder.primitive.PrimitiveAssertion;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
@@ -34,8 +35,8 @@ public class TransportBinding extends Binding {
 
     private TransportToken transportToken;
 
-    public TransportBinding(SPConstants version) {
-        super(version);
+    public TransportBinding(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
@@ -147,7 +148,7 @@ public class TransportBinding extends Binding {
             all.addPolicyComponent(getLayout());
         }
         ea.addPolicyComponent(all);
-        PolicyComponent pc = p.normalize(true);
+        PolicyComponent pc = p.normalize(builder.getPolicyRegistry(), true);
         if (pc instanceof Policy) {
             return (Policy)pc;
         } else {
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportToken.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportToken.java
index 306d41c9d8..ffdf40ab5d 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportToken.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/model/TransportToken.java
@@ -22,13 +22,14 @@ import javax.xml.namespace.QName;
 import javax.xml.stream.XMLStreamException;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 
 public class TransportToken extends TokenWrapper {
 
-    public TransportToken(SPConstants version) {
-        super(version);
+    public TransportToken(SPConstants version, PolicyBuilder b) {
+        super(version, b);
     }
 
     /**
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/trust/STSClient.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/trust/STSClient.java
index 172413bbbc..764704c933 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/trust/STSClient.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/trust/STSClient.java
@@ -589,11 +589,12 @@ public class STSClient implements Configurable, InterceptorProvider {
         ExactlyOne one = new ExactlyOne();
         validatePolicy.addPolicyComponent(one);
         All all = new All();
-        SymmetricBinding binding = new SymmetricBinding();
+        PolicyBuilder pbuilder = bus.getExtension(PolicyBuilder.class);
+        SymmetricBinding binding = new SymmetricBinding(pbuilder);
         all.addAssertion(binding);
         one.addPolicyComponent(all);
         all.addAssertion(getAddressingAssertion());
-        ProtectionToken ptoken = new ProtectionToken();
+        ProtectionToken ptoken = new ProtectionToken(pbuilder);
         binding.setProtectionToken(ptoken);
         binding.setIncludeTimestamp(true);
         binding.setEntireHeadersAndBodySignatures(true);
@@ -656,11 +657,12 @@ public class STSClient implements Configurable, InterceptorProvider {
         ExactlyOne one = new ExactlyOne();
         cancelPolicy.addPolicyComponent(one);
         All all = new All();
-        one.addPolicyComponent(all);
-        SymmetricBinding binding = new SymmetricBinding();
+        one.addPolicyComponent(all); 
+        PolicyBuilder pbuilder = bus.getExtension(PolicyBuilder.class);
+        SymmetricBinding binding = new SymmetricBinding(pbuilder);
         all.addAssertion(binding);
         all.addAssertion(getAddressingAssertion());
-        ProtectionToken ptoken = new ProtectionToken();
+        ProtectionToken ptoken = new ProtectionToken(pbuilder);
         binding.setProtectionToken(ptoken);
         binding.setIncludeTimestamp(true);
         binding.setEntireHeadersAndBodySignatures(true);
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JOutInterceptor.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JOutInterceptor.java
index 38e08ec2d0..849ee52480 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JOutInterceptor.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JOutInterceptor.java
@@ -35,6 +35,7 @@ import org.apache.cxf.phase.Phase;
 import org.apache.cxf.phase.PhaseInterceptor;
 import org.apache.cxf.ws.policy.AssertionInfo;
 import org.apache.cxf.ws.policy.AssertionInfoMap;
+import org.apache.cxf.ws.policy.PolicyBuilder;
 import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.model.AsymmetricBinding;
 import org.apache.cxf.ws.security.policy.model.Binding;
@@ -114,7 +115,9 @@ public class PolicyBasedWSS4JOutInterceptor extends AbstractPhaseInterceptor<Soa
                     }                    
                 }
                 if (transport == null && isRequestor(message)) {
-                    transport = new TransportBinding(SP12Constants.INSTANCE);
+                    transport = new TransportBinding(SP12Constants.INSTANCE,
+                                                     message.getExchange().getBus()
+                                                         .getExtension(PolicyBuilder.class));
                 }
                 
                 if (transport != null) {
