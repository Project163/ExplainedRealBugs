diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStore.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStore.java
index 11d5bdea89..ea37a7442d 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStore.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStore.java
@@ -83,14 +83,18 @@ public class EHCacheTokenStore implements TokenStore {
     public void add(SecurityToken token) {
         if (token != null && !StringUtils.isEmpty(token.getId())) {
             int parsedTTL = getTTL(token);
-            cache.put(new Element(token.getId(), token, false, parsedTTL, parsedTTL));
+            if (parsedTTL > 0) {
+                cache.put(new Element(token.getId(), token, false, parsedTTL, parsedTTL));
+            }
         }
     }
     
     public void add(String identifier, SecurityToken token) {
         if (token != null && !StringUtils.isEmpty(identifier)) {
             int parsedTTL = getTTL(token);
-            cache.put(new Element(identifier, token, false, parsedTTL, parsedTTL));
+            if (parsedTTL > 0) {
+                cache.put(new Element(identifier, token, false, parsedTTL, parsedTTL));
+            }
         }
     }
     
@@ -132,9 +136,12 @@ public class EHCacheTokenStore implements TokenStore {
             Date expires = token.getExpires();
             Date current = new Date();
             long expiryTime = (expires.getTime() - current.getTime()) / 1000L;
+            if (expiryTime < 0) {
+                return 0;
+            }
             
             parsedTTL = (int)expiryTime;
-            if (expiryTime != (long)parsedTTL || parsedTTL < 0 || parsedTTL > MAX_TTL) {
+            if (expiryTime != (long)parsedTTL || parsedTTL > MAX_TTL) {
                 // Default to configured value
                 parsedTTL = (int)ttl;
                 if (ttl != (long)parsedTTL) {
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStore.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStore.java
index b997c40207..144510c184 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStore.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStore.java
@@ -40,14 +40,18 @@ public class MemoryTokenStore implements TokenStore {
     public void add(SecurityToken token) {
         if (token != null && !StringUtils.isEmpty(token.getId())) {
             CacheEntry cacheEntry = createCacheEntry(token);
-            tokens.put(token.getId(), cacheEntry);
+            if (cacheEntry != null) {
+                tokens.put(token.getId(), cacheEntry);
+            }
         }
     }
     
     public void add(String identifier, SecurityToken token) {
         if (token != null && !StringUtils.isEmpty(identifier)) {
             CacheEntry cacheEntry = createCacheEntry(token);
-            tokens.put(identifier, cacheEntry);
+            if (cacheEntry != null) {
+                tokens.put(identifier, cacheEntry);
+            }
         }
     }
     
@@ -109,7 +113,10 @@ public class MemoryTokenStore implements TokenStore {
             Date expires = token.getExpires();
             Date current = new Date();
             long expiryTime = expires.getTime() - current.getTime();
-            if (expiryTime < 0 || expiryTime > (MAX_TTL * 1000L)) {
+            if (expiryTime < 0) {
+                return null;
+            }
+            if (expiryTime > (MAX_TTL * 1000L)) {
                 expires.setTime(current.getTime() + (DEFAULT_TTL * 1000L));
             }
             cacheEntry = new CacheEntry(token, expires);
diff --git a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStoreTest.java b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStoreTest.java
new file mode 100644
index 0000000000..82dfd258fc
--- /dev/null
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/tokenstore/EHCacheTokenStoreTest.java
@@ -0,0 +1,101 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.cxf.ws.security.tokenstore;
+
+import java.util.Date;
+
+import org.apache.cxf.common.classloader.ClassLoaderUtils;
+import org.apache.cxf.message.Message;
+import org.apache.cxf.message.MessageImpl;
+import org.apache.cxf.ws.security.SecurityConstants;
+import org.junit.BeforeClass;
+
+public class EHCacheTokenStoreTest extends org.junit.Assert {
+  
+    private static TokenStore store;
+    
+    @BeforeClass
+    public static void init() {
+        TokenStoreFactory tokenStoreFactory = new EHCacheTokenStoreFactory();
+        Message message = new MessageImpl();
+        message.put(
+            SecurityConstants.CACHE_CONFIG_FILE, 
+            ClassLoaderUtils.getResource("cxf-ehcache.xml", EHCacheTokenStoreTest.class)
+        );
+        store = tokenStoreFactory.newTokenStore(SecurityConstants.TOKEN_STORE_CACHE_INSTANCE, message);
+    }
+    
+    // tests TokenStore apis for storing in the cache.
+    @org.junit.Test
+    public void testTokenAdd() throws Exception {
+        String key = "key";
+        SecurityToken token = new SecurityToken(key);
+        store.add(token);
+        assertEquals(token, store.getToken(key));
+        store.remove(token.getId());
+        assertNull(store.getToken(key));
+        
+        String newKey = "xyz";
+        store.add(newKey, token);
+        assertNull(store.getToken(key));
+        assertEquals(token, store.getToken(newKey));
+        store.remove(newKey);
+        assertNull(store.getToken(newKey));
+    }
+    
+    // tests TokenStore apis for storing in the cache with various expiration times
+    @org.junit.Test
+    public void testTokenAddExpiration() throws Exception {
+        SecurityToken expiredToken = new SecurityToken("expiredToken");
+        Date currentDate = new Date();
+        long currentTime = currentDate.getTime();
+        Date expiry = new Date();
+        expiry.setTime(currentTime - 5000L);
+        expiredToken.setExpires(expiry);
+        store.add(expiredToken);
+        assertTrue(store.getTokenIdentifiers().isEmpty());
+        
+        SecurityToken farFutureToken = new SecurityToken("farFuture");
+        expiry = new Date();
+        expiry.setTime(Long.MAX_VALUE);
+        farFutureToken.setExpires(expiry);
+        store.add(farFutureToken);
+        
+        assertTrue(store.getTokenIdentifiers().size() == 1);
+        store.remove(farFutureToken.getId());
+        assertTrue(store.getTokenIdentifiers().isEmpty());
+    }
+    
+    // tests TokenStore apis for removing from the cache.
+    @org.junit.Test
+    public void testTokenRemove() {
+        SecurityToken token1 = new SecurityToken("token1");
+        SecurityToken token2 = new SecurityToken("token2");
+        SecurityToken token3 = new SecurityToken("token3");
+        store.add(token1);
+        store.add(token2);
+        store.add(token3);
+        assertTrue(store.getTokenIdentifiers().size() == 3);
+        store.remove(token3.getId());
+        assertNull(store.getToken("test3"));
+        store.remove(token1.getId());
+        store.remove(token2.getId());
+        assertTrue(store.getTokenIdentifiers().size() == 0);
+    }
+}
diff --git a/services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/DefaultInMemoryTokenStoreTest.java b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStoreTest.java
similarity index 50%
rename from services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/DefaultInMemoryTokenStoreTest.java
rename to rt/ws/security/src/test/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStoreTest.java
index 73b6635ec3..a124c024a5 100644
--- a/services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/DefaultInMemoryTokenStoreTest.java
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/tokenstore/MemoryTokenStoreTest.java
@@ -16,22 +16,27 @@
  * specific language governing permissions and limitations
  * under the License.
  */
-package org.apache.cxf.sts.cache;
+package org.apache.cxf.ws.security.tokenstore;
 
-import org.apache.cxf.ws.security.tokenstore.SecurityToken;
-import org.apache.cxf.ws.security.tokenstore.TokenStore;
+import java.util.Date;
+
+import org.apache.cxf.message.Message;
+import org.apache.cxf.message.MessageImpl;
+import org.apache.cxf.ws.security.SecurityConstants;
 import org.junit.BeforeClass;
 
-public class DefaultInMemoryTokenStoreTest extends org.junit.Assert {
+public class MemoryTokenStoreTest extends org.junit.Assert {
   
     private static TokenStore store;
     
     @BeforeClass
     public static void init() {
-        store = new DefaultInMemoryTokenStore();
+        TokenStoreFactory tokenStoreFactory = new MemoryTokenStoreFactory();
+        Message message = new MessageImpl();
+        store = tokenStoreFactory.newTokenStore(SecurityConstants.TOKEN_STORE_CACHE_INSTANCE, message);
     }
     
-    // tests STSCache apis for storing in the cache.
+    // tests TokenStore apis for storing in the cache.
     @org.junit.Test
     public void testTokenAdd() throws Exception {
         String key = "key";
@@ -40,9 +45,39 @@ public class DefaultInMemoryTokenStoreTest extends org.junit.Assert {
         assertEquals(token, store.getToken(key));
         store.remove(token.getId());
         assertNull(store.getToken(key));
+        
+        String newKey = "xyz";
+        store.add(newKey, token);
+        assertNull(store.getToken(key));
+        assertEquals(token, store.getToken(newKey));
+        store.remove(newKey);
+        assertNull(store.getToken(newKey));
+    }
+    
+    // tests TokenStore apis for storing in the cache with various expiration times
+    @org.junit.Test
+    public void testTokenAddExpiration() throws Exception {
+        SecurityToken expiredToken = new SecurityToken("expiredToken");
+        Date currentDate = new Date();
+        long currentTime = currentDate.getTime();
+        Date expiry = new Date();
+        expiry.setTime(currentTime - 5000L);
+        expiredToken.setExpires(expiry);
+        store.add(expiredToken);
+        assertTrue(store.getTokenIdentifiers().isEmpty());
+        
+        SecurityToken farFutureToken = new SecurityToken("farFuture");
+        expiry = new Date();
+        expiry.setTime(Long.MAX_VALUE);
+        farFutureToken.setExpires(expiry);
+        store.add(farFutureToken);
+        
+        assertTrue(store.getTokenIdentifiers().size() == 1);
+        store.remove(farFutureToken.getId());
+        assertTrue(store.getTokenIdentifiers().isEmpty());
     }
     
-    // tests STSCache apis for removing from the cache.
+    // tests TokenStore apis for removing from the cache.
     @org.junit.Test
     public void testTokenRemove() {
         SecurityToken token1 = new SecurityToken("token1");
diff --git a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/cache/HazelCastTokenStore.java b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/cache/HazelCastTokenStore.java
index aad9580d2b..a014afeb4e 100644
--- a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/cache/HazelCastTokenStore.java
+++ b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/cache/HazelCastTokenStore.java
@@ -62,14 +62,18 @@ public class HazelCastTokenStore implements TokenStore {
     public void add(SecurityToken token) {
         if (token != null && !StringUtils.isEmpty(token.getId())) {
             int parsedTTL = getTTL(token);
-            cacheMap.put(token.getId(), token, parsedTTL, TimeUnit.SECONDS);
+            if (parsedTTL > 0) {
+                cacheMap.put(token.getId(), token, parsedTTL, TimeUnit.SECONDS);
+            }
         }
     }
     
     public void add(String identifier, SecurityToken token) {
         if (token != null && !StringUtils.isEmpty(identifier)) {
             int parsedTTL = getTTL(token);
-            cacheMap.put(identifier, token, parsedTTL, TimeUnit.SECONDS);
+            if (parsedTTL > 0) {
+                cacheMap.put(identifier, token, parsedTTL, TimeUnit.SECONDS);
+            }
         }
     }
     
@@ -98,9 +102,12 @@ public class HazelCastTokenStore implements TokenStore {
             Date expires = token.getExpires();
             Date current = new Date();
             long expiryTime = (expires.getTime() - current.getTime()) / 1000L;
+            if (expiryTime < 0) {
+                return 0;
+            }
             
             parsedTTL = (int)expiryTime;
-            if (expiryTime != (long)parsedTTL || parsedTTL < 0 || parsedTTL > MAX_TTL) {
+            if (expiryTime != (long)parsedTTL || parsedTTL > MAX_TTL) {
                 // Default to configured value
                 parsedTTL = (int)ttl;
                 if (ttl != (long)parsedTTL) {
diff --git a/services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/HazelCastTokenStoreTest.java b/services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/HazelCastTokenStoreTest.java
index cd96f21a9e..afeff1d1b2 100644
--- a/services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/HazelCastTokenStoreTest.java
+++ b/services/sts/sts-core/src/test/java/org/apache/cxf/sts/cache/HazelCastTokenStoreTest.java
@@ -18,6 +18,8 @@
  */
 package org.apache.cxf.sts.cache;
 
+import java.util.Date;
+
 import org.apache.cxf.ws.security.tokenstore.SecurityToken;
 import org.apache.cxf.ws.security.tokenstore.TokenStore;
 import org.junit.BeforeClass;
@@ -31,21 +33,50 @@ public class HazelCastTokenStoreTest extends org.junit.Assert {
         store = new HazelCastTokenStore("default");
     }
     
-    // tests STSCache apis for storing in the cache.
+    // tests TokenStore apis for storing in the cache.
     @org.junit.Test
-    public void testCacheStore() throws Exception {
+    public void testTokenAdd() throws Exception {
         String key = "key";
         SecurityToken token = new SecurityToken(key);
         store.add(token);
-        SecurityToken cachedToken = store.getToken(key);
-        assertEquals(token.getId(), cachedToken.getId());
+        assertEquals(token, store.getToken(key));
         store.remove(token.getId());
         assertNull(store.getToken(key));
+        
+        String newKey = "xyz";
+        store.add(newKey, token);
+        assertNull(store.getToken(key));
+        assertEquals(token, store.getToken(newKey));
+        store.remove(newKey);
+        assertNull(store.getToken(newKey));
+    }
+    
+    // tests TokenStore apis for storing in the cache with various expiration times
+    @org.junit.Test
+    public void testTokenAddExpiration() throws Exception {
+        SecurityToken expiredToken = new SecurityToken("expiredToken");
+        Date currentDate = new Date();
+        long currentTime = currentDate.getTime();
+        Date expiry = new Date();
+        expiry.setTime(currentTime - 5000L);
+        expiredToken.setExpires(expiry);
+        store.add(expiredToken);
+        assertTrue(store.getTokenIdentifiers().isEmpty());
+        
+        SecurityToken farFutureToken = new SecurityToken("farFuture");
+        expiry = new Date();
+        expiry.setTime(Long.MAX_VALUE);
+        farFutureToken.setExpires(expiry);
+        store.add(farFutureToken);
+        
+        assertTrue(store.getTokenIdentifiers().size() == 1);
+        store.remove(farFutureToken.getId());
+        assertTrue(store.getTokenIdentifiers().isEmpty());
     }
     
-    // tests STSCache apis for removing from the cache.
+    // tests TokenStore apis for removing from the cache.
     @org.junit.Test
-    public void testCacheRemove() {
+    public void testTokenRemove() {
         SecurityToken token1 = new SecurityToken("token1");
         SecurityToken token2 = new SecurityToken("token2");
         SecurityToken token3 = new SecurityToken("token3");
