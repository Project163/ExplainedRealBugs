diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder.java
index af4863cbd2..ad26d6a79a 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder.java
@@ -1661,6 +1661,8 @@ public abstract class AbstractBindingBuilder {
      * @throws IllegalArgumentException
      *             if an element in {@code signedParts} contains a {@code
      *             WSEncryptionPart} with a {@code null} {@code id} value
+     *             and the {@code WSEncryptionPart} {@code name} value is not
+     *             "Token"
      */
     public void handleEncryptedSignedHeaders(Vector<WSEncryptionPart> encryptedParts, 
                                              Vector<WSEncryptionPart> signedParts) {
@@ -1671,7 +1673,13 @@ public abstract class AbstractBindingBuilder {
             final Iterator<WSEncryptionPart> signedPartsIt = signedParts.iterator();
             while (signedPartsIt.hasNext()) {
                 WSEncryptionPart signedPart = signedPartsIt.next();
-                if (signedPart.getId() == null) {
+                // Everything has to be ID based except for the case of a part
+                // indicating "Token" as the element name.  This name is a flag
+                // for WSS4J to sign the initiator token used in the signature.
+                // Since the encryption happened before the signature creation,
+                // this element can't possibly be encrypted so we can safely ignore
+                // if it were ever to be set before this method is called.
+                if (signedPart.getId() == null && !"Token".equals(signedPart.getName())) {
                     throw new IllegalArgumentException(
                             "WSEncryptionPart must be ID based but no id was found.");
                 } else if (encryptedPart.getEncModifier().equals("Element")
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AsymmetricBindingHandler.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AsymmetricBindingHandler.java
index e79871e68c..f5fdc9b580 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AsymmetricBindingHandler.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/AsymmetricBindingHandler.java
@@ -386,17 +386,23 @@ public class AsymmetricBindingHandler extends AbstractBindingBuilder {
         } else {
             WSSecSignature sig = getSignatureBuider(wrapper, sigToken, false);
             sig.prependBSTElementToHeader(secHeader);
+            insertBeforeBottomUp(sig.getSignatureElement());
             
-            if (abinding.isTokenProtection()
-                    && sig.getBSTTokenId() != null) {
-                sigParts.add(new WSEncryptionPart(sig.getBSTTokenId()));
+            if (abinding.isTokenProtection()) {                
+                // Special flag telling WSS4J to sign the initiator token.
+                // Use this instead of the BST ID so that we don't
+                // have to deal with maintaining such logic here.
+                sigParts.add(new WSEncryptionPart("Token", null, 
+                        "Element", WSConstants.PART_TYPE_ELEMENT));
             }
+                    
+            sig.prependBSTElementToHeader(secHeader);
 
             sig.addReferencesToSign(sigParts, secHeader);
             sig.computeSignature();
             signatures.add(sig.getSignatureValue());
 
-            insertBeforeBottomUp(sig.getSignatureElement());            
+                        
             mainSigId = addWsuIdToElement(sig.getSignatureElement());
         }
     }
diff --git a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWss4JInOutTest.java b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWss4JInOutTest.java
index c0bc2ae191..9a517668dd 100644
--- a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWss4JInOutTest.java
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWss4JInOutTest.java
@@ -462,6 +462,118 @@ public class PolicyBasedWss4JInOutTest extends AbstractSecurityTest {
                         CoverageType.SIGNED));
     }
     
+    @Test
+    public void testProtectTokenAssertion() throws Exception {
+        
+        // ////////////////////////////////////////////////////
+        // x509 Direct Ref Tests
+        
+        /* REVISIT
+        No inbound validation is available for the PROTECT_TOKENS assertion.
+        We cannot yet test inbound in the standard manner.  Since we can't
+        test inbound, we can't test reound trip either and thus must take
+        a different approach for now.
+         
+        this.runInInterceptorAndValidate(
+                "signed_x509_direct_ref_token_prot.xml",
+                "protect_token_policy_asym_x509_direct_ref.xml",
+                SP12Constants.PROTECT_TOKENS,
+                null,
+                CoverageType.SIGNED);
+
+        this.runInInterceptorAndValidate(
+                "signed_x509_direct_ref.xml",
+                "protect_token_policy_asym_x509_direct_ref.xml",
+                null,
+                SP12Constants.PROTECT_TOKENS,
+                CoverageType.SIGNED);
+        
+        this.runAndValidate(
+                "wsse-request-clean.xml",
+                "protect_token_policy_asym_x509_direct_ref.xml",
+                null,
+                null,
+                Arrays.asList(new QName[] {SP12Constants.PROTECT_TOKENS }),
+                null,
+                Arrays.asList(new CoverageType[] {CoverageType.SIGNED }));
+        */
+        
+        // REVISIT
+        // We test using a policy with ProtectTokens enabled on
+        // the outbound but with a policy using a SignedElements policy
+        // on the inbound to validate that the correct thing got signed.
+        this.runAndValidate(
+                "wsse-request-clean.xml",
+                "protect_token_policy_asym_x509_direct_ref.xml",
+                "protect_token_policy_asym_x509_direct_ref_complement.xml",
+                new AssertionsHolder(
+                        Arrays.asList(new QName[] {SP12Constants.ASYMMETRIC_BINDING}),
+                        null),
+                new AssertionsHolder(
+                        Arrays.asList(new QName[] {SP12Constants.SIGNED_ELEMENTS}),
+                        null),
+                Arrays.asList(new CoverageType[] {CoverageType.SIGNED }));
+        
+        // ////////////////////////////////////////////////////
+        // x509 Issuer Serial Tests
+        
+        /* REVISIT
+        No inbound validation is available for the PROTECT_TOKENS assertion.
+        We cannot yet test inbound in the standard manner.  Since we can't
+        test inbound, we can't test reound trip either and thus must take
+        a different approach for now.
+        
+        this.runInInterceptorAndValidate(
+                "signed_x509_issuer_serial_token_prot.xml",
+                "protect_token_policy_asym_x509_issuer_serial.xml",
+                SP12Constants.PROTECT_TOKENS,
+                null,
+                CoverageType.SIGNED);
+
+        this.runInInterceptorAndValidate(
+                "signed_x509_issuer_serial.xml",
+                "protect_token_policy_asym_x509_issuer_serial.xml",
+                null,
+                SP12Constants.PROTECT_TOKENS,
+                CoverageType.SIGNED);
+
+        this.runAndValidate(
+                "wsse-request-clean.xml",
+                "protect_token_policy_asym_x509_issuer_serial.xml",
+                null,
+                null,
+                Arrays.asList(new QName[] { SP12Constants.PROTECT_TOKENS }),
+                null,
+                Arrays.asList(new CoverageType[] { CoverageType.SIGNED }));
+        */
+        
+        // REVISIT
+        // We test using a policy with ProtectTokens enabled on
+        // the outbound but with a policy using a SignedElements policy
+        // on the inbound to validate that the correct thing got signed.
+        this.runAndValidate(
+                "wsse-request-clean.xml",
+                "protect_token_policy_asym_x509_issuer_serial.xml",
+                "protect_token_policy_asym_x509_issuer_serial_complement.xml",
+                new AssertionsHolder(
+                        Arrays.asList(new QName[] {SP12Constants.ASYMMETRIC_BINDING}),
+                        null),
+                new AssertionsHolder(
+                        Arrays.asList(new QName[] {SP12Constants.SIGNED_ELEMENTS}),
+                        null),
+                Arrays.asList(new CoverageType[] {CoverageType.SIGNED }));
+
+        // ////////////////////////////////////////////////////
+        // x509 Key Identifier Tests
+
+        // TODO: Tests for Key Identifier are needed but require that the
+        // certificates used in the test cases be updated to version 3
+        // according to WSS4J.
+        
+        // TODO: Tests for derived keys.
+    }
+
+    
     protected Bus createBus() throws BusException {
         Bus b = super.createBus();
         this.policyBuilder = 
@@ -474,17 +586,39 @@ public class PolicyBasedWss4JInOutTest extends AbstractSecurityTest {
             List<QName> assertedInAssertions, List<QName> notAssertedInAssertions,
             List<CoverageType> types) throws Exception {
         
-        final Element policyElement = 
-            this.readDocument(policyDocument).getDocumentElement();
+        this.runAndValidate(document, policyDocument, null,
+                new AssertionsHolder(assertedOutAssertions, notAssertedOutAssertions),
+                new AssertionsHolder(assertedInAssertions, notAssertedInAssertions),
+                types);
+    }
+    
+    private void runAndValidate(
+            String document,
+            String outPolicyDocument, String inPolicyDocument,
+            AssertionsHolder outAssertions,
+            AssertionsHolder inAssertions,
+            List<CoverageType> types) throws Exception {
+        
+        final Element outPolicyElement = this.readDocument(outPolicyDocument)
+                .getDocumentElement();
+        final Element inPolicyElement;
+
+        if (inPolicyDocument != null) {
+            inPolicyElement = this.readDocument(inPolicyDocument)
+                    .getDocumentElement();
+        } else {
+            inPolicyElement = outPolicyElement;
+        }
+            
         
-        final Policy outPolicy = this.policyBuilder.getPolicy(policyElement);
-        final Policy inPolicy = this.policyBuilder.getPolicy(policyElement);
+        final Policy outPolicy = this.policyBuilder.getPolicy(outPolicyElement);
+        final Policy inPolicy = this.policyBuilder.getPolicy(inPolicyElement);
         
         final Document originalDoc = this.readDocument(document);
         
         final Document inDoc = this.runOutInterceptorAndValidate(
-                originalDoc, outPolicy, assertedOutAssertions,
-                notAssertedOutAssertions);
+                originalDoc, outPolicy, outAssertions.getAssertedAssertions(),
+                outAssertions.getNotAssertedAssertions());
         
         // Can't use this method if you want output that is not mangled.
         // Such is the case when you want to capture output to use
@@ -500,8 +634,8 @@ public class PolicyBasedWss4JInOutTest extends AbstractSecurityTest {
         */
         
         this.runInInterceptorAndValidate(inDoc,
-                inPolicy, assertedInAssertions,
-                assertedOutAssertions, types);
+                inPolicy, inAssertions.getAssertedAssertions(),
+                inAssertions.getNotAssertedAssertions(), types);
     }
     
     private void runInInterceptorAndValidate(String document,
@@ -790,6 +924,28 @@ public class PolicyBasedWss4JInOutTest extends AbstractSecurityTest {
 
         public void setOutFaultObserver(MessageObserver observer) {            
         }
+    }
+    
+    /**
+     * A simple container used to reduce argument numbers to satisfy
+     * project code conventions.
+     */
+    private static final class AssertionsHolder {
+        private List<QName> assertedAssertions;
+        private List<QName> notAssertedAssertions;
+        
+        public AssertionsHolder(List<QName> assertedAssertions,
+                List<QName> notAssertedAssertions) {
+            super();
+            this.assertedAssertions = assertedAssertions;
+            this.notAssertedAssertions = notAssertedAssertions;
+        }
         
+        public List<QName> getAssertedAssertions() {
+            return this.assertedAssertions;
+        }
+        public List<QName> getNotAssertedAssertions() {
+            return this.notAssertedAssertions;
+        }
     }
 }
diff --git a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_direct_ref.xml b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_direct_ref.xml
new file mode 100644
index 0000000000..5b15d0a635
--- /dev/null
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_direct_ref.xml
@@ -0,0 +1,48 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<wsp:Policy 
+    xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" 
+    xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
+  <wsp:ExactlyOne>
+    <wsp:All>
+      <sp:AsymmetricBinding>
+        <wsp:Policy>
+          <sp:InitiatorToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireEmbeddedTokenReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:InitiatorToken>
+          <sp:RecipientToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireEmbeddedTokenReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:RecipientToken>
+          <sp:Layout>
+            <wsp:Policy>
+              <sp:Strict />
+            </wsp:Policy>
+          </sp:Layout>
+          <sp:IncludeTimestamp />
+          <sp:ProtectTokens/>
+          <sp:AlgorithmSuite>
+            <wsp:Policy>
+              <sp:Basic256 />
+            </wsp:Policy>
+          </sp:AlgorithmSuite>
+        </wsp:Policy>
+      </sp:AsymmetricBinding>
+      <sp:SignedParts>
+        <sp:Body/>
+      </sp:SignedParts>  
+    </wsp:All>
+  </wsp:ExactlyOne>
+</wsp:Policy>
diff --git a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_direct_ref_complement.xml b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_direct_ref_complement.xml
new file mode 100644
index 0000000000..8d6199661e
--- /dev/null
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_direct_ref_complement.xml
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<wsp:Policy 
+    xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" 
+    xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"
+    xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
+  <wsp:ExactlyOne>
+    <wsp:All>
+      <sp:AsymmetricBinding>
+        <wsp:Policy>
+          <sp:InitiatorToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireEmbeddedTokenReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:InitiatorToken>
+          <sp:RecipientToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireEmbeddedTokenReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:RecipientToken>
+          <sp:Layout>
+            <wsp:Policy>
+              <sp:Strict />
+            </wsp:Policy>
+          </sp:Layout>
+          <sp:AlgorithmSuite>
+            <wsp:Policy>
+              <sp:Basic256 />
+            </wsp:Policy>
+          </sp:AlgorithmSuite>
+        </wsp:Policy>
+      </sp:AsymmetricBinding>
+      <sp:SignedElements>
+        <sp:XPath>//wsse:BinarySecurityToken</sp:XPath>
+      </sp:SignedElements>
+      <sp:SignedParts>
+        <sp:Body/>
+      </sp:SignedParts>  
+    </wsp:All>
+  </wsp:ExactlyOne>
+</wsp:Policy>
diff --git a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_issuer_serial.xml b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_issuer_serial.xml
new file mode 100644
index 0000000000..4d67e97d78
--- /dev/null
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_issuer_serial.xml
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<wsp:Policy 
+    xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" 
+    xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
+  <wsp:ExactlyOne>
+    <wsp:All>
+      <sp:AsymmetricBinding>
+        <wsp:Policy>
+          <sp:InitiatorToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireIssuerSerialReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:InitiatorToken>
+          <sp:RecipientToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireIssuerSerialReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:RecipientToken>
+          <sp:Layout>
+            <wsp:Policy>
+              <sp:Strict />
+            </wsp:Policy>
+          </sp:Layout>
+          <sp:ProtectTokens/>
+          <sp:AlgorithmSuite>
+            <wsp:Policy>
+              <sp:Basic256 />
+            </wsp:Policy>
+          </sp:AlgorithmSuite>
+        </wsp:Policy>
+      </sp:AsymmetricBinding>
+      <sp:SignedParts>
+        <sp:Body/>
+      </sp:SignedParts>  
+    </wsp:All>
+  </wsp:ExactlyOne>
+</wsp:Policy>
diff --git a/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_issuer_serial_complement.xml b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_issuer_serial_complement.xml
new file mode 100644
index 0000000000..9317fe57d7
--- /dev/null
+++ b/rt/ws/security/src/test/java/org/apache/cxf/ws/security/wss4j/protect_token_policy_asym_x509_issuer_serial_complement.xml
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<wsp:Policy 
+    xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" 
+    xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"
+    xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
+  <wsp:ExactlyOne>
+    <wsp:All>
+      <sp:AsymmetricBinding>
+        <wsp:Policy>
+          <sp:InitiatorToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireEmbeddedTokenReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:InitiatorToken>
+          <sp:RecipientToken>
+            <wsp:Policy>
+              <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always">
+                <wsp:Policy>
+                  <sp:WssX509V3Token10 />
+                  <sp:RequireEmbeddedTokenReference />
+                </wsp:Policy>
+              </sp:X509Token>
+            </wsp:Policy>
+          </sp:RecipientToken>
+          <sp:Layout>
+            <wsp:Policy>
+              <sp:Strict />
+            </wsp:Policy>
+          </sp:Layout>
+          <sp:AlgorithmSuite>
+            <wsp:Policy>
+              <sp:Basic256 />
+            </wsp:Policy>
+          </sp:AlgorithmSuite>
+        </wsp:Policy>
+      </sp:AsymmetricBinding>
+      <sp:SignedElements>
+        <sp:XPath>//wsse:KeyInfo</sp:XPath>
+      </sp:SignedElements>
+      <sp:SignedParts>
+        <sp:Body/>
+      </sp:SignedParts>  
+    </wsp:All>
+  </wsp:ExactlyOne>
+</wsp:Policy>
