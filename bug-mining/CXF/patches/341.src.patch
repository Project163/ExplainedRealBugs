diff --git a/api/src/main/java/org/apache/cxf/tools/common/ToolConstants.java b/api/src/main/java/org/apache/cxf/tools/common/ToolConstants.java
index 2366574945..3d2b5d14e8 100644
--- a/api/src/main/java/org/apache/cxf/tools/common/ToolConstants.java
+++ b/api/src/main/java/org/apache/cxf/tools/common/ToolConstants.java
@@ -89,6 +89,7 @@ public final class ToolConstants {
     public static final String CFG_LIB_REF = "library.references";
     public static final String CFG_ANT_PROP = "ant.prop";
     public static final String CFG_NO_ADDRESS_BINDING = "noAddressBinding";
+    public static final String CFG_ALLOW_ELEMENT_REFS = "allowElementReferences";
 
 
 
@@ -107,7 +108,6 @@ public final class ToolConstants {
     public static final String CFG_GEN_NEW_ONLY = "newonly";
 
     // Java2WSDL Constants
-
     public static final String CFG_CLASSPATH = "classpath";
     public static final String CFG_TNS = "tns";
     public static final String CFG_SERVICENAME = "servicename";
diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java
index cab9be1d5e..3aa0db9f8d 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/Option.java
@@ -140,6 +140,11 @@ public class Option {
      * Disable generation of service address binding in the generated Java classes
      */
     boolean noAddressBinding;
+    
+    /**
+     * Allow element references when determining if an operation can be unwrapped or not 
+     */
+    boolean allowElementRefs;
 
 
     public Option() {
@@ -315,6 +320,14 @@ public class Option {
         this.noAddressBinding = noAddressBinding;
     }
 
+    public boolean isAllowElementRefs() {
+        return allowElementRefs;
+    }
+
+    public void setAllowElementRefs(boolean allowElementRefs) {
+        this.allowElementRefs = allowElementRefs;
+    }
+
     public void copyOptions(Option destination) {
         destination.setAutoNameResolution(isAutoNameResolution());
         destination.setBindingFiles(getBindingFiles());
@@ -333,6 +346,7 @@ public class Option {
         destination.setPackagenames(getPackagenames());
         destination.setServiceName(getServiceName());
         destination.setValidateWsdl(isValidateWsdl());
+        destination.setAllowElementRefs(isAllowElementRefs());
         if (isSetWsdlLocation()) {
             destination.setWsdlLocation(getWsdlLocation());
         }
diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java
index f113b2b909..c7a01a9967 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/WSDL2JavaMojo.java
@@ -422,6 +422,10 @@ public class WSDL2JavaMojo extends AbstractMojo {
         }
         if (wsdlOption.isExtendedSoapHeaders()) {
             list.add("-exsh");
+            list.add("true");
+        }
+        if (wsdlOption.isAllowElementRefs()) {
+            list.add("-allowElementRefs");
         }
         if (wsdlOption.isValidateWsdl()) {
             list.add("-validate");
diff --git a/rt/core/src/main/java/org/apache/cxf/wsdl11/WSDLServiceBuilder.java b/rt/core/src/main/java/org/apache/cxf/wsdl11/WSDLServiceBuilder.java
index bc6f82e3ef..c3e004de79 100644
--- a/rt/core/src/main/java/org/apache/cxf/wsdl11/WSDLServiceBuilder.java
+++ b/rt/core/src/main/java/org/apache/cxf/wsdl11/WSDLServiceBuilder.java
@@ -104,6 +104,7 @@ public class WSDLServiceBuilder {
     private Bus bus;
     private Map<String, Element> schemaList = new HashMap<String, Element>();
     private boolean recordOriginal = true;
+    private boolean allowRefs;
     private boolean ignoreUnknownBindings;
 
     public WSDLServiceBuilder(Bus bus) {
@@ -117,6 +118,9 @@ public class WSDLServiceBuilder {
     public void setIgnoreUnknownBindings(boolean b) {
         ignoreUnknownBindings = b;
     }
+    public void setAllowElementRefs(boolean b) {
+        allowRefs = b;
+    }
     
     private void copyExtensors(AbstractPropertiesHolder info, List<?> extList) {
         if (info != null) {
@@ -599,10 +603,13 @@ public class WSDLServiceBuilder {
             copyExtensors(finfo, entry.getValue().getExtensibilityElements());
             copyExtensionAttributes(finfo, entry.getValue());
         }
-        checkForWrapped(opInfo, false);
+        checkForWrapped(opInfo, allowRefs, false);
     }
 
     public static void checkForWrapped(OperationInfo opInfo, boolean relaxed) {
+        checkForWrapped(opInfo, relaxed, relaxed);
+    }
+    public static void checkForWrapped(OperationInfo opInfo, boolean allowRefs, boolean relaxed) {
         MessageInfo inputMessage = opInfo.getInput();
         MessageInfo outputMessage = opInfo.getOutput();
         boolean passedRule = true;
@@ -676,7 +683,7 @@ public class WSDLServiceBuilder {
             if (hasAttributes(xsct)
                 || (inputEl.isNillable() && !relaxed)
                 || !isWrappableSequence(xsct, inputEl.getQName().getNamespaceURI(),
-                                        unwrappedInput, relaxed)) {
+                                        unwrappedInput, allowRefs)) {
                 passedRule = false;
             }
         } else {
@@ -698,7 +705,7 @@ public class WSDLServiceBuilder {
                 if (hasAttributes(xsct)
                     || (outputEl.isNillable() && !relaxed)
                     || !isWrappableSequence(xsct, outputEl.getQName().getNamespaceURI(), unwrappedOutput,
-                                            relaxed)) {
+                                            allowRefs)) {
                     passedRule = false;
                 }
             } else {
diff --git a/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJavaContainer.java b/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJavaContainer.java
index 44556ded10..a4c5da6a53 100644
--- a/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJavaContainer.java
+++ b/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJavaContainer.java
@@ -167,6 +167,17 @@ public class WSDLToJavaContainer extends AbstractCXFToolContainer {
 
                 WSDLServiceBuilder serviceBuilder = new WSDLServiceBuilder(getBus());
                 serviceBuilder.setIgnoreUnknownBindings(true);
+                String allowRefs = (String)context.get(ToolConstants.CFG_ALLOW_ELEMENT_REFS);
+                if (!StringUtils.isEmpty(allowRefs) 
+                    || context.optionSet(ToolConstants.CFG_ALLOW_ELEMENT_REFS)) {
+                    if (allowRefs.length() > 0 && allowRefs.charAt(0) == '=') {
+                        allowRefs = allowRefs.substring(1);
+                    }
+                    if (StringUtils.isEmpty(allowRefs)) {
+                        allowRefs = "true";
+                    }
+                    serviceBuilder.setAllowElementRefs(Boolean.valueOf(allowRefs));
+                }
                 String serviceName = (String)context.get(ToolConstants.CFG_SERVICENAME);
 
                 if (serviceName != null) {
diff --git a/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/jaxws-toolspec.xml b/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/jaxws-toolspec.xml
index e776aa888b..d1fdeeddaa 100644
--- a/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/jaxws-toolspec.xml
+++ b/tools/wsdlto/frontend/jaxws/src/main/java/org/apache/cxf/tools/wsdlto/frontend/jaxws/jaxws-toolspec.xml
@@ -171,6 +171,17 @@ Examples:
                 </annotation>
                 <switch>autoNameResolution</switch>
             </option>
+            
+            <option id="allowElementReferences" maxOccurs="1">
+            	<annotaion>
+            	</annotaion>
+            	<associatedArgument placement="immediate">
+                    <annotation>=true</annotation>
+                    <valueenum>true|false</valueenum>
+                </associatedArgument>
+            	<switch>allowElementReferences</switch>
+            	<switch>aer</switch>
+            </option>
 
 	        <option id="defaultValues" maxOccurs="1">
                 <annotation>
