diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/MappingsHandler.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/SystemQueryHandler.java
similarity index 75%
rename from rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/MappingsHandler.java
rename to rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/SystemQueryHandler.java
index c572b29949..fb2c4574db 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/MappingsHandler.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/ext/SystemQueryHandler.java
@@ -24,15 +24,17 @@ import java.util.Map;
 
 import javax.ws.rs.core.MultivaluedMap;
 import javax.ws.rs.core.Response;
-import javax.ws.rs.core.UriInfo;
 
 import org.apache.cxf.jaxrs.impl.UriInfoImpl;
 import org.apache.cxf.jaxrs.model.ClassResourceInfo;
 import org.apache.cxf.message.Message;
 
-public class MappingsHandler implements RequestHandler {
+public class SystemQueryHandler implements RequestHandler {
 
     private static final String CONTENT_QUERY = "_type";
+    private static final String METHOD_QUERY = "_method";
+    
+    
     private static final Map<String, String> SHORTCUTS;
     static {
         SHORTCUTS = new HashMap<String, String>();
@@ -44,24 +46,28 @@ public class MappingsHandler implements RequestHandler {
     
     public Response handleRequest(Message m, ClassResourceInfo resourceClass) {
         
-        UriInfo uriInfo = new UriInfoImpl(m, null);
-        handleTypeQuery(m, uriInfo.getQueryParameters());
-        
+        MultivaluedMap<String, String> queries = new UriInfoImpl(m, null).getQueryParameters();
+        handleTypeQuery(m, queries);
+        handleMethodQuery(m, queries);
         
         return null;
     }
 
-    private boolean handleTypeQuery(Message m, 
-                                    MultivaluedMap<String, String> queries) {
+    private void handleMethodQuery(Message m, MultivaluedMap<String, String> queries) {
+        String method = queries.getFirst(METHOD_QUERY);
+        if (method != null) {
+            m.put(Message.HTTP_REQUEST_METHOD, method);
+        }
+    }
+    
+    private void handleTypeQuery(Message m, MultivaluedMap<String, String> queries) {
         String type = queries.getFirst(CONTENT_QUERY);
         if (type != null) {
             if (SHORTCUTS.containsKey(type)) {
                 type = SHORTCUTS.get(type);
             }
             updateAcceptTypeHeader(m, type);
-            return true;
         }
-        return false;
     }
     
     private void updateAcceptTypeHeader(Message m, String anotherValue) {
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProvider.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProvider.java
index 95a148236e..5db9ca449a 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProvider.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProvider.java
@@ -22,6 +22,7 @@ package org.apache.cxf.jaxrs.impl;
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
+import java.util.Map;
 
 import javax.ws.rs.core.CacheControl;
 import javax.ws.rs.ext.RuntimeDelegate.HeaderDelegate;
@@ -93,27 +94,13 @@ public class CacheControlHeaderProvider implements HeaderDelegate<CacheControl>
 
     public String toString(CacheControl c) {
         StringBuilder sb = new StringBuilder();
-        if (!c.isPrivate()) {
-            sb.append(PUBLIC).append(';');
-        } else {
-            sb.append(PRIVATE).append('=');
-            for (Iterator<String> it = c.getPrivateFields().iterator(); it.hasNext();) {
-                sb.append('\"').append(it.next()).append('\"');
-                if (it.hasNext()) {
-                    sb.append(',');
-                }
-            }
-            sb.append(';');
+        if (c.isPrivate()) {
+            sb.append(PRIVATE);
+            handleFields(c.getPrivateFields(), sb);
         }
         if (c.isNoCache()) {
-            sb.append(NO_CACHE).append('=');
-            for (Iterator<String> it = c.getNoCacheFields().iterator(); it.hasNext();) {
-                sb.append('\"').append(it.next()).append('\"');
-                if (it.hasNext()) {
-                    sb.append(',');
-                }
-            }
-            sb.append(';');
+            sb.append(NO_CACHE);
+            handleFields(c.getNoCacheFields(), sb);
         }
         if (c.isNoStore()) {
             sb.append(NO_STORE).append(';');
@@ -133,6 +120,20 @@ public class CacheControlHeaderProvider implements HeaderDelegate<CacheControl>
         if (c.getSMaxAge() != -1) {
             sb.append(SMAX_AGE).append('=').append(c.getSMaxAge()).append(';');
         }
+        Map<String, String> exts = c.getCacheExtension();
+        for (Map.Entry<String, String> entry : exts.entrySet()) {
+            sb.append(entry.getKey());
+            String v = entry.getValue();
+            if (v != null) {
+                sb.append("=");
+                if (v.indexOf(' ') != -1) {
+                    sb.append('\"').append(v).append('\"');
+                } else {
+                    sb.append(v);
+                }
+            }
+            sb.append(';');
+        }
         String s = sb.toString();
         return s.endsWith(";") ? s.substring(0, s.length() - 1) : s; 
     }
@@ -153,4 +154,16 @@ public class CacheControlHeaderProvider implements HeaderDelegate<CacheControl>
         }
     }
 
+    private static void handleFields(List<String> fields, StringBuilder sb) {
+        if (!fields.isEmpty()) {
+            sb.append('=');
+        }
+        for (Iterator<String> it = fields.iterator(); it.hasNext();) {
+            sb.append('\"').append(it.next()).append('\"');
+            if (it.hasNext()) {
+                sb.append(',');
+            }
+        }
+        sb.append(';');
+    }
 }
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/RequestPreprocessor.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/RequestPreprocessor.java
index 5519a0ec8e..e9dd1ce7f6 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/RequestPreprocessor.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/impl/RequestPreprocessor.java
@@ -25,6 +25,7 @@ import java.util.Map;
 
 import javax.ws.rs.core.UriInfo;
 
+import org.apache.cxf.jaxrs.utils.HttpUtils;
 import org.apache.cxf.message.Message;
 
 public class RequestPreprocessor {
@@ -88,7 +89,8 @@ public class RequestPreprocessor {
     
     private void updatePath(Message m, String path, String suffix) {
         String newPath = path.substring(0, path.length() - (suffix.length() + 1));
-        m.put(Message.REQUEST_URI, newPath);
+        HttpUtils.updatePath(m, newPath);
+        //m.put(Message.REQUEST_URI, newPath);
     }
     
 }
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java
index f792402e37..0965e7e459 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java
@@ -38,10 +38,10 @@ import javax.ws.rs.ext.MessageBodyReader;
 import javax.ws.rs.ext.MessageBodyWriter;
 
 import org.apache.cxf.jaxrs.client.ResponseExceptionMapper;
-import org.apache.cxf.jaxrs.ext.MappingsHandler;
 import org.apache.cxf.jaxrs.ext.ParameterHandler;
 import org.apache.cxf.jaxrs.ext.RequestHandler;
 import org.apache.cxf.jaxrs.ext.ResponseHandler;
+import org.apache.cxf.jaxrs.ext.SystemQueryHandler;
 import org.apache.cxf.jaxrs.impl.RequestPreprocessor;
 import org.apache.cxf.jaxrs.impl.WebApplicationExceptionMapper;
 import org.apache.cxf.jaxrs.model.ProviderInfo;
@@ -66,7 +66,7 @@ public final class ProviderFactory {
                                     new PrimitiveTextProvider(),
                                     new ActivationProvider(),
                                     new WebApplicationExceptionMapper(),
-                                    new MappingsHandler());
+                                    new SystemQueryHandler());
     }
     
     private List<ProviderInfo<MessageBodyReader>> messageReaders = 
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/HttpUtils.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/HttpUtils.java
index f9a90e7602..e4641f69a2 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/HttpUtils.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/HttpUtils.java
@@ -103,6 +103,19 @@ public final class HttpUtils {
         return address;
     }
     
+    public static void updatePath(Message m, String path) {
+        String baseAddress = getBaseAddress(m);
+        boolean pathSlash = path.startsWith("/");
+        boolean baseSlash = baseAddress.endsWith("/");
+        if (pathSlash && baseSlash) {
+            path = path.substring(1);
+        } else if (!pathSlash && !baseSlash) {
+            path = "/" + path;
+        }
+        m.put(Message.REQUEST_URI, baseAddress + path);
+    }
+
+    
     public static String getPathToMatch(String path, String address, boolean addSlash) {
         
         int ind = path.indexOf(address);
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/JAXRSUtils.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/JAXRSUtils.java
index e3bc4e94d4..f2f851a2dc 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/JAXRSUtils.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/utils/JAXRSUtils.java
@@ -594,6 +594,9 @@ public final class JAXRSUtils {
                                              String defaultValue) {
         
         List<String> values = new HttpHeadersImpl(m).getRequestHeader(header);
+        if (values != null && values.isEmpty()) {
+            values = null;
+        }
         String basePath = HttpUtils.getOriginalAddress(m);
         return InjectionUtils.createParameterObject(values, 
                                                     pClass, 
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/ext/SystemQueryHandlerTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/ext/SystemQueryHandlerTest.java
new file mode 100644
index 0000000000..845b84f688
--- /dev/null
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/ext/SystemQueryHandlerTest.java
@@ -0,0 +1,41 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+package org.apache.cxf.jaxrs.ext;
+
+import org.apache.cxf.message.Message;
+import org.apache.cxf.message.MessageImpl;
+
+import org.junit.Assert;
+import org.junit.Test;
+
+public class SystemQueryHandlerTest extends Assert {
+
+    @Test
+    public void testMethodQuery() {
+        Message m = new MessageImpl();
+        m.put(Message.HTTP_REQUEST_METHOD, "POST");
+        m.put(Message.QUERY_STRING, "_method=GET");
+        
+        SystemQueryHandler sqh = new SystemQueryHandler();
+        sqh.handleRequest(m, null);
+        assertEquals("GET", m.get(Message.HTTP_REQUEST_METHOD));
+    }
+    
+}
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProviderTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProviderTest.java
index c04cf39b60..2febc641d7 100644
--- a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProviderTest.java
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/impl/CacheControlHeaderProviderTest.java
@@ -61,4 +61,31 @@ public class CacheControlHeaderProviderTest extends Assert {
         String parsed = CacheControl.valueOf(s).toString();
         assertEquals(s, parsed);       
     }
+    
+    @Test
+    public void testNoCacheEnabled() {
+        CacheControl cc = new CacheControl();
+        cc.setNoCache(true);
+        assertEquals("no-cache;no-transform", cc.toString());
+    }
+    
+    @Test
+    public void testNoCacheDisabled() {
+        CacheControl cc = new CacheControl();
+        cc.setNoCache(false);
+        assertEquals("no-transform", cc.toString());
+    }
+    
+    @Test
+    public void testCacheExtensionToString() {
+        CacheControl cc = new CacheControl();
+        cc.getCacheExtension().put("ext1", null);
+        cc.getCacheExtension().put("ext2", "value2");
+        cc.getCacheExtension().put("ext3", "value 3");
+        String value = cc.toString();
+        assertTrue(value.indexOf("ext1") != -1 && value.indexOf("ext1=") == -1);
+        assertTrue(value.indexOf("ext2=value2") != -1);
+        assertTrue(value.indexOf("ext3=\"value 3\"") != -1);
+    }
+    
 }
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/utils/HttpUtilsTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/utils/HttpUtilsTest.java
index 09e9ed5360..1518dcd40a 100644
--- a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/utils/HttpUtilsTest.java
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/utils/HttpUtilsTest.java
@@ -21,13 +21,17 @@ package org.apache.cxf.jaxrs.utils;
 
 import javax.ws.rs.core.Response;
 
+import org.apache.cxf.message.ExchangeImpl;
+import org.apache.cxf.message.Message;
+import org.apache.cxf.message.MessageImpl;
+
 import org.junit.Assert;
 import org.junit.Test;
 
 public class HttpUtilsTest extends Assert {
 
     @Test
-    public void testUpdatePath() {
+    public void testPathToMatch() {
         assertEquals("/", HttpUtils.getPathToMatch("/", "/", true));
         assertEquals("/", HttpUtils.getPathToMatch("/", "/bar", true));
         assertEquals("/bar", HttpUtils.getPathToMatch("/bar", "/", true));
@@ -38,6 +42,24 @@ public class HttpUtilsTest extends Assert {
         
     }
     
+    @Test
+    public void testUpdatePath() {
+        
+        Message m = new MessageImpl();
+        m.setExchange(new ExchangeImpl());
+        m.put(Message.ENDPOINT_ADDRESS, "http://localhost/");
+        HttpUtils.updatePath(m, "/bar");
+        assertEquals("/bar", m.get(Message.REQUEST_URI));
+        HttpUtils.updatePath(m, "bar");
+        assertEquals("/bar", m.get(Message.REQUEST_URI));
+        HttpUtils.updatePath(m, "bar/");
+        assertEquals("/bar/", m.get(Message.REQUEST_URI));
+        m.put(Message.ENDPOINT_ADDRESS, "http://localhost");
+        HttpUtils.updatePath(m, "bar/");
+        assertEquals("/bar/", m.get(Message.REQUEST_URI));
+    }
+    
+    
     @Test
     public void testParameterErrorStatus() {
         assertEquals(Response.Status.NOT_FOUND,
diff --git a/rt/transports/http/src/main/java/org/apache/cxf/transport/servlet/ServletController.java b/rt/transports/http/src/main/java/org/apache/cxf/transport/servlet/ServletController.java
index c423ecfe3e..a54a072028 100644
--- a/rt/transports/http/src/main/java/org/apache/cxf/transport/servlet/ServletController.java
+++ b/rt/transports/http/src/main/java/org/apache/cxf/transport/servlet/ServletController.java
@@ -239,7 +239,8 @@ public class ServletController {
                 response.getWriter().write("<table " + (serviceListStyleSheet == null
                         ? "cellpadding=\"1\" cellspacing=\"1\" border=\"1\" width=\"100%\"" : "") + ">");
                 for (ServletDestination sd : destinations) {
-                    if (null != sd.getEndpointInfo().getName()) {
+                    if (null != sd.getEndpointInfo().getName() 
+                        && null != sd.getEndpointInfo().getInterface()) {
                         response.getWriter().write("<tr><td>");
                         response.getWriter().write("<span class=\"porttypename\">"
                                 + sd.getEndpointInfo().getInterface().getName().getLocalPart()
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore.java
index 99202a2327..d8c031c5b3 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore.java
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore.java
@@ -47,10 +47,10 @@ import org.apache.abdera.model.Feed;
 import org.apache.cxf.customer.book.BookNotFoundDetails;
 import org.apache.cxf.customer.book.BookNotFoundFault;
 
-@Path("/bookstore/")
+@Path("/")
 public class AtomBookStore {
 
-    @Context private UriInfo uField;
+    @Context protected UriInfo uField;
     private HttpHeaders headers;
     private Map<Long, Book> books = new HashMap<Long, Book>();
     private Map<Long, CD> cds = new HashMap<Long, CD>();
@@ -124,7 +124,7 @@ public class AtomBookStore {
             // this code is broken as Response does not
             
             URI uri = 
-                uField.getBaseUriBuilder().path("bookstore").path("books").path("entries") 
+                uField.getBaseUriBuilder().path("books").path("entries") 
                                                 .path(Long.toString(b.getId())).build();
             return Response.created(uri).entity(e).build();
         } catch (Exception ex) {
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore2.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore2.java
index e27957865f..b8fde19928 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore2.java
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore2.java
@@ -40,6 +40,11 @@ public class AtomBookStore2 extends AtomBookStore {
         return super.getBooksAsFeed(uParam);
         
     }
+    
+    @Context
+    public void setUriInfo(UriInfo ui) {
+        super.uField = ui;
+    }
 }
 
 
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore3.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore3.java
new file mode 100644
index 0000000000..abccc0e56f
--- /dev/null
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/AtomBookStore3.java
@@ -0,0 +1,37 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+
+package org.apache.cxf.systest.jaxrs;
+
+
+import javax.ws.rs.Path;
+import javax.ws.rs.core.Context;
+import javax.ws.rs.core.UriInfo;
+
+@Path("/atom")
+public class AtomBookStore3 extends AtomBookStore {
+    
+    @Context
+    public void setUriInfo(UriInfo ui) {
+        super.uField = ui;
+    }
+}
+
+
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java
index af042f9555..13201d25cc 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/BookStore.java
@@ -173,6 +173,14 @@ public class BookStore {
         return doGetBook(ids.get(0) + ids.get(1) + ids.get(2));
     }
     
+    @GET
+    @Path("/bookheaders2/")
+    public Book getBookByHeader(@DefaultValue("123") @HeaderParam("BOOK2") String id) 
+        throws Exception {
+        return doGetBook(id);
+    }
+    
+    
     @GET
     @Path("/bookquery")
     public Book getBookByURLQuery(@QueryParam("urlid") String urlValue) throws Exception {
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSAtomBookTest.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSAtomBookTest.java
index aed87e3fdc..dd6bfc38d1 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSAtomBookTest.java
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSAtomBookTest.java
@@ -38,6 +38,7 @@ import org.apache.cxf.helpers.IOUtils;
 import org.apache.cxf.io.CachedOutputStream;
 import org.apache.cxf.testutil.common.AbstractBusClientServerTestBase;
 import org.codehaus.jettison.json.JSONObject;
+
 import org.junit.BeforeClass;
 import org.junit.Test;
 
@@ -54,17 +55,17 @@ public class JAXRSAtomBookTest extends AbstractBusClientServerTestBase {
     @Test
     public void testGetBooks() throws Exception {
         String endpointAddress =
-            "http://localhost:9080/bookstore/books/feed"; 
+            "http://localhost:9080/bookstore/bookstore/books/feed"; 
         Feed feed = getFeed(endpointAddress, null);
-        assertEquals("http://localhost:9080/bookstore/books/feed", 
+        assertEquals("http://localhost:9080/bookstore/bookstore/books/feed", 
                      feed.getBaseUri().toString());
         assertEquals("Collection of Books", feed.getTitle());
         
-        getAndCompareJson("http://localhost:9080/bookstore/books/feed",
+        getAndCompareJson("http://localhost:9080/bookstore/bookstore/books/feed",
                                "resources/expected_atom_books_json.txt",
                                "application/json");
         
-        getAndCompareJson("http://localhost:9080/bookstore/books/jsonfeed",
+        getAndCompareJson("http://localhost:9080/bookstore/bookstore/books/jsonfeed",
                           "resources/expected_atom_books_jsonfeed.txt",
                           "application/json, text/html, application/xml;q=0.9,"
                           + " application/xhtml+xml, image/png, image/jpeg, image/gif,"
@@ -97,25 +98,25 @@ public class JAXRSAtomBookTest extends AbstractBusClientServerTestBase {
         
         
         endpointAddress =
-            "http://localhost:9080/bookstore/books/subresources/123"; 
+            "http://localhost:9080/bookstore/bookstore/books/subresources/123"; 
         entry = getEntry(endpointAddress, null);
         assertEquals("CXF in Action", entry.getTitle());
         
-        getAndCompareJson("http://localhost:9080/bookstore/books/entries/123",
+        getAndCompareJson("http://localhost:9080/bookstore/bookstore/books/entries/123",
                                "resources/expected_atom_book_json.txt",
                                "application/json");
         
-        getAndCompareJson("http://localhost:9080/bookstore/books/entries/123?_type="
+        getAndCompareJson("http://localhost:9080/bookstore/bookstore/books/entries/123?_type="
                                + "application/json",
                                "resources/expected_atom_book_json.txt",
                                "*/*");
-        getAndCompareJson("http://localhost:9080/bookstore/books/entries/123?_type="
+        getAndCompareJson("http://localhost:9080/bookstore/bookstore/books/entries/123?_type="
                                + "json",
                                "resources/expected_atom_book_json.txt",
                                "*/*");
         
         // do the same using extension mappings
-        getAndCompareJson("http://localhost:9080/bookstore/books/entries/123.json",
+        getAndCompareJson("http://localhost:9080/bookstore/bookstore/books/entries/123.json",
                                "resources/expected_atom_book_json.txt",
                                "*/*");
         
@@ -125,11 +126,22 @@ public class JAXRSAtomBookTest extends AbstractBusClientServerTestBase {
     @Test
     public void testGetBooks2() throws Exception {
         String endpointAddress =
-            "http://localhost:9080"; 
+            "http://localhost:9080/bookstore/sub/"; 
         Feed feed = getFeed(endpointAddress, null);
-        assertEquals("http://localhost:9080/", 
+        assertEquals("http://localhost:9080/bookstore/sub/", 
                      feed.getBaseUri().toString());
         assertEquals("Collection of Books", feed.getTitle());
+        
+        getAndCompareJson("http://localhost:9080/bookstore/sub/books/entries/123.json",
+                        "resources/expected_atom_book_json2.txt",
+                        "*/*");
+    }
+    
+    @Test
+    public void testGetBooks3() throws Exception {
+        getAndCompareJson("http://localhost:9080/atom/atom/books/entries/123.json",
+                        "resources/expected_atom_book_json3.txt",
+                        "*/*");
     }
     
     private void getAndCompareJson(String address, 
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSClientServerBookTest.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSClientServerBookTest.java
index 7b4acb2324..31b43f8305 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSClientServerBookTest.java
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSClientServerBookTest.java
@@ -285,6 +285,13 @@ public class JAXRSClientServerBookTest extends AbstractBusClientServerTestBase {
                                "application/xml;q=0.5,text/xml", 200);
     }
     
+    @Test
+    public void testGetBookByHeaderDefault() throws Exception {
+        getAndCompareAsStrings("http://localhost:9080/bookstore/bookheaders2",
+                               "resources/expected_get_book123.txt",
+                               "application/xml;q=0.5,text/xml", 200);
+    }
+    
     @Test
     public void testGetBookElement() throws Exception {
         getAndCompareAsStrings("http://localhost:9080/bookstore/books/element",
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSMultipartTest.java b/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSMultipartTest.java
index 483682d155..fb1995ab5c 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSMultipartTest.java
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSMultipartTest.java
@@ -189,7 +189,7 @@ public class JAXRSMultipartTest extends AbstractBusClientServerTestBase {
             + "boundary=\"----=_Part_4_701508.1145579811786\"";
         post.setRequestHeader("Content-Type", ct);
         InputStream is = 
-            getClass().getResourceAsStream("/org/apache/cxf/systest/jaxrs/" + resourceName);
+            getClass().getResourceAsStream("/org/apache/cxf/systest/jaxrs/resources/" + resourceName);
         RequestEntity entity = new InputStreamRequestEntity(is);
         post.setRequestEntity(entity);
         HttpClient httpclient = new HttpClient();
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentData b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentData
similarity index 100%
rename from systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentData
rename to systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentData
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentData2 b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentData2
similarity index 100%
rename from systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentData2
rename to systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentData2
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentData3 b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentData3
similarity index 100%
rename from systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentData3
rename to systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentData3
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentForm b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentForm
similarity index 100%
rename from systests/src/test/java/org/apache/cxf/systest/jaxrs/attachmentForm
rename to systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/attachmentForm
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/book.xsd b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/book.xsd
similarity index 100%
rename from systests/src/test/java/org/apache/cxf/systest/jaxrs/book.xsd
rename to systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/book.xsd
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/bookid.xsd b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/bookid.xsd
similarity index 99%
rename from systests/src/test/java/org/apache/cxf/systest/jaxrs/bookid.xsd
rename to systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/bookid.xsd
index 6c60aafdab..34ae2dc0f0 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/bookid.xsd
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/bookid.xsd
@@ -1,4 +1,4 @@
-<?xml version="1.0" encoding="UTF-8"?>
+<?xml version="1.0" encoding="UTF-8"?>
 <!--
   Licensed to the Apache Software Foundation (ASF) under one
   or more contributor license agreements. See the NOTICE file
@@ -16,11 +16,11 @@
   KIND, either express or implied. See the License for the
   specific language governing permissions and limitations
   under the License.
--->
-<schema xmlns="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://www.example.org/books/id" xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" targetNamespace="http://www.example.org/books/id">
-  
-
-     <simpleType name="bid">
-       <restriction base="xs:long"/>
-     </simpleType>
-  </schema>
+-->
+<schema xmlns="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://www.example.org/books/id" xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" targetNamespace="http://www.example.org/books/id">
+  
+
+     <simpleType name="bid">
+       <restriction base="xs:long"/>
+     </simpleType>
+  </schema>
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json.txt b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json.txt
index bcf0e2419d..9050783dbe 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json.txt
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json.txt
@@ -9,6 +9,6 @@
   ]
  },
  "attributes":{
-  "xml:base":"http://localhost:9080/bookstore/books/entries/123"
+  "xml:base":"http://localhost:9080/bookstore/bookstore/books/entries/123"
  }
 }
\ No newline at end of file
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json2.txt b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json2.txt
new file mode 100644
index 0000000000..3e1a9be814
--- /dev/null
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json2.txt
@@ -0,0 +1,14 @@
+{
+ "id":"123",
+ "title":"CXF in Action",
+ "content":{
+  "attributes":{
+   "type":"application/xml"
+  },
+  "children":["<Book><id>123<\/id><name>CXF in Action<\/name><\/Book>"
+  ]
+ },
+ "attributes":{
+  "xml:base":"http://localhost:9080/bookstore/sub/books/entries/123"
+ }
+}
\ No newline at end of file
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json3.txt b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json3.txt
new file mode 100644
index 0000000000..a8094aeb16
--- /dev/null
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_book_json3.txt
@@ -0,0 +1,14 @@
+{
+ "id":"123",
+ "title":"CXF in Action",
+ "content":{
+  "attributes":{
+   "type":"application/xml"
+  },
+  "children":["<Book><id>123<\/id><name>CXF in Action<\/name><\/Book>"
+  ]
+ },
+ "attributes":{
+  "xml:base":"http://localhost:9080/atom/atom/books/entries/123"
+ }
+}
\ No newline at end of file
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_json.txt b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_json.txt
index cb4ac765d2..80f53ad459 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_json.txt
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_json.txt
@@ -18,7 +18,7 @@
   }
  ],
  "attributes":{
-  "xml:base":"http://localhost:9080/bookstore/books/feed"
+  "xml:base":"http://localhost:9080/bookstore/bookstore/books/feed"
  }
 }
 
diff --git a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_jsonfeed.txt b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_jsonfeed.txt
index b56dbdee85..c955af95d4 100644
--- a/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_jsonfeed.txt
+++ b/systests/src/test/java/org/apache/cxf/systest/jaxrs/resources/expected_atom_books_jsonfeed.txt
@@ -18,7 +18,7 @@
   }
  ],
  "attributes":{
-  "xml:base":"http://localhost:9080/bookstore/books/jsonfeed"
+  "xml:base":"http://localhost:9080/bookstore/bookstore/books/jsonfeed"
  }
 }
 
diff --git a/systests/src/test/resources/jaxrs/WEB-INF/beans.xml b/systests/src/test/resources/jaxrs/WEB-INF/beans.xml
index 16183e9ce1..ae3a76c4eb 100644
--- a/systests/src/test/resources/jaxrs/WEB-INF/beans.xml
+++ b/systests/src/test/resources/jaxrs/WEB-INF/beans.xml
@@ -87,8 +87,8 @@ http://cxf.apache.org/schemas/jaxrs.xsd">
   </bean>
   
   <util:list id="theSchemas">
-    <value>classpath:/org/apache/cxf/systest/jaxrs/bookid.xsd</value>
-    <value>classpath:/org/apache/cxf/systest/jaxrs/book.xsd</value>
+    <value>classpath:/org/apache/cxf/systest/jaxrs/resources/bookid.xsd</value>
+    <value>classpath:/org/apache/cxf/systest/jaxrs/resources/book.xsd</value>
   </util:list>
   
   <util:list id="jsonTypes">
diff --git a/systests/src/test/resources/jaxrs_atom/WEB-INF/beans.xml b/systests/src/test/resources/jaxrs_atom/WEB-INF/beans.xml
index a60332d10e..d21eb003e2 100644
--- a/systests/src/test/resources/jaxrs_atom/WEB-INF/beans.xml
+++ b/systests/src/test/resources/jaxrs_atom/WEB-INF/beans.xml
@@ -39,22 +39,56 @@ http://cxf.apache.org/schemas/jaxrs.xsd">
   <import resource="classpath:META-INF/cxf/cxf-servlet.xml" />
   
   <jaxrs:server id="atomservice"
-		        address="/" 
+		        address="/bookstore" 
 		        staticSubresourceResolution="true">
     <jaxrs:serviceBeans>
       <ref bean="atomstore"/>
-      <ref bean="atomstore2"/>
     </jaxrs:serviceBeans>
     <jaxrs:providers>
-        <bean class="org.apache.cxf.jaxrs.provider.AtomFeedProvider"/>
-        <bean class="org.apache.cxf.jaxrs.provider.AtomEntryProvider"/>
+        <ref bean="feed"/>
+        <ref bean="entry"/>
     </jaxrs:providers>	
     <jaxrs:extensionMappings>
       <entry key="json" value="application/json"/>
     </jaxrs:extensionMappings>		   
   </jaxrs:server>
+  
+  <jaxrs:server id="atomservice2"
+		        address="/sub" 
+		        staticSubresourceResolution="true">
+    <jaxrs:serviceBeans>
+      <ref bean="atomstore2"/>
+    </jaxrs:serviceBeans>
+    <jaxrs:providers>
+        <ref bean="feed"/>
+        <ref bean="entry"/>
+    </jaxrs:providers>	
+    <jaxrs:extensionMappings>
+      <entry key="json" value="application/json"/>
+    </jaxrs:extensionMappings>	
+  </jaxrs:server>
+  
+  <jaxrs:server id="atomservice3"
+		        address="/">
+    <jaxrs:serviceBeans>
+      <ref bean="atomstore3"/>
+    </jaxrs:serviceBeans>
+    <jaxrs:providers>
+        <ref bean="feed"/>
+        <ref bean="entry"/>
+    </jaxrs:providers>	
+    <jaxrs:extensionMappings>
+      <entry key="json" value="application/json"/>
+    </jaxrs:extensionMappings>	
+  </jaxrs:server>
+  
   <bean id="atomstore" class="org.apache.cxf.systest.jaxrs.AtomBookStore"/>
   <bean id="atomstore2" class="org.apache.cxf.systest.jaxrs.AtomBookStore2"/>
+  <bean id="atomstore3" class="org.apache.cxf.systest.jaxrs.AtomBookStore3"/>
+  
+  <bean id="feed" class="org.apache.cxf.jaxrs.provider.AtomFeedProvider"/>
+  <bean id="entry" class="org.apache.cxf.jaxrs.provider.AtomEntryProvider"/>
+  
 </beans>
 <!-- END SNIPPET: beans -->
 
diff --git a/systests/src/test/resources/jaxrs_atom/WEB-INF/web.xml b/systests/src/test/resources/jaxrs_atom/WEB-INF/web.xml
index 1a5fad1252..c9e6de4e1d 100644
--- a/systests/src/test/resources/jaxrs_atom/WEB-INF/web.xml
+++ b/systests/src/test/resources/jaxrs_atom/WEB-INF/web.xml
@@ -44,7 +44,13 @@
 
 	<servlet-mapping>
 		<servlet-name>CXFServlet</servlet-name>
-		<url-pattern>/*</url-pattern>
+		<url-pattern>/bookstore/*</url-pattern>
 	</servlet-mapping>
+	
+	<servlet-mapping>
+		<servlet-name>CXFServlet</servlet-name>
+		<url-pattern>/atom/*</url-pattern>
+	</servlet-mapping>
+	
 </web-app>
 <!-- END SNIPPET: webxml -->
