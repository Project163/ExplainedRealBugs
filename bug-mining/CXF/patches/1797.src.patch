diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java
index aaf170f0f3..b5f09b692a 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java
@@ -613,7 +613,7 @@ public class WSS4JInInterceptor extends AbstractWSS4JInterceptor {
                     || WSConstants.WSS_KRB_KI_VALUE_TYPE.equals(pc.getType())) {
                     for (String tokenId : store.getTokenIdentifiers()) {
                         SecurityToken token = store.getToken(tokenId);
-                        if (id.equals(token.getSHA1())) {
+                        if (token != null && id.equals(token.getSHA1())) {
                             pc.setKey(token.getSecret());
                             return;
                         }
