diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/URITemplate.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/URITemplate.java
index 9f91dccbbc..b9fc5abca6 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/URITemplate.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/model/URITemplate.java
@@ -168,16 +168,23 @@ public final class URITemplate {
         }
 
         // Assign the matched template values to template variables
+        int groupCount = m.groupCount();
+        
         int i = 1;
         for (String name : variables) {
-            String value = m.group(i++);
-            templateVariableToValue.add(name, value);
+            while (i <= groupCount) {
+                String value = m.group(i++);
+                if (value == null || value.length() == 0) {
+                    continue;
+                }
+                templateVariableToValue.add(name, value);
+                break;
+            }
         }
         // The right hand side value, might be used to further resolve
         // sub-resources.
-        int groupCount = m.groupCount();
         
-        String finalGroup = m.group(groupCount);
+        String finalGroup = i > groupCount ? "/" : m.group(groupCount);
         templateVariableToValue.putSingle(FINAL_MATCH_GROUP, finalGroup == null ? "/" : finalGroup);
 
         return true;
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/model/URITemplateTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/model/URITemplateTest.java
index 918347ce16..af4bcbd887 100644
--- a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/model/URITemplateTest.java
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/model/URITemplateTest.java
@@ -270,6 +270,58 @@ public class URITemplateTest extends Assert {
         assertFalse(uriTemplate.match("/script.pdf", values));
     }
 
+    @Test
+    public void testExpressionWithNestedGroupAndTwoVars() throws Exception {
+        URITemplate uriTemplate = new URITemplate("/foo/{bar}/{resource:.+\\.(js|css|gif|png)}");
+        MultivaluedMap<String, String> values = new MetadataMap<String, String>();
+
+        assertTrue(uriTemplate.match("/foo/1/script.js", values));
+        assertEquals("1", values.getFirst("bar"));
+        assertEquals("script.js", values.getFirst("resource"));
+        String finalPath = values.getFirst(URITemplate.FINAL_MATCH_GROUP);
+        assertEquals("/", finalPath);
+    }
+    
+    @Test
+    public void testExpressionWithNestedGroupAndTwoVars2() throws Exception {
+        URITemplate uriTemplate = new URITemplate("/foo/{bar}{resource:(/format/[^/]+?)?}");
+        MultivaluedMap<String, String> values = new MetadataMap<String, String>();
+
+        assertTrue(uriTemplate.match("/foo/1/format", values));
+        assertEquals("1", values.getFirst("bar"));
+        assertEquals("/format", values.getFirst("resource"));
+        String finalPath = values.getFirst(URITemplate.FINAL_MATCH_GROUP);
+        assertEquals("/", finalPath);
+        values.clear();
+        
+        assertTrue(uriTemplate.match("/foo/1/format/2", values));
+        assertEquals("1", values.getFirst("bar"));
+        assertEquals("/format/2", values.getFirst("resource"));
+        finalPath = values.getFirst(URITemplate.FINAL_MATCH_GROUP);
+        assertEquals("/", finalPath);
+        values.clear();
+        
+        assertTrue(uriTemplate.match("/foo/1", values));
+        assertEquals("1", values.getFirst("bar"));
+        assertNull(values.getFirst("resource"));
+        finalPath = values.getFirst(URITemplate.FINAL_MATCH_GROUP);
+        assertEquals("/", finalPath);
+    }
+    
+    
+    @Test
+    public void testExpressionWithNestedGroupAndManySegments() throws Exception {
+        URITemplate uriTemplate = new URITemplate("/foo/{bar}{resource:(/format/[^/]+?)?}/baz");
+        MultivaluedMap<String, String> values = new MetadataMap<String, String>();
+
+        assertTrue(uriTemplate.match("/foo/1/format/2/baz/3", values));
+        assertEquals("1", values.getFirst("bar"));
+        assertEquals("/format/2", values.getFirst("resource"));
+        String finalPath = values.getFirst(URITemplate.FINAL_MATCH_GROUP);
+        assertEquals("/3", finalPath);
+        values.clear();
+    }
+    
     @Test
     public void testExpressionWithNestedGroup2() throws Exception {
         URITemplate uriTemplate = 
