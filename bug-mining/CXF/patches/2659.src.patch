diff --git a/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java b/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java
index a67a78934d..6fbf2a46c9 100644
--- a/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java
+++ b/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java
@@ -19,8 +19,8 @@
 package org.apache.cxf.common.util;
 
 import java.io.ByteArrayInputStream;
+import java.io.ByteArrayOutputStream;
 import java.io.InputStream;
-import java.io.SequenceInputStream;
 import java.util.zip.DataFormatException;
 import java.util.zip.Deflater;
 import java.util.zip.Inflater;
@@ -35,39 +35,26 @@ public final class CompressionUtils {
     }
     public static InputStream inflate(byte[] deflatedToken, boolean nowrap) 
         throws DataFormatException {
-        Inflater inflater = new Inflater(nowrap);
+        Inflater inflater = new Inflater(true);
         inflater.setInput(deflatedToken);
-        
-        byte[] input = new byte[deflatedToken.length * 2];
-        int inflatedLen = 0;
-        int inputLen = 0;
-        byte[] inflatedToken = input;
+
+        byte[] buffer = new byte[deflatedToken.length];
+        int inflateLen;
+        ByteArrayOutputStream inflatedToken = new ByteArrayOutputStream();
         while (!inflater.finished()) {
-            inputLen = inflater.inflate(input);
-            if (!inflater.finished()) {
-                
-                if (inputLen == 0) {
-                    if (inflater.needsInput()) {
-                        throw new DataFormatException("Inflater can not inflate all the token bytes");
-                    } else {
-                        break;
-                    }
-                }
-                byte[] lastInflatedToken = inflatedToken;
-                inflatedToken = new byte[input.length + inflatedLen];
-                if (lastInflatedToken != input) {
-                    System.arraycopy(lastInflatedToken, 0, inflatedToken, 0, inflatedLen);
+            inflateLen = inflater.inflate(buffer, 0, deflatedToken.length);
+            if (inflateLen == 0 && !inflater.finished()) {
+                if (inflater.needsInput()) {
+                    throw new DataFormatException("Inflater can not inflate all the token bytes");
+                } else {
+                    break;
                 }
-                System.arraycopy(input, 0, inflatedToken, inflatedLen, inputLen);
-                inflatedLen += inputLen;
             }
+            
+            inflatedToken.write(buffer, 0, inflateLen);
         }
-        InputStream is = new ByteArrayInputStream(input, 0, inputLen);
-        if (inflatedToken != input) {
-            is = new SequenceInputStream(new ByteArrayInputStream(inflatedToken, 0, inflatedLen),
-                                         is);
-        }
-        return is;
+
+        return new ByteArrayInputStream(inflatedToken.toByteArray());
     }
     
     public static byte[] deflate(byte[] tokenBytes) {
