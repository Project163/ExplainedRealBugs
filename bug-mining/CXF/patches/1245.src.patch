diff --git a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RMSoapInterceptor.java b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RMSoapInterceptor.java
index 98c18f8c92..f510f28246 100644
--- a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RMSoapInterceptor.java
+++ b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RMSoapInterceptor.java
@@ -282,11 +282,11 @@ public class RMSoapInterceptor extends AbstractSoapInterceptor {
                                 wsauri = maps.getNamespaceURI();
                             }
                             ProtocolVariation protocol = ProtocolVariation.findVariant(rmUri, wsauri);
-                            codec = protocol.getCodec();
-                            if (codec == null) {
+                            if (protocol == null) {
                                 LOG.log(Level.WARNING, "NAMESPACE_ERROR_MSG", wsauri); 
                                 break;
                             }
+                            codec = protocol.getCodec();
                         }
                         String localName = elem.getLocalName();
                         LOG.log(Level.FINE, "decoding RM header {0}", localName);
diff --git a/rt/ws/rm/src/test/java/org/apache/cxf/ws/rm/ProtocolVariationTest.java b/rt/ws/rm/src/test/java/org/apache/cxf/ws/rm/ProtocolVariationTest.java
new file mode 100755
index 0000000000..c2d3c0d9c9
--- /dev/null
+++ b/rt/ws/rm/src/test/java/org/apache/cxf/ws/rm/ProtocolVariationTest.java
@@ -0,0 +1,48 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+package org.apache.cxf.ws.rm;
+
+import junit.framework.Assert;
+
+import org.apache.cxf.ws.addressing.Names;
+import org.apache.cxf.ws.addressing.VersionTransformer.Names200408;
+
+import org.junit.Test;
+
+/**
+ * 
+ */
+public class ProtocolVariationTest extends Assert {
+
+    @Test
+    public void testFindVariant() {
+        // valid combinations
+        assertNotNull(ProtocolVariation.findVariant(
+                          RM10Constants.NAMESPACE_URI, Names200408.WSA_NAMESPACE_NAME));
+        assertNotNull(ProtocolVariation.findVariant(
+                          RM10Constants.NAMESPACE_URI, Names.WSA_NAMESPACE_NAME));
+        assertNotNull(ProtocolVariation.findVariant(
+                          RM11Constants.NAMESPACE_URI, Names.WSA_NAMESPACE_NAME));
+        
+        // invalid combinations 
+        assertNull(ProtocolVariation.findVariant(
+                          RM11Constants.NAMESPACE_URI, Names200408.WSA_NAMESPACE_NAME));
+    }
+}
diff --git a/systests/ws-specs/src/test/java/org/apache/cxf/systest/ws/rm/ProtocolVariationsTest.java b/systests/ws-specs/src/test/java/org/apache/cxf/systest/ws/rm/ProtocolVariationsTest.java
index 6dc5ada4ee..42aaf57e9a 100644
--- a/systests/ws-specs/src/test/java/org/apache/cxf/systest/ws/rm/ProtocolVariationsTest.java
+++ b/systests/ws-specs/src/test/java/org/apache/cxf/systest/ws/rm/ProtocolVariationsTest.java
@@ -50,6 +50,7 @@ import org.apache.cxf.ws.addressing.VersionTransformer.Names200408;
 import org.apache.cxf.ws.rm.RM10Constants;
 import org.apache.cxf.ws.rm.RM11Constants;
 import org.apache.cxf.ws.rm.RMConstants;
+import org.apache.cxf.ws.rm.RMException;
 import org.apache.cxf.ws.rm.RMManager;
 
 import org.junit.After;
@@ -161,6 +162,29 @@ public class ProtocolVariationsTest extends AbstractBusClientServerTestBase {
         verifyTwowayNonAnonymous(Names.WSA_NAMESPACE_NAME, RM11Constants.INSTANCE);
     }
     
+    @Test
+    public void testInvalidRM11WSA200408() throws Exception {
+        init("org/apache/cxf/systest/ws/rm/rminterceptors.xml", false);
+        
+        // WS-RM 1.1, but using the WS-A 1.0 namespace
+        Client client = ClientProxy.getClient(greeter);
+        client.getRequestContext().put(RMManager.WSRM_VERSION_PROPERTY, RM11Constants.NAMESPACE_URI);
+        client.getRequestContext().put(RMManager.WSRM_WSA_VERSION_PROPERTY, Names200408.WSA_NAMESPACE_NAME);
+
+        try {
+            greeter.greetMe("one");
+            fail("invalid namespace combination");
+        } catch (Exception e) {
+            assertTrue(e.getCause() instanceof RMException);
+            // verify a partial error text match to exclude an unexpected exception
+            // (see UNSUPPORTED_NAMESPACE in Messages.properties)
+            final String text = Names200408.WSA_NAMESPACE_NAME + " is not supported";
+            assertTrue(e.getCause().getMessage() != null 
+                       && e.getCause().getMessage().indexOf(text) > 0);
+        }
+        
+    }
+    
     @Test
     public void testDefaultDecoupled() throws Exception {
         init("org/apache/cxf/systest/ws/rm/rminterceptors.xml", true);
