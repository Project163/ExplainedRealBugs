diff --git a/tools/corba/src/main/java/org/apache/cxf/tools/corba/processors/idl/ConstVisitor.java b/tools/corba/src/main/java/org/apache/cxf/tools/corba/processors/idl/ConstVisitor.java
index 27a4ff3add..4e290f69f5 100644
--- a/tools/corba/src/main/java/org/apache/cxf/tools/corba/processors/idl/ConstVisitor.java
+++ b/tools/corba/src/main/java/org/apache/cxf/tools/corba/processors/idl/ConstVisitor.java
@@ -93,7 +93,9 @@ public class ConstVisitor extends VisitorBase {
         } else if (ScopedNameVisitor.accept(getScope(), definition, schema, constTypeNode, wsdlVisitor)) {
             visitor = new ScopedNameVisitor(getScope(), definition, schema, wsdlVisitor);            
         }
-        
+        if (visitor == null) {
+            throw new RuntimeException("can't resolve type for const " + constNameNode.getText());
+        }
         visitor.visit(constTypeNode);                
         XmlSchemaType constSchemaType = visitor.getSchemaType();
         CorbaTypeImpl constCorbaType = visitor.getCorbaType();        
diff --git a/tools/corba/src/test/java/org/apache/cxf/tools/corba/IDLToWSDLTest.java b/tools/corba/src/test/java/org/apache/cxf/tools/corba/IDLToWSDLTest.java
index 36a43e88e0..f5d7e2b680 100644
--- a/tools/corba/src/test/java/org/apache/cxf/tools/corba/IDLToWSDLTest.java
+++ b/tools/corba/src/test/java/org/apache/cxf/tools/corba/IDLToWSDLTest.java
@@ -378,4 +378,21 @@ public class IDLToWSDLTest extends ToolTestBase {
         doTestGeneratedWsdl(expected, actual);
     }
 
+    public void testUndefinedTypeRef() throws Exception {
+        File input = new File(getClass().getResource("/idl/ReferUndefinedType.idl").toURI());
+        File include1Dir = new File(getClass().getResource("/idl").toURI());
+               
+        String[] args = new String[] {"-ow", "ExternalInterfaceRef.wsdl",
+                                      "-o", output.toString(),
+                                      "-I", include1Dir.toString(),
+                                      "-verbose",
+                                      input.toString()
+        };
+        try {
+            IDLToWSDL.run(args);
+            fail("should throw a RuntimeException");
+        } catch (Exception e) {
+            assertTrue(e.getMessage().indexOf("can't resolve type for const myConst") >= 0);
+        }
+    }
 }
diff --git a/tools/corba/src/test/resources/idl/ReferUndefinedType.idl b/tools/corba/src/test/resources/idl/ReferUndefinedType.idl
new file mode 100644
index 0000000000..c7898198e2
--- /dev/null
+++ b/tools/corba/src/test/resources/idl/ReferUndefinedType.idl
@@ -0,0 +1,30 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+#ifndef EXTERNAL_INTTERFACE_REF_IDL
+#define EXTERNAL_INTTERFACE_REF_IDL
+
+#include "PragmaPrefix.idl"
+
+module ReferUndefinedType {
+
+  
+  const Test2::NoThisType myConst = 1;
+};
+#endif
