diff --git a/core/src/main/java/org/apache/cxf/common/util/ClassHelper.java b/core/src/main/java/org/apache/cxf/common/util/ClassHelper.java
index 645f780381..98c249b265 100644
--- a/core/src/main/java/org/apache/cxf/common/util/ClassHelper.java
+++ b/core/src/main/java/org/apache/cxf/common/util/ClassHelper.java
@@ -19,6 +19,9 @@
 
 package org.apache.cxf.common.util;
 
+import org.apache.cxf.Bus;
+import org.apache.cxf.BusFactory;
+
 /**
  * 
  */
@@ -49,10 +52,8 @@ public class ClassHelper {
         return o;
     }
     
-    
-    
     public static Class<?> getRealClass(Object o) {
-        return HELPER.getRealClassInternal(o);
+        return getRealClass(null, o);
     }
     
     public static Class<?> getRealClassFromClass(Class<?> cls) {
@@ -63,5 +64,14 @@ public class ClassHelper {
         return HELPER.getRealObjectInternal(o);
     }
 
+    public static Class<?> getRealClass(Bus bus, Object o) {
+        bus = bus == null ? BusFactory.getThreadDefaultBus() : bus;
+        if (bus != null && bus.getProperty(ClassUnwrapper.class.getName()) != null) {
+            ClassUnwrapper unwrapper = (ClassUnwrapper)bus.getProperty(ClassUnwrapper.class.getName());
+            return unwrapper.getRealClass(o);
+        } else {
+            return HELPER.getRealClassInternal(o);
+        }
+    }
     
 }
diff --git a/core/src/main/java/org/apache/cxf/common/util/ClassUnwrapper.java b/core/src/main/java/org/apache/cxf/common/util/ClassUnwrapper.java
new file mode 100644
index 0000000000..c3f8361e66
--- /dev/null
+++ b/core/src/main/java/org/apache/cxf/common/util/ClassUnwrapper.java
@@ -0,0 +1,25 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements. See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership. The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License. You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied. See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.cxf.common.util;
+
+public interface ClassUnwrapper {
+
+    Class<?> getRealClass(Object o);
+
+}
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java
index 135ac8d41e..9cba3710d9 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSInvoker.java
@@ -235,7 +235,7 @@ public class JAXRSInvoker extends AbstractInvoker {
                 result = checkResultObject(result, subResourcePath);
 
                 subCri = cri.getSubResource(methodToInvoke.getReturnType(),
-                    ClassHelper.getRealClass(result), result);
+                    ClassHelper.getRealClass(exchange.getBus(), result), result);
                 if (subCri == null) {
                     org.apache.cxf.common.i18n.Message errorM =
                         new org.apache.cxf.common.i18n.Message("NO_SUBRESOURCE_FOUND",
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSServiceFactoryBean.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSServiceFactoryBean.java
index b9da272786..b615bc3e13 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSServiceFactoryBean.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/JAXRSServiceFactoryBean.java
@@ -215,7 +215,7 @@ public class JAXRSServiceFactoryBean extends AbstractServiceFactoryBean {
     public void setResourceClassesFromBeans(List<Object> beans) {
         for (Object bean : beans) {
             
-            Class<?> realClass = ClassHelper.getRealClass(bean);
+            Class<?> realClass = ClassHelper.getRealClass(getBus(), bean);
             
             ClassResourceInfo cri = getCreatedFromModel(realClass);
             if (cri != null) {
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java
index e38bdb4545..1fb8abf6b4 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ProviderFactory.java
@@ -272,7 +272,7 @@ public abstract class ProviderFactory {
                                      Class<?> providerClass,
                                      boolean injectContext) {
         
-        Class<?> mapperClass = ClassHelper.getRealClass(em.getProvider());
+        Class<?> mapperClass = ClassHelper.getRealClass(bus, em.getProvider());
         Type[] types = null;
         if (m != null && MessageUtils.isTrue(m.getContextualProperty(IGNORE_TYPE_VARIABLES))) {
             types = new Type[]{mapperClass};
@@ -495,7 +495,7 @@ public abstract class ProviderFactory {
         List<ProviderInfo<WriterInterceptor>> writeInts = 
             new LinkedList<ProviderInfo<WriterInterceptor>>();
         for (ProviderInfo<? extends Object> provider : theProviders) {
-            Class<?> providerCls = ClassHelper.getRealClass(provider.getProvider());
+            Class<?> providerCls = ClassHelper.getRealClass(bus, provider.getProvider());
             
             if (MessageBodyReader.class.isAssignableFrom(providerCls)) {
                 addProviderToList(messageReaders, provider);
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java
index 9418224929..0094ace736 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/ServerProviderFactory.java
@@ -220,7 +220,7 @@ public final class ServerProviderFactory extends ProviderFactory {
             prepareProviders((Object[])providers, application);
         super.setCommonProviders(theProviders);
         for (ProviderInfo<? extends Object> provider : theProviders) {
-            Class<?> providerCls = ClassHelper.getRealClass(provider.getProvider());
+            Class<?> providerCls = ClassHelper.getRealClass(getBus(), provider.getProvider());
             
             if (filterContractSupported(provider, providerCls, ContainerRequestFilter.class)) {
                 addContainerRequestFilter(postMatchRequestFilters, 
diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/EndpointImpl.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/EndpointImpl.java
index 9807cae04c..467751f296 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/EndpointImpl.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/EndpointImpl.java
@@ -216,7 +216,7 @@ public class EndpointImpl extends javax.xml.ws.Endpoint
      * @return the class of the implementor object
      */
     public Class<?> getImplementorClass() {
-        return implementorClass != null ? implementorClass : ClassHelper.getRealClass(implementor);
+        return implementorClass != null ? implementorClass : ClassHelper.getRealClass(bus, implementor);
     }
 
     public List<Source> getMetadata() {
diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/spring/JaxWsWebServicePublisherBeanPostProcessor.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/spring/JaxWsWebServicePublisherBeanPostProcessor.java
index f3294b4ed9..45118a3e65 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/spring/JaxWsWebServicePublisherBeanPostProcessor.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/spring/JaxWsWebServicePublisherBeanPostProcessor.java
@@ -130,7 +130,7 @@ public class JaxWsWebServicePublisherBeanPostProcessor
     }
     
     public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
-        Class<?> clazz = ClassHelper.getRealClass(bean);
+        Class<?> clazz = ClassHelper.getRealClass(getServletBus(), bean);
 
         if (clazz.isAnnotationPresent(WebService.class)) {
             WebService ws = clazz.getAnnotation(WebService.class);
diff --git a/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ServerFactoryBean.java b/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ServerFactoryBean.java
index 3d82657dec..46fc155931 100644
--- a/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ServerFactoryBean.java
+++ b/rt/frontend/simple/src/main/java/org/apache/cxf/frontend/ServerFactoryBean.java
@@ -156,7 +156,7 @@ public class ServerFactoryBean extends AbstractWSDLBasedEndpointFactory {
                     getServiceFactory().getProperties().putAll(getProperties());
                 }
                 if (serviceBean != null && getServiceClass() == null) {
-                    setServiceClass(ClassHelper.getRealClass(serviceBean));
+                    setServiceClass(ClassHelper.getRealClass(bus, serviceBean));
                 }
                 if (invoker != null) {
                     getServiceFactory().setInvoker(invoker);
@@ -173,7 +173,7 @@ public class ServerFactoryBean extends AbstractWSDLBasedEndpointFactory {
                                                   ? getServiceFactory().getServiceClass() 
                                                   : getServiceClass()
                                               : getServiceClass() == null
-                                                  ? ClassHelper.getRealClass(getServiceBean()) 
+                                                  ? ClassHelper.getRealClass(getBus(), getServiceBean()) 
                                                   : getServiceClass());
 
                 server = new ServerImpl(getBus(),
@@ -285,7 +285,7 @@ public class ServerFactoryBean extends AbstractWSDLBasedEndpointFactory {
 
     public Class<?> getServiceBeanClass() {
         if (serviceBean != null) {
-            return ClassHelper.getRealClass(serviceBean);
+            return ClassHelper.getRealClass(getBus(), serviceBean);
         } else {
             return getServiceFactory().getServiceClass();
         }
diff --git a/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/ClientProviderFactory.java b/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/ClientProviderFactory.java
index 0c2b20bf81..2764756cd5 100644
--- a/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/ClientProviderFactory.java
+++ b/rt/rs/client/src/main/java/org/apache/cxf/jaxrs/client/ClientProviderFactory.java
@@ -88,7 +88,7 @@ public final class ClientProviderFactory extends ProviderFactory {
             prepareProviders((Object[])providers, null);
         super.setCommonProviders(theProviders);
         for (ProviderInfo<? extends Object> provider : theProviders) {
-            Class<?> providerCls = ClassHelper.getRealClass(provider.getProvider());
+            Class<?> providerCls = ClassHelper.getRealClass(getBus(), provider.getProvider());
             if (filterContractSupported(provider, providerCls, ClientRequestFilter.class)) {
                 addProviderToList(clientRequestFilters, provider);
             }
diff --git a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/CustomJAXRSInvoker.java b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/CustomJAXRSInvoker.java
index 2f5a0f230d..cce0f048d1 100644
--- a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/CustomJAXRSInvoker.java
+++ b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/CustomJAXRSInvoker.java
@@ -38,7 +38,7 @@ public class CustomJAXRSInvoker extends JAXRSInvoker {
         
         OperationResourceInfo ori = exchange.get(OperationResourceInfo.class);
         Method m = ori.getMethodToInvoke();
-        Class<?> realClass = ClassHelper.getRealClass(resourceObject);
+        Class<?> realClass = ClassHelper.getRealClass(exchange.getBus(), resourceObject);
         
         Principal p = new SecurityContextImpl(exchange.getInMessage()).getUserPrincipal();
         if (realClass == SecureBookStore.class && "getThatBook".equals(m.getName())
