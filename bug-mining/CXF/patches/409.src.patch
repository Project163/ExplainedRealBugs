diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassInInterceptor.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassInInterceptor.java
index 2d45a8dfca..1fa1242e38 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassInInterceptor.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassInInterceptor.java
@@ -148,7 +148,7 @@ public class WrapperClassInInterceptor extends AbstractPhaseInterceptor<Message>
                             if (removes == null) {
                                 removes = new ArrayList<Integer>();
                             }
-                            removes.add(mpi.getIndex());
+                            removes.add(part.getIndex());
                         }
                     } else {
                         ++count;
@@ -159,7 +159,9 @@ public class WrapperClassInInterceptor extends AbstractPhaseInterceptor<Message>
                 } else if (removes != null) {
                     Collections.sort(removes, Collections.reverseOrder());
                     for (Integer i : removes) {
-                        newParams.remove(i.intValue());
+                        if (i < newParams.size()) {
+                            newParams.remove(i.intValue());
+                        }
                     }
                 }
                 
@@ -187,13 +189,15 @@ public class WrapperClassInInterceptor extends AbstractPhaseInterceptor<Message>
         
         for (MessagePartInfo p : messageInfo.getMessageParts()) {
             if (Boolean.TRUE.equals(p.getProperty(ReflectionServiceFactoryBean.HEADER))) {
-                int idx = p.getIndex();
-                ensureSize(elTypeNames, idx);
-                ensureSize(partClasses, idx);
-                ensureSize(partNames, idx);
-                elTypeNames.set(idx, null);
-                partClasses.set(idx, null);
-                partNames.set(idx, null);
+                if (p.getTypeClass() != null) {
+                    int idx = p.getIndex();
+                    ensureSize(elTypeNames, idx);
+                    ensureSize(partClasses, idx);
+                    ensureSize(partNames, idx);
+                    elTypeNames.set(idx, null);
+                    partClasses.set(idx, null);
+                    partNames.set(idx, null);
+                }
             } else {
                 String elementType = null;
                 if (p.getTypeQName() == null) {
