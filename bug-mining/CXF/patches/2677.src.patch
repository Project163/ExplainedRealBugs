diff --git a/core/src/main/java/org/apache/cxf/io/CachedWriter.java b/core/src/main/java/org/apache/cxf/io/CachedWriter.java
index 77b22665cd..ea18a54469 100644
--- a/core/src/main/java/org/apache/cxf/io/CachedWriter.java
+++ b/core/src/main/java/org/apache/cxf/io/CachedWriter.java
@@ -52,6 +52,7 @@ public class CachedWriter extends Writer {
     private static int defaultThreshold;
     private static long defaultMaxSize;
     private static String defaultCipherTransformation;
+    
     static {
         
         String s = SystemPropertyAction.getPropertyOrNull("org.apache.cxf.io.CachedOutputStream.OutputDirectory");
@@ -78,6 +79,7 @@ public class CachedWriter extends Writer {
     protected boolean outputLocked;
     protected Writer currentStream;
 
+    private boolean cosClosed;
     private long threshold = defaultThreshold;
     private long maxSize = defaultMaxSize;
 
@@ -176,7 +178,10 @@ public class CachedWriter extends Writer {
     }
 
     public void flush() throws IOException {
-        currentStream.flush();
+        if (!cosClosed) {
+            currentStream.flush();
+        }
+        
         if (null != callbacks) {
             for (CachedWriterCallback cb : callbacks) {
                 cb.onFlush(this);
@@ -220,7 +225,9 @@ public class CachedWriter extends Writer {
     }
     
     public void close() throws IOException {
-        currentStream.flush();
+        if (!cosClosed) {
+            currentStream.flush();
+        }
         outputLocked = true;
         if (null != callbacks) {
             for (CachedWriterCallback cb : callbacks) {
@@ -601,16 +608,22 @@ public class CachedWriter extends Writer {
                 throw new IOException(e.getMessage(), e);
             }
             out = new CipherOutputStream(out, ciphers.getEncryptor()) {
-                boolean closed;
                 public void close() throws IOException {
-                    if (!closed) {
+                    if (!cosClosed) {
                         super.close();
-                        closed = true;
+                        cosClosed = true;
                     }
                 }
             };
         }
-        return new OutputStreamWriter(out, "utf-8");
+        return new OutputStreamWriter(out, "utf-8") {
+            public void close() throws IOException {
+                if (!cosClosed) {
+                    super.close();
+                    cosClosed = true;
+                }
+            }
+        };
     }
 
     private InputStreamReader createInputStreamReader(File file) throws IOException {
diff --git a/core/src/test/java/org/apache/cxf/io/CachedOutputStreamTest.java b/core/src/test/java/org/apache/cxf/io/CachedOutputStreamTest.java
index 1df7afb4db..b54c3cfecc 100644
--- a/core/src/test/java/org/apache/cxf/io/CachedOutputStreamTest.java
+++ b/core/src/test/java/org/apache/cxf/io/CachedOutputStreamTest.java
@@ -64,6 +64,7 @@ public class CachedOutputStreamTest extends CachedStreamTestBase {
         CachedOutputStream cos = (CachedOutputStream)cache;
         cos.write(result.getBytes("utf-8"));
         cos.flush();
+        cos.getOut().close();
         return cos.getTempFile();
     }
 
diff --git a/core/src/test/java/org/apache/cxf/io/CachedWriterTest.java b/core/src/test/java/org/apache/cxf/io/CachedWriterTest.java
index 1f0bfdc128..7a4c846ce8 100644
--- a/core/src/test/java/org/apache/cxf/io/CachedWriterTest.java
+++ b/core/src/test/java/org/apache/cxf/io/CachedWriterTest.java
@@ -63,6 +63,7 @@ public class CachedWriterTest extends CachedStreamTestBase {
         CachedWriter cos = (CachedWriter)cache;
         cos.write(result);
         cos.flush();
+        cos.getOut().close();
         return cos.getTempFile();
     }
 
