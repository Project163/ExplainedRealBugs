diff --git a/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java b/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java
index a3ae330c6b..ed1a1cc58f 100644
--- a/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java
+++ b/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java
@@ -130,6 +130,10 @@ public final class Base64Utility {
                                      int l)
         throws Base64Exception {
 
+        if (id != null && id.length == 0 && l == 0) {
+            return new byte[0];
+        }
+
         // Keep it simple - must be >= 4. Unpadded
         // base64 data contain < 3 octets is invalid.
         //
diff --git a/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java b/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java
index ff61b802a7..bec0dd334a 100644
--- a/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java
+++ b/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java
@@ -179,6 +179,14 @@ public class Base64UtilityTest extends Assert {
         assertEquals("Zm9vYg==", Base64Utility.encode("foob".getBytes()));
         assertEquals("Zm9vYmE=", Base64Utility.encode("fooba".getBytes()));
         assertEquals("Zm9vYmFy", Base64Utility.encode("foobar".getBytes()));
+
+        assertEquals("", new String(Base64Utility.decode("")));
+        assertEquals("f", new String(Base64Utility.decode("Zg==")));
+        assertEquals("fo", new String(Base64Utility.decode("Zm8=")));
+        assertEquals("foo", new String(Base64Utility.decode("Zm9v")));
+        assertEquals("foob", new String(Base64Utility.decode("Zm9vYg==")));
+        assertEquals("fooba", new String(Base64Utility.decode("Zm9vYmE=")));
+        assertEquals("foobar", new String(Base64Utility.decode("Zm9vYmFy")));
     }
 
 }
