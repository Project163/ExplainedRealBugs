diff --git a/api/src/main/java/org/apache/cxf/attachment/AttachmentUtil.java b/api/src/main/java/org/apache/cxf/attachment/AttachmentUtil.java
index 502d996de4..9ea6fc8fa9 100644
--- a/api/src/main/java/org/apache/cxf/attachment/AttachmentUtil.java
+++ b/api/src/main/java/org/apache/cxf/attachment/AttachmentUtil.java
@@ -186,10 +186,7 @@ public final class AttachmentUtil {
         return dataHandlers == null ? new LinkedHashMap<String, DataHandler>() : dataHandlers;
     }
     
-    public static Attachment createAttachment(InputStream stream, InternetHeaders headers) 
-        throws IOException {
-     
-        String id = headers.getHeader("Content-ID", null);
+    public static String cleanContentId(String id) {
         if (id != null) {
             if (id.startsWith("<")) {
                 // strip <>
@@ -200,13 +197,24 @@ public final class AttachmentUtil {
                 id = id.substring(4);
             }
             // urldecode. Is this bad even without cid:? What does decode do with malformed %-signs, anyhow?
-            id = URLDecoder.decode(id, "UTF-8");
+            try {
+                id = URLDecoder.decode(id, "UTF-8");
+            } catch (UnsupportedEncodingException e) {
+                //ignore, keep id as is
+            }
         }
         if (id == null) {
             //no Content-ID, set cxf default ID
             id = "root.message@cxf.apache.org";
         }
-
+        return id;
+    }
+    
+    
+    public static Attachment createAttachment(InputStream stream, InternetHeaders headers) 
+        throws IOException {
+     
+        String id = cleanContentId(headers.getHeader("Content-ID", null));
 
         AttachmentImpl att = new AttachmentImpl(id);
         
diff --git a/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJInInterceptor.java b/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJInInterceptor.java
index 55f468394d..147fc9d6cf 100644
--- a/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJInInterceptor.java
+++ b/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJInInterceptor.java
@@ -54,6 +54,7 @@ import org.apache.cxf.binding.soap.interceptor.AbstractSoapInterceptor;
 import org.apache.cxf.binding.soap.interceptor.ReadHeadersInterceptor;
 import org.apache.cxf.common.i18n.BundleUtils;
 import org.apache.cxf.common.injection.NoJSR250Annotations;
+import org.apache.cxf.common.util.StringUtils;
 import org.apache.cxf.databinding.DataBinding;
 import org.apache.cxf.headers.Header;
 import org.apache.cxf.headers.HeaderManager;
@@ -203,13 +204,15 @@ public class SAAJInInterceptor extends AbstractSoapInterceptor {
                         }
                     }
                     AttachmentPart ap = soapMessage.createAttachmentPart(a.getDataHandler());
-                    ap.setContentId(a.getId());
                     Iterator<String> i = a.getHeaderNames();
                     while (i != null && i.hasNext()) {
                         String h = i.next();
                         String val = a.getHeader(h);
                         ap.addMimeHeader(h, val);
                     }
+                    if (StringUtils.isEmpty(ap.getContentId())) {
+                        ap.setContentId(a.getId());
+                    }
                     soapMessage.addAttachmentPart(ap);
                 }
             }
diff --git a/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJOutInterceptor.java b/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJOutInterceptor.java
index 651e7a7747..76e35497e2 100644
--- a/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJOutInterceptor.java
+++ b/rt/bindings/soap/src/main/java/org/apache/cxf/binding/soap/saaj/SAAJOutInterceptor.java
@@ -40,6 +40,7 @@ import org.w3c.dom.Node;
 
 
 import org.apache.cxf.attachment.AttachmentImpl;
+import org.apache.cxf.attachment.AttachmentUtil;
 import org.apache.cxf.binding.soap.Soap11;
 import org.apache.cxf.binding.soap.Soap12;
 import org.apache.cxf.binding.soap.SoapFault;
@@ -187,7 +188,8 @@ public class SAAJOutInterceptor extends AbstractSoapInterceptor {
                     Iterator<AttachmentPart> it = CastUtils.cast(soapMessage.getAttachments());
                     while (it.hasNext()) {
                         AttachmentPart part = it.next();
-                        AttachmentImpl att = new AttachmentImpl(part.getContentId());
+                        String id = AttachmentUtil.cleanContentId(part.getContentId());
+                        AttachmentImpl att = new AttachmentImpl(id);
                         try {
                             att.setDataHandler(part.getDataHandler());
                         } catch (SOAPException e) {
