diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/context/WrappedAttachments.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/context/WrappedAttachments.java
index 920d22a3c0..f3fa3ce080 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/context/WrappedAttachments.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/context/WrappedAttachments.java
@@ -71,7 +71,7 @@ class WrappedAttachments implements Set<Attachment> {
     @SuppressWarnings("unchecked")
     public <T> T[] toArray(T[] a) {
         T[] copy = a.length == attachments.size()
-            ? a : (T[])Array.newInstance(a.getClass(), attachments.size());
+            ? a : (T[])Array.newInstance(a.getClass().getComponentType(), attachments.size());
         int i = 0;
         for (Map.Entry<String, DataHandler> entry : attachments.entrySet()) {
             Attachment o = cache.get(entry.getKey());
diff --git a/rt/frontend/jaxws/src/test/java/org/apache/cxf/jaxws/context/WrappedAttachmentsTest.java b/rt/frontend/jaxws/src/test/java/org/apache/cxf/jaxws/context/WrappedAttachmentsTest.java
index c705d6e112..d6b6db874d 100644
--- a/rt/frontend/jaxws/src/test/java/org/apache/cxf/jaxws/context/WrappedAttachmentsTest.java
+++ b/rt/frontend/jaxws/src/test/java/org/apache/cxf/jaxws/context/WrappedAttachmentsTest.java
@@ -63,10 +63,20 @@ public class WrappedAttachmentsTest extends Assert {
 
         assertEquals(1, attachments.size());
 
-        Attachment[] atts = attachments.toArray(new Attachment[0]);
+        Attachment[] atts = attachments.toArray(new Attachment[0]); //NOPMD - explicitly test this
         assertEquals(1, atts.length);
         assertEquals("att-1".equals(attx.getId()) ? "att-2" : "att-1", atts[0].getId());
 
+        atts = attachments.toArray(new Attachment[attachments.size()]); //NOPMD - explicitly test this
+        assertEquals(1, atts.length);
+        assertEquals("att-1".equals(attx.getId()) ? "att-2" : "att-1", atts[0].getId());
+        
+        Object o[] = attachments.toArray(); //NOPMD - explicitly test this
+        assertEquals(1, o.length);
+        Attachment a = (Attachment)o[0];
+        assertEquals("att-1".equals(attx.getId()) ? "att-2" : "att-1", a.getId());
+
+        
         attachments.clear();
         assertTrue(attachments.isEmpty());
         assertTrue(content.isEmpty());
