diff --git a/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java b/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java
index 77c9410a51..a3ae330c6b 100644
--- a/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java
+++ b/core/src/main/java/org/apache/cxf/common/util/Base64Utility.java
@@ -263,7 +263,9 @@ public final class Base64Utility {
                                      int o,
                                      int l,
                                      boolean urlSafe) {
-        if (l <= 0) {
+        if (id != null && id.length == 0 && l == 0) {
+            return new char[0];
+        } else if (l <= 0) {
             return null;
         }
 
diff --git a/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java b/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java
index 93adf53223..ff61b802a7 100644
--- a/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java
+++ b/core/src/test/java/org/apache/cxf/common/util/Base64UtilityTest.java
@@ -169,5 +169,16 @@ public class Base64UtilityTest extends Assert {
 
     }
 
+    // See https://tools.ietf.org/html/rfc4648#section-10
+    @Test
+    public void testVectors() throws Exception {
+        assertEquals("", Base64Utility.encode("".getBytes()));
+        assertEquals("Zg==", Base64Utility.encode("f".getBytes()));
+        assertEquals("Zm8=", Base64Utility.encode("fo".getBytes()));
+        assertEquals("Zm9v", Base64Utility.encode("foo".getBytes()));
+        assertEquals("Zm9vYg==", Base64Utility.encode("foob".getBytes()));
+        assertEquals("Zm9vYmE=", Base64Utility.encode("fooba".getBytes()));
+        assertEquals("Zm9vYmFy", Base64Utility.encode("foobar".getBytes()));
+    }
 
 }
