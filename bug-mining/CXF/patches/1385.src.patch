diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/JAXBElementProvider.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/JAXBElementProvider.java
index 1375a5ae48..21862682e3 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/JAXBElementProvider.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/JAXBElementProvider.java
@@ -503,7 +503,9 @@ public class JAXBElementProvider<T> extends AbstractJAXBProvider<T>  {
                 mc.put(XMLStreamWriter.class.getName(), writer);    
             }
             marshalToWriter(ms, obj, writer, mt);
-            writer.writeEndDocument();
+            if (mc != null) { 
+                writer.writeEndDocument();
+            }
         } else {
             marshalToOutputStream(ms, obj, os, mt);
         }
diff --git a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProvider.java b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProvider.java
index 2772cda1f1..84e6bf0187 100644
--- a/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProvider.java
+++ b/rt/frontend/jaxrs/src/main/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProvider.java
@@ -194,11 +194,11 @@ public class XSLTJaxbProvider<T> extends JAXBElementProvider<T> {
         marshalToOutputStream(ms, obj, out, mt);
         
         StaxUtils.copy(new StreamSource(out.getInputStream()), writer);
-        if (getContext() == null) {
-            writer.writeEndDocument();
-            writer.flush();
-            writer.close();
-        }
+    }
+    
+    @Override
+    protected void addAttachmentMarshaller(Marshaller ms) {
+        // complete
     }
     
     @Override
@@ -211,14 +211,20 @@ public class XSLTJaxbProvider<T> extends JAXBElementProvider<T> {
             return;
         }
         
-        TransformerHandler th = factory.newTransformerHandler(
-            createTemplates(getOutTemplates(mt), outParamsMap, outProperties));
+        TransformerHandler th = factory.newTransformerHandler(t);
         Result result = new StreamResult(os);
         if (systemId != null) {
             result.setSystemId(systemId);
         }
         th.setResult(result);
+        
+        if (getContext() == null) {
+            th.startDocument();
+        }
         ms.marshal(obj, th);
+        if (getContext() == null) {
+            th.endDocument();
+        }
     }
     
     public void setOutTemplate(String loc) {
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/JAXBElementProviderTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/JAXBElementProviderTest.java
index fd5f73e18f..997e2f974a 100644
--- a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/JAXBElementProviderTest.java
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/JAXBElementProviderTest.java
@@ -42,6 +42,7 @@ import java.util.TreeSet;
 import javax.ws.rs.GET;
 import javax.ws.rs.Path;
 import javax.ws.rs.WebApplicationException;
+import javax.ws.rs.core.Application;
 import javax.ws.rs.core.MediaType;
 import javax.ws.rs.core.Response;
 import javax.xml.bind.JAXBContext;
@@ -66,7 +67,9 @@ import org.w3c.dom.Node;
 
 import org.xml.sax.ContentHandler;
 
+import org.apache.cxf.endpoint.Endpoint;
 import org.apache.cxf.helpers.CastUtils;
+import org.apache.cxf.jaxrs.ext.MessageContextImpl;
 import org.apache.cxf.jaxrs.ext.xml.XMLSource;
 import org.apache.cxf.jaxrs.fortest.jaxb.packageinfo.Book2;
 import org.apache.cxf.jaxrs.fortest.jaxb.packageinfo.Book2NoRootElement;
@@ -84,6 +87,11 @@ import org.apache.cxf.jaxrs.resources.TagVO2;
 import org.apache.cxf.jaxrs.resources.Tags;
 import org.apache.cxf.jaxrs.utils.ParameterizedCollectionType;
 import org.apache.cxf.jaxrs.utils.ResourceUtils;
+import org.apache.cxf.message.Exchange;
+import org.apache.cxf.message.ExchangeImpl;
+import org.apache.cxf.message.Message;
+import org.apache.cxf.message.MessageImpl;
+import org.easymock.EasyMock;
 
 import org.junit.Assert;
 import org.junit.Ignore;
@@ -775,6 +783,7 @@ public class JAXBElementProviderTest extends Assert {
 
         //Provider
         JAXBElementProvider<List<?>> provider = new JAXBElementProvider<List<?>>();
+        provider.setMessageContext(new MessageContextImpl(createMessage()));
         provider.setCollectionWrapperName("tagholders");
         Map<String, String> map = new HashMap<String, String>();
         map.put("{http://tags}*", "*");
@@ -1484,4 +1493,28 @@ public class JAXBElementProviderTest extends Assert {
             return null;
         }
     }
+    
+    private Message createMessage() {
+        ProviderFactory factory = ProviderFactory.getInstance();
+        Message m = new MessageImpl();
+        m.put(Message.ENDPOINT_ADDRESS, "http://localhost:8080/bar");
+        m.put("org.apache.cxf.http.case_insensitive_queries", false);
+        Exchange e = new ExchangeImpl();
+        m.setExchange(e);
+        e.setInMessage(m);
+        Endpoint endpoint = EasyMock.createMock(Endpoint.class);
+        endpoint.getEndpointInfo();
+        EasyMock.expectLastCall().andReturn(null).anyTimes();
+        endpoint.get(Application.class.getName());
+        EasyMock.expectLastCall().andReturn(null);
+        endpoint.size();
+        EasyMock.expectLastCall().andReturn(0).anyTimes();
+        endpoint.isEmpty();
+        EasyMock.expectLastCall().andReturn(true).anyTimes();
+        endpoint.get(ProviderFactory.class.getName());
+        EasyMock.expectLastCall().andReturn(factory).anyTimes();
+        EasyMock.replay(endpoint);
+        e.put(Endpoint.class, endpoint);
+        return m;
+    }
 }
diff --git a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProviderTest.java b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProviderTest.java
index 031defa631..c1296097a9 100644
--- a/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProviderTest.java
+++ b/rt/frontend/jaxrs/src/test/java/org/apache/cxf/jaxrs/provider/XSLTJaxbProviderTest.java
@@ -26,15 +26,23 @@ import java.io.StringReader;
 import java.util.ArrayList;
 import java.util.List;
 
+import javax.ws.rs.core.Application;
 import javax.ws.rs.core.MediaType;
 import javax.xml.bind.Unmarshaller;
 import javax.xml.stream.XMLStreamReader;
 import javax.xml.stream.XMLStreamWriter;
 
+import org.apache.cxf.endpoint.Endpoint;
+import org.apache.cxf.jaxrs.ext.MessageContextImpl;
 import org.apache.cxf.jaxrs.impl.MetadataMap;
 import org.apache.cxf.jaxrs.resources.Book;
 import org.apache.cxf.jaxrs.resources.SuperBook;
+import org.apache.cxf.message.Exchange;
+import org.apache.cxf.message.ExchangeImpl;
+import org.apache.cxf.message.Message;
+import org.apache.cxf.message.MessageImpl;
 import org.apache.cxf.staxutils.StaxUtils;
+import org.easymock.EasyMock;
 
 import org.junit.Assert;
 import org.junit.Test;
@@ -87,7 +95,7 @@ public class XSLTJaxbProviderTest extends Assert {
     public void testWrite() throws Exception {
         XSLTJaxbProvider<Book> provider = new XSLTJaxbProvider<Book>();
         provider.setOutTemplate(TEMPLATE_LOCATION);
-        
+        provider.setMessageContext(new MessageContextImpl(createMessage()));
         Book b = new Book();
         b.setId(123L);
         b.setName("TheBook");
@@ -109,7 +117,7 @@ public class XSLTJaxbProviderTest extends Assert {
             }
         };
         provider.setOutTemplate(TEMPLATE_LOCATION);
-        
+        provider.setMessageContext(new MessageContextImpl(createMessage()));
         Book b = new Book();
         b.setId(123L);
         b.setName("TheBook");
@@ -225,4 +233,27 @@ public class XSLTJaxbProviderTest extends Assert {
         assertEquals("Transformation is bad", b, b2);
     }
     
+    private Message createMessage() {
+        ProviderFactory factory = ProviderFactory.getInstance();
+        Message m = new MessageImpl();
+        m.put(Message.ENDPOINT_ADDRESS, "http://localhost:8080/bar");
+        m.put("org.apache.cxf.http.case_insensitive_queries", false);
+        Exchange e = new ExchangeImpl();
+        m.setExchange(e);
+        e.setInMessage(m);
+        Endpoint endpoint = EasyMock.createMock(Endpoint.class);
+        endpoint.getEndpointInfo();
+        EasyMock.expectLastCall().andReturn(null).anyTimes();
+        endpoint.get(Application.class.getName());
+        EasyMock.expectLastCall().andReturn(null);
+        endpoint.size();
+        EasyMock.expectLastCall().andReturn(0).anyTimes();
+        endpoint.isEmpty();
+        EasyMock.expectLastCall().andReturn(true).anyTimes();
+        endpoint.get(ProviderFactory.class.getName());
+        EasyMock.expectLastCall().andReturn(factory).anyTimes();
+        EasyMock.replay(endpoint);
+        e.put(Endpoint.class, endpoint);
+        return m;
+    }
 }
diff --git a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSSoapBookTest.java b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSSoapBookTest.java
index 07451e5a4d..5be4a8475e 100644
--- a/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSSoapBookTest.java
+++ b/systests/jaxrs/src/test/java/org/apache/cxf/systest/jaxrs/JAXRSSoapBookTest.java
@@ -78,6 +78,7 @@ import org.apache.cxf.systest.jaxrs.jaxws.User;
 import org.apache.cxf.systest.jaxrs.jaxws.UserImpl;
 import org.apache.cxf.testutil.common.AbstractBusClientServerTestBase;
 import org.apache.cxf.transport.http.HTTPConduit;
+import org.apache.cxf.transports.http.configuration.HTTPClientPolicy;
 
 import org.junit.BeforeClass;
 import org.junit.Ignore;
@@ -89,7 +90,7 @@ public class JAXRSSoapBookTest extends AbstractBusClientServerTestBase {
     @BeforeClass
     public static void startServers() throws Exception {
         assertTrue("server did not launch correctly", 
-                   launchServer(BookServerRestSoap.class, true));
+                   launchServer(BookServerRestSoap.class));
     }
     
     @Test
@@ -115,21 +116,41 @@ public class JAXRSSoapBookTest extends AbstractBusClientServerTestBase {
     }
     
     @Test
-    public void testHelloSoapCustomDataBinding() throws Exception {
+    public void testHelloSoapCustomDataBindingJaxb() throws Exception {
+        final String address = "http://localhost:" + PORT + "/test/services/hello-soap-databinding-jaxb";
+        doTestHelloSoapCustomDataBinding(address);
+    }
+    
+    @Test
+    public void testHelloSoapCustomDataBindingJaxbXslt() throws Exception {
+        final String address = "http://localhost:" + PORT + "/test/services/hello-soap-databinding-xslt";
+        doTestHelloSoapCustomDataBinding(address);
+    }
+    
+    private void doTestHelloSoapCustomDataBinding(String address) throws Exception {
         final QName serviceName = new QName("http://hello.com", "HelloWorld");
         final QName portName = new QName("http://hello.com", "HelloWorldPort");
-        final String address = "http://localhost:" + PORT + "/test/services/hello-soap-databinding";
         
         Service service = Service.create(serviceName);
         service.addPort(portName, SOAPBinding.SOAP11HTTP_BINDING, address);
     
         HelloWorld hw = service.getPort(HelloWorld.class); 
+        
+        Client cl = ClientProxy.getClient(hw);
+        
+        HTTPConduit http = (HTTPConduit) cl.getConduit();
+         
+        HTTPClientPolicy httpClientPolicy = new HTTPClientPolicy();
+        httpClientPolicy.setConnectionTimeout(0);
+        httpClientPolicy.setReceiveTimeout(0);
+         
+        http.setClient(httpClientPolicy);
     
         User user = new UserImpl("Barry");
         User user2 = hw.echoUser(user);
         
         assertNotSame(user, user2);
-        assertEquals("Barry", user.getName());
+        assertEquals("Barry", user2.getName());
     }
     
     private void useHelloService(HelloWorld service) {
diff --git a/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/beans.xml b/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/beans.xml
index abf17b559a..408e64db6c 100644
--- a/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/beans.xml
+++ b/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/beans.xml
@@ -93,25 +93,46 @@ http://cxf.apache.org/schemas/jaxrs.xsd">
           <entry key="org.apache.cxf.endpoint.private" value="true"/>
       </jaxws:properties>
   </jaxws:endpoint>
-  
   <jaxws:endpoint xmlns:s="http://hello.com"
       serviceName="s:HelloWorld"
       endpointName="s:HelloWorldPort"
       id="hello_soap-databinding"
       implementor="org.apache.cxf.systest.jaxrs.jaxws.HelloWorldImpl"
-      address="/hello-soap-databinding">
+      address="/hello-soap-databinding-jaxb">
       
       <jaxws:dataBinding>
           <ref bean="jaxrs-data-binding"/>
       </jaxws:dataBinding>
       
-  </jaxws:endpoint>        
-
+  </jaxws:endpoint>
+  
+  <jaxws:endpoint xmlns:s="http://hello.com"
+      serviceName="s:HelloWorld"
+      endpointName="s:HelloWorldPort"
+      id="hello_soap-databinding-xslt"
+      implementor="org.apache.cxf.systest.jaxrs.jaxws.HelloWorldImpl"
+      address="/hello-soap-databinding-xslt">
+      
+      <jaxws:dataBinding>
+          <ref bean="jaxrs-data-binding-xslt"/>
+      </jaxws:dataBinding>
+      
+  </jaxws:endpoint>
+          
   <bean id="jaxrs-data-binding" class="org.apache.cxf.jaxrs.provider.JAXRSDataBinding">
       <property name="provider" ref="jaxbProviderSoap"/>
   </bean>
-
+  
   <bean id="jaxbProviderSoap" class="org.apache.cxf.jaxrs.provider.JAXBElementProvider"/>
+  
+  <bean id="jaxrs-data-binding-xslt" class="org.apache.cxf.jaxrs.provider.JAXRSDataBinding">
+      <property name="provider" ref="jaxbProviderXslt"/>
+  </bean>
+  
+  <bean id="jaxbProviderXslt" class="org.apache.cxf.jaxrs.provider.XSLTJaxbProvider">
+      <property name="inTemplate" value="classpath:/WEB-INF/template.xsl"/>
+      <property name="outTemplate" value="classpath:/WEB-INF/template.xsl"/>
+  </bean>
 
   <jaxrs:server id="restservice2"
 		        address="/rest2">
diff --git a/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/template.xsl b/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/template.xsl
new file mode 100644
index 0000000000..bd68fad365
--- /dev/null
+++ b/systests/jaxrs/src/test/resources/jaxrs_soap_rest/WEB-INF/template.xsl
@@ -0,0 +1,27 @@
+<!--
+  Licensed to the Apache Software Foundation (ASF) under one
+  or more contributor license agreements. See the NOTICE file
+  distributed with this work for additional information
+  regarding copyright ownership. The ASF licenses this file
+  to you under the Apache License, Version 2.0 (the
+  "License"); you may not use this file except in compliance
+  with the License. You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing,
+  software distributed under the License is distributed on an
+  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  KIND, either express or implied. See the License for the
+  specific language governing permissions and limitations
+  under the License.
+-->
+<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0" xmlns:books="http://www.w3.org/books">
+ 
+ <xsl:template match="@*|node()">
+    <xsl:copy>
+      <xsl:apply-templates select="@*|node()"/>
+    </xsl:copy>
+  </xsl:template>
+ 
+</xsl:stylesheet> 
