diff --git a/rt/core/src/main/java/org/apache/cxf/service/factory/ReflectionServiceFactoryBean.java b/rt/core/src/main/java/org/apache/cxf/service/factory/ReflectionServiceFactoryBean.java
index 7c2df8be76..50c36a0a49 100644
--- a/rt/core/src/main/java/org/apache/cxf/service/factory/ReflectionServiceFactoryBean.java
+++ b/rt/core/src/main/java/org/apache/cxf/service/factory/ReflectionServiceFactoryBean.java
@@ -815,6 +815,13 @@ public class ReflectionServiceFactoryBean extends AbstractServiceFactoryBean {
             }
             if (part == null && isHeader && o.isUnwrapped()) {
                 part = ((UnwrappedOperationInfo)o).getWrappedOperation().getInput().getMessagePart(name);
+                if (part == null) {
+                    QName name2 = this.getInParameterName(o, method, i);
+                    part = o.getInput().getMessagePart(name2);
+                    if (part != null) {
+                        name = name2;
+                    }
+                }
                 if (part != null) {
                     //header part in wsdl, need to get this mapped in to the unwrapped form
                     MessagePartInfo inf = o.getInput().addMessagePart(part.getName());
@@ -848,12 +855,16 @@ public class ReflectionServiceFactoryBean extends AbstractServiceFactoryBean {
         } else if (isIn && isOut) {
             QName name = getInPartName(o, method, i);
             part = o.getInput().getMessagePart(name);
+            if (part == null && isHeader && o.isUnwrapped()) {
+                QName name2 = this.getInParameterName(o, method, i);
+                part = o.getInput().getMessagePart(name2);
+                if (part != null) {
+                    name = name2;
+                }
+            }
             if (part == null && this.isFromWsdl()) {
                 part = o.getInput().getMessagePartByIndex(i);
             }
-            if (part == null && isHeader && o.isUnwrapped()) {
-                part = o.getUnwrappedOperation().getInput().getMessagePart(name);
-            }
             if (part == null) {
                 return false;
             }
diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassOutInterceptor.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassOutInterceptor.java
index 02b9c51c4a..f1d4d0eb24 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassOutInterceptor.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/WrapperClassOutInterceptor.java
@@ -171,6 +171,10 @@ public class WrapperClassOutInterceptor extends AbstractPhaseInterceptor<Message
         }
 
         for (MessagePartInfo p : messageInfo.getMessageParts()) {
+            if (p.getTypeClass() == null) {
+                //WSDL part wasn't mapped to a parameter
+                continue;
+            }
             ensureSize(partNames, p.getIndex());
             ensureSize(elTypeNames, p.getIndex());
             ensureSize(partClasses, p.getIndex());
