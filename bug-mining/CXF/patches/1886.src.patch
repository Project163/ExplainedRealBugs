diff --git a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/SAMLTokenProvider.java b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/SAMLTokenProvider.java
index 85d30c91ce..3afc96ac69 100644
--- a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/SAMLTokenProvider.java
+++ b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/SAMLTokenProvider.java
@@ -138,10 +138,7 @@ public class SAMLTokenProvider implements TokenProvider {
                 securityToken.setToken(token);
                 securityToken.setPrincipal(tokenParameters.getPrincipal());
 
-                Properties props = securityToken.getProperties();
-                if (props == null) {
-                    props = new Properties();
-                }
+                Properties props = new Properties();
                 securityToken.setProperties(props);
                 if (tokenParameters.getRealm() != null) {
                     props.setProperty(STSConstants.TOKEN_REALM, tokenParameters.getRealm());
diff --git a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewer.java b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewer.java
index e65f8fb7a5..3c1cd479b2 100644
--- a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewer.java
+++ b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewer.java
@@ -35,7 +35,6 @@ import javax.xml.ws.handler.MessageContext;
 
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
-
 import org.apache.cxf.common.logging.LogUtils;
 import org.apache.cxf.helpers.CastUtils;
 import org.apache.cxf.helpers.DOMUtils;
@@ -45,6 +44,7 @@ import org.apache.cxf.sts.STSPropertiesMBean;
 import org.apache.cxf.sts.SignatureProperties;
 import org.apache.cxf.sts.request.ReceivedToken;
 import org.apache.cxf.sts.request.ReceivedToken.STATE;
+import org.apache.cxf.sts.request.Renewing;
 import org.apache.cxf.sts.token.provider.ConditionsProvider;
 import org.apache.cxf.sts.token.provider.DefaultConditionsProvider;
 import org.apache.cxf.sts.token.realm.SAMLRealm;
@@ -212,7 +212,7 @@ public class SAMLTokenRenewer implements TokenRenewer {
             
             // Cache the token
             storeTokenInCache(
-                tokenStore, renewedAssertion, tokenParameters.getPrincipal(), tokenParameters.getRealm()
+                tokenStore, renewedAssertion, tokenParameters.getPrincipal(), tokenParameters
             );
             
             response.setToken(token);
@@ -556,7 +556,7 @@ public class SAMLTokenRenewer implements TokenRenewer {
         TokenStore tokenStore, 
         SamlAssertionWrapper assertion, 
         Principal principal,
-        String tokenRealm
+        TokenRenewerParameters tokenParameters
     ) throws WSSecurityException {
         // Store the successfully renewed token in the cache
         byte[] signatureValue = assertion.getSignatureValue();
@@ -572,11 +572,29 @@ public class SAMLTokenRenewer implements TokenRenewer {
             securityToken.setToken(assertion.getElement());
             securityToken.setPrincipal(principal);
             
+            Properties props = new Properties();
+            String tokenRealm = tokenParameters.getRealm();
             if (tokenRealm != null) {
-                Properties props = new Properties();
                 props.setProperty(STSConstants.TOKEN_REALM, tokenRealm);
-                securityToken.setProperties(props);
             }
+            
+            // Handle Renewing logic
+            Renewing renewing = tokenParameters.getTokenRequirements().getRenewing();
+            if (renewing != null) {
+                props.put(
+                    STSConstants.TOKEN_RENEWING_ALLOW, 
+                    String.valueOf(renewing.isAllowRenewing())
+                );
+                props.put(
+                    STSConstants.TOKEN_RENEWING_ALLOW_AFTER_EXPIRY, 
+                    String.valueOf(renewing.isAllowRenewingAfterExpiry())
+                );
+            } else {
+                props.setProperty(STSConstants.TOKEN_RENEWING_ALLOW, "true");
+                props.setProperty(STSConstants.TOKEN_RENEWING_ALLOW_AFTER_EXPIRY, "false");
+            }
+            
+            securityToken.setProperties(props);
 
             int hash = Arrays.hashCode(signatureValue);
             securityToken.setTokenHash(hash);
diff --git a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/validator/SAMLTokenValidator.java b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/validator/SAMLTokenValidator.java
index 06fe1ac07b..393d74e448 100644
--- a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/validator/SAMLTokenValidator.java
+++ b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/validator/SAMLTokenValidator.java
@@ -215,7 +215,7 @@ public class SAMLTokenValidator implements TokenValidator {
                     Properties props = secToken.getProperties();
                     if (props != null) {
                         String cachedRealm = props.getProperty(STSConstants.TOKEN_REALM);
-                        if (!tokenRealm.equals(cachedRealm)) {
+                        if (cachedRealm != null && !tokenRealm.equals(cachedRealm)) {
                             return response;
                         }
                     }
diff --git a/services/sts/sts-core/src/test/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewerTest.java b/services/sts/sts-core/src/test/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewerTest.java
index 12e38406da..646d2ed29d 100644
--- a/services/sts/sts-core/src/test/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewerTest.java
+++ b/services/sts/sts-core/src/test/java/org/apache/cxf/sts/token/renewer/SAMLTokenRenewerTest.java
@@ -135,6 +135,17 @@ public class SAMLTokenRenewerTest extends org.junit.Assert {
         assertTrue(validatorResponse != null);
         assertTrue(validatorResponse.getToken() != null);
         assertTrue(validatorResponse.getToken().getState() == STATE.VALID);
+        
+        // Now try to renew it again!
+        renewerParameters.setToken(validatorResponse.getToken());
+        
+        samlTokenRenewer = new SAMLTokenRenewer();
+        samlTokenRenewer.setVerifyProofOfPossession(false);
+        assertTrue(samlTokenRenewer.canHandleToken(validatorResponse.getToken()));
+        
+        renewerResponse = samlTokenRenewer.renewToken(renewerParameters);
+        assertTrue(renewerResponse != null);
+        assertTrue(renewerResponse.getToken() != null);
     }
     
     /**
