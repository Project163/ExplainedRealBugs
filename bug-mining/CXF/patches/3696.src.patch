diff --git a/parent/pom.xml b/parent/pom.xml
index beccc913c4..2cec6a4bc4 100644
--- a/parent/pom.xml
+++ b/parent/pom.xml
@@ -135,7 +135,7 @@
         <cxf.jettison.version>1.5.4</cxf.jettison.version>
         <cxf.jetty11.version>11.0.15</cxf.jetty11.version>
         <cxf.jetty.version>${cxf.jetty11.version}</cxf.jetty.version>
-        <cxf.jexl.version>3.2.1</cxf.jexl.version>
+        <cxf.jexl.version>3.3</cxf.jexl.version>
         <cxf.joda.time.version>2.10.10</cxf.joda.time.version>
         <cxf.johnzon.version>1.2.20</cxf.johnzon.version>
         <cxf.json.api.version>2.0.1</cxf.json.api.version>
diff --git a/services/sts/sts-core/pom.xml b/services/sts/sts-core/pom.xml
index 12157623eb..5c11821f0b 100644
--- a/services/sts/sts-core/pom.xml
+++ b/services/sts/sts-core/pom.xml
@@ -107,11 +107,6 @@
             <artifactId>jcl-over-slf4j</artifactId>
             <scope>test</scope>
         </dependency>
-        <dependency>
-            <groupId>org.slf4j</groupId>
-            <artifactId>slf4j-jdk14</artifactId>
-            <scope>test</scope>
-        </dependency>
         <dependency>
             <groupId>${cxf.servlet-api.group}</groupId>
             <artifactId>${cxf.servlet-api.artifact}</artifactId>
diff --git a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/claims/mapper/JexlClaimsMapper.java b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/claims/mapper/JexlClaimsMapper.java
index b01dc98703..dffa1f6a00 100644
--- a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/claims/mapper/JexlClaimsMapper.java
+++ b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/claims/mapper/JexlClaimsMapper.java
@@ -32,6 +32,7 @@ import org.apache.commons.jexl3.JexlContext;
 import org.apache.commons.jexl3.JexlEngine;
 import org.apache.commons.jexl3.JexlScript;
 import org.apache.commons.jexl3.MapContext;
+import org.apache.commons.jexl3.introspection.JexlPermissions.ClassPermissions;
 import org.apache.cxf.common.classloader.ClassLoaderUtils;
 import org.apache.cxf.common.logging.LogUtils;
 import org.apache.cxf.sts.claims.ClaimsMapper;
@@ -52,7 +53,12 @@ public class JexlClaimsMapper implements ClaimsMapper {
         Map<String, Object> functions = new HashMap<>();
         functions.put("claims", new ClaimUtils());
         functions.put("LOG", LOG);
-        jexlEngine = new JexlBuilder().silent(false).namespaces(functions).create();
+        jexlEngine = new JexlBuilder()
+                .silent(false)
+                .namespaces(functions)
+                .permissions(new ClassPermissions(java.net.URI.class)
+                    .compose("org.apache.cxf.*"))
+                .create();
     }
 
     public JexlClaimsMapper(String script) throws IOException {
