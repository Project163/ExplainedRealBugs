diff --git a/core/src/main/java/org/apache/cxf/common/util/WeakIdentityHashMap.java b/core/src/main/java/org/apache/cxf/common/util/WeakIdentityHashMap.java
index 143440c169..5f24946520 100644
--- a/core/src/main/java/org/apache/cxf/common/util/WeakIdentityHashMap.java
+++ b/core/src/main/java/org/apache/cxf/common/util/WeakIdentityHashMap.java
@@ -73,19 +73,23 @@ public class WeakIdentityHashMap<K, V> implements Map<K, V> {
         Set<Map.Entry<K, V>> ret = new HashSet<Map.Entry<K, V>>();
         for (Map.Entry<IdentityWeakReference, V> ref : backingStore.entrySet()) {
             final K key = ref.getKey().get();
-            final V value = ref.getValue();
-            Map.Entry<K, V> entry = new Map.Entry<K, V>() {
-                public K getKey() {
-                    return key;
-                }
-                public V getValue() {
-                    return value;
-                }
-                public V setValue(V value) {
-                    throw new UnsupportedOperationException();
-                }
-            };
-            ret.add(entry);
+            if (key != null) {
+                final V value = ref.getValue();
+                Map.Entry<K, V> entry = new Map.Entry<K, V>() {
+                    public K getKey() {
+                        return key;
+                    }
+
+                    public V getValue() {
+                        return value;
+                    }
+
+                    public V setValue(V value) {
+                        throw new UnsupportedOperationException();
+                    }
+                };
+                ret.add(entry);
+            }
         }
         return Collections.unmodifiableSet(ret);
     }
@@ -93,7 +97,10 @@ public class WeakIdentityHashMap<K, V> implements Map<K, V> {
         reap();
         Set<K> ret = new HashSet<>();
         for (IdentityWeakReference ref : backingStore.keySet()) {
-            ret.add(ref.get());
+            K key = ref.get();
+            if (key != null) {
+                ret.add(key);
+            }
         }
         return Collections.unmodifiableSet(ret);
     }
