diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java
index fbd94d012a..b6fff97a16 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java
@@ -117,18 +117,22 @@ public class ClassLoaderSwitcher {
      * Restore the old classloader
      */
     public void restoreClassLoader() {
-        Thread.currentThread().setContextClassLoader(origContextClassloader);
+        if (origContextClassloader != null) {
+            Thread.currentThread().setContextClassLoader(origContextClassloader);
+            origContextClassloader = null; // don't hold a reference.
+        }
         if (origClassPath != null) {
             System.setProperty("java.class.path", origClassPath);
         }
 
-        Map<Object, Object> newProps = new HashMap<Object, Object>(System.getProperties());
-        for (Object o : newProps.keySet()) {
-            if (!origProps.containsKey(o)) {
-                System.clearProperty(o.toString());
+        if (origProps != null) {
+            Map<Object, Object> newProps = new HashMap<Object, Object>(System.getProperties());
+            for (Object o : newProps.keySet()) {
+                if (!origProps.containsKey(o)) {
+                    System.clearProperty(o.toString());
+                }
             }
+            System.getProperties().putAll(origProps);
         }
-        System.getProperties().putAll(origProps);
-        origContextClassloader = null; // don't hold a reference.
     }
 }
diff --git a/maven-plugins/java2ws-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java b/maven-plugins/java2ws-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java
index a78a25bda2..0f8ca2c651 100644
--- a/maven-plugins/java2ws-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java
+++ b/maven-plugins/java2ws-plugin/src/main/java/org/apache/cxf/maven_plugin/ClassLoaderSwitcher.java
@@ -110,18 +110,22 @@ public class ClassLoaderSwitcher {
      * Restore the old classloader
      */
     public void restoreClassLoader() {
-        Thread.currentThread().setContextClassLoader(origContextClassloader);
+        if (origContextClassloader != null) {
+            Thread.currentThread().setContextClassLoader(origContextClassloader);
+            origContextClassloader = null; // don't hold a reference.
+        }
         if (origClassPath != null) {
             System.setProperty("java.class.path", origClassPath);
         }
 
-        Map<Object, Object> newProps = new HashMap<Object, Object>(System.getProperties());
-        for (Object o : newProps.keySet()) {
-            if (!origProps.containsKey(o)) {
-                System.clearProperty(o.toString());
+        if (origProps != null) {
+            Map<Object, Object> newProps = new HashMap<Object, Object>(System.getProperties());
+            for (Object o : newProps.keySet()) {
+                if (!origProps.containsKey(o)) {
+                    System.clearProperty(o.toString());
+                }
             }
+            System.getProperties().putAll(origProps);
         }
-        System.getProperties().putAll(origProps);
-        origContextClassloader = null; // don't hold a reference.
     }
 }
diff --git a/maven-plugins/wadl2java-plugin/src/main/java/org/apache/cxf/maven_plugin/common/ClassLoaderSwitcher.java b/maven-plugins/wadl2java-plugin/src/main/java/org/apache/cxf/maven_plugin/common/ClassLoaderSwitcher.java
index 122e2aa2ee..21b13ef0e8 100644
--- a/maven-plugins/wadl2java-plugin/src/main/java/org/apache/cxf/maven_plugin/common/ClassLoaderSwitcher.java
+++ b/maven-plugins/wadl2java-plugin/src/main/java/org/apache/cxf/maven_plugin/common/ClassLoaderSwitcher.java
@@ -119,18 +119,22 @@ public class ClassLoaderSwitcher {
      * Restore the old classloader
      */
     public void restoreClassLoader() {
-        Thread.currentThread().setContextClassLoader(origContextClassloader);
+        if (origContextClassloader != null) {
+            Thread.currentThread().setContextClassLoader(origContextClassloader);
+            origContextClassloader = null; // don't hold a reference.
+        }
         if (origClassPath != null) {
             System.setProperty("java.class.path", origClassPath);
         }
 
-        Map<Object, Object> newProps = new HashMap<Object, Object>(System.getProperties());
-        for (Object o : newProps.keySet()) {
-            if (!origProps.containsKey(o)) {
-                System.clearProperty(o.toString());
+        if (origProps != null) {
+            Map<Object, Object> newProps = new HashMap<Object, Object>(System.getProperties());
+            for (Object o : newProps.keySet()) {
+                if (!origProps.containsKey(o)) {
+                    System.clearProperty(o.toString());
+                }
             }
+            System.getProperties().putAll(origProps);
         }
-        System.getProperties().putAll(origProps);
-        origContextClassloader = null; // don't hold a reference.
     }
 }
