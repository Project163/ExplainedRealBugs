diff --git a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/auth/DigestAuthSupplier.java b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/auth/DigestAuthSupplier.java
index f34cfc8475..a8d6266a90 100644
--- a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/auth/DigestAuthSupplier.java
+++ b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/auth/DigestAuthSupplier.java
@@ -74,11 +74,7 @@ public class DigestAuthSupplier implements HttpAuthSupplier {
                 /* Preemptive authentication is only possible if we have a cached
                  * challenge
                  */
-                String authURI = currentURI.getPath();
-                if (currentURI.getQuery() != null) {
-                    authURI += '?' + currentURI.getQuery();
-                }
-                return di.generateAuth(authURI, 
+                return di.generateAuth(getAuthURI(currentURI), 
                                        authPolicy.getUserName(),
                                        authPolicy.getPassword());            
             } else {
@@ -107,7 +103,7 @@ public class DigestAuthSupplier implements HttpAuthSupplier {
                 }
                 authInfo.put(currentURI, di);
                 
-                return di.generateAuth(currentURI.getPath(), 
+                return di.generateAuth(getAuthURI(currentURI), 
                                        authPolicy.getUserName(),
                                        authPolicy.getPassword());
             }
@@ -116,6 +112,14 @@ public class DigestAuthSupplier implements HttpAuthSupplier {
         return null;
     }
 
+    private static String getAuthURI(URI currentURI) {
+        String authURI = currentURI.getPath();
+        if (currentURI.getQuery() != null) {
+            authURI += '?' + currentURI.getQuery();
+        }
+        return authURI;
+    }
+
     public String createCnonce() throws UnsupportedEncodingException {
         String cnonce = Long.toString(System.currentTimeMillis());
         byte[] bytes = cnonce.getBytes("US-ASCII");
