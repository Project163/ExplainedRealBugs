diff --git a/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java b/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java
index 9ff55109a4..cd5b306155 100644
--- a/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java
+++ b/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java
@@ -67,6 +67,8 @@ public final class PackageUtils {
             }
             if (j == lParts.size()) {
                 currentParts.add(lParts.get(j - 1).get(i));
+            } else {
+                break;
             }
         }
         StringBuilder sb = new StringBuilder();
diff --git a/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java b/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java
index f4401f64a5..03ad66dea7 100644
--- a/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java
+++ b/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java
@@ -93,4 +93,11 @@ public class PackageUtilsTest extends Assert {
                     org.apache.cxf.common.jaxb.JAXBContextCache.class));       
         assertEquals("", packageName);
     }
+    @Test
+    public void testSharedPackageNameManyClassesCommonRoot6() {
+        String packageName = PackageUtils.getSharedPackageName(
+            Arrays.asList(org.apache.cxf.bus.spring.BusApplicationContext.class,
+                    org.apache.cxf.configuration.spring.JAXBBeanFactory.class));
+        assertEquals("org.apache.cxf", packageName);
+    }
 }
