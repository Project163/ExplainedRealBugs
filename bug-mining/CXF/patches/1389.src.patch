diff --git a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RMCaptureInInterceptor.java b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RMCaptureInInterceptor.java
index fcc248bc64..ab4c8459e3 100755
--- a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RMCaptureInInterceptor.java
+++ b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RMCaptureInInterceptor.java
@@ -54,6 +54,7 @@ public class RMCaptureInInterceptor extends AbstractRMInterceptor<Message> {
 
                     saved.flush();
                     is.close();
+                    saved.lockOutputStream();
 
                     message.setContent(InputStream.class, saved.getInputStream());
                     LOG.fine("Capturing the original RM message");
diff --git a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RetransmissionCallback.java b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RetransmissionCallback.java
index a1eb82bdac..0ded2cae6b 100644
--- a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RetransmissionCallback.java
+++ b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/RetransmissionCallback.java
@@ -48,6 +48,7 @@ public class RetransmissionCallback implements CachedOutputStreamCallback {
         saved.holdTempFile();
         try {
             cos.writeCacheTo(saved);            
+            saved.lockOutputStream();
         } catch (IOException e) {
             // ignore
         }
diff --git a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/persistence/jdbc/RMTxStore.java b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/persistence/jdbc/RMTxStore.java
index 5c171a41d7..75e860f545 100644
--- a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/persistence/jdbc/RMTxStore.java
+++ b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/persistence/jdbc/RMTxStore.java
@@ -733,16 +733,28 @@ public class RMTxStore implements RMStore {
             LOG.log(Level.FINE, "Storing {0} message number {1} for sequence {2}, to = {3}",
                     new Object[] {outbound ? "outbound" : "inbound", nr, id, to});
         }
-        PreparedStatement stmt = outbound ? createOutboundMessageStmt : createInboundMessageStmt;
-        int i = 1;
-        stmt.setString(i++, id);  
-        stmt.setLong(i++, nr);
-        stmt.setString(i++, to); 
-        stmt.setBinaryStream(i++, msg.getInputStream(), (int)msg.getSize());
-        stmt.execute();
-        if (LOG.isLoggable(Level.FINE)) {
-            LOG.log(Level.FINE, "Successfully stored {0} message number {1} for sequence {2}",
-                    new Object[] {outbound ? "outbound" : "inbound", nr, id});
+        InputStream msgin = null;
+        try {
+            msgin = msg.getInputStream();
+            PreparedStatement stmt = outbound ? createOutboundMessageStmt : createInboundMessageStmt;
+            int i = 1;
+            stmt.setString(i++, id);  
+            stmt.setLong(i++, nr);
+            stmt.setString(i++, to); 
+            stmt.setBinaryStream(i++, msgin, (int)msg.getSize());
+            stmt.execute();
+            if (LOG.isLoggable(Level.FINE)) {
+                LOG.log(Level.FINE, "Successfully stored {0} message number {1} for sequence {2}",
+                        new Object[] {outbound ? "outbound" : "inbound", nr, id});
+            }
+        } finally  {
+            if (msgin != null) {
+                try {
+                    msgin.close();
+                } catch (IOException e) {
+                    // ignore
+                }
+            }
         }
         
     }
diff --git a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RetransmissionQueueImpl.java b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RetransmissionQueueImpl.java
index af3b49ef07..4423d3821d 100644
--- a/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RetransmissionQueueImpl.java
+++ b/rt/ws/rm/src/main/java/org/apache/cxf/ws/rm/soap/RetransmissionQueueImpl.java
@@ -659,6 +659,12 @@ public class RetransmissionQueueImpl implements RetransmissionQueue {
             CachedOutputStream saved = (CachedOutputStream)message.remove(RMMessageConstants.SAVED_CONTENT);
             if (saved != null) {
                 saved.releaseTempFileHold();
+                // call close to dispose
+                try {
+                    saved.close();
+                } catch (IOException e) {
+                    // ignore
+                }
             }
         }
 
