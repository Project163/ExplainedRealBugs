diff --git a/rt/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java b/rt/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java
index ec15e9d344..b298be53f7 100644
--- a/rt/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java
+++ b/rt/core/src/main/java/org/apache/cxf/endpoint/ClientImpl.java
@@ -151,7 +151,11 @@ public class ClientImpl
         EndpointInfo epfo = findEndpoint(svc, port);
 
         try {
-            getConduitSelector().setEndpoint(new EndpointImpl(bus, svc, epfo));
+            if (endpointImplFactory != null) {
+                getConduitSelector().setEndpoint(endpointImplFactory.newEndpointImpl(bus, svc, epfo));
+            } else {
+                getConduitSelector().setEndpoint(new EndpointImpl(bus, svc, epfo));
+            }
         } catch (EndpointException epex) {
             throw new IllegalStateException("Unable to create endpoint: " + epex.getMessage(), epex);
         }
diff --git a/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/DynamicClientFactory.java b/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/DynamicClientFactory.java
index acd3de75e1..5367fb255c 100644
--- a/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/DynamicClientFactory.java
+++ b/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/DynamicClientFactory.java
@@ -362,13 +362,18 @@ public class DynamicClientFactory {
         // Setup the new classloader!
         Thread.currentThread().setContextClassLoader(cl);
 
-        TypeClassInitializer visitor = new TypeClassInitializer(svcfo, intermediateModel);
+        TypeClassInitializer visitor = new TypeClassInitializer(svcfo, 
+                                                                intermediateModel,
+                                                                allowWrapperOps());
         visitor.walk();
         // delete the classes files
         FileUtils.removeDir(classes);
         return client;
     }
-
+    protected boolean allowWrapperOps() {
+        return false;
+    }
+    
     private void addBindingFiles(List<String> bindingFiles, SchemaCompiler compiler) {
         if (bindingFiles != null) {
             for (String s : bindingFiles) {
diff --git a/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/TypeClassInitializer.java b/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/TypeClassInitializer.java
index 4373cce56f..e58d4c4b08 100644
--- a/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/TypeClassInitializer.java
+++ b/rt/databinding/jaxb/src/main/java/org/apache/cxf/endpoint/dynamic/TypeClassInitializer.java
@@ -44,16 +44,20 @@ public class TypeClassInitializer extends ServiceModelVisitor {
     private static final Logger LOG = LogUtils.getL7dLogger(TypeClassInitializer.class);
     
     S2JJAXBModel model;
+    boolean allowWrapperOperations;
     
-    public TypeClassInitializer(ServiceInfo serviceInfo, S2JJAXBModel model) {
+    public TypeClassInitializer(ServiceInfo serviceInfo, 
+                                S2JJAXBModel model,
+                                boolean allowWr) {
         super(serviceInfo);
         this.model = model;
+        this.allowWrapperOperations = allowWr;
     }
 
     @Override
     public void begin(MessagePartInfo part) {
         OperationInfo op = part.getMessageInfo().getOperation();
-        if (op.isUnwrappedCapable() && !op.isUnwrapped()) {
+        if (!allowWrapperOperations && op.isUnwrappedCapable() && !op.isUnwrapped()) {
             return;
         }
         
@@ -120,6 +124,12 @@ public class TypeClassInitializer extends ServiceModelVisitor {
                 rootType = rootType.elementType();
                 arrayCount++;
             }
+            if (arrayCount == 0
+                && part.isElement()
+                && part.getXmlSchema() instanceof XmlSchemaElement
+                && ((XmlSchemaElement)part.getXmlSchema()).getMaxOccurs() > 1) {
+                arrayCount = 1;
+            }
             cls = getClassByName(rootType);
             // bmargulies cannot find a way to ask the JVM to do this without creating 
             // an array object on the way.
diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/endpoint/dynamic/JaxWsDynamicClientFactory.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/endpoint/dynamic/JaxWsDynamicClientFactory.java
index 5045c4e753..ba063fd945 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/endpoint/dynamic/JaxWsDynamicClientFactory.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/endpoint/dynamic/JaxWsDynamicClientFactory.java
@@ -46,7 +46,10 @@ public class JaxWsDynamicClientFactory extends DynamicClientFactory {
     protected EndpointImplFactory getEndpointImplFactory() {
         return JaxWsEndpointImplFactory.getSingleton();
     }
-    
+    protected boolean allowWrapperOps() {
+        return true;
+    }
+
     /**
      * Create a new instance using a specific <tt>Bus</tt>.
      * 
diff --git a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/HolderInInterceptor.java b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/HolderInInterceptor.java
index 5ae7be31b5..222c13910a 100644
--- a/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/HolderInInterceptor.java
+++ b/rt/frontend/jaxws/src/main/java/org/apache/cxf/jaxws/interceptors/HolderInInterceptor.java
@@ -61,8 +61,10 @@ public class HolderInInterceptor extends AbstractPhaseInterceptor<Message> {
             for (MessagePartInfo part : parts) {
                 if (part.getIndex() != 0 && part.getTypeClass() != null) {
                     Holder holder = (Holder)outHolders.get(part.getIndex() - 1);
-                    holder.value = inObjects.get(part);
-                    inObjects.put(part, holder);
+                    if (holder != null) {
+                        holder.value = inObjects.get(part);
+                        inObjects.put(part, holder);
+                    }
                 }
             }
         } else {
diff --git a/systests/jaxws/src/test/java/org/apache/cxf/systest/jaxws/JaxWsDynamicClientTest.java b/systests/jaxws/src/test/java/org/apache/cxf/systest/jaxws/JaxWsDynamicClientTest.java
index 88563d7136..a051439c2d 100644
--- a/systests/jaxws/src/test/java/org/apache/cxf/systest/jaxws/JaxWsDynamicClientTest.java
+++ b/systests/jaxws/src/test/java/org/apache/cxf/systest/jaxws/JaxWsDynamicClientTest.java
@@ -81,5 +81,5 @@ public class JaxWsDynamicClientTest extends AbstractBusClientServerTestBase {
         r = (Operation1Response)rparts[0];
         assertEquals(md5(bucketOfBytes), r.getStatus());
     }
-
+    
 }
