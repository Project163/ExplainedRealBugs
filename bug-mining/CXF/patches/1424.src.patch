diff --git a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/DefaultSubjectProvider.java b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/DefaultSubjectProvider.java
index b874d79eba..9da7fbd59c 100644
--- a/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/DefaultSubjectProvider.java
+++ b/services/sts/sts-core/src/main/java/org/apache/cxf/sts/token/provider/DefaultSubjectProvider.java
@@ -211,6 +211,7 @@ public class DefaultSubjectProvider implements SubjectProvider {
         encrKey.setEphemeralKey(secret);
         encrKey.setSymmetricEncAlgorithm(encryptionProperties.getEncryptionAlgorithm());
         encrKey.setUseThisCert(certificate);
+        encrKey.setKeyEncAlgo(encryptionProperties.getKeyWrapAlgorithm());
         encrKey.prepare(doc, encryptionCrypto);
         Element encryptedKeyElement = encrKey.getEncryptedKeyElement();
 
