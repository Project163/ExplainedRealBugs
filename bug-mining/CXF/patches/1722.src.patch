diff --git a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/Headers.java b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/Headers.java
index 5f28c7fdce..73d6d485a4 100644
--- a/rt/transports/http/src/main/java/org/apache/cxf/transport/http/Headers.java
+++ b/rt/transports/http/src/main/java/org/apache/cxf/transport/http/Headers.java
@@ -320,7 +320,8 @@ public class Headers {
                 connection.setRequestProperty(header, b.toString());
             }
         }
-        if (!connection.getRequestProperties().containsKey("User-Agent")) {
+        // make sure we don't add more than one User-Agent header
+        if (connection.getRequestProperty("User-Agent") != null) {
             connection.addRequestProperty("User-Agent", Version.getCompleteVersionString());
         }
     }
