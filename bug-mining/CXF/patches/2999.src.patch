diff --git a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractContentEncryptionAlgorithm.java b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractContentEncryptionAlgorithm.java
index 6e2728957a..11a76f3575 100644
--- a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractContentEncryptionAlgorithm.java
+++ b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractContentEncryptionAlgorithm.java
@@ -53,7 +53,9 @@ public abstract class AbstractContentEncryptionAlgorithm extends AbstractContent
             theCek = CryptoUtils.getSecretKey(AlgorithmUtils.stripAlgoProperties(algoJava),
                           getContentEncryptionKeySize(headers)).getEncoded();
             if (generateCekOnce) {
-                cek = theCek;
+                synchronized (this) {
+                    cek = theCek;
+                }
             }
         } else {
             theCek = cek;
diff --git a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweUtils.java b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweUtils.java
index e5828be337..613fc77c0d 100644
--- a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweUtils.java
+++ b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweUtils.java
@@ -269,8 +269,12 @@ public final class JweUtils {
         return null;
     }
     public static ContentEncryptionProvider getContentEncryptionProvider(ContentAlgorithm algorithm) {
+        return getContentEncryptionProvider(algorithm, false);
+    }
+    public static ContentEncryptionProvider getContentEncryptionProvider(ContentAlgorithm algorithm, 
+                                                                         boolean generateCekOnce) {
         if (AlgorithmUtils.isAesGcm(algorithm.getJwaName())) {
-            return new AesGcmContentEncryptionAlgorithm(algorithm);
+            return new AesGcmContentEncryptionAlgorithm(algorithm, generateCekOnce);
         }
         return null;
     }
