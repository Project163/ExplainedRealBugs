diff --git a/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java b/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java
index c80352e431..a67a78934d 100644
--- a/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java
+++ b/core/src/main/java/org/apache/cxf/common/util/CompressionUtils.java
@@ -53,8 +53,11 @@ public final class CompressionUtils {
                         break;
                     }
                 }
-                
+                byte[] lastInflatedToken = inflatedToken;
                 inflatedToken = new byte[input.length + inflatedLen];
+                if (lastInflatedToken != input) {
+                    System.arraycopy(lastInflatedToken, 0, inflatedToken, 0, inflatedLen);
+                }
                 System.arraycopy(input, 0, inflatedToken, inflatedLen, inputLen);
                 inflatedLen += inputLen;
             }
diff --git a/rt/rs/security/xml/src/test/java/org/apache/cxf/rs/security/saml/DeflateEncoderDecoderTest.java b/rt/rs/security/xml/src/test/java/org/apache/cxf/rs/security/saml/DeflateEncoderDecoderTest.java
index 15a2512a00..38bfdf4aa4 100644
--- a/rt/rs/security/xml/src/test/java/org/apache/cxf/rs/security/saml/DeflateEncoderDecoderTest.java
+++ b/rt/rs/security/xml/src/test/java/org/apache/cxf/rs/security/saml/DeflateEncoderDecoderTest.java
@@ -70,7 +70,7 @@ public class DeflateEncoderDecoderTest extends Assert {
         String token = "valid_grant valid_grant valid_grant valid_grant valid_grant valid_grant";
 
         DeflateEncoderDecoder deflateEncoderDecoder = new DeflateEncoderDecoder();
-        byte[] deflatedToken = deflateEncoderDecoder.deflateToken(token.getBytes(), 0, true);
+        byte[] deflatedToken = deflateEncoderDecoder.deflateToken(token.getBytes());
 
         String cxfInflatedToken = IOUtils
                 .toString(deflateEncoderDecoder.inflateToken(deflatedToken));
