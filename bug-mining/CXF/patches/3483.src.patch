diff --git a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractJweEncryption.java b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractJweEncryption.java
index a1b226ec2c..008922449e 100644
--- a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractJweEncryption.java
+++ b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/AbstractJweEncryption.java
@@ -198,7 +198,8 @@ public abstract class AbstractJweEncryption implements JweEncryptionProvider {
 
         JweEncryptionInternal state = new JweEncryptionInternal();
         state.jweContentEncryptionKey = getEncryptedContentEncryptionKey(theHeaders, theCek);
-
+        state.theHeaders = theHeaders;
+        
         if (jweInput.isContentEncryptionRequired()) {
             String contentEncryptionAlgoJavaName = getContentEncryptionAlgoJava();
             KeyProperties keyProps = new KeyProperties(contentEncryptionAlgoJavaName);
@@ -216,7 +217,6 @@ public abstract class AbstractJweEncryption implements JweEncryptionProvider {
 
             state.keyProps = keyProps;
             state.theIv = theIv;
-            state.theHeaders = theHeaders;
             state.protectedHeadersJson = protectedHeadersJson;
             state.aad = jweInput.getAad();
             state.secretKey = theCek;
diff --git a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducer.java b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducer.java
index 6bb5fe777c..f3dde4ea22 100644
--- a/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducer.java
+++ b/rt/rs/security/jose-parent/jose/src/main/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducer.java
@@ -128,6 +128,22 @@ public class JweJsonProducer {
                 input.setContentEncryptionRequired(false);
             }
             JweEncryptionOutput state = encryptor.getEncryptionOutput(input);
+            
+            if (state.getHeaders() != null && state.getHeaders().asMap().size() != jsonHeaders.asMap().size()) {
+                // New headers were generated during encryption for recipient
+                Map<String, Object> newHeaders = new LinkedHashMap<String, Object>();
+                state.getHeaders().asMap().forEach((name, value) -> {
+                    if (!unionHeaders.containsHeader(name)) {
+                        // store recipient header
+                        newHeaders.put(name, value);
+                    }
+                });
+                Map<String, Object> perRecipientUnprotectedHeaders = (perRecipientUnprotected != null) 
+                    ? new LinkedHashMap<String, Object>(perRecipientUnprotected.asMap()) 
+                        : new LinkedHashMap<String, Object>();
+                perRecipientUnprotectedHeaders.putAll(newHeaders);
+                perRecipientUnprotected = new JweHeaders(perRecipientUnprotectedHeaders);
+            }
             byte[] currentCipherText = state.getEncryptedContent();
             byte[] currentAuthTag = state.getAuthTag();
             byte[] currentIv = state.getIv();
@@ -152,11 +168,11 @@ public class JweJsonProducer {
             entries.add(new JweJsonEncryptionEntry(perRecipientUnprotected, encodedCek));
 
         }
-        if (protectedHeader != null) {
+        if (protectedHeader != null && !protectedHeader.asMap().isEmpty()) {
             jweJsonMap.put("protected",
                         Base64UrlUtility.encode(writer.toJson(protectedHeader)));
         }
-        if (unprotectedHeader != null) {
+        if (unprotectedHeader != null && !unprotectedHeader.asMap().isEmpty()) {
             jweJsonMap.put("unprotected", unprotectedHeader);
         }
         if (entries.size() == 1 && canBeFlat) {
diff --git a/rt/rs/security/jose-parent/jose/src/test/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducerTest.java b/rt/rs/security/jose-parent/jose/src/test/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducerTest.java
index c1a2f35dda..164dc33b29 100644
--- a/rt/rs/security/jose-parent/jose/src/test/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducerTest.java
+++ b/rt/rs/security/jose-parent/jose/src/test/java/org/apache/cxf/rs/security/jose/jwe/JweJsonProducerTest.java
@@ -71,7 +71,7 @@ public class JweJsonProducerTest {
         + "\"protected\":\"eyJlbmMiOiJBMTI4R0NNIn0\","
         + "\"recipients\":"
         + "["
-        + "{}"
+        + "{\"header\":{\"alg\":\"dir\"}}"
         + "],"
         + "\"iv\":\"48V1_ALb6US04U3b\","
         + "\"ciphertext\":\"KTuJBMk9QG59xPB-c_YLM5-J7VG40_eMPvyHDD7eB-WHj_34YiWgpBOydTBm4RW0zUCJZ09xqorhWJME-DcQ\","
@@ -80,6 +80,7 @@ public class JweJsonProducerTest {
     static final String SINGLE_RECIPIENT_DIRECT_FLAT_OUTPUT =
         "{"
         + "\"protected\":\"eyJlbmMiOiJBMTI4R0NNIn0\","
+        + "\"header\":{\"alg\":\"dir\"},"
         + "\"iv\":\"48V1_ALb6US04U3b\","
         + "\"ciphertext\":\"KTuJBMk9QG59xPB-c_YLM5-J7VG40_eMPvyHDD7eB-WHj_34YiWgpBOydTBm4RW0zUCJZ09xqorhWJME-DcQ\","
         + "\"tag\":\"Te59ApbK8wNBDY_1_dgYSw\""
@@ -146,7 +147,7 @@ public class JweJsonProducerTest {
         + "\"protected\":\"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0\","
         + "\"recipients\":"
         + "["
-        + "{}"
+        + "{\"header\":{\"alg\":\"dir\"}}"
         + "],"
         + "\"iv\":\"AxY8DCtDaGlsbGljb3RoZQ\","
         + "\"ciphertext\":\"KDlTtXchhZTGufMYmOYGS4HffxPSUrfmqCHXaI9wOGY\","
