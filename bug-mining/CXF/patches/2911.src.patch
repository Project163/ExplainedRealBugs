diff --git a/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java b/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java
index b743320f82..9ff55109a4 100644
--- a/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java
+++ b/core/src/main/java/org/apache/cxf/common/util/PackageUtils.java
@@ -20,7 +20,6 @@
 package org.apache.cxf.common.util;
 
 import java.util.ArrayList;
-import java.util.Collections;
 import java.util.List;
 import java.util.StringTokenizer;
 
@@ -51,20 +50,23 @@ public final class PackageUtils {
     }
     
     public static String getSharedPackageName(List<Class<?>> classes) {
-        List<String> currentParts = null;
+        if (classes.isEmpty()) {
+            return "";
+        }
+        List<List<String>> lParts = new  ArrayList<List<String>>(classes.size());
+        List<String> currentParts = new ArrayList<String>();
         for (Class<?> cls : classes) {
-            List<String> parts = StringUtils.getParts(getPackageName(cls), "\\.");
-            if (currentParts == null) {
-                currentParts = parts;
-            } else {
-                List<String> subList = Collections.emptyList();
-                for (int i = parts.size() - 1; i > 0; i--) {
-                    subList = parts.subList(0, i + 1);
-                    if (currentParts.equals(subList)) {
-                        break;
-                    }
-                }
-                currentParts.retainAll(subList);
+            lParts.add(StringUtils.getParts(getPackageName(cls), "\\."));
+        }
+        for (int i = 0; i < lParts.get(0).size(); i++) {
+            int j = 1;
+            for (; j < lParts.size(); j++) {
+                if (i > (lParts.get(j).size() - 1) || !lParts.get(j).get(i).equals(lParts.get(0).get(i))) {
+                    break;
+                }  
+            }
+            if (j == lParts.size()) {
+                currentParts.add(lParts.get(j - 1).get(i));
             }
         }
         StringBuilder sb = new StringBuilder();
diff --git a/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java b/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java
index 644e529b12..f4401f64a5 100644
--- a/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java
+++ b/core/src/test/java/org/apache/cxf/common/util/PackageUtilsTest.java
@@ -77,4 +77,20 @@ public class PackageUtilsTest extends Assert {
             Arrays.asList(Annotation.class, Array.class));       
         assertEquals("java.lang", packageName);
     }
+    @Test
+    public void testSharedPackageNameManyClassesCommonRoot4() throws Exception {
+        String packageName = PackageUtils.getSharedPackageName(
+            Arrays.asList(org.apache.cxf.common.util.PackageUtils.class, 
+                    org.apache.cxf.bus.CXFBusFactory.class,
+                    org.apache.cxf.common.jaxb.JAXBContextCache.class));       
+        assertEquals("org.apache.cxf", packageName);
+    }
+    @Test
+    public void testSharedPackageNameManyClassesCommonRoot5() throws Exception {
+        String packageName = PackageUtils.getSharedPackageName(
+            Arrays.asList(java.lang.annotation.Annotation.class, 
+                    org.apache.cxf.bus.CXFBusFactory.class,
+                    org.apache.cxf.common.jaxb.JAXBContextCache.class));       
+        assertEquals("", packageName);
+    }
 }
