diff --git a/rt/core/src/main/java/org/apache/cxf/attachment/AttachmentSerializer.java b/rt/core/src/main/java/org/apache/cxf/attachment/AttachmentSerializer.java
index 6bfac26f09..dfdd048c87 100644
--- a/rt/core/src/main/java/org/apache/cxf/attachment/AttachmentSerializer.java
+++ b/rt/core/src/main/java/org/apache/cxf/attachment/AttachmentSerializer.java
@@ -127,7 +127,7 @@ public class AttachmentSerializer {
         writer.write("Content-ID: <");
         if (attachmentId.charAt(0) == '<'
             && attachmentId.charAt(attachmentId.length() - 1) == '>') {
-            attachmentId = attachmentId.substring(1, attachmentId.length() - 2);
+            attachmentId = attachmentId.substring(1, attachmentId.length() - 1);
         }
         writer.write(URLDecoder.decode(attachmentId, "UTF-8"));
         writer.write(">\r\n\r\n");
diff --git a/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java b/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java
index e4fa9b82d2..18fcce7b86 100644
--- a/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java
+++ b/rt/core/src/main/java/org/apache/cxf/transport/http/WSDLQueryHandler.java
@@ -109,7 +109,15 @@ public class WSDLQueryHandler implements StemMatchingQueryHandler {
         try {
             int idx = baseUri.toLowerCase().indexOf("?");
             Map<String, String> params = UrlUtilities.parseQueryString(baseUri.substring(idx + 1));
-            String base = baseUri.substring(0, baseUri.toLowerCase().indexOf("?"));
+
+            String base;
+            
+            if (endpointInfo.getProperty("publishedEndpointUrl") != null) {
+                base = String.valueOf(endpointInfo.getProperty("publishedEndpointUrl"));
+            } else {
+                base = baseUri.substring(0, baseUri.toLowerCase().indexOf("?"));
+            }
+
             String wsdl = params.get("wsdl");
             String xsd =  params.get("xsd");
             
