diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/TransportBindingHandler.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/TransportBindingHandler.java
index 09c0121905..f77fd35bcf 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/TransportBindingHandler.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/TransportBindingHandler.java
@@ -62,6 +62,7 @@ import org.apache.ws.security.WSConstants;
 import org.apache.ws.security.WSEncryptionPart;
 import org.apache.ws.security.WSPasswordCallback;
 import org.apache.ws.security.WSSConfig;
+import org.apache.ws.security.WSSecurityException;
 import org.apache.ws.security.components.crypto.Crypto;
 import org.apache.ws.security.conversation.ConversationConstants;
 import org.apache.ws.security.message.WSSecDKSign;
@@ -281,7 +282,6 @@ public class TransportBindingHandler extends AbstractBindingBuilder {
         if (token instanceof IssuedToken
             || token instanceof SecureConversationToken
             || token instanceof SecurityContextToken
-            || token instanceof KeyValueToken
             || token instanceof KerberosToken) {
             addSig(
                 signatureValues, 
@@ -387,6 +387,10 @@ public class TransportBindingHandler extends AbstractBindingBuilder {
         boolean tokenIncluded = false;
         // Get the issued token
         SecurityToken secTok = getSecurityToken();
+        if (secTok == null) {
+            LOG.fine("The retrieved SecurityToken was null");
+            throw new WSSecurityException("The retrieved SecurityToken was null");
+        }
         
         if (includeToken(token.getInclusion())) {
             //Add the token
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSupportingTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSupportingTokenPolicyValidator.java
index 1011cc85e0..f9af3349f2 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSupportingTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSupportingTokenPolicyValidator.java
@@ -19,6 +19,7 @@
 
 package org.apache.cxf.ws.security.wss4j.policyvalidators;
 
+import java.security.PublicKey;
 import java.security.cert.X509Certificate;
 import java.util.ArrayList;
 import java.util.Arrays;
@@ -299,6 +300,40 @@ public abstract class AbstractSupportingTokenPolicyValidator
         return true;
     }
     
+    /**
+     * Process KeyValue Tokens.
+     */
+    protected boolean processKeyValueTokens() {
+        List<WSSecurityEngineResult> tokenResults = new ArrayList<WSSecurityEngineResult>();
+        for (WSSecurityEngineResult wser : signedResults) {
+            PublicKey publicKey = 
+                (PublicKey)wser.get(WSSecurityEngineResult.TAG_PUBLIC_KEY);
+            if (publicKey != null) {
+                tokenResults.add(wser);
+            }
+        }
+        
+        if (tokenResults.isEmpty()) {
+            return false;
+        }
+        
+        if (signed && !areTokensSigned(tokenResults)) {
+            return false;
+        }
+        if (encrypted && !areTokensEncrypted(tokenResults)) {
+            return false;
+        }
+        if (endorsed && !checkEndorsed(tokenResults)) {
+            return false;
+        }
+        
+        if (!validateSignedEncryptedPolicies(tokenResults)) {
+            return false;
+        }
+        
+        return true;
+    }
+    
     /**
      * Validate (SignedParts|SignedElements|EncryptedParts|EncryptedElements) policies of this
      * SupportingToken.
@@ -447,7 +482,7 @@ public abstract class AbstractSupportingTokenPolicyValidator
         if (!isTLSInUse()) {
             for (WSSecurityEngineResult wser : tokens) {
                 Element tokenElement = (Element)wser.get(WSSecurityEngineResult.TAG_TOKEN_ELEMENT);
-                if (!isTokenSigned(tokenElement)) {
+                if (tokenElement == null || !isTokenSigned(tokenElement)) {
                     return false;
                 }
             }
@@ -462,7 +497,7 @@ public abstract class AbstractSupportingTokenPolicyValidator
         if (!isTLSInUse()) {
             for (WSSecurityEngineResult wser : tokens) {
                 Element tokenElement = (Element)wser.get(WSSecurityEngineResult.TAG_TOKEN_ELEMENT);
-                if (!isTokenEncrypted(tokenElement)) {
+                if (tokenElement == null || !isTokenEncrypted(tokenElement)) {
                     return false;
                 }
             }
@@ -538,6 +573,8 @@ public abstract class AbstractSupportingTokenPolicyValidator
             Integer actInt = (Integer)token.get(WSSecurityEngineResult.TAG_ACTION);
             BinarySecurity binarySecurity = 
                 (BinarySecurity)token.get(WSSecurityEngineResult.TAG_BINARY_SECURITY_TOKEN);
+            PublicKey publicKey = 
+                (PublicKey)token.get(WSSecurityEngineResult.TAG_PUBLIC_KEY);
             if (binarySecurity instanceof X509Security
                 || binarySecurity instanceof PKIPathSecurity) {
                 X509Certificate foundCert = 
@@ -560,14 +597,18 @@ public abstract class AbstractSupportingTokenPolicyValidator
                         return true;
                     }
                 }
-            } else {
-                byte[] foundSecret = (byte[])token.get(WSSecurityEngineResult.TAG_SECRET);
-                if (foundSecret != null && Arrays.equals(foundSecret, secret)) {
+            } else if (publicKey != null) {
+                PublicKey foundPublicKey = 
+                    (PublicKey)token.get(WSSecurityEngineResult.TAG_PUBLIC_KEY);
+                if (publicKey.equals(foundPublicKey)) {
                     return true;
                 }
+            } else {
+                byte[] foundSecret = (byte[])token.get(WSSecurityEngineResult.TAG_SECRET);
                 byte[] derivedKey = 
                     (byte[])token.get(WSSecurityEngineResult.TAG_ENCRYPTED_EPHEMERAL_KEY);
-                if (derivedKey != null && Arrays.equals(derivedKey, secret)) {
+                if ((foundSecret != null && Arrays.equals(foundSecret, secret))
+                    || (derivedKey != null && Arrays.equals(derivedKey, secret))) {
                     return true;
                 }
             }
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/ConcreteSupportingTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/ConcreteSupportingTokenPolicyValidator.java
index 2388b028fb..b51589557e 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/ConcreteSupportingTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/ConcreteSupportingTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -98,6 +99,10 @@ public class ConcreteSupportingTokenPolicyValidator extends AbstractSupportingTo
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof SecurityContextToken) {
                     if (!processSCTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EncryptedTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EncryptedTokenPolicyValidator.java
index a022488f78..bc218478e0 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EncryptedTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EncryptedTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -94,6 +95,10 @@ public class EncryptedTokenPolicyValidator extends AbstractSupportingTokenPolicy
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof SecurityContextToken) {
                     if (!processSCTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingEncryptedTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingEncryptedTokenPolicyValidator.java
index 4b7546659b..344b0aa4bc 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingEncryptedTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingEncryptedTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -94,6 +95,10 @@ public class EndorsingEncryptedTokenPolicyValidator extends AbstractSupportingTo
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof UsernameToken) {
                     if (!processUsernameTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingTokenPolicyValidator.java
index 6e5bdad671..d99509c688 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/EndorsingTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -93,6 +94,10 @@ public class EndorsingTokenPolicyValidator extends AbstractSupportingTokenPolicy
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof UsernameToken) {
                     if (!processUsernameTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEncryptedTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEncryptedTokenPolicyValidator.java
index b83ab6339f..0b292b0950 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEncryptedTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEncryptedTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -95,6 +96,10 @@ public class SignedEncryptedTokenPolicyValidator extends AbstractSupportingToken
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof SecurityContextToken) {
                     if (!processSCTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingEncryptedTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingEncryptedTokenPolicyValidator.java
index d5121a2685..489c739b26 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingEncryptedTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingEncryptedTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -99,6 +100,10 @@ public class SignedEndorsingEncryptedTokenPolicyValidator extends AbstractSuppor
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof UsernameToken) {
                     if (!processUsernameTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingTokenPolicyValidator.java
index 50a2e65403..4f9886f300 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedEndorsingTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -97,6 +98,10 @@ public class SignedEndorsingTokenPolicyValidator extends AbstractSupportingToken
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof UsernameToken) {
                     if (!processUsernameTokens()) {
                         processingFailed = true;
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedTokenPolicyValidator.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedTokenPolicyValidator.java
index 741cb7b4d6..a1543a0479 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedTokenPolicyValidator.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyvalidators/SignedTokenPolicyValidator.java
@@ -29,6 +29,7 @@ import org.apache.cxf.ws.security.policy.SP12Constants;
 import org.apache.cxf.ws.security.policy.SPConstants;
 import org.apache.cxf.ws.security.policy.model.IssuedToken;
 import org.apache.cxf.ws.security.policy.model.KerberosToken;
+import org.apache.cxf.ws.security.policy.model.KeyValueToken;
 import org.apache.cxf.ws.security.policy.model.SamlToken;
 import org.apache.cxf.ws.security.policy.model.SecurityContextToken;
 import org.apache.cxf.ws.security.policy.model.SupportingToken;
@@ -98,6 +99,10 @@ public class SignedTokenPolicyValidator extends AbstractSupportingTokenPolicyVal
                     if (!processX509Tokens()) {
                         processingFailed = true;
                     }
+                } else if (token instanceof KeyValueToken) {
+                    if (!processKeyValueTokens()) {
+                        processingFailed = true;
+                    }
                 } else if (token instanceof SecurityContextToken) {
                     if (!processSCTokens()) {
                         processingFailed = true;
diff --git a/systests/ws-security/src/test/java/org/apache/cxf/systest/ws/x509/X509TokenTest.java b/systests/ws-security/src/test/java/org/apache/cxf/systest/ws/x509/X509TokenTest.java
index 4655e647a1..eec7606c09 100644
--- a/systests/ws-security/src/test/java/org/apache/cxf/systest/ws/x509/X509TokenTest.java
+++ b/systests/ws-security/src/test/java/org/apache/cxf/systest/ws/x509/X509TokenTest.java
@@ -488,6 +488,30 @@ public class X509TokenTest extends AbstractBusClientServerTestBase {
         x509Port.doubleIt(25);
     }
     
+    @org.junit.Test
+    public void testTransportKVT() throws Exception {
+        if (!unrestrictedPoliciesInstalled) {
+            return;
+        }
+
+        SpringBusFactory bf = new SpringBusFactory();
+        URL busFile = X509TokenTest.class.getResource("client/client.xml");
+
+        Bus bus = bf.createBus(busFile.toString());
+        SpringBusFactory.setDefaultBus(bus);
+        SpringBusFactory.setThreadDefaultBus(bus);
+
+        URL wsdl = X509TokenTest.class.getResource("DoubleItX509.wsdl");
+        Service service = Service.create(wsdl, SERVICE_QNAME);
+        QName portQName = new QName(NAMESPACE, "DoubleItTransportKVTPort");
+        DoubleItPortType x509Port = 
+                service.getPort(portQName, DoubleItPortType.class);
+        updateAddressPort(x509Port, PORT2);
+        x509Port.doubleIt(25);
+        
+        bus.shutdown(true);
+    }
+    
     private boolean checkUnrestrictedPoliciesInstalled() {
         try {
             byte[] data = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};
diff --git a/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl b/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl
index 1e24d7d38a..29250fdcdf 100644
--- a/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl
+++ b/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl
@@ -275,6 +275,23 @@
             </wsdl:fault>
         </wsdl:operation>
     </wsdl:binding>
+    <wsdl:binding name="DoubleItTransportKVTBinding" type="tns:DoubleItPortType">
+        <wsp:PolicyReference URI="#DoubleItTransportKVTPolicy" />
+        <soap:binding style="document"
+            transport="http://schemas.xmlsoap.org/soap/http" />
+        <wsdl:operation name="DoubleIt">
+            <soap:operation soapAction="" />
+            <wsdl:input>
+                <soap:body use="literal" />
+            </wsdl:input>
+            <wsdl:output>
+                <soap:body use="literal" />
+            </wsdl:output>
+            <wsdl:fault name="DoubleItFault">
+                <soap:body use="literal" name="DoubleItFault" />
+            </wsdl:fault>
+        </wsdl:operation>
+    </wsdl:binding>
     
     <wsdl:service name="DoubleItService">
         <wsdl:port name="DoubleItKeyIdentifierPort" binding="tns:DoubleItKeyIdentifierBinding">
@@ -326,6 +343,10 @@
                    binding="tns:DoubleItTransportSupportingSignedBinding">
             <soap:address location="https://localhost:9002/DoubleItX509TransportSupportingSigned" />
         </wsdl:port>
+        <wsdl:port name="DoubleItTransportKVTPort" 
+                   binding="tns:DoubleItTransportKVTBinding">
+            <soap:address location="https://localhost:9002/DoubleItX509TransportKVT" />
+        </wsdl:port>
     </wsdl:service>
 
     <wsp:Policy wsu:Id="DoubleItKeyIdentifierPolicy">
@@ -846,6 +867,45 @@
         </wsp:ExactlyOne>
     </wsp:Policy>
     
+    <wsp:Policy wsu:Id="DoubleItTransportKVTPolicy">
+        <wsp:ExactlyOne>
+            <wsp:All>
+                <sp:TransportBinding>
+                    <wsp:Policy>
+                        <sp:TransportToken>
+                            <wsp:Policy>
+                                <sp:HttpsToken>
+                                    <wsp:Policy/>
+                                </sp:HttpsToken>
+                            </wsp:Policy>
+                        </sp:TransportToken>
+                        <sp:Layout>
+                            <wsp:Policy>
+                                <sp:Lax />
+                            </wsp:Policy>
+                        </sp:Layout>
+                        <sp:IncludeTimestamp />
+                        <sp:AlgorithmSuite>
+                            <wsp:Policy>
+                                <sp:Basic128 />
+                            </wsp:Policy>
+                        </sp:AlgorithmSuite>
+                    </wsp:Policy>
+                </sp:TransportBinding>
+                <sp:EndorsingSupportingTokens>
+                   <wsp:Policy>
+                        <sp:KeyValueToken
+                           sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
+                           <wsp:Policy>
+                              <sp:RsaKeyValue />
+                           </wsp:Policy>
+                        </sp:KeyValueToken>
+                    </wsp:Policy>
+                </sp:EndorsingSupportingTokens>
+            </wsp:All>
+        </wsp:ExactlyOne>
+    </wsp:Policy>
+    
     
     <wsp:Policy wsu:Id="DoubleItBinding_DoubleIt_Input_Policy">
       <wsp:ExactlyOne>
diff --git a/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/client/client.xml b/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/client/client.xml
index 98d8f4e635..77a745c382 100644
--- a/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/client/client.xml
+++ b/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/client/client.xml
@@ -222,6 +222,17 @@
        </jaxws:properties>
     </jaxws:client>
     
+    <jaxws:client name="{http://www.example.org/contract/DoubleIt}DoubleItTransportKVTPort" 
+                  createdFromAPI="true">
+       <jaxws:properties>
+           <entry key="ws-security.signature.properties" 
+                  value="org/apache/cxf/systest/ws/wssec10/client/alice.properties"/> 
+           <entry key="ws-security.signature.username" value="alice"/>
+           <entry key="ws-security.callback-handler" 
+                  value="org.apache.cxf.systest.ws.wssec10.client.KeystorePasswordCallback"/>
+       </jaxws:properties>
+    </jaxws:client>
+    
     <http:conduit name="https://localhost:.*">
         <http:tlsClientParameters disableCNCheck="true">
             <sec:trustManagers>
diff --git a/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/server/server.xml b/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/server/server.xml
index 194744c329..ea91e7cb4d 100644
--- a/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/server/server.xml
+++ b/systests/ws-security/src/test/resources/org/apache/cxf/systest/ws/x509/server/server.xml
@@ -364,4 +364,22 @@
      
     </jaxws:endpoint> 
     
+    <jaxws:endpoint 
+       id="TransportKVT"
+       address="https://localhost:${testutil.ports.Server.2}/DoubleItX509TransportKVT" 
+       serviceName="s:DoubleItService"
+       endpointName="s:DoubleItTransportKVTPort"
+       xmlns:s="http://www.example.org/contract/DoubleIt"
+       implementor="org.apache.cxf.systest.ws.common.DoubleItImpl"
+       wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl"
+       depends-on="tls-settings">
+        
+       <jaxws:properties>
+          <entry key="ws-security.encryption.properties" 
+                  value="org/apache/cxf/systest/ws/wssec10/client/alice.properties"/> 
+          <entry key="ws-security.is-bsp-compliant" value="false"/>
+       </jaxws:properties> 
+     
+    </jaxws:endpoint> 
+    
 </beans>
