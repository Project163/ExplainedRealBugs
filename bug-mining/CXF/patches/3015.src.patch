diff --git a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/AbstractCodegenMoho.java b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/AbstractCodegenMoho.java
index 9e4fc3030c..88a0b21db9 100644
--- a/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/AbstractCodegenMoho.java
+++ b/maven-plugins/codegen-plugin/src/main/java/org/apache/cxf/maven_plugin/AbstractCodegenMoho.java
@@ -202,6 +202,8 @@ public abstract class AbstractCodegenMoho extends AbstractMojo {
     }
 
     public void execute() throws MojoExecutionException {
+        System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
+
         // add the generated source into compile source
         // do this step first to ensure the source folder will be added to the Eclipse classpath
         if (project != null && getGeneratedSourceRoot() != null) {
@@ -236,21 +238,22 @@ public abstract class AbstractCodegenMoho extends AbstractMojo {
         String originalNonProxyHosts = SystemPropertyAction.getProperty(HTTP_NON_PROXY_HOSTS);
         String originalProxyUser = SystemPropertyAction.getProperty(HTTP_PROXY_USER);
         String originalProxyPassword = SystemPropertyAction.getProperty(HTTP_PROXY_PASSWORD);
-
-        configureProxyServerSettings();
-
-        List<GenericWsdlOption> effectiveWsdlOptions = createWsdlOptionsFromScansAndExplicitWsdlOptions();
-
-        if (effectiveWsdlOptions.size() == 0) {
-            getLog().info("Nothing to generate");
-            return;
-        }
-
-        ClassLoaderSwitcher classLoaderSwitcher = new ClassLoaderSwitcher(getLog());
-        boolean result = true;
+        
 
         Bus bus = null;
+        ClassLoaderSwitcher classLoaderSwitcher = null;
         try {
+            configureProxyServerSettings();
+
+            List<GenericWsdlOption> effectiveWsdlOptions = createWsdlOptionsFromScansAndExplicitWsdlOptions();
+
+            if (effectiveWsdlOptions.size() == 0) {
+                getLog().info("Nothing to generate");
+                return;
+            }
+            classLoaderSwitcher = new ClassLoaderSwitcher(getLog());
+            boolean result = true;
+    
             Set<URI> cp = classLoaderSwitcher.switchClassLoader(project, useCompileClasspath, classesDir);
 
             if ("once".equals(fork) || "true".equals(fork)) {
@@ -272,7 +275,9 @@ public abstract class AbstractCodegenMoho extends AbstractMojo {
             if (bus != null) {
                 bus.shutdown(true);
             }
-            classLoaderSwitcher.restoreClassLoader();
+            if (classLoaderSwitcher != null) {
+                classLoaderSwitcher.restoreClassLoader();
+            }
             restoreProxySetting(originalProxyHost, originalProxyPort, originalNonProxyHosts,
                                 originalProxyUser, originalProxyPassword);
         }
diff --git a/tools/common/src/main/java/org/apache/cxf/tools/common/CommandInterfaceUtils.java b/tools/common/src/main/java/org/apache/cxf/tools/common/CommandInterfaceUtils.java
index 4e8a531c51..8110a50130 100644
--- a/tools/common/src/main/java/org/apache/cxf/tools/common/CommandInterfaceUtils.java
+++ b/tools/common/src/main/java/org/apache/cxf/tools/common/CommandInterfaceUtils.java
@@ -37,6 +37,7 @@ public final class CommandInterfaceUtils {
 
     public static void commandCommonMain() {
         if (!testInProgress) {
+            System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
             // force commons-logging into j.u.l so we can
             // configure it.
             System.setProperty("org.apache.commons.logging.Log",
diff --git a/tools/common/src/main/java/org/apache/cxf/tools/common/toolspec/ToolRunner.java b/tools/common/src/main/java/org/apache/cxf/tools/common/toolspec/ToolRunner.java
index 6b91b1c3e0..e0fbcc361a 100644
--- a/tools/common/src/main/java/org/apache/cxf/tools/common/toolspec/ToolRunner.java
+++ b/tools/common/src/main/java/org/apache/cxf/tools/common/toolspec/ToolRunner.java
@@ -30,7 +30,7 @@ import org.apache.cxf.common.logging.LogUtils;
 import org.apache.cxf.tools.common.ToolContext;
 import org.apache.cxf.tools.common.ToolException;
 public final class ToolRunner {
-    private static final Logger LOG = LogUtils.getL7dLogger(ToolRunner.class);
+    
     private ToolRunner() {
         // utility class - never constructed
     }
@@ -74,6 +74,7 @@ public final class ToolRunner {
                                boolean exitOnFinish,
                                ToolContext context,
                                OutputStream os) throws Exception {
+        System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
 
         ToolContainer container = null;
 
@@ -88,8 +89,9 @@ public final class ToolRunner {
                                             new ToolSpec(toolspecStream, validate)
                                         });
         } catch (Exception ex) {
-            Message message = new Message("CLZ_CANNOT_BE_CONSTRUCTED", LOG, clz.getName());
-            LOG.log(Level.SEVERE, message.toString());
+            Logger log = LogUtils.getL7dLogger(ToolRunner.class);
+            Message message = new Message("CLZ_CANNOT_BE_CONSTRUCTED", log, clz.getName());
+            log.log(Level.SEVERE, message.toString());
             throw new ToolException(message, ex);
         }
 
diff --git a/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2js/JavaToJS.java b/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2js/JavaToJS.java
index feeec8b98f..713a6f46ce 100644
--- a/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2js/JavaToJS.java
+++ b/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2js/JavaToJS.java
@@ -99,6 +99,8 @@ public class JavaToJS extends AbstractCXFToolContainer {
     }
 
     public static void main(String[] pargs) {
+        System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
+
         try {
             ToolRunner.runTool(JavaToJS.class,
                                JavaToJS.class.getResourceAsStream("java2js.xml"),
diff --git a/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2ws/JavaToWS.java b/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2ws/JavaToWS.java
index 1826f947d6..22df372fb0 100644
--- a/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2ws/JavaToWS.java
+++ b/tools/javato/ws/src/main/java/org/apache/cxf/tools/java2ws/JavaToWS.java
@@ -39,6 +39,7 @@ public class JavaToWS {
     }
 
     public static void main(String[] args) {
+        System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
         CommandInterfaceUtils.commandCommonMain();
         JavaToWS j2w = new JavaToWS(args);
         try {
diff --git a/tools/wadlto/jaxrs/src/main/java/org/apache/cxf/tools/wadlto/WADLToJava.java b/tools/wadlto/jaxrs/src/main/java/org/apache/cxf/tools/wadlto/WADLToJava.java
index ccbd63e900..33b833f7fd 100644
--- a/tools/wadlto/jaxrs/src/main/java/org/apache/cxf/tools/wadlto/WADLToJava.java
+++ b/tools/wadlto/jaxrs/src/main/java/org/apache/cxf/tools/wadlto/WADLToJava.java
@@ -91,7 +91,7 @@ public class WADLToJava {
 
 
     public static void main(String[] pargs) {
-
+        System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
         CommandInterfaceUtils.commandCommonMain();
         WADLToJava w2j = new WADLToJava(pargs);
         try {
diff --git a/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJava.java b/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJava.java
index 80bc7af4b2..284bf3e667 100644
--- a/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJava.java
+++ b/tools/wsdlto/core/src/main/java/org/apache/cxf/tools/wsdlto/WSDLToJava.java
@@ -176,7 +176,8 @@ public class WSDLToJava {
     }
 
     public static void main(String[] pargs) {
-
+        System.setProperty("org.apache.cxf.JDKBugHacks.defaultUsesCaches", "true");
+        
         CommandInterfaceUtils.commandCommonMain();
         WSDLToJava w2j = new WSDLToJava(pargs);
         try {
