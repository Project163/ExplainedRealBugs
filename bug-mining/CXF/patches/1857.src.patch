diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/KerberosTokenInterceptorProvider.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/KerberosTokenInterceptorProvider.java
index 393ec63d04..814387e25a 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/KerberosTokenInterceptorProvider.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/policy/interceptors/KerberosTokenInterceptorProvider.java
@@ -53,12 +53,14 @@ import org.apache.cxf.ws.security.wss4j.PolicyStaxActionInInterceptor;
 import org.apache.cxf.ws.security.wss4j.StaxSecurityContextInInterceptor;
 import org.apache.cxf.ws.security.wss4j.WSS4JInInterceptor;
 import org.apache.cxf.ws.security.wss4j.policyvalidators.KerberosTokenPolicyValidator;
+import org.apache.wss4j.common.ext.WSSecurityException;
 import org.apache.wss4j.dom.WSConstants;
 import org.apache.wss4j.dom.WSSecurityEngineResult;
 import org.apache.wss4j.dom.handler.WSHandlerConstants;
 import org.apache.wss4j.dom.handler.WSHandlerResult;
 import org.apache.wss4j.dom.message.token.BinarySecurity;
 import org.apache.wss4j.dom.message.token.KerberosSecurity;
+import org.apache.wss4j.dom.util.WSSecurityUtil;
 import org.apache.wss4j.policy.SP11Constants;
 import org.apache.wss4j.policy.SP12Constants;
 import org.apache.wss4j.policy.SPConstants;
@@ -67,6 +69,7 @@ import org.apache.wss4j.stax.securityEvent.WSSecurityEventConstants;
 import org.apache.wss4j.stax.securityToken.KerberosServiceSecurityToken;
 import org.apache.xml.security.exceptions.XMLSecurityException;
 import org.apache.xml.security.stax.securityEvent.SecurityEvent;
+import org.apache.xml.security.utils.Base64;
 
 /**
  * 
@@ -146,6 +149,11 @@ public class KerberosTokenInterceptorProvider extends AbstractPolicyInterceptorP
                         message.getExchange().put(SecurityConstants.TOKEN_ID, 
                                                   tok.getId());
                         getTokenStore(message).add(tok);
+                        
+                        // Create another cache entry with the SHA1 Identifier as the key for easy retrieval
+                        if (tok.getSHA1() != null) {
+                            getTokenStore(message).add(tok.getSHA1(), tok);
+                        }
                     }
                 } else {
                     //server side should be checked on the way in
@@ -327,6 +335,12 @@ public class KerberosTokenInterceptorProvider extends AbstractPolicyInterceptorP
         SecurityToken token = new SecurityToken(binarySecurityToken.getID());
         token.setToken(binarySecurityToken.getElement());
         token.setTokenType(binarySecurityToken.getValueType());
+        byte[] tokenBytes = binarySecurityToken.getToken();
+        try {
+            token.setSHA1(Base64.encode(WSSecurityUtil.generateDigest(tokenBytes)));
+        } catch (WSSecurityException e) {
+            // Just consume this for now as it isn't critical...
+        }
         return token;
     }
         
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/SymmetricBindingHandler.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/SymmetricBindingHandler.java
index 8310c0e28f..d32a1d0373 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/SymmetricBindingHandler.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/policyhandlers/SymmetricBindingHandler.java
@@ -427,10 +427,17 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
                 // attached use key identifier as defined in WSS1.1 section
                 // 7.7 Encrypted Key reference
                 SecurityTokenReference tokenRef = new SecurityTokenReference(saaj.getSOAPPart());
-                tokenRef.setKeyIdentifierEncKeySHA1(encrTok.getSHA1());
                 String tokenType = encrTok.getTokenType();
-                if (tokenType == null) {
-                    tokenType = WSConstants.WSS_ENC_KEY_VALUE_TYPE;
+                if (encrToken instanceof KerberosToken) {
+                    tokenRef.setKeyIdentifier(WSConstants.WSS_KRB_KI_VALUE_TYPE, encrTok.getSHA1(), true);
+                    if (tokenType == null) {
+                        tokenType = WSConstants.WSS_GSS_KRB_V5_AP_REQ;
+                    }
+                } else {
+                    tokenRef.setKeyIdentifierEncKeySHA1(encrTok.getSHA1());
+                    if (tokenType == null) {
+                        tokenType = WSConstants.WSS_ENC_KEY_VALUE_TYPE;
+                    }
                 }
                 tokenRef.addTokenType(tokenType);
                 dkEncr.setExternalKey(encrTok.getSecret(), tokenRef.getElement());
@@ -575,6 +582,9 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
                         }
                     } else if (encrToken instanceof UsernameToken) {
                         encr.setCustomReferenceValue(WSConstants.WSS_USERNAME_TOKEN_VALUE_TYPE);
+                    } else if (encrToken instanceof KerberosToken && !isRequestor()) {
+                        encr.setCustomReferenceValue(WSConstants.WSS_KRB_KI_VALUE_TYPE);
+                        encr.setEncKeyId(encrTok.getSHA1());
                     } else if (!isRequestor()) {
                         if (encrTok.getSHA1() != null) {
                             encr.setCustomReferenceValue(encrTok.getSHA1());
@@ -640,10 +650,17 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
             // 7.7 Encrypted Key reference
             SecurityTokenReference tokenRef = new SecurityTokenReference(doc);
             if (tok.getSHA1() != null) {
-                tokenRef.setKeyIdentifierEncKeySHA1(tok.getSHA1());
                 String tokenType = tok.getTokenType();
-                if (tokenType == null) {
-                    tokenType = WSConstants.WSS_ENC_KEY_VALUE_TYPE;
+                if (policyToken instanceof KerberosToken) {
+                    tokenRef.setKeyIdentifier(WSConstants.WSS_KRB_KI_VALUE_TYPE, tok.getSHA1(), true);
+                    if (tokenType == null) {
+                        tokenType = WSConstants.WSS_GSS_KRB_V5_AP_REQ;
+                    }
+                } else {
+                    tokenRef.setKeyIdentifierEncKeySHA1(tok.getSHA1());
+                    if (tokenType == null) {
+                        tokenType = WSConstants.WSS_ENC_KEY_VALUE_TYPE;
+                    }
                 }
                 tokenRef.addTokenType(tokenType);
             }
@@ -738,6 +755,7 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
             // be used in the wsse:Reference in ds:KeyInfo
             int type = included ? WSConstants.CUSTOM_SYMM_SIGNING 
                 : WSConstants.CUSTOM_SYMM_SIGNING_DIRECT;
+            String sigTokId = tok.getId();
             if (policyToken instanceof X509Token) {
                 if (isRequestor()) {
                     sig.setCustomTokenValueType(
@@ -752,6 +770,15 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
             } else if (policyToken instanceof UsernameToken) {
                 sig.setCustomTokenValueType(WSConstants.WSS_USERNAME_TOKEN_VALUE_TYPE);
                 sig.setKeyIdentifierType(type);
+            } else if (policyToken instanceof KerberosToken) {
+                if (isRequestor()) {
+                    sig.setCustomTokenValueType(tok.getTokenType());
+                    sig.setKeyIdentifierType(type);
+                } else {
+                    sig.setCustomTokenValueType(WSConstants.WSS_KRB_KI_VALUE_TYPE);
+                    sig.setKeyIdentifierType(WSConstants.CUSTOM_KEY_IDENTIFIER);
+                    sigTokId = tok.getSHA1();
+                }
             } else {
                 //Setting the AttachedReference or the UnattachedReference according to the flag
                 Element ref;
@@ -783,7 +810,6 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
                 }
             }
             
-            String sigTokId;
             if (included) {
                 sigTokId = tok.getWsuId();
                 if (sigTokId == null) {
@@ -796,8 +822,6 @@ public class SymmetricBindingHandler extends AbstractBindingBuilder {
                 if (sigTokId.startsWith("#")) {
                     sigTokId = sigTokId.substring(1);
                 }
-            } else {
-                sigTokId = tok.getId();
             }
                       
             if (included && sbinding.isProtectTokens()) {
