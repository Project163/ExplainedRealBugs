diff --git a/distribution/src/main/release/samples/ws_security/interopfest/wssc/pom.xml b/distribution/src/main/release/samples/ws_security/interopfest/wssc/pom.xml
index 0ef0c6f780..aa937c4f74 100644
--- a/distribution/src/main/release/samples/ws_security/interopfest/wssc/pom.xml
+++ b/distribution/src/main/release/samples/ws_security/interopfest/wssc/pom.xml
@@ -90,7 +90,7 @@
             <plugin>
                 <groupId>org.apache.cxf</groupId>
                 <artifactId>cxf-codegen-plugin</artifactId>
-                <version>LATEST</version>
+                <version>2.3.0-SNAPSHOT</version>
                 <executions>
                     <execution>
                         <id>generate-sources</id>
diff --git a/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/main/java/interop/server/Server.java b/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/main/java/interop/server/Server.java
index 31f76d6a76..1dde238075 100755
--- a/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/main/java/interop/server/Server.java
+++ b/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/main/java/interop/server/Server.java
@@ -84,6 +84,10 @@ public class Server {
         if (url.contains("X10_I")) {
             ep.getProperties().put(SecurityConstants.SIGNATURE_PROPERTIES + ".sct", "etc/bob.properties");
             ep.getProperties().put(SecurityConstants.ENCRYPT_PROPERTIES + ".sct", "etc/alice.properties");
+        } else if (url.contains("MutualCert")) {
+            ep.getProperties().put(SecurityConstants.ENCRYPT_PROPERTIES + ".sct", "etc/bob.properties");
+            ep.getProperties().put(SecurityConstants.SIGNATURE_PROPERTIES + ".sct", "etc/alice.properties");
+            ep.getProperties().put(SecurityConstants.CALLBACK_HANDLER, new KeystorePasswordCallback());
         }
         ep.publish(url);
     }
diff --git a/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/style/makelocal.xsl b/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/style/makelocal.xsl
index d80df7d485..307dbf2e2e 100644
--- a/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/style/makelocal.xsl
+++ b/distribution/src/main/release/samples/ws_security/interopfest/wssc/src/style/makelocal.xsl
@@ -34,6 +34,32 @@
                 <xsl:when test="@schemaLocation='http://ndgo-introp-s24/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?xsd=xsd3'">
                     <xsl:attribute name="schemaLocation">WSSecureConversation_3.xsd</xsl:attribute>
                 </xsl:when>
+
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversation.svc?xsd=xsd0'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_0.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?xsd=xsd0'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_0.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversation.svc?xsd=xsd1'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_1.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?xsd=xsd1'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_1.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversation.svc?xsd=xsd2'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_2.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?xsd=xsd2'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_2.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversation.svc?xsd=xsd3'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_3.xsd</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@schemaLocation='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?xsd=xsd3'">
+                    <xsl:attribute name="schemaLocation">WSSecureConversation_3.xsd</xsl:attribute>
+                </xsl:when>
+
                 <xsl:otherwise>
                     <xsl:attribute name="schemaLocation">
                         <xsl:value-of select="@schemaLocation"/>
@@ -53,6 +79,12 @@
                 <xsl:when test="@location='http://ndgo-introp-s24/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?wsdl'">
                     <xsl:attribute name="location">WSSecureConversation.wsdl</xsl:attribute>
                 </xsl:when>
+                <xsl:when test="@location='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversation.svc?wsdl'">
+                    <xsl:attribute name="location">WSSecureConversation.wsdl</xsl:attribute>
+                </xsl:when>
+                <xsl:when test="@location='http://131.107.153.205/Security_WsSecurity_Service_Indigo/WSSecureConversationSign.svc?wsdl'">
+                    <xsl:attribute name="location">WSSecureConversation.wsdl</xsl:attribute>
+                </xsl:when>
                 <xsl:otherwise>
                     <xsl:attribute name="location">WSSecureConversation_policy.wsdl</xsl:attribute>
                 </xsl:otherwise>
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JInInterceptor.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JInInterceptor.java
index 79e196ae71..73575b2d72 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JInInterceptor.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JInInterceptor.java
@@ -262,9 +262,9 @@ public class PolicyBasedWSS4JInInterceptor extends WSS4JInInterceptor {
                 Object s = message.getContextualProperty(SecurityConstants.SIGNATURE_PROPERTIES);
                 Object e = message.getContextualProperty(SecurityConstants.ENCRYPT_PROPERTIES);
                 if (abinding.getProtectionToken() != null) {
-                    if (e != null) {
+                    if (e != null && s == null) {
                         s = e;
-                    } else if (s != null) {
+                    } else if (s != null && e == null) {
                         e = s;
                     }
                 }
diff --git a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java
index 119fed93af..533fdc4675 100644
--- a/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java
+++ b/rt/ws/security/src/main/java/org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.java
@@ -233,18 +233,24 @@ public class WSS4JInInterceptor extends AbstractWSS4JInterceptor {
              */
 
             // Extract the signature action result from the action vector
-            WSSecurityEngineResult actionResult = WSSecurityUtil
-                .fetchActionResult(wsResult, WSConstants.SIGN);
-
-            if (actionResult != null) {
-                X509Certificate returnCert = (X509Certificate)actionResult
-                    .get(WSSecurityEngineResult.TAG_X509_CERTIFICATE);
-
-                if (returnCert != null && !verifyTrust(returnCert, reqData)) {
-                    LOG.warning("The certificate used for the signature is not trusted");
-                    throw new WSSecurityException(WSSecurityException.FAILED_CHECK);
+            Vector signatureResults = new Vector();
+            signatureResults = 
+                WSSecurityUtil.fetchAllActionResults(wsResult, WSConstants.SIGN, signatureResults);
+
+            if (!signatureResults.isEmpty()) {
+                for (int i = 0; i < signatureResults.size(); i++) {
+                    WSSecurityEngineResult result = 
+                        (WSSecurityEngineResult) signatureResults.get(i);
+                    
+                    X509Certificate returnCert = (X509Certificate)result
+                        .get(WSSecurityEngineResult.TAG_X509_CERTIFICATE);
+    
+                    if (returnCert != null && !verifyTrust(returnCert, reqData)) {
+                        LOG.warning("The certificate used for the signature is not trusted");
+                        throw new WSSecurityException(WSSecurityException.FAILED_CHECK);
+                    }
+                    msg.put(SIGNATURE_RESULT, result);
                 }
-                msg.put(SIGNATURE_RESULT, actionResult);
             }
 
             /*
@@ -257,16 +263,22 @@ public class WSS4JInInterceptor extends AbstractWSS4JInterceptor {
              */
 
             // Extract the timestamp action result from the action vector
-            actionResult = WSSecurityUtil.fetchActionResult(wsResult, WSConstants.TS);
-
-            if (actionResult != null) {
-                Timestamp timestamp = (Timestamp)actionResult.get(WSSecurityEngineResult.TAG_TIMESTAMP);
-
-                if (timestamp != null && !verifyTimestamp(timestamp, decodeTimeToLive(reqData))) {
-                    LOG.warning("The timestamp could not be validated");
-                    throw new WSSecurityException(WSSecurityException.MESSAGE_EXPIRED);
+            Vector timestampResults = new Vector();
+            timestampResults = 
+                WSSecurityUtil.fetchAllActionResults(wsResult, WSConstants.TS, timestampResults);
+
+            if (!timestampResults.isEmpty()) {
+                for (int i = 0; i < timestampResults.size(); i++) {
+                    WSSecurityEngineResult result = 
+                        (WSSecurityEngineResult) timestampResults.get(i);
+                    Timestamp timestamp = (Timestamp)result.get(WSSecurityEngineResult.TAG_TIMESTAMP);
+    
+                    if (timestamp != null && !verifyTimestamp(timestamp, decodeTimeToLive(reqData))) {
+                        LOG.warning("The timestamp could not be validated");
+                        throw new WSSecurityException(WSSecurityException.MESSAGE_EXPIRED);
+                    }
+                    msg.put(TIMESTAMP_RESULT, result);
                 }
-                msg.put(TIMESTAMP_RESULT, actionResult);
             }
 
             /*
diff --git a/systests/src/test/java/org/apache/cxf/systest/ws/wssc/WSSCTest.java b/systests/src/test/java/org/apache/cxf/systest/ws/wssc/WSSCTest.java
index d0d365ad38..28b292a580 100644
--- a/systests/src/test/java/org/apache/cxf/systest/ws/wssc/WSSCTest.java
+++ b/systests/src/test/java/org/apache/cxf/systest/ws/wssc/WSSCTest.java
@@ -129,8 +129,12 @@ public class WSSCTest extends AbstractBusClientServerTestBase {
             ping.setScenario("Scenario5");
             ping.setText("ping");
             params.setPing(ping);
-            PingResponse output = port.ping(params);
-            assertEquals(OUT, output.getPingResponse().getText());
+            try {
+                PingResponse output = port.ping(params);
+                assertEquals(OUT, output.getPingResponse().getText());
+            } catch (Exception ex) {
+                throw new Exception("Error doing " + portPrefix, ex);
+            }
         }
     }
 
diff --git a/systests/src/test/java/org/apache/cxf/systest/ws/wssc/server/Server.java b/systests/src/test/java/org/apache/cxf/systest/ws/wssc/server/Server.java
index 34dac3a021..aa03293448 100644
--- a/systests/src/test/java/org/apache/cxf/systest/ws/wssc/server/Server.java
+++ b/systests/src/test/java/org/apache/cxf/systest/ws/wssc/server/Server.java
@@ -106,6 +106,12 @@ public class Server extends AbstractBusTestServerBase {
                     "org/apache/cxf/systest/ws/wssec11/server/bob.properties");
             ep.getProperties().put(SecurityConstants.ENCRYPT_PROPERTIES + ".sct", 
                     "org/apache/cxf/systest/ws/wssec11/server/alice.properties");
+        } else if (url.contains("MutualCert")) {
+            ep.getProperties().put(SecurityConstants.ENCRYPT_PROPERTIES + ".sct", 
+                "org/apache/cxf/systest/ws/wssec11/server/bob.properties");
+            ep.getProperties().put(SecurityConstants.SIGNATURE_PROPERTIES + ".sct", 
+                "org/apache/cxf/systest/ws/wssec11/server/alice.properties");
+            ep.getProperties().put(SecurityConstants.CALLBACK_HANDLER, new KeystorePasswordCallback());
         }
         ep.publish(url);
     }
