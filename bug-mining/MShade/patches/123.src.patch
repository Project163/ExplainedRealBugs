diff --git a/src/main/java/org/apache/maven/plugins/shade/DefaultShader.java b/src/main/java/org/apache/maven/plugins/shade/DefaultShader.java
index defa123..c646cc7 100644
--- a/src/main/java/org/apache/maven/plugins/shade/DefaultShader.java
+++ b/src/main/java/org/apache/maven/plugins/shade/DefaultShader.java
@@ -181,8 +181,11 @@ public class DefaultShader
         public boolean hasZipHeader() throws IOException
         {
             final byte[] header = new byte[HEADER_LEN];
-            super.read( header, 0, HEADER_LEN );
-            super.unread( header );
+            int len = super.read( header, 0, HEADER_LEN );
+            if ( len != -1 )
+            {
+                super.unread( header, 0, len );
+            }
             return Arrays.equals( header, ZIP_HEADER );
         }
     }
diff --git a/src/test/java/org/apache/maven/plugins/shade/DefaultShaderTest.java b/src/test/java/org/apache/maven/plugins/shade/DefaultShaderTest.java
index b6a8728..14786ec 100644
--- a/src/test/java/org/apache/maven/plugins/shade/DefaultShaderTest.java
+++ b/src/test/java/org/apache/maven/plugins/shade/DefaultShaderTest.java
@@ -477,6 +477,45 @@ public class DefaultShaderTest
         temporaryFolder.delete();
     }
 
+    @Test
+    public void testShaderWithSmallEntries() throws Exception
+    {
+        TemporaryFolder temporaryFolder = new TemporaryFolder();
+
+        final String innerJarFileName = "inner.jar";
+        int len;
+
+        temporaryFolder.create();
+        File innerJar = temporaryFolder.newFile( innerJarFileName );
+        try ( JarOutputStream jos = new JarOutputStream( new FileOutputStream( innerJar ) ) )
+        {
+            jos.putNextEntry( new JarEntry( "foo.txt" ) );
+            byte[] bytes = "c1".getBytes(StandardCharsets.UTF_8);
+            len = bytes.length;
+            jos.write( bytes );
+            jos.closeEntry();
+        }
+
+        ShadeRequest shadeRequest = new ShadeRequest();
+        shadeRequest.setJars( new LinkedHashSet<>( Collections.singleton( innerJar ) ) );
+        shadeRequest.setFilters( new ArrayList<Filter>() );
+        shadeRequest.setRelocators( new ArrayList<Relocator>() );
+        shadeRequest.setResourceTransformers( new ArrayList<ResourceTransformer>() );
+        File shadedFile = temporaryFolder.newFile( "shaded.jar" );
+        shadeRequest.setUberJar( shadedFile );
+
+        DefaultShader shader = newShader();
+        shader.shade( shadeRequest );
+
+        JarFile shadedJarFile = new JarFile( shadedFile );
+        JarEntry entry = shadedJarFile.getJarEntry( "foo.txt" );
+
+        //After shading, entry compression method should not be changed.
+        Assert.assertEquals( entry.getSize(), len );
+
+        temporaryFolder.delete();
+    }
+
     private void writeEntryWithoutCompression( String entryName, byte[] entryBytes, JarOutputStream jos ) throws IOException
     {
         final JarEntry entry = new JarEntry( entryName );
