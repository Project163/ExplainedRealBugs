diff --git a/pom.xml b/pom.xml
index 96c7952..81ac2c8 100644
--- a/pom.xml
+++ b/pom.xml
@@ -148,6 +148,7 @@ under the License.
               <localRepositoryPath>${project.build.directory}/local-repo</localRepositoryPath>
               <settingsFile>src/it/settings.xml</settingsFile>
               <goals>
+                <goal>clean</goal>
                 <goal>install</goal>
               </goals>
             </configuration>
diff --git a/src/it/duplicate-classes-with-reloc/pom.xml b/src/it/duplicate-classes-with-reloc/pom.xml
new file mode 100644
index 0000000..8b2e577
--- /dev/null
+++ b/src/it/duplicate-classes-with-reloc/pom.xml
@@ -0,0 +1,113 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.dcwr</groupId>
+  <artifactId>test</artifactId>
+  <version>1.0</version>
+  <packaging>jar</packaging>
+
+  <name>MSHADE-30</name>
+  <description>
+    Test that duplicate classes/resources on the class path are gracefully handled.
+  </description>
+
+  <!--
+  These dependencies contain the same class/resource. In reality, this might happen for API JARs that have been
+  packaged by different providers and hence have different group identifiers.
+  -->
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.its.shade.dcwr</groupId>
+      <artifactId>a</artifactId>
+      <version>0.1</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.maven.its.shade.dcwr</groupId>
+      <artifactId>b</artifactId>
+      <version>0.1</version>
+    </dependency>
+  </dependencies>
+
+  <repositories>
+    <repository>
+      <id>shade-it</id>
+      <url>file:///${basedir}/repo</url>
+      <releases>
+        <checksumPolicy>ignore</checksumPolicy>
+      </releases>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+  </repositories>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>2.0.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-jar-plugin</artifactId>
+        <version>2.1</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-resources-plugin</artifactId>
+        <version>2.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-shade-plugin</artifactId>
+        <version>@project.version@</version>
+        <executions>
+          <execution>
+            <id>shade</id>
+            <phase>package</phase>
+            <goals>
+              <goal>shade</goal>
+            </goals>
+            <configuration>
+              <createDependencyReducedPom>false</createDependencyReducedPom>
+              <!-- NOTE: This test checks the code path using class relocation -->
+              <relocations>
+                <relocation>
+                  <pattern>org.apache</pattern>
+                  <shadedPattern>hidden</shadedPattern>
+                </relocation>
+              </relocations>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-surefire-plugin</artifactId>
+        <version>2.3.1</version>
+      </plugin>
+    </plugins>
+  </build>
+</project>
diff --git a/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/0.1/a-0.1.jar b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/0.1/a-0.1.jar
new file mode 100644
index 0000000..753c7e0
Binary files /dev/null and b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/0.1/a-0.1.jar differ
diff --git a/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/0.1/a-0.1.pom b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/0.1/a-0.1.pom
new file mode 100644
index 0000000..d66ff55
--- /dev/null
+++ b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/0.1/a-0.1.pom
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.dcwr</groupId>
+  <artifactId>a</artifactId>
+  <version>0.1</version>
+  <packaging>jar</packaging>
+</project>
diff --git a/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/maven-metadata.xml b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/maven-metadata.xml
new file mode 100644
index 0000000..658f7fb
--- /dev/null
+++ b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/a/maven-metadata.xml
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="UTF-8"?><metadata>
+  <groupId>org.apache.maven.its.shade.dcwr</groupId>
+  <artifactId>a</artifactId>
+  <version>0.1</version>
+  <versioning>
+    <release>0.1</release>
+    <versions>
+      <version>0.1</version>
+    </versions>
+    <lastUpdated>20090108191842</lastUpdated>
+  </versioning>
+</metadata>
\ No newline at end of file
diff --git a/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/0.1/b-0.1.jar b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/0.1/b-0.1.jar
new file mode 100644
index 0000000..e29b375
Binary files /dev/null and b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/0.1/b-0.1.jar differ
diff --git a/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/0.1/b-0.1.pom b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/0.1/b-0.1.pom
new file mode 100644
index 0000000..c4251dd
--- /dev/null
+++ b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/0.1/b-0.1.pom
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.dcwr</groupId>
+  <artifactId>b</artifactId>
+  <version>0.1</version>
+  <packaging>jar</packaging>
+</project>
diff --git a/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/maven-metadata.xml b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/maven-metadata.xml
new file mode 100644
index 0000000..66bd2fb
--- /dev/null
+++ b/src/it/duplicate-classes-with-reloc/repo/org/apache/maven/its/shade/dcwr/b/maven-metadata.xml
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="UTF-8"?><metadata>
+  <groupId>org.apache.maven.its.shade.dcwr</groupId>
+  <artifactId>b</artifactId>
+  <version>0.1</version>
+  <versioning>
+    <release>0.1</release>
+    <versions>
+      <version>0.1</version>
+    </versions>
+    <lastUpdated>20090108191825</lastUpdated>
+  </versioning>
+</metadata>
\ No newline at end of file
diff --git a/src/it/duplicate-classes-without-reloc/pom.xml b/src/it/duplicate-classes-without-reloc/pom.xml
new file mode 100644
index 0000000..ceafdc5
--- /dev/null
+++ b/src/it/duplicate-classes-without-reloc/pom.xml
@@ -0,0 +1,107 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.dcwor</groupId>
+  <artifactId>test</artifactId>
+  <version>1.0</version>
+  <packaging>jar</packaging>
+
+  <name>MSHADE-30</name>
+  <description>
+    Test that duplicate classes/resources on the class path are gracefully handled.
+  </description>
+
+  <!--
+  These dependencies contain the same class/resource. In reality, this might happen for API JARs that have been
+  packaged by different providers and hence have different group identifiers.
+  -->
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.its.shade.dcwor</groupId>
+      <artifactId>a</artifactId>
+      <version>0.1</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.maven.its.shade.dcwor</groupId>
+      <artifactId>b</artifactId>
+      <version>0.1</version>
+    </dependency>
+  </dependencies>
+
+  <repositories>
+    <repository>
+      <id>shade-it</id>
+      <url>file:///${basedir}/repo</url>
+      <releases>
+        <checksumPolicy>ignore</checksumPolicy>
+      </releases>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+  </repositories>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>2.0.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-jar-plugin</artifactId>
+        <version>2.1</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-resources-plugin</artifactId>
+        <version>2.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-shade-plugin</artifactId>
+        <version>@project.version@</version>
+        <executions>
+          <execution>
+            <id>shade</id>
+            <phase>package</phase>
+            <goals>
+              <goal>shade</goal>
+            </goals>
+            <configuration>
+              <createDependencyReducedPom>false</createDependencyReducedPom>
+              <!-- NOTE: This test checks the code path not using class relocation -->
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-surefire-plugin</artifactId>
+        <version>2.3.1</version>
+      </plugin>
+    </plugins>
+  </build>
+</project>
diff --git a/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/0.1/a-0.1.jar b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/0.1/a-0.1.jar
new file mode 100644
index 0000000..753c7e0
Binary files /dev/null and b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/0.1/a-0.1.jar differ
diff --git a/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/0.1/a-0.1.pom b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/0.1/a-0.1.pom
new file mode 100644
index 0000000..3a74143
--- /dev/null
+++ b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/0.1/a-0.1.pom
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.dcwor</groupId>
+  <artifactId>a</artifactId>
+  <version>0.1</version>
+  <packaging>jar</packaging>
+</project>
diff --git a/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/maven-metadata.xml b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/maven-metadata.xml
new file mode 100644
index 0000000..fac14ce
--- /dev/null
+++ b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/a/maven-metadata.xml
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="UTF-8"?><metadata>
+  <groupId>org.apache.maven.its.shade.dcwor</groupId>
+  <artifactId>a</artifactId>
+  <version>0.1</version>
+  <versioning>
+    <release>0.1</release>
+    <versions>
+      <version>0.1</version>
+    </versions>
+    <lastUpdated>20090108191842</lastUpdated>
+  </versioning>
+</metadata>
\ No newline at end of file
diff --git a/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/0.1/b-0.1.jar b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/0.1/b-0.1.jar
new file mode 100644
index 0000000..e29b375
Binary files /dev/null and b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/0.1/b-0.1.jar differ
diff --git a/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/0.1/b-0.1.pom b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/0.1/b-0.1.pom
new file mode 100644
index 0000000..2596274
--- /dev/null
+++ b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/0.1/b-0.1.pom
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.dcwor</groupId>
+  <artifactId>b</artifactId>
+  <version>0.1</version>
+  <packaging>jar</packaging>
+</project>
diff --git a/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/maven-metadata.xml b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/maven-metadata.xml
new file mode 100644
index 0000000..27d9f67
--- /dev/null
+++ b/src/it/duplicate-classes-without-reloc/repo/org/apache/maven/its/shade/dcwor/b/maven-metadata.xml
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="UTF-8"?><metadata>
+  <groupId>org.apache.maven.its.shade.dcwor</groupId>
+  <artifactId>b</artifactId>
+  <version>0.1</version>
+  <versioning>
+    <release>0.1</release>
+    <versions>
+      <version>0.1</version>
+    </versions>
+    <lastUpdated>20090108191825</lastUpdated>
+  </versioning>
+</metadata>
\ No newline at end of file
diff --git a/src/it/rerun-with-reloc/invoker.properties b/src/it/rerun-with-reloc/invoker.properties
new file mode 100644
index 0000000..8cf287b
--- /dev/null
+++ b/src/it/rerun-with-reloc/invoker.properties
@@ -0,0 +1,2 @@
+# NOTE: It's the essential part of the test to re-run the package phase
+invoker.goals = clean package package
diff --git a/src/it/rerun-with-reloc/pom.xml b/src/it/rerun-with-reloc/pom.xml
new file mode 100644
index 0000000..f8197ad
--- /dev/null
+++ b/src/it/rerun-with-reloc/pom.xml
@@ -0,0 +1,109 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.rrwr</groupId>
+  <artifactId>test</artifactId>
+  <version>0.1</version>
+  <packaging>jar</packaging>
+
+  <name>MSHADE-30</name>
+  <description>
+    Test that re-running the package phase without any code changes in between doesn't cause shading to crash. The
+    potential issue was that the first run produced the shaded artifact and that this artifact survived unchanged
+    until shading got executed the second time, thereby re-shading all classes that were included during the first
+    run.
+  </description>
+
+  <!-- NOTE: The test requires a dependency to include during shading, doesn't matter what classes though -->
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.plugins</groupId>
+      <artifactId>maven-compiler-plugin</artifactId>
+      <version>2.0.2</version>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>2.0.2</version>
+        <configuration>
+          <staleMillis>5000</staleMillis>
+        </configuration>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-install-plugin</artifactId>
+        <version>2.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-jar-plugin</artifactId>
+        <version>2.1</version>
+        <configuration>
+          <archive>
+            <!-- NOTE: This test requires MJAR-7 which in turn requires this config to actually work. -->
+            <addMavenDescriptor>false</addMavenDescriptor>
+          </archive>
+        </configuration>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-resources-plugin</artifactId>
+        <version>2.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-shade-plugin</artifactId>
+        <version>@project.version@</version>
+        <executions>
+          <execution>
+            <id>shade</id>
+            <phase>package</phase>
+            <goals>
+              <goal>shade</goal>
+            </goals>
+            <configuration>
+              <createDependencyReducedPom>false</createDependencyReducedPom>
+              <!-- NOTE: This test checks the code path using relocation -->
+              <relocations>
+                <relocation>
+                  <pattern>org.apache</pattern>
+                  <shadedPattern>hidden</shadedPattern>
+                </relocation>
+              </relocations>
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-surefire-plugin</artifactId>
+        <version>2.3.1</version>
+      </plugin>
+    </plugins>
+  </build>
+</project>
diff --git a/src/it/rerun-with-reloc/src/main/java/org/MyInterface.java b/src/it/rerun-with-reloc/src/main/java/org/MyInterface.java
new file mode 100644
index 0000000..89e2d08
--- /dev/null
+++ b/src/it/rerun-with-reloc/src/main/java/org/MyInterface.java
@@ -0,0 +1,8 @@
+package org;
+
+/*
+ * NOTE: The project's main artifact must not be empty!
+ */
+public interface MyInterface
+{
+}
diff --git a/src/it/rerun-with-reloc/src/main/resources/some-ordinary-resource.txt b/src/it/rerun-with-reloc/src/main/resources/some-ordinary-resource.txt
new file mode 100644
index 0000000..e69de29
diff --git a/src/it/rerun-without-reloc/invoker.properties b/src/it/rerun-without-reloc/invoker.properties
new file mode 100644
index 0000000..8cf287b
--- /dev/null
+++ b/src/it/rerun-without-reloc/invoker.properties
@@ -0,0 +1,2 @@
+# NOTE: It's the essential part of the test to re-run the package phase
+invoker.goals = clean package package
diff --git a/src/it/rerun-without-reloc/pom.xml b/src/it/rerun-without-reloc/pom.xml
new file mode 100644
index 0000000..1718a87
--- /dev/null
+++ b/src/it/rerun-without-reloc/pom.xml
@@ -0,0 +1,103 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<!--
+Licensed to the Apache Software Foundation (ASF) under one
+or more contributor license agreements.  See the NOTICE file
+distributed with this work for additional information
+regarding copyright ownership.  The ASF licenses this file
+to you under the Apache License, Version 2.0 (the
+"License"); you may not use this file except in compliance
+with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing,
+software distributed under the License is distributed on an
+"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+KIND, either express or implied.  See the License for the
+specific language governing permissions and limitations
+under the License.
+-->
+
+<project>
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.its.shade.rrwor</groupId>
+  <artifactId>test</artifactId>
+  <version>0.1</version>
+  <packaging>jar</packaging>
+
+  <name>MSHADE-30</name>
+  <description>
+    Test that re-running the package phase without any code changes in between doesn't cause shading to crash. The
+    potential issue was that the first run produced the shaded artifact and that this artifact survived unchanged
+    until shading got executed the second time, thereby re-shading all classes that were included during the first
+    run.
+  </description>
+
+  <!-- NOTE: The test requires a dependency to include during shading, doesn't matter what classes though -->
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.plugins</groupId>
+      <artifactId>maven-compiler-plugin</artifactId>
+      <version>2.0.2</version>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>2.0.2</version>
+        <configuration>
+          <staleMillis>5000</staleMillis>
+        </configuration>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-install-plugin</artifactId>
+        <version>2.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-jar-plugin</artifactId>
+        <version>2.1</version>
+        <configuration>
+          <archive>
+            <!-- NOTE: This test requires MJAR-7 which in turn requires this config to actually work. -->
+            <addMavenDescriptor>false</addMavenDescriptor>
+          </archive>
+        </configuration>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-resources-plugin</artifactId>
+        <version>2.2</version>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-shade-plugin</artifactId>
+        <version>@project.version@</version>
+        <executions>
+          <execution>
+            <id>shade</id>
+            <phase>package</phase>
+            <goals>
+              <goal>shade</goal>
+            </goals>
+            <configuration>
+              <createDependencyReducedPom>false</createDependencyReducedPom>
+              <!-- NOTE: This test checks the code path not using relocation -->
+            </configuration>
+          </execution>
+        </executions>
+      </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-surefire-plugin</artifactId>
+        <version>2.3.1</version>
+      </plugin>
+    </plugins>
+  </build>
+</project>
diff --git a/src/it/rerun-without-reloc/src/main/java/org/MyInterface.java b/src/it/rerun-without-reloc/src/main/java/org/MyInterface.java
new file mode 100644
index 0000000..89e2d08
--- /dev/null
+++ b/src/it/rerun-without-reloc/src/main/java/org/MyInterface.java
@@ -0,0 +1,8 @@
+package org;
+
+/*
+ * NOTE: The project's main artifact must not be empty!
+ */
+public interface MyInterface
+{
+}
diff --git a/src/it/rerun-without-reloc/src/main/resources/some-ordinary-resource.txt b/src/it/rerun-without-reloc/src/main/resources/some-ordinary-resource.txt
new file mode 100644
index 0000000..e69de29
