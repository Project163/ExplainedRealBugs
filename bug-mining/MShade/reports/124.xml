<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:20:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MSHADE-413] Maven shade plugin enters endless loop </title>
                <link>https://issues.apache.org/jira/browse/MSHADE-413</link>
                <project id="12317921" key="MSHADE">Maven Shade Plugin (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;Two issues at play here:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;ShadeMojo.createDependencyReducedPom()&lt;/tt&gt;&#160;pulls in &lt;tt&gt;origDeps = project.getDependencies()&lt;/tt&gt; and later modifies these &lt;tt&gt;Dependency&lt;/tt&gt; objects.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;ShadeMojo.updateExcludesInDeps()&lt;/tt&gt; enters it&apos;s own endless loop, endlessly adding the exact same exclusions.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This leads to a &lt;a href=&quot;https://github.com/projectnessie/nessie/issues/3678&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;reproducible&lt;/a&gt; endless loop (see below).&lt;/p&gt;

&lt;p&gt;If the Shade plugin&apos;s not using the &lt;tt&gt;Dependency&lt;/tt&gt; objects &quot;owned by Maven itself&quot; (by setting &lt;tt&gt;promoteTransitiveDependencies&lt;/tt&gt; to &lt;tt&gt;true&lt;/tt&gt;), the build passes fine.&lt;/p&gt;

&lt;p&gt;I think, &lt;em&gt;modifying&lt;/em&gt; the &lt;tt&gt;Dependency&lt;/tt&gt; objects &quot;owned by Maven itself&quot; is bad for two reasons (which IMO justify the increased priority of this ticket): &lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;the reproducible endless loop&lt;/li&gt;
	&lt;li&gt;it breaks the correctness of the project build - at least plugins running after the &lt;tt&gt;shade&lt;/tt&gt; goal that use those dependencies.&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="13434916">MSHADE-413</key>
            <summary>Maven shade plugin enters endless loop </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Mar 2022 13:34:13 +0000</created>
                <updated>Sat, 14 Jun 2025 18:13:08 +0000</updated>
                            <resolved>Fri, 21 Oct 2022 19:54:46 +0000</resolved>
                                    <version>3.2.4</version>
                                    <fixVersion>3.4.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17509907" author="snazy" created="Mon, 21 Mar 2022 14:07:49 +0000"  >&lt;p&gt;Reproducer from projectnessie:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;tt&gt;git clone &lt;a href=&quot;https://github.com/projectnessie/nessie.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/projectnessie/nessie.git&lt;/a&gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;git checkout a8572ea368e03f5cb5e805b2af1776556a62f2ed&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;mvn clean install -T1C -DskipTests&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;mvn clean install -T1C -pl clients/spark-extensions -pl clients/spark-3.2-extensions&lt;/tt&gt; (if the above doesn&apos;t run into the endless loop)&lt;/li&gt;
	&lt;li&gt;With the workaround @ &lt;tt&gt;git checkout 25e2b891f2ea4e032bf188574002517f583c7645&lt;/tt&gt;, the last &lt;tt&gt;mvn&lt;/tt&gt; passes fine&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="17509913" author="snazy" created="Mon, 21 Mar 2022 14:15:09 +0000"  >&lt;p&gt;But... even with &lt;tt&gt;promoteTransitiveDependencies==true&lt;/tt&gt;, the shade plugin can still loop forever rewriting the &lt;tt&gt;dependency-reduced-pom.xml&lt;/tt&gt; file. So there is also something else at play in the maven-shade-plugin.&lt;/p&gt;</comment>
                            <comment id="17509977" author="snazy" created="Mon, 21 Mar 2022 16:15:43 +0000"  >&lt;p&gt;The reason for the latter is that the exclusion(s) added in &lt;tt&gt;ShadeMojo.updateExcludesInDeps()&lt;/tt&gt; keep on adding the same exclusion(s) over and over again.&lt;/p&gt;</comment>
                            <comment id="17514370" author="khmarbaise" created="Tue, 29 Mar 2022 23:54:11 +0000"  >&lt;ul&gt;
	&lt;li&gt;First I can&apos;t even compile the whole project as given with  step 3, because a dependency is missing: &lt;tt&gt;io.delta:delta-core_2.12:jar:1.1.0-nessie&lt;/tt&gt; which does not exist in central.&lt;/li&gt;
	&lt;li&gt;Furthermore I can not reproduce the Step 4. because I can run it without any issue...&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17514510" author="snazy" created="Wed, 30 Mar 2022 07:56:36 +0000"  >&lt;p&gt;&amp;gt; I can&apos;t even compile the whole project&lt;/p&gt;

&lt;p&gt;That&apos;s weird. The repository&apos;s &lt;a href=&quot;https://github.com/projectnessie/nessie/blob/main/clients/deltalake/pom.xml#L116-L122&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;configured here&lt;/a&gt;. Maybe something with your local settings?&lt;/p&gt;

&lt;p&gt;&amp;gt; I can not reproduce the Step 4. because I can run it without any issue&lt;/p&gt;

&lt;p&gt;There&apos;s a reproducer on the PR as well. Have you tried it?&lt;/p&gt;

&lt;p&gt;The symptoms are exactly the same as reported by many other people (&lt;a href=&quot;https://issues.apache.org/jira/browse/MNG-7096&quot; title=&quot;Maven master and m-shade-p 3.2.1 hangs forever&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MNG-7096&quot;&gt;&lt;del&gt;MNG-7096&lt;/del&gt;&lt;/a&gt;, the unmerged PR on &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-148&quot; title=&quot;Shade Plugin gets stuck in infinite loop building dependency reduced POM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-148&quot;&gt;&lt;del&gt;MSHADE-148&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-384&quot; title=&quot;maven building hang when using multithread on jdk 11&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-384&quot;&gt;MSHADE-384&lt;/a&gt; and couple of mentions elsewhere, sometimes with the workaround to set &lt;tt&gt;promoteTransitiveDependencies=true&lt;/tt&gt;, which is a change to the behavior).&lt;/p&gt;</comment>
                            <comment id="17514872" author="khmarbaise" created="Wed, 30 Mar 2022 18:10:14 +0000"  >&lt;p&gt;Ah... now I see the problem was the repository given in the pom file which prevents that, because I&apos;m using a repository manager which blocks everything...&lt;/p&gt;</comment>
                            <comment id="17525446" author="delany" created="Thu, 21 Apr 2022 06:41:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/hunterhacker/jdom/issues/199&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/hunterhacker/jdom/issues/199&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17622476" author="hudson" created="Fri, 21 Oct 2022 20:25:51 +0000"  >&lt;p&gt;Build succeeded in Jenkins: Maven &#187; Maven TLP &#187; maven-shade-plugin &#187; master #45&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-shade-plugin/job/master/45/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-shade-plugin/job/master/45/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17976390" author="JIRAUSER302100" created="Sat, 14 Jun 2025 18:13:08 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-shade-plugin/issues/658&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-shade-plugin#658&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13357897">MNG-7096</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10oaw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>