<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:20:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MSHADE-339] Shaded test jar has wrong type &quot;jar&quot;</title>
                <link>https://issues.apache.org/jira/browse/MSHADE-339</link>
                <project id="12317921" key="MSHADE">Maven Shade Plugin (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;The shaded test jar has the wrong type &quot;jar&quot;.&lt;br/&gt;
It should be &quot;test-jar&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13275950">MSHADE-339</key>
            <summary>Shaded test jar has wrong type &quot;jar&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="khmarbaise">Karl Heinz Marbaise</assignee>
                                    <reporter username="peterdm">Peter De Maeyer</reporter>
                        <labels>
                    </labels>
                <created>Sun, 22 Dec 2019 18:28:43 +0000</created>
                <updated>Sat, 14 Jun 2025 18:13:05 +0000</updated>
                            <resolved>Mon, 3 Feb 2020 18:09:32 +0000</resolved>
                                    <version>2.2</version>
                    <version>3.2.2</version>
                                    <fixVersion>3.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17003699" author="hboutemy" created="Thu, 26 Dec 2019 16:50:19 +0000"  >&lt;p&gt;true, this is one of the few cases where extension is not the same as artifact type &lt;a href=&quot;https://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;one question: is this little code inconsistency breaking anything?&lt;/p&gt;

&lt;p&gt;and while at it, shouldn&apos;t the &quot;tests&quot; classifier be removed from the call, since it is implicit in &quot;test-jar&quot; type?&lt;/p&gt;

&lt;p&gt;is there any test that covers the change? (because I would also fear the the API has a parameter named type but uses it as extension: this is a part of the Maven APIs that has been unclear for years...)&lt;/p&gt;</comment>
                            <comment id="17003714" author="rfscholte" created="Thu, 26 Dec 2019 17:55:29 +0000"  >&lt;p&gt;IMO there&apos;s too much mixup between dependencies and artifacts. We should work more towards &lt;a href=&quot;https://maven.apache.org/shared/maven-artifact-transfer/comparison.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/shared/maven-artifact-transfer/comparison.html&lt;/a&gt;&lt;br/&gt;
That said: artifacts have an extension, not a type (that&apos;s for dependencies). &lt;br/&gt;
In the end this PR has will still give you the same result.&lt;/p&gt;</comment>
                            <comment id="17004341" author="peterdm" created="Fri, 27 Dec 2019 22:36:27 +0000"  >&lt;blockquote&gt;
&lt;p&gt;and while at it, shouldn&apos;t the &quot;tests&quot; classifier be removed from the call, since it is implicit in &quot;test-jar&quot; type?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s not correct - the classifier is not implicit. &quot;tests&quot; is the &lt;em&gt;default&lt;/em&gt; classifier for &quot;test-jar&quot; type, but can be explicitly overridden to be anything.&lt;br/&gt;
See &lt;a href=&quot;https://issues.apache.org/jira/browse/MSOURCES-124&quot; title=&quot;Sources and test sources should have separate artifact types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSOURCES-124&quot;&gt;MSOURCES-124&lt;/a&gt; for a more elaborate explanation.&lt;/p&gt;

&lt;p&gt;The Shade plugin only deals well with the default classifiers, but doesn&apos;t properly handle non-default classifiers.&lt;br/&gt;
I&apos;ve made another bug for that which I intend to fix at some point too, but let&apos;s first fix the default classifier already (the scope of &lt;em&gt;this&lt;/em&gt; issue).&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;one question: is this little code inconsistency breaking anything?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Types and classifiers are used to look up dependencies, so if a dependency is attached with the wrong type, a project that depends on it may not find back the dependency.&lt;br/&gt;
Hence, I think it will break projects that depend on it, which are processed later in the &quot;Maven reactor processing chain&quot; (not sure if that is a correct term).&lt;br/&gt;
I suppose I could try and write an IT test scenario that illustrates what can go wrong. I didn&apos;t bother initially because it takes some effort and the fix is obvious enough, but if you really like I can try...&lt;/p&gt;</comment>
                            <comment id="17004429" author="hboutemy" created="Sat, 28 Dec 2019 09:00:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=peterdm&quot; class=&quot;user-hover&quot; rel=&quot;peterdm&quot;&gt;peterdm&lt;/a&gt; thank you for your feedback&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;That&apos;s not correct - the classifier is not implicit. &quot;tests&quot; is the default classifier for &quot;test-jar&quot; type, but can be explicitly overridden to be anything.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yes, it can be overridden, when necessary (then default value is implicit: we fully agree): in this case it is not necessary, since it is the default value.&lt;br/&gt;
Then why override the default value with the same value?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I suppose I could try and write an IT test scenario that illustrates what can go wrong. I didn&apos;t bother initially because it takes some effort and the fix is obvious enough, but if you really like I can try...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think an IT would be useful (perhaps updating an existing IT, if one was written for &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-158&quot; title=&quot;Allow shading of test jar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-158&quot;&gt;&lt;del&gt;MSHADE-158&lt;/del&gt;&lt;/a&gt;): from experience, these little one liner changes are the most risky, because &quot;they are obvious&quot; then we discover that the effect is not limited to what was obvious &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17004431" author="hboutemy" created="Sat, 28 Dec 2019 09:07:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rfscholte&quot; class=&quot;user-hover&quot; rel=&quot;rfscholte&quot;&gt;rfscholte&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;In the end this PR has will still give you the same result.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Is it an opinion based on pure logic, or result of tests? I&apos;ve learned in the past to avoid pure opinions, since effective results a may vary...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;That said: artifacts have an extension, not a type (that&apos;s for dependencies)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yes, we should probably update MavenProjectHelper.attachArtifact API &lt;a href=&quot;https://maven.apache.org/ref/3.6.3/maven-core/apidocs/org/apache/maven/project/MavenProjectHelper.html#attachArtifact-org.apache.maven.project.MavenProject-java.lang.String-java.io.File-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/ref/3.6.3/maven-core/apidocs/org/apache/maven/project/MavenProjectHelper.html#attachArtifact-org.apache.maven.project.MavenProject-java.lang.String-java.io.File-&lt;/a&gt;&lt;br/&gt;
perhaps it&apos;s just the attribute name that is just wrongly named as &lt;tt&gt;artifactType&lt;/tt&gt; (then implies default classifier) when it is in reality just &lt;tt&gt;artifactExtension&lt;/tt&gt;&lt;br/&gt;
but in this case, the PR won&apos;t work, since the extension from a call with &quot;test-jar&quot; would be &quot;.test-jar&quot;...&lt;br/&gt;
these types of issues are exactly why I don&apos;t want to just rely on &quot;pure logic&quot;, since it seems the initial logic in Maven core may be half baked&lt;/p&gt;</comment>
                            <comment id="17004443" author="peterdm" created="Sat, 28 Dec 2019 10:06:43 +0000"  >&lt;blockquote&gt;
&lt;p&gt;perhaps it&apos;s just the attribute name that is just wrongly named as &lt;tt&gt;artifactType&lt;/tt&gt; (then implies default classifier) when it is in reality just &lt;tt&gt;artifactExtension&lt;/tt&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hmm, I&apos;m not entirely certain, but I don&apos;t think think that&apos;s true - the extension is still jar.&lt;br/&gt;
The reason I dare say this is because I think I would have noticed that while fixing.&lt;br/&gt;
Even though I didn&apos;t write an additional IT, I &lt;em&gt;did&lt;/em&gt; run all the &lt;em&gt;existing&lt;/em&gt; ITs, and they were all green.&lt;br/&gt;
Surely enough, if something so obvious as the file extension would change, it would make some existing ITs fail (I hope)...&lt;/p&gt;

&lt;p&gt;Anyway, point taken: I&apos;ll go back to the drawing board and either add a new IT or update an existing one in my PR to illustrate a scenario that could go wrong.&lt;/p&gt;</comment>
                            <comment id="17004462" author="hboutemy" created="Sat, 28 Dec 2019 11:26:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;Surely enough, if something so obvious as the file extension would change, it would make some existing ITs fail (I hope)...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;from the initial implementation in &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-158&quot; title=&quot;Allow shading of test jar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-158&quot;&gt;&lt;del&gt;MSHADE-158&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1543990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1543990&lt;/a&gt; , I fear there is absolutely no IT checking anything about this case...&lt;/p&gt;

&lt;p&gt;(and reading &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-158&quot; title=&quot;Allow shading of test jar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-158&quot;&gt;&lt;del&gt;MSHADE-158&lt;/del&gt;&lt;/a&gt;, the request about improving documentation for the new parameter seems to have been neglected: this one would also be useful to improve)&lt;br/&gt;
then if you did not test the update with one of your favorite project that uses the feature, any change in code is just hazardous guessing about the effective result vs the intent &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17004566" author="peterdm" created="Sat, 28 Dec 2019 19:53:25 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I fear there is absolutely no IT checking anything about this case&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Actually, there is &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. It&apos;s the one that I wrote myself in the context of &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-284&quot; title=&quot;Shaded test JARs are always empty&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-284&quot;&gt;&lt;del&gt;MSHADE-284&lt;/del&gt;&lt;/a&gt;. See &lt;a href=&quot;https://github.com/apache/maven-shade-plugin/blob/master/src/it/MSHADE-284_shadeTestJar/verify.groovy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;master/src/it/MSHADE-284_shadeTestJar/verify.groovy&lt;/a&gt;, lines 37-52: those assertions would have failed if the extension had suddenly changed to &quot;test-jar&quot;. I double-checked just now by running the test and inspecting the resulting project in the &lt;tt&gt;target/&lt;/tt&gt; directory - I confirm that the extension is still &quot;jar&quot; after my fix.&lt;/p&gt;

&lt;p&gt;Still, I&apos;ll (try to) add an IT to illustrate what can go wrong if we don&apos;t fix this issue. Stay tuned.&lt;/p&gt;</comment>
                            <comment id="17004732" author="hboutemy" created="Sun, 29 Dec 2019 10:01:47 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=peterdm&quot; class=&quot;user-hover&quot; rel=&quot;peterdm&quot;&gt;peterdm&lt;/a&gt;&lt;br/&gt;
I had a look at Artifact interface  &lt;a href=&quot;https://maven.apache.org/ref/3.6.3/maven-artifact/apidocs/org/apache/maven/artifact/Artifact.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/ref/3.6.3/maven-artifact/apidocs/org/apache/maven/artifact/Artifact.html&lt;/a&gt; and its default implementation&lt;br/&gt;
the root issue is in this interface, which mixes artifact features with dependency features, then it&apos;s hard to really use only one aspect...&lt;/p&gt;

&lt;p&gt;IMHO if we consider that the MavenProjectHelper parameter is a type (which it actually is given the implementation), we should attach with &quot;test-jar&quot; type and no classifier, since the implementation will fill with the default classifier &lt;a href=&quot;https://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html&lt;/a&gt;&lt;br/&gt;
if we consider we want to use it more as an extension (which is IMHO more logical given &lt;a href=&quot;https://maven.apache.org/shared/maven-artifact-transfer/comparison.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/shared/maven-artifact-transfer/comparison.html&lt;/a&gt;), we should use &quot;jar&quot; extension and &quot;tests&quot; classifier&lt;/p&gt;

&lt;p&gt;of course, if your IT can prove one provides different result than the other (which is not obvious to me), this will give us a preference for one implementation over the other...&lt;/p&gt;</comment>
                            <comment id="17005051" author="peterdm" created="Sun, 29 Dec 2019 21:52:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;IMHO if we consider that the MavenProjectHelper parameter is a type (which it actually is given the implementation), we should attach with &quot;test-jar&quot; type and no classifier, since the implementation will fill with the default classifier &lt;a href=&quot;https://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree with you there, but if we do that consistently in the implementation of &lt;tt&gt;ShadeMojo&lt;/tt&gt;, that&apos;s a much bigger change than I was willing to do in the context of this issue. I was planning to create a separate issue for that at some point.&lt;/p&gt;

&lt;p&gt;Everywhere in the implementation &lt;tt&gt;ShadeMojo&lt;/tt&gt; where &lt;tt&gt;projectHelper.attachArtifact&lt;/tt&gt; is used, we should pass &lt;tt&gt;null&lt;/tt&gt; as classifier. In fact, the only reason to ever pass a non-null classifier is if you intend to use a &lt;em&gt;different&lt;/em&gt; one than the default. Classifiers and extension should always be gotten from the &lt;tt&gt;ArtifactHandler&lt;/tt&gt; instead of the hardcoded ones that are currently used. If you do that, it would be easier to prove that &quot;jar&quot; is the wrong type, and it should really be &quot;test-jar&quot;.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;if we consider we want to use it more as an extension (which is IMHO more logical given &lt;a href=&quot;https://maven.apache.org/shared/maven-artifact-transfer/comparison.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/shared/maven-artifact-transfer/comparison.html&lt;/a&gt;), we should use &quot;jar&quot; extension and &quot;tests&quot; classifier&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I disagree with you there.&lt;br/&gt;
You shouldn&apos;t use type &quot;as an extension&quot; nor &quot;as a classifier&quot;, because type, extension and classifier are 3 different things.&lt;br/&gt;
Let me elaborate:&lt;br/&gt;
There are 3 relevant types in the context of &lt;tt&gt;ShadeMojo&lt;/tt&gt;: &quot;jar&quot;, &quot;test-jar&quot; and &quot;java-source&quot;.&lt;br/&gt;
The type you pass to &lt;tt&gt;(Default)MavenProjectHelper.attachArtifact&lt;/tt&gt; is used to look up an &lt;tt&gt;ArtifactHandler&lt;/tt&gt;.&lt;br/&gt;
The &lt;tt&gt;ArtifactHandler&lt;/tt&gt; defines the extension and the default classifier.&lt;br/&gt;
By using &quot;jar&quot; instead of &quot;test-jar&quot;, you in fact have the wrong &lt;tt&gt;ArtifactHandler&lt;/tt&gt;.&lt;br/&gt;
It works by accident because &quot;jar&quot; happens to have the same extension as &quot;test-jar&quot;, and because the &lt;tt&gt;ArtifactHandler&lt;/tt&gt; isn&apos;t really used much in the rest of the code because the classifier &quot;tests&quot; is passed in to override it, but that doesn&apos;t make it right.&lt;/p&gt;</comment>
                            <comment id="17005182" author="hboutemy" created="Mon, 30 Dec 2019 07:57:24 +0000"  >&lt;p&gt;it seems we now agree on changing the PR to not override classifier but use the default value:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
projectHelper.attachArtifact( project, &lt;span class=&quot;code-quote&quot;&gt;&quot;test-jar&quot;&lt;/span&gt;, shadedTests );&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;on deciding whether this change should really be done instead of letting initial&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
projectHelper.attachArtifact( project, &lt;span class=&quot;code-quote&quot;&gt;&quot;jar&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;tests&quot;&lt;/span&gt;, shadedTests );&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we perfectly see the difference in the 2 Artifact objects that are created by these 2 API calls, that map to the same file (classifier + extension): notice that these objects are not equal given equals() implementation that uses groupId, artifactId, version, type and classifier&lt;/p&gt;

&lt;p&gt;Now, in the context of the project attaching the artifact, the project does not care: it does not use the artifact as a dependency.&lt;br/&gt;
 In the context of another project that would use the file as a dependency, it would create another Artifact instance with the expected type for the dependency, and that would match the file. The resolution of the dependency happens at File level, as resolved from repositories: the artifact instance that created the file has no impact. Reactor resolution optimization does the same, using extension: &lt;a href=&quot;https://maven.apache.org/ref/3.6.3/maven-core/xref/org/apache/maven/ReactorReader.html#L232&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/ref/3.6.3/maven-core/xref/org/apache/maven/ReactorReader.html#L232&lt;/a&gt; (notice that Artifact here is org.eclipse.aether.Artifact, that perfectly separates Artifact&#160;&lt;a href=&quot;http://maven.apache.org/resolver/maven-resolver-api/apidocs/org/eclipse/aether/artifact/Artifact.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://maven.apache.org/resolver/maven-resolver-api/apidocs/org/eclipse/aether/artifact/Artifact.html&lt;/a&gt; and Dependency &lt;a href=&quot;http://maven.apache.org/resolver/maven-resolver-api/apidocs/org/eclipse/aether/graph/Dependency.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://maven.apache.org/resolver/maven-resolver-api/apidocs/org/eclipse/aether/graph/Dependency.html&lt;/a&gt; notions: it learned from initial Maven mistake)&lt;/p&gt;

&lt;p&gt;I&apos;m confident that ITs will prove that both codes work.&lt;br/&gt;
 I&apos;m clear that the &quot;test-jar&quot; is what the API intended.&lt;br/&gt;
 I&apos;m sure that &quot;jar&quot; + &quot;tests&quot; is what best represents the reality in the context of the project that attach the file, and that when we refactor Maven&apos;s Artifact to split its dependency aspects, &quot;test-jar&quot; won&apos;t work any more at artifact level but only at dependency level&lt;/p&gt;

&lt;p&gt;I&apos;m torn if the PR should be applied :/&lt;/p&gt;</comment>
                            <comment id="17005240" author="rfscholte" created="Mon, 30 Dec 2019 10:22:37 +0000"  >&lt;p&gt;Regarding my &quot;In the end this PR has will still give you the same result.&quot;: The result is a file attached which will be distributed with the jar extension, because the first thing that&apos;s happening is mapping the type to an extension when possible. Both test-jar and jar map to jar, hence my reason to say the result will be the same.&lt;/p&gt;</comment>
                            <comment id="17005340" author="hboutemy" created="Mon, 30 Dec 2019 14:03:06 +0000"  >&lt;p&gt;with reactor resolution, there is no file distributed anywhere: this is the case I was worried about. But it seems it should work also&lt;br/&gt;
For any other case, where there is distribution, yes, we don&apos;t care from the beginning&lt;/p&gt;</comment>
                            <comment id="17006478" author="peterdm" created="Wed, 1 Jan 2020 20:35:16 +0000"  >&lt;p&gt;In terms of file distribution, indeed you can achieve the same by using &quot;jar&quot;, since the type is not stored in the artifact name.&lt;br/&gt;
Reactor resolution on the other hand is exactly the case where I expected to prove my point that &quot;jar&quot; is a bug and it should be &quot;test-jar&quot;:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;test-jar&quot; should end up on the &lt;em&gt;test&lt;/em&gt; classpath and be propagated as such to dependent projects. Test classpaths should not be visible on the main classpath.&lt;/li&gt;
	&lt;li&gt;&quot;jar&quot; should end up on the main classpath (which is also visible on the main classpath).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;What I expected is that, because shaded test classes are attached with the wrong type &quot;jar&quot;, test classes from a shaded project would pollute the &lt;em&gt;main&lt;/em&gt; classpath of a dependent project, which would be a bug.&lt;br/&gt;
Unfortunately, the reactor behaves differently than I thought, and I wasn&apos;t able to prove anything yet.&lt;/p&gt;</comment>
                            <comment id="17008355" author="hboutemy" created="Sun, 5 Jan 2020 16:55:54 +0000"  >&lt;p&gt;after digging in depth, my final view on this is: I&apos;m ok either to stay with &quot;attach( &quot;jar&quot;, &quot;tests&quot; )&quot; or switch to &quot;attach( &quot;test-jar&quot; )&quot;, as you wish&lt;br/&gt;
but against current PR &quot;attach( &quot;test-jar&quot;, &quot;tests&quot; )&quot;, which is an option that is a mix between type and ext+classpath, then IMHO creating even more confusion&lt;/p&gt;</comment>
                            <comment id="17008389" author="rfscholte" created="Sun, 5 Jan 2020 18:34:39 +0000"  >&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hboutemy&quot; class=&quot;user-hover&quot; rel=&quot;hboutemy&quot;&gt;hboutemy&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17013572" author="peterdm" created="Sat, 11 Jan 2020 20:54:37 +0000"  >&lt;p&gt;I updated the pull request with the &quot;attach( &quot;test-jar&quot; )&quot; solution, since we all agree on that.&lt;/p&gt;

&lt;p&gt;Note that it&apos;s now a bit inconsistent with &quot;attach( &quot;java-source&quot;, &quot;sources&quot; )&quot; a couple of lines above, which could ultimately become &quot;attach( &quot;java-sources&quot; )&quot; as well following the same rationale. My fingers were itching to bring that in line too, but I didn&apos;t want to stir up the debate again, so I left it alone.&lt;/p&gt;</comment>
                            <comment id="17016365" author="hboutemy" created="Wed, 15 Jan 2020 22:18:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;My fingers were itching to bring that in line too, but I didn&apos;t want to stir up the debate again, so I left it alone&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;good reaction, given how the current discussion has been unexpectedly hard&lt;/p&gt;

&lt;p&gt;to me, changing to &quot;attach( &quot;java-sources&quot; )&quot; would be a good idea, but it deserves a separate PR on the current has been merged &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17023553" author="khmarbaise" created="Sat, 25 Jan 2020 13:28:43 +0000"  >&lt;p&gt;So any objections to get the PR merged as it is?&lt;/p&gt;</comment>
                            <comment id="17029147" author="hboutemy" created="Mon, 3 Feb 2020 18:09:33 +0000"  >&lt;p&gt;merged the updated PR content, ie not the old content that was in &lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-339&quot; title=&quot;Shaded test jar has wrong type &amp;quot;jar&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-339&quot;&gt;&lt;del&gt;MSHADE-339&lt;/del&gt;&lt;/a&gt; branch&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/maven-shade-plugin/commit/85509b1574663be0856ab8e8eca303aa17445011&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-shade-plugin/commit/85509b1574663be0856ab8e8eca303aa17445011&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17029235" author="hudson" created="Mon, 3 Feb 2020 20:04:31 +0000"  >&lt;p&gt;Build succeeded in Jenkins: Maven TLP &#187; maven-shade-plugin &#187; master #52&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://builds.apache.org/job/maven-box/job/maven-shade-plugin/job/master/52/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/maven-box/job/maven-shade-plugin/job/master/52/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17976378" author="JIRAUSER302100" created="Sat, 14 Jun 2025 18:13:05 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-shade-plugin/issues/340&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-shade-plugin#340&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="12808077">MSHADE-158</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13149571">MSHADE-284</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09x6g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>