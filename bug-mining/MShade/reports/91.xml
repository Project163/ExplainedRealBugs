<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:20:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MSHADE-240] support relocation pom.properties and pom.xml descriptors in shaded jars</title>
                <link>https://issues.apache.org/jira/browse/MSHADE-240</link>
                <project id="12317921" key="MSHADE">Maven Shade Plugin (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;When using shade plugin to embbed (and relocate to be safe) some dependency the final jar ends up with the dependency &lt;tt&gt;/META-INF/maven/&amp;lt;groupid&amp;gt;/&amp;lt;artifactid&amp;gt;/*&lt;/tt&gt; files.&lt;/p&gt;

&lt;p&gt;The problem is that in the final jars those files essentially become a lie for any tools looking at those descriptors to find out what the jar contains and you end up with false positive.&lt;/p&gt;

&lt;p&gt;Ideally they should be stripped when relocating a dependency since it means the jar does not contain what is indicated in those files anymore, only something that happen to have the same feature but with completely different packages (so unusable). An alternative is to move them in some other place like &lt;tt&gt;/META-INF/shade/maven/&amp;lt;groupid&amp;gt;/&amp;lt;artifactid&amp;gt;/*&lt;/tt&gt; for example, so that you still keep information about what has been shaded.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13021493">MSHADE-240</key>
            <summary>support relocation pom.properties and pom.xml descriptors in shaded jars</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rfscholte">Robert Scholte</assignee>
                                    <reporter username="tmortagne">Thomas Mortagne</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Nov 2016 16:04:45 +0000</created>
                <updated>Sat, 14 Jun 2025 18:13:00 +0000</updated>
                            <resolved>Fri, 20 Jan 2017 16:38:10 +0000</resolved>
                                    <version>2.4.3</version>
                                    <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15674093" author="tmortagne" created="Thu, 17 Nov 2016 16:10:38 +0000"  >&lt;p&gt;Note: I can try to implement it if I&apos;m not the only one thinking it would be nice and with some pointers of where it would be the cleanest to do that (I was thinking about somewhere in DefaultShader#shadeJars) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I would suggest skip those files if there is any relocation (i.e. the jar is missing stuff and can&apos;t be considered the same anymore) but keep them if nothing is modified (jar merged as it is).&lt;/p&gt;</comment>
                            <comment id="15832070" author="rfscholte" created="Fri, 20 Jan 2017 16:38:10 +0000"  >&lt;p&gt;I haven&apos;t activated it by default, but at least it is now a lot easier to achieve using the following relocator:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;relocation&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;pattern&amp;gt;&lt;/span&gt;META-INF/maven&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/pattern&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;shadedPattern&amp;gt;&lt;/span&gt;META-INF/shade/maven&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/shadedPattern&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;excludes&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;exclude&amp;gt;&lt;/span&gt;META-INF/maven/${project.groupId}/${project.artifactId}/pom.*&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/exclude&amp;gt;&lt;/span&gt;
                  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/excludes&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/relocation&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15832083" author="hudson" created="Fri, 20 Jan 2017 16:46:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build maven-plugins #8621 (See &lt;a href=&quot;https://builds.apache.org/job/maven-plugins/8621/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/maven-plugins/8621/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-240&quot; title=&quot;support relocation pom.properties and pom.xml descriptors in shaded jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-240&quot;&gt;&lt;del&gt;MSHADE-240&lt;/del&gt;&lt;/a&gt; support relocation pom.properties and pom.xml descriptors in shaded jars (rfscholte: &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1779644&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1779644&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) maven-shade-plugin/src/it/&lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-240&quot; title=&quot;support relocation pom.properties and pom.xml descriptors in shaded jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-240&quot;&gt;&lt;del&gt;MSHADE-240&lt;/del&gt;&lt;/a&gt;_reloc-mavenfiles&lt;/li&gt;
	&lt;li&gt;(add) maven-shade-plugin/src/it/&lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-240&quot; title=&quot;support relocation pom.properties and pom.xml descriptors in shaded jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-240&quot;&gt;&lt;del&gt;MSHADE-240&lt;/del&gt;&lt;/a&gt;_reloc-mavenfiles/pom.xml&lt;/li&gt;
	&lt;li&gt;(add) maven-shade-plugin/src/it/&lt;a href=&quot;https://issues.apache.org/jira/browse/MSHADE-240&quot; title=&quot;support relocation pom.properties and pom.xml descriptors in shaded jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MSHADE-240&quot;&gt;&lt;del&gt;MSHADE-240&lt;/del&gt;&lt;/a&gt;_reloc-mavenfiles/verify.groovy&lt;/li&gt;
	&lt;li&gt;(edit) maven-shade-plugin/src/main/java/org/apache/maven/plugins/shade/relocation/SimpleRelocator.java&lt;/li&gt;
	&lt;li&gt;(edit) maven-shade-plugin/src/test/java/org/apache/maven/plugins/shade/relocation/SimpleRelocatorTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15832178" author="tmortagne" created="Fri, 20 Jan 2017 17:54:18 +0000"  >&lt;blockquote&gt;&lt;p&gt;I haven&apos;t activated it by default&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Would have been nice. Most of the issues I have are with dependencies I don&apos;t control on and which don&apos;t care about those files so they will never thing about enabling this.&lt;/p&gt;</comment>
                            <comment id="15832286" author="rfscholte" created="Fri, 20 Jan 2017 19:22:46 +0000"  >&lt;p&gt;I know cases where these files are searched for on the classpath. So relocating will make it fail in such cases. Current behavior seems reasonable to me, also because it is simple: a pure merge of jar files.&lt;/p&gt;</comment>
                            <comment id="15833119" author="tmortagne" created="Sat, 21 Jan 2017 19:35:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;I know cases where these files are searched for on the classpath&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes my use case is exactly about that. But what you don&apos;t seems to understand is that in case of relocation these files don&apos;t match what is in the jar anymore. Again as I explained in the issue description those files are misleading any tools that search for those files to find out what is in the JAR. In other words since the JAR does not contain the classes of somegroupid:someartifactid:someversion it should not contain a descriptor indicating it&apos;s somegroupid:someartifactid:someversion because it&apos;s simply not true anymore.&lt;/p&gt;</comment>
                            <comment id="15833135" author="rfscholte" created="Sat, 21 Jan 2017 20:38:32 +0000"  >&lt;p&gt;Your situation is exactly the opposite of my usecase. In my case it must find the version of a certain dependency, no matter shaded or not. So it all depends on the implementation, hence it is up to the developer to decide if these files should be relocated or not.&lt;/p&gt;</comment>
                            <comment id="15833437" author="tmortagne" created="Sun, 22 Jan 2017 10:05:16 +0000"  >&lt;p&gt;IMO your use case is covered by what I suggested in the issue description:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;An alternative is to move them in some other place like /META-INF/shade/maven/&amp;lt;groupid&amp;gt;/&amp;lt;artifactid&amp;gt;/* for example, so that you still keep information about what has been shaded.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As I said since the JAR does not contain what it&apos;s supposed to contain it should not screen to still being what it used to be. But in your use case you could look at both shaded and not shaded descriptors. In my case I have no way to know what kind of JAR it is (and I&apos;m not even supposed to know what shade plugin is).&lt;/p&gt;</comment>
                            <comment id="17976354" author="JIRAUSER302100" created="Sat, 14 Jun 2025 18:13:00 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-shade-plugin/issues/605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-shade-plugin#605&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36gkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>