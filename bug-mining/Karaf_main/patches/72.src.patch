diff --git a/main/src/main/java/org/apache/karaf/main/InstanceHelper.java b/main/src/main/java/org/apache/karaf/main/InstanceHelper.java
index f276f0103a..f78c127432 100644
--- a/main/src/main/java/org/apache/karaf/main/InstanceHelper.java
+++ b/main/src/main/java/org/apache/karaf/main/InstanceHelper.java
@@ -36,10 +36,10 @@ import org.osgi.framework.launch.Framework;
 
 public class InstanceHelper {
 
-    static void updateInstancePid(final File karafHome, File karafBase) {
+    static void updateInstancePid(final File karafHome, File karafBase, final boolean isStartingInstance) {
         try {
             final String instanceName = System.getProperty("karaf.name");
-            final String pid = getPid();
+            final String pid = isStartingInstance ? getPid() : "0";
 
             final boolean isRoot = karafHome.equals(karafBase);
             
@@ -70,7 +70,9 @@ public class InstanceHelper {
                                 props.setProperty("item.0.pid", pid);
                                 props.setProperty("item.0.root", "true");
                             } else {
-                                throw new IllegalStateException("Child instance started but no root registered in " + propertiesFile);
+                                String errMsg = "Child instance " + (isStartingInstance ? "started" : "stopped") + " but no root registered in ";
+                                throw new IllegalStateException(errMsg + propertiesFile);
+
                             }
                         } else {
                             int count = Integer.parseInt(props.getProperty("count"));
diff --git a/main/src/main/java/org/apache/karaf/main/Main.java b/main/src/main/java/org/apache/karaf/main/Main.java
index 169e31a27b..12b8c43b0c 100644
--- a/main/src/main/java/org/apache/karaf/main/Main.java
+++ b/main/src/main/java/org/apache/karaf/main/Main.java
@@ -185,6 +185,7 @@ public class Main {
                 main.awaitShutdown();
                 boolean stopped = main.destroy();
                 restart = Boolean.getBoolean("karaf.restart");
+                main.updateInstancePidAfterShutdown();
                 if (!stopped) {
                     if (restart) {
                         System.err.println("Timeout waiting for framework to stop.  Restarting now.");
@@ -214,6 +215,13 @@ public class Main {
     public void setShutdownCallback(ShutdownCallback shutdownCallback) {
         this.shutdownCallback = shutdownCallback;
     }
+    
+    public void updateInstancePidAfterShutdown() throws Exception {
+        if (config == null) {
+            config = new ConfigProperties();
+        }
+        InstanceHelper.updateInstancePid(config.karafHome, config.karafBase, false);
+    }
 
     public void launch() throws Exception {
         config = new ConfigProperties();
@@ -223,7 +231,7 @@ public class Main {
         String log4jConfigPath = System.getProperty("karaf.etc") + "/org.ops4j.pax.logging.cfg";
         BootstrapLogManager.setProperties(config.props, log4jConfigPath);
         lockCallback = new KarafLockCallback();
-        InstanceHelper.updateInstancePid(config.karafHome, config.karafBase);
+        InstanceHelper.updateInstancePid(config.karafHome, config.karafBase, true);
         LOG.addHandler(BootstrapLogManager.getDefaultHandler());
 
         for (String provider : config.securityProviders) {
