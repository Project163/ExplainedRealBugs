diff --git a/main/src/main/java/org/apache/karaf/main/Main.java b/main/src/main/java/org/apache/karaf/main/Main.java
index 441ac30b23..c0414b6507 100644
--- a/main/src/main/java/org/apache/karaf/main/Main.java
+++ b/main/src/main/java/org/apache/karaf/main/Main.java
@@ -913,9 +913,12 @@ public class Main {
 
         List<URL> urls = new ArrayList<URL>();
         urls.add( bundleFile.toURI().toURL() );
-        for (File f : new File(karafHome, "lib").listFiles()) {
-            if (f.isFile() && f.canRead() && f.getName().endsWith(".jar")) {
-                urls.add(f.toURI().toURL());
+        File[] libs = new File(karafHome, "lib").listFiles();
+        if (libs != null) {
+            for (File f : libs) {
+                if (f.isFile() && f.canRead() && f.getName().endsWith(".jar")) {
+                    urls.add(f.toURI().toURL());
+                }
             }
         }
 
diff --git a/main/src/test/resources/test-karaf-home/lib/foo b/main/src/test/resources/test-karaf-home/lib/foo
deleted file mode 100644
index e69de29bb2..0000000000
