diff --git a/main/src/main/java/org/apache/karaf/main/Main.java b/main/src/main/java/org/apache/karaf/main/Main.java
index b29c028e44..5df94ee5d0 100644
--- a/main/src/main/java/org/apache/karaf/main/Main.java
+++ b/main/src/main/java/org/apache/karaf/main/Main.java
@@ -345,7 +345,7 @@ public class Main {
         } catch (Exception e) {
             if (e instanceof InvocationTargetException){
                 throw new RuntimeException("Exception instantiating lock class " + config.lockClass
-                                            + "\n" + ((InvocationTargetException)e).getTargetException().getMessage());
+                                            + "\n" + ((InvocationTargetException)e).getTargetException().getMessage(), e);
             }else{
                 throw new RuntimeException("Exception instantiating lock class " + config.lockClass, e);
             }
diff --git a/main/src/main/java/org/apache/karaf/main/lock/SimpleFileLock.java b/main/src/main/java/org/apache/karaf/main/lock/SimpleFileLock.java
index 8e3c9b18d0..16dd599968 100644
--- a/main/src/main/java/org/apache/karaf/main/lock/SimpleFileLock.java
+++ b/main/src/main/java/org/apache/karaf/main/lock/SimpleFileLock.java
@@ -53,9 +53,9 @@ public class SimpleFileLock implements Lock {
             lockPath = new File(base, "lock"); 
             lockFile = new RandomAccessFile(lockPath, "rw");
         } catch (IOException ioe){
-            throw new RuntimeException("Karaf can't startup, make sure the log file can be accessed and written by the user starting Karaf : " + ioe.getMessage());
+            throw new RuntimeException("Karaf can't startup, make sure the log file can be accessed and written by the user starting Karaf : " + ioe.getMessage(), ioe);
         } catch (Exception e){
-            throw new RuntimeException("Could not create file lock", e);
+            throw new RuntimeException("Could not create file lock: " + e.getMessage(), e);
         }
     }
 
diff --git a/main/src/main/java/org/apache/karaf/main/util/BootstrapLogManager.java b/main/src/main/java/org/apache/karaf/main/util/BootstrapLogManager.java
index 370b8aa939..b80ef84cd9 100644
--- a/main/src/main/java/org/apache/karaf/main/util/BootstrapLogManager.java
+++ b/main/src/main/java/org/apache/karaf/main/util/BootstrapLogManager.java
@@ -19,6 +19,7 @@
 package org.apache.karaf.main.util;
 
 import java.io.BufferedOutputStream;
+import java.io.Closeable;
 import java.io.File;
 import java.io.FileInputStream;
 import java.io.FileOutputStream;
@@ -28,7 +29,6 @@ import java.util.logging.Handler;
 import java.util.logging.LogRecord;
 import java.util.logging.StreamHandler;
 
-
 /**
  * Convenience class for configuring java.util.logging to append to
  * the configured log4j log.  This could be used for bootstrap logging
@@ -36,52 +36,77 @@ import java.util.logging.StreamHandler;
  * 
  */
 public class BootstrapLogManager {
-    private static Handler handler;
-    private static final String KARAF_BOOTSTRAP_LOG = "karaf.bootstrap.log";
-
-    private static Properties configProps;
+	private static final String KARAF_BOOTSTRAP_LOG = "karaf.bootstrap.log";
+    private static final String LOG4J_APPENDER_FILE = "log4j.appender.out.file";
+    private static BootstrapLogManager instance;
+	private Handler handler;
+    private Properties configProps;
+    
+    public BootstrapLogManager(Properties configProps) {
+		this.configProps = configProps;
+		this.handler = null;
+	}
+
+    public static synchronized Handler getDefaultHandler() {
+    	if (instance == null) {
+        	throw new IllegalStateException("Properties must be set before calling getDefaultHandler");
+        }
+    	return instance.getDefaultHandlerInternal();
+    }
+    
+    public static void setProperties(Properties configProps) {
+        instance = new BootstrapLogManager(configProps);
+    }
 
-    public static synchronized Handler getDefaultHandler () throws Exception {
+    private Handler getDefaultHandlerInternal() {
         if (handler != null) {
             return handler;
         }
-        String filename;
-        File log;
-        Properties props = new Properties();
-        filename = configProps.getProperty(KARAF_BOOTSTRAP_LOG);
-
-        if (filename != null) {
-            log = new File(filename);
-        } else {
-            // Make a best effort to log to the default file appender configured for log4j
-            FileInputStream fis = null;
-            try {
-                fis = new FileInputStream(System.getProperty("karaf.base") + "/etc/org.ops4j.pax.logging.cfg");
-                props.load(fis);
-            } catch (IOException e) {
-                props.setProperty("log4j.appender.out.file", "${karaf.data}/log/karaf.log");
-            } finally {
-                if (fis != null) { 
-                    try {
-                        fis.close(); 
-                    } catch (IOException ioe) {
-                        ioe.printStackTrace();
-                    }
-                }
-            }
-            filename = SubstHelper.substVars(props.getProperty("log4j.appender.out.file"), "log4j.appender.out.file", null, null);
-            log = new File(filename);
+        
+        String filename = getLogFilePath();
+        filename = SubstHelper.substVars(filename, LOG4J_APPENDER_FILE, null, null);
+        File logFile = new File(filename);
+        try {
+			return new SimpleFileHandler(logFile);
+		} catch (IOException e) {
+			throw new RuntimeException(e.getMessage(), e);
+		}
+	}
+
+	private static Properties loadPaxLoggingConfig() {
+    	Properties props = new Properties();
+        FileInputStream fis = null;
+        try {
+            fis = new FileInputStream(System.getProperty("karaf.base") + "/etc/org.ops4j.pax.logging.cfg");
+            props.load(fis);
+        } catch (Exception e) {
+        	// Ignore
+		} finally {
+        	close(fis);
         }
-
-        return new BootstrapLogManager.SimpleFileHandler(log);
-
+        return props;
     }
 
-    public static void setProperties(Properties configProps) {
-        BootstrapLogManager.configProps = configProps;
+	private static void close(Closeable closeable) {
+		try {
+			if (closeable != null) {
+				closeable.close();
+			}
+		} catch (IOException e) {
+		    // Ignore
+		}
+	}
+    
+    String getLogFilePath() {
+    	String filename = configProps == null ? null : configProps.getProperty(KARAF_BOOTSTRAP_LOG);
+    	if (filename != null) {
+    		return filename;
+    	}
+    	Properties props = loadPaxLoggingConfig();
+  		// Make a best effort to log to the default file appender configured for log4j
+  		return props.getProperty(LOG4J_APPENDER_FILE, "${karaf.data}/log/karaf.log");
     }
 
-
     /**
      * Implementation of java.util.logging.Handler that does simple appending
      * to a named file.  Should be able to use this for bootstrap logging
diff --git a/main/src/test/java/org/apache/karaf/main/util/BootstrapLogManagerTest.java b/main/src/test/java/org/apache/karaf/main/util/BootstrapLogManagerTest.java
new file mode 100644
index 0000000000..d22c0030e1
--- /dev/null
+++ b/main/src/test/java/org/apache/karaf/main/util/BootstrapLogManagerTest.java
@@ -0,0 +1,67 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.karaf.main.util;
+
+import java.io.File;
+import java.util.Properties;
+import java.util.logging.Handler;
+
+import junit.framework.Assert;
+
+import org.junit.Test;
+
+public class BootstrapLogManagerTest {
+
+	@Test
+	public void testGetLogManagerNoProperties() {
+		System.setProperty("karaf.data", "target");
+		BootstrapLogManager.setProperties(null);
+		try {
+			BootstrapLogManager.getDefaultHandler();
+		} catch (IllegalStateException e) {
+			Assert.assertEquals("Properties must be set before calling getDefaultHandler", e.getMessage());
+		}
+	}
+	
+	@Test
+	public void testGetLogManager() {
+		new File("target/log/karaf.log").delete();
+		System.setProperty("karaf.data", "target");
+		Properties configProps = new Properties();
+		BootstrapLogManager.setProperties(configProps);
+		Handler handler = BootstrapLogManager.getDefaultHandler();
+		Assert.assertNotNull(handler);
+		assertExists("target/log/karaf.log");
+	}
+	
+	@Test
+	public void testGetLogManagerFromPaxLoggingConfig() {
+		new File("target/test.log").delete();
+		System.setProperty("karaf.base", "src/test/resources/test-karaf-home");
+		Properties configProps = new Properties();
+		BootstrapLogManager.setProperties(configProps);
+		Handler handler = BootstrapLogManager.getDefaultHandler();
+		Assert.assertNotNull(handler);
+		assertExists("target/test.log");
+	}
+	
+	private void assertExists(String path) {
+		Assert.assertTrue("File should exist at " + path, new File(path).exists());
+	}
+}
diff --git a/main/src/test/resources/test-karaf-home/etc/org.ops4j.pax.logging.cfg b/main/src/test/resources/test-karaf-home/etc/org.ops4j.pax.logging.cfg
new file mode 100644
index 0000000000..169fafd407
--- /dev/null
+++ b/main/src/test/resources/test-karaf-home/etc/org.ops4j.pax.logging.cfg
@@ -0,0 +1 @@
+log4j.appender.out.file=target/test.log
