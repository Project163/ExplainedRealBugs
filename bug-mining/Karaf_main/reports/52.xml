<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:13:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KARAF-2523] Karaf JDBC lock doesn&apos;t work with M$ SQLServer</title>
                <link>https://issues.apache.org/jira/browse/KARAF-2523</link>
                <project id="12311140" key="KARAF">Karaf</project>
                    <description>&lt;p&gt;Using the M$ SQLServer (with jtds) as lock backend (and the Karaf default JDBC lock implementation) with this configuration:&lt;/p&gt;

&lt;p&gt;#setup in system.properties&lt;/p&gt;

&lt;p&gt;karaf.lock=true&lt;br/&gt;
karaf.lock.class=org.apache.karaf.main.DefaultJDBCLock&lt;br/&gt;
karaf.lock.level=50&lt;br/&gt;
karaf.lock.delay=10&lt;br/&gt;
karaf.lock.jdbc.url=jdbc:jtds:sqlserver://xxx;databaseName=evillarr&lt;br/&gt;
karaf.lock.jdbc.driver=net.sourceforge.jtds.jdbc.Driver&lt;br/&gt;
karaf.lock.jdbc.user=xxx&lt;br/&gt;
karaf.lock.jdbc.password=xxx&lt;br/&gt;
karaf.lock.jdbc.table=KARAF_LOCK&lt;br/&gt;
karaf.lock.jdbc.clustername=karaf&lt;br/&gt;
karaf.lock.jdbc.timeout=30&lt;/p&gt;

&lt;p&gt;Karaf doesn&apos;t start because it can&apos;t acquire the lock:&lt;/p&gt;

&lt;p&gt;2013-10-21 09:47:42 | WARN | Thread-28 | - - | Failed to acquire database lock: java.sql.SQLException: Line 1: FOR UPDATE clause allowed only for DECLARE CURSOR.&lt;/p&gt;

&lt;p&gt;As SQLServer doesn&apos;t support the &quot;select ... for update&quot; statement, we have to provide a MSSQLServerLock implementation using a different SQL query.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12674722">KARAF-2523</key>
            <summary>Karaf JDBC lock doesn&apos;t work with M$ SQLServer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="jbonofre">Jean-Baptiste Onofr&#233;</reporter>
                        <labels>
                    </labels>
                <created>Sun, 20 Oct 2013 23:22:26 +0000</created>
                <updated>Fri, 14 Sep 2018 08:37:13 +0000</updated>
                            <resolved>Sat, 2 Nov 2013 17:35:04 +0000</resolved>
                                    <version>2.3.0</version>
                                    <fixVersion>2.4.0</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                    <fixVersion>2.3.4</fixVersion>
                                    <component>karaf</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13800300" author="olamy" created="Mon, 21 Oct 2013 01:43:24 +0000"  >&lt;p&gt;Got it working creating the class (NOTE: as methods are package private the class need to be in the package org.apache.karaf.main)&lt;br/&gt;
Class:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MSSqlJdbcLock
    &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; DefaultJDBCLock
{
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; MSSqlJdbcLock( Properties props )
    {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;( props );
    }
 
    Statements createStatements()
    {
        Statements statements = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MSSqlStatements();
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; statements;
    }
 
 
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MSSqlStatements
        &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Statements
    {
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getLockCreateStatement()
        {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM &quot;&lt;/span&gt; + getFullLockTableName();
        }
    }
 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13800358" author="olamy" created="Mon, 21 Oct 2013 04:59:04 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbonofre&quot; class=&quot;user-hover&quot; rel=&quot;jbonofre&quot;&gt;jbonofre&lt;/a&gt; I tested that on prod env. So looks good.&lt;br/&gt;
Feel free to apply (That will be part of the beers you owe me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;</comment>
                            <comment id="13805426" author="jbonofre" created="Fri, 25 Oct 2013 16:25:07 +0000"  >&lt;p&gt;Thanks Olivier, I review and apply.&lt;/p&gt;</comment>
                            <comment id="13812061" author="jbonofre" created="Sat, 2 Nov 2013 16:40:13 +0000"  >&lt;p&gt;Fixed on trunk: &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1538218&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1538218&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13812079" author="jbonofre" created="Sat, 2 Nov 2013 17:25:25 +0000"  >&lt;p&gt;Fixed on karaf-2.x: &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1538235&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1538235&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13812081" author="jbonofre" created="Sat, 2 Nov 2013 17:34:36 +0000"  >&lt;p&gt;Fixed on karaf-2.3.x: &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1538238&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1538238&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14313878" author="tmielke" created="Tue, 10 Feb 2015 09:22:15 +0000"  >&lt;p&gt;To benefit from this fix one needs to change &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;karaf.lock.class=org.apache.karaf.main.DefaultJDBCLock
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;karaf.lock.class=org.apache.karaf.main.SQLServerJDBCLock
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14313894" author="jbonofre" created="Tue, 10 Feb 2015 09:32:50 +0000"  >&lt;p&gt;Yes, I updated the documentation for 3.0.x and 2.x branches, but not for 2.3.x (my bad).&lt;/p&gt;

&lt;p&gt;I&apos;m updating the documentation on karaf-2.3.x. Sorry about that.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>354344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1p387:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>354634</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>