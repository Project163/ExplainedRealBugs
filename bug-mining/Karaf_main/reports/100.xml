<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:13:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KARAF-5055] Service wrapper shutdown timeout is not taken into account when Karaf&apos;s JVM is &apos;Stopped&apos;</title>
                <link>https://issues.apache.org/jira/browse/KARAF-5055</link>
                <project id="12311140" key="KARAF">Karaf</project>
                    <description>&lt;p&gt;To reproduce, install the attached blueprint and start Karaf using the Service Wrapper. Then:
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;bin/karaf-service stop and then immediately&lt;/li&gt;
	&lt;li&gt;kill -STOP $karaf_jvm_pid&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You&apos;ll notice that the Karaf JVM will be killed using SIGTERM regardless of the shutdown timeouts set in both the Service wrapper settings file (karaf-wrapper.conf) and karaf. This doesn&apos;t allow for graceful shutdown.&lt;/p&gt;

&lt;p&gt;I can provide a PR.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13058207">KARAF-5055</key>
            <summary>Service wrapper shutdown timeout is not taken into account when Karaf&apos;s JVM is &apos;Stopped&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="jpoth">John Poth</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Mar 2017 12:41:48 +0000</created>
                <updated>Sat, 15 Sep 2018 05:24:03 +0000</updated>
                            <resolved>Thu, 23 Mar 2017 14:20:58 +0000</resolved>
                                                    <fixVersion>4.0.9</fixVersion>
                    <fixVersion>4.1.1</fixVersion>
                                    <component>karaf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15936237" author="githubbot" created="Wed, 22 Mar 2017 12:48:22 +0000"  >&lt;p&gt;GitHub user johnpoth opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/karaf/pull/290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/karaf/pull/290&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; title=&quot;Service wrapper shutdown timeout is not taken into account when Karaf&amp;#39;s JVM is &amp;#39;Stopped&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-5055&quot;&gt;&lt;del&gt;KARAF-5055&lt;/del&gt;&lt;/a&gt;: use karaf shutdown timeout when notifying the service wra&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;pper&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KARAF-5055&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Instead of notifying the service wrapper every 5 seconds that we are awaiting shutdown for 5*2 seconds or so, I propose to notify once the service wrapper that we are shutting down using the Karaf shutdown timeout.&lt;/p&gt;

&lt;p&gt;    I&apos;ve tested both when the timeout is reached(ungraceful shutdown) and when it&apos;s not (graceful shutdown). Both cases yield expected behavior.&lt;/p&gt;

&lt;p&gt;    Thanks!&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/johnpoth/karaf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/johnpoth/karaf&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; title=&quot;Service wrapper shutdown timeout is not taken into account when Karaf&amp;#39;s JVM is &amp;#39;Stopped&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-5055&quot;&gt;&lt;del&gt;KARAF-5055&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/karaf/pull/290.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/karaf/pull/290.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #290&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 79f78a8a3c6621f7e31aea8476a1b441404e4073&lt;br/&gt;
Author: jpoth &amp;lt;poth.john@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-03-22T12:43:08Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; title=&quot;Service wrapper shutdown timeout is not taken into account when Karaf&amp;#39;s JVM is &amp;#39;Stopped&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-5055&quot;&gt;&lt;del&gt;KARAF-5055&lt;/del&gt;&lt;/a&gt;: use karaf shutdown timeout when notifying the service wrapper&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15938394" author="jira-bot" created="Thu, 23 Mar 2017 14:18:31 +0000"  >&lt;p&gt;Commit e5f4f5c4852b3b825bdfe411665c37721ba921fb in karaf&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpoth&quot; class=&quot;user-hover&quot; rel=&quot;jpoth&quot;&gt;jpoth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=karaf.git;h=e5f4f5c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=karaf.git;h=e5f4f5c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; title=&quot;Service wrapper shutdown timeout is not taken into account when Karaf&amp;#39;s JVM is &amp;#39;Stopped&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-5055&quot;&gt;&lt;del&gt;KARAF-5055&lt;/del&gt;&lt;/a&gt; Use karaf shutdown timeout when notifying the service wrapper in Main&lt;/p&gt;</comment>
                            <comment id="15938395" author="jira-bot" created="Thu, 23 Mar 2017 14:18:34 +0000"  >&lt;p&gt;Commit 64d2ef60adb718655dee10d9e0bdc1d0a2e94a5c in karaf&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbonofre&quot; class=&quot;user-hover&quot; rel=&quot;jbonofre&quot;&gt;jbonofre&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=karaf.git;h=64d2ef6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=karaf.git;h=64d2ef6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; title=&quot;Service wrapper shutdown timeout is not taken into account when Karaf&amp;#39;s JVM is &amp;#39;Stopped&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-5055&quot;&gt;&lt;del&gt;KARAF-5055&lt;/del&gt;&lt;/a&gt; This closes #290&lt;/p&gt;</comment>
                            <comment id="15938396" author="githubbot" created="Thu, 23 Mar 2017 14:18:44 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/karaf/pull/290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/karaf/pull/290&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15938403" author="jira-bot" created="Thu, 23 Mar 2017 14:20:02 +0000"  >&lt;p&gt;Commit 3293f91b63f6abf30d2867972b3e5f075c24f3fe in karaf&apos;s branch refs/heads/karaf-4.0.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpoth&quot; class=&quot;user-hover&quot; rel=&quot;jpoth&quot;&gt;jpoth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=karaf.git;h=3293f91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=karaf.git;h=3293f91&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KARAF-5055&quot; title=&quot;Service wrapper shutdown timeout is not taken into account when Karaf&amp;#39;s JVM is &amp;#39;Stopped&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KARAF-5055&quot;&gt;&lt;del&gt;KARAF-5055&lt;/del&gt;&lt;/a&gt; Use karaf shutdown timeout when notifying the service wrapper in Main&lt;/p&gt;</comment>
                            <comment id="15938406" author="jpoth" created="Thu, 23 Mar 2017 14:21:18 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbonofre&quot; class=&quot;user-hover&quot; rel=&quot;jbonofre&quot;&gt;jbonofre&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12859925" name="wrapper-shutdown.xml" size="976" author="jpoth" created="Wed, 22 Mar 2017 12:49:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cmrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>