diff --git a/client/src/main/java/org/apache/oozie/client/AuthOozieClient.java b/client/src/main/java/org/apache/oozie/client/AuthOozieClient.java
index 3a8b5ab62..1371a919b 100644
--- a/client/src/main/java/org/apache/oozie/client/AuthOozieClient.java
+++ b/client/src/main/java/org/apache/oozie/client/AuthOozieClient.java
@@ -29,12 +29,17 @@ import java.io.Writer;
 import java.lang.management.ManagementFactory;
 import java.net.HttpURLConnection;
 import java.net.URL;
+import java.nio.charset.StandardCharsets;
 import java.nio.file.Files;
 import java.nio.file.StandardCopyOption;
 import java.util.HashMap;
 import java.util.Map;
 
+import com.google.common.annotations.VisibleForTesting;
 import com.google.common.base.Charsets;
+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;
+import org.apache.commons.codec.binary.Base64;
+import org.apache.commons.io.FilenameUtils;
 import org.apache.hadoop.security.authentication.client.AuthenticatedURL;
 import org.apache.hadoop.security.authentication.client.AuthenticationException;
 import org.apache.hadoop.security.authentication.client.Authenticator;
@@ -57,12 +62,7 @@ public class AuthOozieClient extends XOozieClient {
      */
     public static final String USE_AUTH_TOKEN_CACHE_SYS_PROP = "oozie.auth.token.cache";
 
-    /**
-     * File constant that defines the location of the authentication token cache file.
-     * <p>
-     * It resolves to <code>${user.home}/.oozie-auth-token</code>.
-     */
-    public static final File AUTH_TOKEN_CACHE_FILE = new File(System.getProperty("user.home"), ".oozie-auth-token");
+    public static final int AUTH_TOKEN_CACHE_FILENAME_MAXLENGTH = 255;
 
     public enum AuthType {
         KERBEROS, SIMPLE
@@ -70,6 +70,13 @@ public class AuthOozieClient extends XOozieClient {
 
     private String authOption = null;
 
+    /**
+     * authTokenCacheFile defines the location of the authentication token cache file.
+     * <p>
+     * It resolves to <code>${user.home}/.oozie-auth-token-Base64(${oozieUrl})</code>.
+     */
+    private final File authTokenCacheFile;
+
     /**
      * Create an instance of the AuthOozieClient.
      *
@@ -85,9 +92,26 @@ public class AuthOozieClient extends XOozieClient {
      * @param oozieUrl the Oozie URL
      * @param authOption the auth option
      */
+    @SuppressFBWarnings(value = "PATH_TRAVERSAL_IN", justification = "FilenameUtils is used to filter user input. JDK8+ is used.")
     public AuthOozieClient(String oozieUrl, String authOption) {
         super(oozieUrl);
         this.authOption = authOption;
+        String filename = getAuthCacheFileName(oozieUrl);
+        // just to filter user input
+        authTokenCacheFile = new File(System.getProperty("user.home"), FilenameUtils.getName(filename));
+        if (filename.length() >= AUTH_TOKEN_CACHE_FILENAME_MAXLENGTH && authTokenCacheFile.exists()) {
+            System.out.println("Warn: the same Oozie auth cache filename exists, filename=" + filename);
+        }
+    }
+
+    @VisibleForTesting
+    public String getAuthCacheFileName(String oozieUrl) {
+        String encodeBase64OozieUrl = Base64.encodeBase64URLSafeString(oozieUrl.getBytes(StandardCharsets.UTF_8));
+        String filename = ".oozie-auth-token-" + encodeBase64OozieUrl;
+        if (filename.length() >= AUTH_TOKEN_CACHE_FILENAME_MAXLENGTH) {
+            filename = filename.substring(0, AUTH_TOKEN_CACHE_FILENAME_MAXLENGTH);
+        }
+        return filename;
     }
 
     /**
@@ -129,7 +153,7 @@ public class AuthOozieClient extends XOozieClient {
             long expires = getExpirationTime(currentToken);
             if (expires < System.currentTimeMillis() + 300000) {
                 if (useAuthFile) {
-                    AUTH_TOKEN_CACHE_FILE.delete();
+                    authTokenCacheFile.delete();
                 }
                 currentToken = new AuthenticatedURL.Token();
             }
@@ -143,7 +167,7 @@ public class AuthOozieClient extends XOozieClient {
             if (conn.getResponseCode() == HttpURLConnection.HTTP_UNAUTHORIZED
                     || conn.getResponseCode() == HttpURLConnection.HTTP_FORBIDDEN) {
                 if (useAuthFile) {
-                    AUTH_TOKEN_CACHE_FILE.delete();
+                    authTokenCacheFile.delete();
                 }
                 currentToken = new AuthenticatedURL.Token();
             } else {
@@ -159,7 +183,7 @@ public class AuthOozieClient extends XOozieClient {
                     AuthenticatedURL.extractToken(conn, currentToken);
                 } catch (AuthenticationException ex) {
                     if (useAuthFile) {
-                        AUTH_TOKEN_CACHE_FILE.delete();
+                        authTokenCacheFile.delete();
                     }
                     currentToken = new AuthenticatedURL.Token();
                 }
@@ -174,7 +198,7 @@ public class AuthOozieClient extends XOozieClient {
             }
             catch (AuthenticationException ex) {
                 if (useAuthFile) {
-                    AUTH_TOKEN_CACHE_FILE.delete();
+                    authTokenCacheFile.delete();
                 }
                 throw new OozieClientException(OozieClientException.AUTHENTICATION,
                                                "Could not authenticate, " + ex.getMessage(), ex);
@@ -182,7 +206,11 @@ public class AuthOozieClient extends XOozieClient {
         }
 
         // If we got a new token, save it to the cache file
-        if (useAuthFile && currentToken.isSet() && !currentToken.equals(readToken)) {
+        // For comparison of currentToken and readToken, please see the details of OOZIE-3396
+        // Here, because of Hadoop AuthenticatedURL.Token don't override the equals() method,
+        // we have to compare the token.toString()
+        if (useAuthFile && currentToken.isSet() &&
+                (readToken == null || !currentToken.toString().equals(readToken.toString()))) {
             writeAuthToken(currentToken);
         }
 
@@ -216,9 +244,9 @@ public class AuthOozieClient extends XOozieClient {
      */
     protected AuthenticatedURL.Token readAuthToken() {
         AuthenticatedURL.Token authToken = null;
-        if (AUTH_TOKEN_CACHE_FILE.exists()) {
+        if (authTokenCacheFile.exists()) {
             try {
-                BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(AUTH_TOKEN_CACHE_FILE),
+                BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(authTokenCacheFile),
                         Charsets.UTF_8));
                 String line = reader.readLine();
                 reader.close();
@@ -252,17 +280,17 @@ public class AuthOozieClient extends XOozieClient {
             Writer writer = new OutputStreamWriter(new FileOutputStream(tmpTokenFile), Charsets.UTF_8);
             writer.write(authToken.toString());
             writer.close();
-            Files.move(tmpTokenFile.toPath(), AUTH_TOKEN_CACHE_FILE.toPath(), StandardCopyOption.ATOMIC_MOVE);
+            Files.move(tmpTokenFile.toPath(), authTokenCacheFile.toPath(), StandardCopyOption.ATOMIC_MOVE);
             // sets read-write permissions to owner only
-            AUTH_TOKEN_CACHE_FILE.setReadable(false, false);
-            AUTH_TOKEN_CACHE_FILE.setReadable(true, true);
-            AUTH_TOKEN_CACHE_FILE.setWritable(true, true);
+            authTokenCacheFile.setReadable(false, false);
+            authTokenCacheFile.setReadable(true, true);
+            authTokenCacheFile.setWritable(true, true);
         }
         catch (IOException ioe) {
             // if case of any error we just delete the cache, if user-only
             // write permissions are not properly set a security exception
             // is thrown and the file will be deleted.
-            AUTH_TOKEN_CACHE_FILE.delete();
+            authTokenCacheFile.delete();
 
         }
     }
