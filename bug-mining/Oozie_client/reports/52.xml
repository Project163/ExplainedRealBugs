<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:47:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OOZIE-1368] Error message when using an incorrect oozie url with kerberos is misleading</title>
                <link>https://issues.apache.org/jira/browse/OOZIE-1368</link>
                <project id="12311620" key="OOZIE">Oozie (Retired)</project>
                    <description>&lt;p&gt;If you specify an incorrect oozie url (e.g. its quite common for users to type &lt;a href=&quot;http://localhost:11000&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:11000&lt;/a&gt; instead of &lt;a href=&quot;http://localhost:11000/oozie&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:11000/oozie&lt;/a&gt;) on a secure cluster (kerberos) and oozie hasn&apos;t already cached the delegation token (in ~/.oozie-auth-token), the oozie client gives a nasty NPE error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ rm ~/.oozie-auth-token
$ kinit ...
$ oozie admin -status -oozie http://localhost:11000
java.lang.NullPointerException
	at java.io.Writer.write(Writer.java:140)
	at org.apache.oozie.client.AuthOozieClient.writeAuthToken(AuthOozieClient.java:182)
	at org.apache.oozie.client.AuthOozieClient.createConnection(AuthOozieClient.java:137)
	at org.apache.oozie.client.OozieClient.validateWSVersion(OozieClient.java:243)
	at org.apache.oozie.client.OozieClient.createURL(OozieClient.java:344)
	at org.apache.oozie.client.OozieClient.access$000(OozieClient.java:76)
	at org.apache.oozie.client.OozieClient$ClientCallable.call(OozieClient.java:410)
	at org.apache.oozie.client.OozieClient.getSystemMode(OozieClient.java:1299)
	at org.apache.oozie.cli.OozieCLI.adminCommand(OozieCLI.java:1323)
	at org.apache.oozie.cli.OozieCLI.processCommand(OozieCLI.java:499)
	at org.apache.oozie.cli.OozieCLI.run(OozieCLI.java:466)
	at org.apache.oozie.cli.OozieCLI.main(OozieCLI.java:176)
null
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once Oozie writes the auth token (because you used the correct url), if you then give an incorrect url, it will return a more appropriate 404 error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ sudo -u oozie oozie admin -status -oozie http://localhost:11000/oozie
$ ls ~/.oozie-auth-token 
/home/rkanter/.oozie-auth-token
$ sudo -u oozie oozie admin -status -oozie http://localhost:11000
Error: HTTP error code: 404 : Not Found
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="12646939">OOZIE-1368</key>
            <summary>Error message when using an incorrect oozie url with kerberos is misleading</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rkanter">Robert Kanter</assignee>
                                    <reporter username="rkanter">Robert Kanter</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 May 2013 02:06:03 +0000</created>
                <updated>Thu, 31 Oct 2013 21:11:19 +0000</updated>
                            <resolved>Fri, 10 May 2013 20:15:54 +0000</resolved>
                                    <version>trunk</version>
                                    <fixVersion>4.0.0</fixVersion>
                                    <component>client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13653499" author="rkanter" created="Fri, 10 May 2013 03:00:14 +0000"  >&lt;p&gt;The fix is pretty simple:&lt;br/&gt;
&lt;tt&gt;AuthOozieClient.createConnection(...)&lt;/tt&gt; should check to make sure that the &lt;tt&gt;currentToken&lt;/tt&gt; is set before trying to write it, or it will try to write a null token string, which gives the NPE.  &lt;/p&gt;

&lt;p&gt;I tried to make a unit test for this, but it seems that the way we&apos;re running the servlets in the unit tests makes it behave differently in this scenario it will give a authentication error even without the fix.  From what I can tell, when run from the tests the following line (line #128) in &lt;tt&gt;AuthOozieClient&lt;/tt&gt; throws an &lt;tt&gt;AuthenticationException&lt;/tt&gt;, which makes Oozie print an authentication error.  When run in tomcat, its not throwing an exception, so Oozie then tries to write the null auth token and gets the NPE (which the patch fixes).  In any case, I tested it manually and it works correctly now:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AuthenticatedURL(authenticator).openConnection(url, currentToken);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13653521" author="hadoopqa" created="Fri, 10 May 2013 04:09:25 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/OOZIE-1368&quot; title=&quot;Error message when using an incorrect oozie url with kerberos is misleading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OOZIE-1368&quot;&gt;&lt;del&gt;OOZIE-1368&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Cleaning local svn workspace&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 132&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch does not add/modify any testcase&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 BACKWARDS_COMPATIBILITY&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not change any JPA Entity/Colum/Basic/Lob/Transient annotations&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not modify JPA files&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 1149&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/oozie-trunk-precommit-build/505/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/oozie-trunk-precommit-build/505/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13654674" author="tucu00" created="Fri, 10 May 2013 18:09:15 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13654791" author="rkanter" created="Fri, 10 May 2013 20:15:54 +0000"  >&lt;p&gt;Committed to trunk!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12676957">HADOOP-10078</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12610174">OOZIE-1010</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12582566" name="OOZIE-1368.patch" size="785" author="rkanter" created="Fri, 10 May 2013 03:00:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327296</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kgzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327640</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>