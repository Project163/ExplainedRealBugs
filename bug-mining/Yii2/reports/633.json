{"url":"https://api.github.com/repos/yiisoft/yii2/issues/17673","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/17673/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/17673/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/17673/events","html_url":"https://github.com/yiisoft/yii2/issues/17673","id":524355681,"node_id":"MDU6SXNzdWU1MjQzNTU2ODE=","number":17673,"title":"Javascript registered in renderDynamic doesn't appear anywhere when PageCache is used","user":{"login":"nagyt234","id":1257088,"node_id":"MDQ6VXNlcjEyNTcwODg=","avatar_url":"https://avatars.githubusercontent.com/u/1257088?v=4","gravatar_id":"","url":"https://api.github.com/users/nagyt234","html_url":"https://github.com/nagyt234","followers_url":"https://api.github.com/users/nagyt234/followers","following_url":"https://api.github.com/users/nagyt234/following{/other_user}","gists_url":"https://api.github.com/users/nagyt234/gists{/gist_id}","starred_url":"https://api.github.com/users/nagyt234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nagyt234/subscriptions","organizations_url":"https://api.github.com/users/nagyt234/orgs","repos_url":"https://api.github.com/users/nagyt234/repos","events_url":"https://api.github.com/users/nagyt234/events{/privacy}","received_events_url":"https://api.github.com/users/nagyt234/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208443,"node_id":"MDU6TGFiZWwzMzIwODQ0Mw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:bug","name":"type:bug","color":"e102d8","default":false,"description":"Bug"},{"id":33208865,"node_id":"MDU6TGFiZWwzMzIwODg2NQ==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:docs","name":"type:docs","color":"207de5","default":false,"description":"Documentation"},{"id":316272259,"node_id":"MDU6TGFiZWwzMTYyNzIyNTk=","url":"https://api.github.com/repos/yiisoft/yii2/labels/status:wontfix","name":"status:wontfix","color":"C0BABA","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-11-18T13:05:41Z","updated_at":"2019-11-19T14:17:12Z","closed_at":"2019-11-19T14:17:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"JS or CSS registered with registerJS, registerJSFile etc will not work in renderDynamic. This problem causes, that it is not possible to use any widgets in `renderDynamic` on a cached page which has JavaScript or CSS assets. This issue is basically #16051 re-opened with simple step-step reproducing.\r\n\r\n### What steps will reproduce the problem?\r\n\r\n1. Create a YII2 system with the Basic Template and go there:\r\n```\r\ncomposer create-project --prefer-dist yiisoft/yii2-app-basic basic\r\ncd basic\r\n```\r\n2. Add the following line as line 2 in `views/site/index.php`:\r\n```\r\n$this->renderDynamic('$this->registerJs(\"alert(\\'JS started\\')\");');\r\n```\r\n3. Start the simple WEB server\r\n```\r\nphp yii serve --port=8888\r\n```\r\n4. Go in browser to http://localhost:8888 Te alert box will appear, and you can find the following lines also in the page source:\r\n```\r\n<script src=\"<script>jQuery(function ($) {\r\nalert('JS started')\r\n});</script>\r\n```\r\n5. Now add PageCache to the Index action. Add the following code in the function `behaviors` in  `controllers/SiteController.php`:\r\n```\r\n'indexCache' => [ \r\n    'class' => 'yii\\filters\\PageCache',\r\n    'only' => ['index'],\r\n    'duration' => 86400,    // 1 day\r\n    'enabled' => true,\r\n],\r\n```\r\n6. Check again the Home page. The JS code and the alert IS NOT INCLUDED anymore.\r\n\r\n\r\n### What is the expected result?\r\nThe registered JavaScript  should appear in the HTML page.\r\n### What do you get instead?\r\nAll Javascript registered in renderDynamic is missing.\r\n\r\n### Additional info\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.29\r\n| PHP version      |  PHP 7.2.24-1+ubuntu16.04.1+deb.sury.org+1\r\n| Operating system | Ubuntu 16.04\r\n","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/17673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/17673/timeline","performed_via_github_app":null,"state_reason":"completed"}