{"url":"https://api.github.com/repos/yiisoft/yii2/issues/17934","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/17934/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/17934/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/17934/events","html_url":"https://github.com/yiisoft/yii2/issues/17934","id":587852725,"node_id":"MDU6SXNzdWU1ODc4NTI3MjU=","number":17934,"title":"Getting ORA-01460 when binding several string parameters","user":{"login":"fen1xpv","id":20625775,"node_id":"MDQ6VXNlcjIwNjI1Nzc1","avatar_url":"https://avatars.githubusercontent.com/u/20625775?v=4","gravatar_id":"","url":"https://api.github.com/users/fen1xpv","html_url":"https://github.com/fen1xpv","followers_url":"https://api.github.com/users/fen1xpv/followers","following_url":"https://api.github.com/users/fen1xpv/following{/other_user}","gists_url":"https://api.github.com/users/fen1xpv/gists{/gist_id}","starred_url":"https://api.github.com/users/fen1xpv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fen1xpv/subscriptions","organizations_url":"https://api.github.com/users/fen1xpv/orgs","repos_url":"https://api.github.com/users/fen1xpv/repos","events_url":"https://api.github.com/users/fen1xpv/events{/privacy}","received_events_url":"https://api.github.com/users/fen1xpv/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208443,"node_id":"MDU6TGFiZWwzMzIwODQ0Mw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:bug","name":"type:bug","color":"e102d8","default":false,"description":"Bug"},{"id":247756521,"node_id":"MDU6TGFiZWwyNDc3NTY1MjE=","url":"https://api.github.com/repos/yiisoft/yii2/labels/Oracle","name":"Oracle","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/51","html_url":"https://github.com/yiisoft/yii2/milestone/51","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/51/labels","id":5232038,"node_id":"MDk6TWlsZXN0b25lNTIzMjAzOA==","number":51,"title":"2.0.34","description":"","creator":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":9,"state":"closed","created_at":"2020-03-24T10:38:24Z","updated_at":"2020-03-26T20:50:01Z","due_on":null,"closed_at":"2020-03-26T20:50:01Z"},"comments":3,"created_at":"2020-03-25T17:08:49Z","updated_at":"2020-03-26T10:51:13Z","closed_at":"2020-03-26T10:51:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\n### What steps will reproduce the problem?\r\n```\r\n$sql =\r\n<<<SQL\r\n    select 1\r\n    from dual\r\n    where    '1' = :param_1\r\n        and '22' = :param_2\r\nSQL;\r\n\r\n$cmd = Yii::$app->db->createCommand($sql);\r\n$cmd->bindValue(':param_1', '1');\r\n$cmd->bindValue(':param_2', '22');\r\n$result = $cmd->queryAll();\r\n```\r\n### What is the expected result?\r\n`[{\"1\":\"1\"}]`\r\n### What do you get instead?\r\n```\r\nSQLSTATE[HY000]: General error: 1460 OCIStmtExecute: ORA-01460: затребовано нереализованное или неразумное преобразование\r\n(/tmp/php-7.0.18/ext/pdo_oci/oci_statement.c:159)\r\nThe SQL being executed was: select 1\r\nfrom dual\r\nwhere '1' = '1'\r\nand '22' = '22'\r\n```\r\n### Stacktrace\r\n```\r\nPDOException: SQLSTATE[HY000]: General error: 1460 OCIStmtExecute: ORA-01460: затребовано нереализованное или неразумное преобразование\r\n (/tmp/php-7.0.18/ext/pdo_oci/oci_statement.c:159) in /var/www/html/vendor/yiisoft/yii2/db/Command.php:1293\r\nStack trace:\r\n#0 /var/www/html/vendor/yiisoft/yii2/db/Command.php(1293): PDOStatement->execute()\r\n#1 /var/www/html/vendor/yiisoft/yii2/db/Command.php(1159): yii\\db\\Command->internalExecute('    select 1\\r\\n ...')\r\n#2 /var/www/html/vendor/yiisoft/yii2/db/Command.php(401): yii\\db\\Command->queryInternal('fetchAll', NULL)\r\n#3 /var/www/html/models/Test2.php(23): yii\\db\\Command->queryAll()\r\n#4 /var/www/html/controllers/TestController.php(17): app\\models\\Test2->getData()\r\n#5 [internal function]: app\\controllers\\TestController->actionIndex()\r\n#6 /var/www/html/vendor/yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)\r\n#7 /var/www/html/vendor/yiisoft/yii2/base/Controller.php(157): yii\\base\\InlineAction->runWithParams(Array)\r\n#8 /var/www/html/vendor/yiisoft/yii2/base/Module.php(528): yii\\base\\Controller->runAction('', Array)\r\n#9 /var/www/html/vendor/yiisoft/yii2/web/Application.php(103): yii\\base\\Module->runAction('test/', Array)\r\n#10 /var/www/html/vendor/yiisoft/yii2/base/Application.php(386): yii\\web\\Application->handleRequest(Object(yii\\web\\Request))\r\n#11 /var/www/html/web/index.php(12): yii\\base\\Application->run()\r\n#12 {main}\r\n\r\nNext yii\\db\\Exception: SQLSTATE[HY000]: General error: 1460 OCIStmtExecute: ORA-01460: затребовано нереализованное или неразумное преобразование\r\n (/tmp/php-7.0.18/ext/pdo_oci/oci_statement.c:159)\r\nThe SQL being executed was:     select 1\r\n    from dual\r\n    where '1' = '1'\r\n        and '22' = '22' in /var/www/html/vendor/yiisoft/yii2/db/Schema.php:674\r\nStack trace:\r\n#0 /var/www/html/vendor/yiisoft/yii2/db/Command.php(1298): yii\\db\\Schema->convertException(Object(PDOException), '    select 1\\r\\n ...')\r\n#1 /var/www/html/vendor/yiisoft/yii2/db/Command.php(1159): yii\\db\\Command->internalExecute('    select 1\\r\\n ...')\r\n#2 /var/www/html/vendor/yiisoft/yii2/db/Command.php(401): yii\\db\\Command->queryInternal('fetchAll', NULL)\r\n#3 /var/www/html/models/Test2.php(23): yii\\db\\Command->queryAll()\r\n#4 /var/www/html/controllers/TestController.php(17): app\\models\\Test2->getData()\r\n#5 [internal function]: app\\controllers\\TestController->actionIndex()\r\n#6 /var/www/html/vendor/yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)\r\n#7 /var/www/html/vendor/yiisoft/yii2/base/Controller.php(157): yii\\base\\InlineAction->runWithParams(Array)\r\n#8 /var/www/html/vendor/yiisoft/yii2/base/Module.php(528): yii\\base\\Controller->runAction('', Array)\r\n#9 /var/www/html/vendor/yiisoft/yii2/web/Application.php(103): yii\\base\\Module->runAction('test/', Array)\r\n#10 /var/www/html/vendor/yiisoft/yii2/base/Application.php(386): yii\\web\\Application->handleRequest(Object(yii\\web\\Request))\r\n#11 /var/www/html/web/index.php(12): yii\\base\\Application->run()\r\n#12 {main}\r\nAdditional Information:\r\nArray\r\n(\r\n    [0] => HY000\r\n    [1] => 1460\r\n    [2] => OCIStmtExecute: ORA-01460: затребовано нереализованное или неразумное преобразование\r\n (/tmp/php-7.0.18/ext/pdo_oci/oci_statement.c:159)\r\n)\r\n```\r\n### Comments\r\nThis bug(?) occurs only on yii2 2.0.33, it works fine with 2.0.32.\r\nI've got same behaviour on machine with php5.6 + Debian 7\r\nIf I bind parameters as Integers instead of Strings - problem goes away.\r\nAs far as I understand this issue may be related to changes in #17854\r\n\r\n### Additional info\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.33\r\n| PHP version      |  7.0.33\r\n| Operating system |  Debian GNU/Linux 9\r\n| Oracle version | 12c Enterprise Edition Release 12.1.0.1.0 - 64bit Production\r\n| Oracle Instant Client Version | 12.1.0.2.0\r\n","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/17934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/17934/timeline","performed_via_github_app":null,"state_reason":"completed"}