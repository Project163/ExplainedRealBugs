{"url":"https://api.github.com/repos/yiisoft/yii2/issues/20042","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/20042/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/20042/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/20042/events","html_url":"https://github.com/yiisoft/yii2/issues/20042","id":1960844549,"node_id":"I_kwDOADRbGc504B0F","number":20042,"title":"ActiveQueryTrait::findWith() throws yii\\\\di\\\\NotInstantiableException when $models is empty array","user":{"login":"Renkas","id":5357180,"node_id":"MDQ6VXNlcjUzNTcxODA=","avatar_url":"https://avatars.githubusercontent.com/u/5357180?v=4","gravatar_id":"","url":"https://api.github.com/users/Renkas","html_url":"https://github.com/Renkas","followers_url":"https://api.github.com/users/Renkas/followers","following_url":"https://api.github.com/users/Renkas/following{/other_user}","gists_url":"https://api.github.com/users/Renkas/gists{/gist_id}","starred_url":"https://api.github.com/users/Renkas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Renkas/subscriptions","organizations_url":"https://api.github.com/users/Renkas/orgs","repos_url":"https://api.github.com/users/Renkas/repos","events_url":"https://api.github.com/users/Renkas/events{/privacy}","received_events_url":"https://api.github.com/users/Renkas/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33332028,"node_id":"MDU6TGFiZWwzMzMzMjAyOA==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:enhancement","name":"type:enhancement","color":"d7e102","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/75","html_url":"https://github.com/yiisoft/yii2/milestone/75","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/75/labels","id":10007738,"node_id":"MI_kwDOADRbGc4AmLS6","number":75,"title":"2.0.50","description":"","creator":{"login":"bizley","id":8577314,"node_id":"MDQ6VXNlcjg1NzczMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8577314?v=4","gravatar_id":"","url":"https://api.github.com/users/bizley","html_url":"https://github.com/bizley","followers_url":"https://api.github.com/users/bizley/followers","following_url":"https://api.github.com/users/bizley/following{/other_user}","gists_url":"https://api.github.com/users/bizley/gists{/gist_id}","starred_url":"https://api.github.com/users/bizley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bizley/subscriptions","organizations_url":"https://api.github.com/users/bizley/orgs","repos_url":"https://api.github.com/users/bizley/repos","events_url":"https://api.github.com/users/bizley/events{/privacy}","received_events_url":"https://api.github.com/users/bizley/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":67,"state":"closed","created_at":"2023-10-05T15:49:03Z","updated_at":"2024-05-30T17:24:04Z","due_on":null,"closed_at":"2024-05-30T17:24:04Z"},"comments":0,"created_at":"2023-10-25T08:30:17Z","updated_at":"2023-10-25T16:53:48Z","closed_at":"2023-10-25T16:53:48Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### What steps will reproduce the problem?\r\nI have this kind of code:\r\n```\r\n$entityMeta = $entity->meta;\r\nEntityMetaBase::find()->findWith(['meta'], $entityMeta);\r\nreturn $entityMeta;\r\n```\r\n\r\nMost of the time the array we pass there is populated. But there are some parts of our code that can have empty array as a perfectly valid value.\r\nAlso type checking does not give any warning about this so developers don't know they would need to do their own array length checks.\r\n\r\nWorkaround is simple enough. But I feel this should be handled in findWith method as currently it's an easy check to miss. Currenlty documentation gives no hints about the need to provide a non empty array\r\n```\r\n$entityMeta = $entity->meta;\r\nif (count($entityMeta)) {\r\n  EntityMetaBase::find()->findWith(['meta'], $entityMeta);\r\n}\r\nreturn $entityMeta;\r\n```\r\n\r\n### What is the expected result?\r\nNot throw an exception as there are legitimate usecases where passed array can be empty. findWith should just do an early return when it encounters an empty array.\r\n\r\n### What do you get instead?\r\n`'yii\\\\di\\\\NotInstantiableException: Can not instantiate common\\\\models\\\\EntityMetaBase. in /.../vendor/yiisoft/yii2/di/Container.php:408`\r\n\r\n### Additional info\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.49\r\n| PHP version      | 8.2.11\r\n| Operating system | Debian\r\n","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/20042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/20042/timeline","performed_via_github_app":null,"state_reason":"completed"}