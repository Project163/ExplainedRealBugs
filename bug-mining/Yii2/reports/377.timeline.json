[{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/342520464","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-342520464","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":342520464,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MjUyMDQ2NA==","user":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-07T15:35:06Z","updated_at":"2017-11-07T15:35:06Z","body":"Em. `yii\\db\\Schema::refreshTableSchema` will be used in `yii\\console\\controllers\\MigrateController::truncateDatabase()` and should take care of it.\r\n\r\nThe current implementation should work fine because it discards a complete table metadata if `$refresh` is true.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/342520464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1330637891,"node_id":"MDEyOkxhYmVsZWRFdmVudDEzMzA2Mzc4OTE=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1330637891","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-11-07T21:27:45Z","label":{"name":"feature:db","color":"bfd4f2"},"performed_via_github_app":null},{"id":1330637892,"node_id":"MDEyOkxhYmVsZWRFdmVudDEzMzA2Mzc4OTI=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1330637892","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-11-07T21:27:45Z","label":{"name":"status:to be verified","color":"fbca04"},"performed_via_github_app":null},{"id":1330637978,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDEzMzA2Mzc5Nzg=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1330637978","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2017-11-07T21:27:47Z","milestone":{"title":"2.0.13.1"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/342627991","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-342627991","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":342627991,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MjYyNzk5MQ==","user":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-07T21:28:00Z","updated_at":"2017-11-07T21:28:00Z","body":"What's the database used? MySQL?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/342627991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/342733999","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-342733999","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":342733999,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MjczMzk5OQ==","user":{"login":"etienneq","id":3263670,"node_id":"MDQ6VXNlcjMyNjM2NzA=","avatar_url":"https://avatars.githubusercontent.com/u/3263670?v=4","gravatar_id":"","url":"https://api.github.com/users/etienneq","html_url":"https://github.com/etienneq","followers_url":"https://api.github.com/users/etienneq/followers","following_url":"https://api.github.com/users/etienneq/following{/other_user}","gists_url":"https://api.github.com/users/etienneq/gists{/gist_id}","starred_url":"https://api.github.com/users/etienneq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/etienneq/subscriptions","organizations_url":"https://api.github.com/users/etienneq/orgs","repos_url":"https://api.github.com/users/etienneq/repos","events_url":"https://api.github.com/users/etienneq/events{/privacy}","received_events_url":"https://api.github.com/users/etienneq/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-08T07:31:56Z","updated_at":"2017-11-08T07:31:56Z","body":"Yes, MySQL.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/342733999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"etienneq","id":3263670,"node_id":"MDQ6VXNlcjMyNjM2NzA=","avatar_url":"https://avatars.githubusercontent.com/u/3263670?v=4","gravatar_id":"","url":"https://api.github.com/users/etienneq","html_url":"https://github.com/etienneq","followers_url":"https://api.github.com/users/etienneq/followers","following_url":"https://api.github.com/users/etienneq/following{/other_user}","gists_url":"https://api.github.com/users/etienneq/gists{/gist_id}","starred_url":"https://api.github.com/users/etienneq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/etienneq/subscriptions","organizations_url":"https://api.github.com/users/etienneq/orgs","repos_url":"https://api.github.com/users/etienneq/repos","events_url":"https://api.github.com/users/etienneq/events{/privacy}","received_events_url":"https://api.github.com/users/etienneq/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1331322911,"node_id":"MDEyOkxhYmVsZWRFdmVudDEzMzEzMjI5MTE=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1331322911","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-11-08T08:15:29Z","label":{"name":"type:bug","color":"e102d8"},"performed_via_github_app":null},{"id":1333951749,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTMzMzk1MTc0OQ==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1333951749","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2017-11-09T13:31:50Z","performed_via_github_app":null},{"id":1333951750,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEzMzM5NTE3NTA=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1333951750","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2017-11-09T13:31:50Z","performed_via_github_app":null},{"id":1333997865,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTMzMzk5Nzg2NQ==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1333997865","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2017-11-09T13:56:44Z","performed_via_github_app":null},{"id":1333997867,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEzMzM5OTc4Njc=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1333997867","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2017-11-09T13:56:44Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/343161754","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-343161754","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":343161754,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MzE2MTc1NA==","user":{"login":"antichris","id":881420,"node_id":"MDQ6VXNlcjg4MTQyMA==","avatar_url":"https://avatars.githubusercontent.com/u/881420?v=4","gravatar_id":"","url":"https://api.github.com/users/antichris","html_url":"https://github.com/antichris","followers_url":"https://api.github.com/users/antichris/followers","following_url":"https://api.github.com/users/antichris/following{/other_user}","gists_url":"https://api.github.com/users/antichris/gists{/gist_id}","starred_url":"https://api.github.com/users/antichris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antichris/subscriptions","organizations_url":"https://api.github.com/users/antichris/orgs","repos_url":"https://api.github.com/users/antichris/repos","events_url":"https://api.github.com/users/antichris/events{/privacy}","received_events_url":"https://api.github.com/users/antichris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-09T13:57:37Z","updated_at":"2017-11-09T13:57:37Z","body":"> The current implementation should work fine because it discards a complete table metadata if $refresh is true.\r\n> @sergeymakinen \r\n\r\nNo, it does not work \"fine\".\r\n\r\n```php\r\nuse yii\\console\\controllers\\MigrateController,\r\n    yii\\db\\Connection,\r\n    yii\\db\\Schema,\r\n    yii\\db\\TableSchema;\r\n```\r\n\r\n`MigrateController::truncateDatabase()` gets table names from `Schema::getTableSchemas()`, where the `TableSchema::$name` for the migrations table is plain **`migration`** (or `{prefix}migration` if current `Connection::$tablePrefix` is `{prefix}`). The metadata for **this** table name is discarded.\r\n\r\nBut `MigrateController::getMigrationHistory()`, which is called when migrating up, gets the metadata for `MigrateController::$migrationTable`, defined as **`{{%migration}}`** by default. If the metadata for **this** table name is cached, `Schema::getTableMetadata()` will return that regardless of the value of `$refresh` (and the actual schema state). That's what this issue is all about.\r\n\r\nI suppose a solution would involve tuning table prefix resolution for schema caching and/or migrations.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/343161754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"antichris","id":881420,"node_id":"MDQ6VXNlcjg4MTQyMA==","avatar_url":"https://avatars.githubusercontent.com/u/881420?v=4","gravatar_id":"","url":"https://api.github.com/users/antichris","html_url":"https://github.com/antichris","followers_url":"https://api.github.com/users/antichris/followers","following_url":"https://api.github.com/users/antichris/following{/other_user}","gists_url":"https://api.github.com/users/antichris/gists{/gist_id}","starred_url":"https://api.github.com/users/antichris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antichris/subscriptions","organizations_url":"https://api.github.com/users/antichris/orgs","repos_url":"https://api.github.com/users/antichris/repos","events_url":"https://api.github.com/users/antichris/events{/privacy}","received_events_url":"https://api.github.com/users/antichris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1333999483,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTMzMzk5OTQ4Mw==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1333999483","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2017-11-09T13:57:37Z","performed_via_github_app":null},{"id":1333999485,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEzMzM5OTk0ODU=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1333999485","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2017-11-09T13:57:37Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/343184229","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-343184229","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":343184229,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MzE4NDIyOQ==","user":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-09T15:11:51Z","updated_at":"2017-11-09T15:11:51Z","body":"@U-D13 thanks for details. It's definitely not okay.\r\nBut caching/purging logic is still the same from the old `Schema`, so it this issue probably existed for some time before.\r\nAnyway I will dig into this.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/343184229/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1334151550,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTMzNDE1MTU1MA==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1334151550","actor":{"login":"antichris","id":881420,"node_id":"MDQ6VXNlcjg4MTQyMA==","avatar_url":"https://avatars.githubusercontent.com/u/881420?v=4","gravatar_id":"","url":"https://api.github.com/users/antichris","html_url":"https://github.com/antichris","followers_url":"https://api.github.com/users/antichris/followers","following_url":"https://api.github.com/users/antichris/following{/other_user}","gists_url":"https://api.github.com/users/antichris/gists{/gist_id}","starred_url":"https://api.github.com/users/antichris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antichris/subscriptions","organizations_url":"https://api.github.com/users/antichris/orgs","repos_url":"https://api.github.com/users/antichris/repos","events_url":"https://api.github.com/users/antichris/events{/privacy}","received_events_url":"https://api.github.com/users/antichris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2017-11-09T15:11:51Z","performed_via_github_app":null},{"id":1334151551,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEzMzQxNTE1NTE=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1334151551","actor":{"login":"antichris","id":881420,"node_id":"MDQ6VXNlcjg4MTQyMA==","avatar_url":"https://avatars.githubusercontent.com/u/881420?v=4","gravatar_id":"","url":"https://api.github.com/users/antichris","html_url":"https://github.com/antichris","followers_url":"https://api.github.com/users/antichris/followers","following_url":"https://api.github.com/users/antichris/following{/other_user}","gists_url":"https://api.github.com/users/antichris/gists{/gist_id}","starred_url":"https://api.github.com/users/antichris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antichris/subscriptions","organizations_url":"https://api.github.com/users/antichris/orgs","repos_url":"https://api.github.com/users/antichris/repos","events_url":"https://api.github.com/users/antichris/events{/privacy}","received_events_url":"https://api.github.com/users/antichris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2017-11-09T15:11:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/343611456","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-343611456","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":343611456,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MzYxMTQ1Ng==","user":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-10T23:12:59Z","updated_at":"2017-11-10T23:12:59Z","body":"I confirm this.\r\nAn issue resides in `yii\\db\\Schema::getCacheKey` it was there for a long time:\r\na cache key doesn't resolve table names to raw names, so `{{%table}}` and `table` entries are stored/deleted as is.\r\nI will add tests and fix it tonight.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/343611456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1336952955,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MTMzNjk1Mjk1NQ==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1336952955","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2017-11-10T23:13:29Z","label":{"name":"status:to be verified","color":"fbca04"},"performed_via_github_app":null},{"id":1336953008,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQxMzM2OTUzMDA4","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1336953008","actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2017-11-10T23:13:33Z","assignee":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"actor":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-11T01:17:21Z","updated_at":"2017-11-11T01:17:21Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/15143","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/15143/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/15143/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/15143/events","html_url":"https://github.com/yiisoft/yii2/pull/15143","id":273102968,"node_id":"MDExOlB1bGxSZXF1ZXN0MTUyMDMzNjQw","number":15143,"title":"Fixed DB schema cache did not honor table prefixes (fixes #15117)","user":{"login":"sergeymakinen","id":983964,"node_id":"MDQ6VXNlcjk4Mzk2NA==","avatar_url":"https://avatars.githubusercontent.com/u/983964?v=4","gravatar_id":"","url":"https://api.github.com/users/sergeymakinen","html_url":"https://github.com/sergeymakinen","followers_url":"https://api.github.com/users/sergeymakinen/followers","following_url":"https://api.github.com/users/sergeymakinen/following{/other_user}","gists_url":"https://api.github.com/users/sergeymakinen/gists{/gist_id}","starred_url":"https://api.github.com/users/sergeymakinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergeymakinen/subscriptions","organizations_url":"https://api.github.com/users/sergeymakinen/orgs","repos_url":"https://api.github.com/users/sergeymakinen/repos","events_url":"https://api.github.com/users/sergeymakinen/events{/privacy}","received_events_url":"https://api.github.com/users/sergeymakinen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208443,"node_id":"MDU6TGFiZWwzMzIwODQ0Mw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:bug","name":"type:bug","color":"e102d8","default":false,"description":"Bug"},{"id":115010082,"node_id":"MDU6TGFiZWwxMTUwMTAwODI=","url":"https://api.github.com/repos/yiisoft/yii2/labels/feature:db","name":"feature:db","color":"bfd4f2","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/27","html_url":"https://github.com/yiisoft/yii2/milestone/27","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/27/labels","id":2885542,"node_id":"MDk6TWlsZXN0b25lMjg4NTU0Mg==","number":27,"title":"2.0.13.1","description":null,"creator":{"login":"rob006","id":5972388,"node_id":"MDQ6VXNlcjU5NzIzODg=","avatar_url":"https://avatars.githubusercontent.com/u/5972388?v=4","gravatar_id":"","url":"https://api.github.com/users/rob006","html_url":"https://github.com/rob006","followers_url":"https://api.github.com/users/rob006/followers","following_url":"https://api.github.com/users/rob006/following{/other_user}","gists_url":"https://api.github.com/users/rob006/gists{/gist_id}","starred_url":"https://api.github.com/users/rob006/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rob006/subscriptions","organizations_url":"https://api.github.com/users/rob006/orgs","repos_url":"https://api.github.com/users/rob006/repos","events_url":"https://api.github.com/users/rob006/events{/privacy}","received_events_url":"https://api.github.com/users/rob006/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":15,"state":"closed","created_at":"2017-11-03T10:09:30Z","updated_at":"2018-04-06T13:49:37Z","due_on":null,"closed_at":"2017-11-14T12:14:03Z"},"comments":1,"created_at":"2017-11-11T01:17:21Z","updated_at":"2025-05-29T11:00:23Z","closed_at":"2017-11-11T20:42:41Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":3431193,"node_id":"MDEwOlJlcG9zaXRvcnkzNDMxMTkz","name":"yii2","full_name":"yiisoft/yii2","private":false,"owner":{"login":"yiisoft","id":993323,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MzMyMw==","avatar_url":"https://avatars.githubusercontent.com/u/993323?v=4","gravatar_id":"","url":"https://api.github.com/users/yiisoft","html_url":"https://github.com/yiisoft","followers_url":"https://api.github.com/users/yiisoft/followers","following_url":"https://api.github.com/users/yiisoft/following{/other_user}","gists_url":"https://api.github.com/users/yiisoft/gists{/gist_id}","starred_url":"https://api.github.com/users/yiisoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiisoft/subscriptions","organizations_url":"https://api.github.com/users/yiisoft/orgs","repos_url":"https://api.github.com/users/yiisoft/repos","events_url":"https://api.github.com/users/yiisoft/events{/privacy}","received_events_url":"https://api.github.com/users/yiisoft/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yiisoft/yii2","description":"Yii 2: The Fast, Secure and Professional PHP Framework","fork":false,"url":"https://api.github.com/repos/yiisoft/yii2","forks_url":"https://api.github.com/repos/yiisoft/yii2/forks","keys_url":"https://api.github.com/repos/yiisoft/yii2/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yiisoft/yii2/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yiisoft/yii2/teams","hooks_url":"https://api.github.com/repos/yiisoft/yii2/hooks","issue_events_url":"https://api.github.com/repos/yiisoft/yii2/issues/events{/number}","events_url":"https://api.github.com/repos/yiisoft/yii2/events","assignees_url":"https://api.github.com/repos/yiisoft/yii2/assignees{/user}","branches_url":"https://api.github.com/repos/yiisoft/yii2/branches{/branch}","tags_url":"https://api.github.com/repos/yiisoft/yii2/tags","blobs_url":"https://api.github.com/repos/yiisoft/yii2/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yiisoft/yii2/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yiisoft/yii2/git/refs{/sha}","trees_url":"https://api.github.com/repos/yiisoft/yii2/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yiisoft/yii2/statuses/{sha}","languages_url":"https://api.github.com/repos/yiisoft/yii2/languages","stargazers_url":"https://api.github.com/repos/yiisoft/yii2/stargazers","contributors_url":"https://api.github.com/repos/yiisoft/yii2/contributors","subscribers_url":"https://api.github.com/repos/yiisoft/yii2/subscribers","subscription_url":"https://api.github.com/repos/yiisoft/yii2/subscription","commits_url":"https://api.github.com/repos/yiisoft/yii2/commits{/sha}","git_commits_url":"https://api.github.com/repos/yiisoft/yii2/git/commits{/sha}","comments_url":"https://api.github.com/repos/yiisoft/yii2/comments{/number}","issue_comment_url":"https://api.github.com/repos/yiisoft/yii2/issues/comments{/number}","contents_url":"https://api.github.com/repos/yiisoft/yii2/contents/{+path}","compare_url":"https://api.github.com/repos/yiisoft/yii2/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yiisoft/yii2/merges","archive_url":"https://api.github.com/repos/yiisoft/yii2/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yiisoft/yii2/downloads","issues_url":"https://api.github.com/repos/yiisoft/yii2/issues{/number}","pulls_url":"https://api.github.com/repos/yiisoft/yii2/pulls{/number}","milestones_url":"https://api.github.com/repos/yiisoft/yii2/milestones{/number}","notifications_url":"https://api.github.com/repos/yiisoft/yii2/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yiisoft/yii2/labels{/name}","releases_url":"https://api.github.com/repos/yiisoft/yii2/releases{/id}","deployments_url":"https://api.github.com/repos/yiisoft/yii2/deployments","created_at":"2012-02-13T15:32:36Z","updated_at":"2025-11-10T03:14:21Z","pushed_at":"2025-11-04T07:28:12Z","git_url":"git://github.com/yiisoft/yii2.git","ssh_url":"git@github.com:yiisoft/yii2.git","clone_url":"https://github.com/yiisoft/yii2.git","svn_url":"https://github.com/yiisoft/yii2","homepage":"http://www.yiiframework.com","size":87767,"stargazers_count":14294,"watchers_count":14294,"language":"PHP","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6863,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":516,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","hacktoberfest","php","php-framework","yii","yii2"],"visibility":"public","forks":6863,"open_issues":516,"watchers":14294,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/yiisoft/yii2/pulls/15143","html_url":"https://github.com/yiisoft/yii2/pull/15143","diff_url":"https://github.com/yiisoft/yii2/pull/15143.diff","patch_url":"https://github.com/yiisoft/yii2/pull/15143.patch","merged_at":"2017-11-11T20:42:41Z"},"body":"| Q             | A\r\n| ------------- | ---\r\n| Is bugfix?    | yes\r\n| New feature?  | no\r\n| Breaks BC?    | no\r\n| Tests pass?   | yes\r\n| Fixed issues  | #15117 \r\n\r\n> `MigrateController::truncateDatabase()` gets table names from `Schema::getTableSchemas()`, where the `TableSchema::$name` for the migrations table is plain **`migration`** (or `{prefix}migration` if current `Connection::$tablePrefix` is `{prefix}`). The metadata for **this** table name is discarded.\r\n> \r\n > But `MigrateController::getMigrationHistory()`, which is called when migrating up, gets the metadata for `MigrateController::$migrationTable`, defined as **`{{%migration}}`** by default. If the metadata for **this** table name is cached, `Schema::getTableMetadata()` will return that regardless of the value of `$refresh` (and the actual schema state). That's what this issue is all about.\r\n> \r\n> I suppose a solution would involve tuning table prefix resolution for schema caching and/or migrations.\r\n> \r\n> @U-D13\r\n","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/15143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/15143/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":1337358173,"node_id":"MDExOkNsb3NlZEV2ZW50MTMzNzM1ODE3Mw==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1337358173","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2017-11-11T20:43:03Z","state_reason":null,"performed_via_github_app":null},{"id":1337358211,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDEzMzczNTgyMTE=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1337358211","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"85b65c889a31b94ca2b8bce63df93ba27d683d9d","commit_url":"https://api.github.com/repos/yiisoft/yii2/commits/85b65c889a31b94ca2b8bce63df93ba27d683d9d","created_at":"2017-11-11T20:43:14Z","performed_via_github_app":null},{"actor":{"login":"pchapl","id":11299467,"node_id":"MDQ6VXNlcjExMjk5NDY3","avatar_url":"https://avatars.githubusercontent.com/u/11299467?v=4","gravatar_id":"","url":"https://api.github.com/users/pchapl","html_url":"https://github.com/pchapl","followers_url":"https://api.github.com/users/pchapl/followers","following_url":"https://api.github.com/users/pchapl/following{/other_user}","gists_url":"https://api.github.com/users/pchapl/gists{/gist_id}","starred_url":"https://api.github.com/users/pchapl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pchapl/subscriptions","organizations_url":"https://api.github.com/users/pchapl/orgs","repos_url":"https://api.github.com/users/pchapl/repos","events_url":"https://api.github.com/users/pchapl/events{/privacy}","received_events_url":"https://api.github.com/users/pchapl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-29T03:32:49Z","updated_at":"2017-12-29T03:32:49Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/15428","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/15428/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/15428/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/15428/events","html_url":"https://github.com/yiisoft/yii2/issues/15428","id":285028151,"node_id":"MDU6SXNzdWUyODUwMjgxNTE=","number":15428,"title":"Error with 2.0.13.1 and 2.0.12 versions working together","user":{"login":"pchapl","id":11299467,"node_id":"MDQ6VXNlcjExMjk5NDY3","avatar_url":"https://avatars.githubusercontent.com/u/11299467?v=4","gravatar_id":"","url":"https://api.github.com/users/pchapl","html_url":"https://github.com/pchapl","followers_url":"https://api.github.com/users/pchapl/followers","following_url":"https://api.github.com/users/pchapl/following{/other_user}","gists_url":"https://api.github.com/users/pchapl/gists{/gist_id}","starred_url":"https://api.github.com/users/pchapl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pchapl/subscriptions","organizations_url":"https://api.github.com/users/pchapl/orgs","repos_url":"https://api.github.com/users/pchapl/repos","events_url":"https://api.github.com/users/pchapl/events{/privacy}","received_events_url":"https://api.github.com/users/pchapl/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":315614343,"node_id":"MDU6TGFiZWwzMTU2MTQzNDM=","url":"https://api.github.com/repos/yiisoft/yii2/labels/question","name":"question","color":"d4c5f9","default":true,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-12-29T03:32:22Z","updated_at":"2018-08-14T11:35:20Z","closed_at":"2017-12-29T08:38:38Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3431193,"node_id":"MDEwOlJlcG9zaXRvcnkzNDMxMTkz","name":"yii2","full_name":"yiisoft/yii2","private":false,"owner":{"login":"yiisoft","id":993323,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MzMyMw==","avatar_url":"https://avatars.githubusercontent.com/u/993323?v=4","gravatar_id":"","url":"https://api.github.com/users/yiisoft","html_url":"https://github.com/yiisoft","followers_url":"https://api.github.com/users/yiisoft/followers","following_url":"https://api.github.com/users/yiisoft/following{/other_user}","gists_url":"https://api.github.com/users/yiisoft/gists{/gist_id}","starred_url":"https://api.github.com/users/yiisoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiisoft/subscriptions","organizations_url":"https://api.github.com/users/yiisoft/orgs","repos_url":"https://api.github.com/users/yiisoft/repos","events_url":"https://api.github.com/users/yiisoft/events{/privacy}","received_events_url":"https://api.github.com/users/yiisoft/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yiisoft/yii2","description":"Yii 2: The Fast, Secure and Professional PHP Framework","fork":false,"url":"https://api.github.com/repos/yiisoft/yii2","forks_url":"https://api.github.com/repos/yiisoft/yii2/forks","keys_url":"https://api.github.com/repos/yiisoft/yii2/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yiisoft/yii2/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yiisoft/yii2/teams","hooks_url":"https://api.github.com/repos/yiisoft/yii2/hooks","issue_events_url":"https://api.github.com/repos/yiisoft/yii2/issues/events{/number}","events_url":"https://api.github.com/repos/yiisoft/yii2/events","assignees_url":"https://api.github.com/repos/yiisoft/yii2/assignees{/user}","branches_url":"https://api.github.com/repos/yiisoft/yii2/branches{/branch}","tags_url":"https://api.github.com/repos/yiisoft/yii2/tags","blobs_url":"https://api.github.com/repos/yiisoft/yii2/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yiisoft/yii2/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yiisoft/yii2/git/refs{/sha}","trees_url":"https://api.github.com/repos/yiisoft/yii2/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yiisoft/yii2/statuses/{sha}","languages_url":"https://api.github.com/repos/yiisoft/yii2/languages","stargazers_url":"https://api.github.com/repos/yiisoft/yii2/stargazers","contributors_url":"https://api.github.com/repos/yiisoft/yii2/contributors","subscribers_url":"https://api.github.com/repos/yiisoft/yii2/subscribers","subscription_url":"https://api.github.com/repos/yiisoft/yii2/subscription","commits_url":"https://api.github.com/repos/yiisoft/yii2/commits{/sha}","git_commits_url":"https://api.github.com/repos/yiisoft/yii2/git/commits{/sha}","comments_url":"https://api.github.com/repos/yiisoft/yii2/comments{/number}","issue_comment_url":"https://api.github.com/repos/yiisoft/yii2/issues/comments{/number}","contents_url":"https://api.github.com/repos/yiisoft/yii2/contents/{+path}","compare_url":"https://api.github.com/repos/yiisoft/yii2/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yiisoft/yii2/merges","archive_url":"https://api.github.com/repos/yiisoft/yii2/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yiisoft/yii2/downloads","issues_url":"https://api.github.com/repos/yiisoft/yii2/issues{/number}","pulls_url":"https://api.github.com/repos/yiisoft/yii2/pulls{/number}","milestones_url":"https://api.github.com/repos/yiisoft/yii2/milestones{/number}","notifications_url":"https://api.github.com/repos/yiisoft/yii2/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yiisoft/yii2/labels{/name}","releases_url":"https://api.github.com/repos/yiisoft/yii2/releases{/id}","deployments_url":"https://api.github.com/repos/yiisoft/yii2/deployments","created_at":"2012-02-13T15:32:36Z","updated_at":"2025-11-10T03:14:21Z","pushed_at":"2025-11-04T07:28:12Z","git_url":"git://github.com/yiisoft/yii2.git","ssh_url":"git@github.com:yiisoft/yii2.git","clone_url":"https://github.com/yiisoft/yii2.git","svn_url":"https://github.com/yiisoft/yii2","homepage":"http://www.yiiframework.com","size":87767,"stargazers_count":14294,"watchers_count":14294,"language":"PHP","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6863,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":516,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","hacktoberfest","php","php-framework","yii","yii2"],"visibility":"public","forks":6863,"open_issues":516,"watchers":14294,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I have few versions of app running on one server. When I tried to upgrade one of them to 2.0.13, I got the follow error in other versions:\r\n```\r\nyii\\base\\ErrorException: Uncaught yii\\base\\ErrorException: Trying to get property of non-object in /project-path/vendor/yiisoft/yii2/db/ActiveRecord.php:404\r\nStack trace:\r\n#0 /project-path/vendor/yiisoft/yii2/db/ActiveRecord.php(404): yii\\base\\ErrorHandler->handleError(8, 'Trying to get p...', '/project-pa...', 404, Array)\r\n#1 /project-path/vendor/yiisoft/yii2/db/ActiveQueryTrait.php(134): yii\\db\\ActiveRecord::populateRecord(Object(app\\models\\common\\Lang), Array)\r\n#2 /project-path/vendor/yiisoft/yii2/db/ActiveQuery.php(209): yii\\db\\ActiveQuery->createModels(Array)\r\n#3 /project-path/vendor/yiisoft/yii2/db/ActiveQuery.php(296): yii\\db\\ActiveQuery->populate(Array)\r\n#4 /project-path/components/query/ExtendedActiveQuery.php(38): yii\\db\\ActiveQuery->one(NULL)\r\n#5 /project-path/vendor/yiisoft/yii2/db/BaseActiveRecord.php(107): app\\components\\query\\Ext in /project-path/vendor/yiisoft/yii2/db/ActiveRecord.php:404\r\nStack trace:\r\n#0 [internal function]: yii\\base\\ErrorHandler->handleFatalError()\r\n#1 {main}\r\n```\r\nAs far as I understand, schema cache has different structure in different versions, but stored with same key.\r\n\r\nIs there some workaround, like setting custom key for schema?\r\n\r\n### What steps will reproduce the problem?\r\nRun two yii2-applications with different versions, shared cache and shared database.\r\n### What is the expected result?\r\nCache stores same structures with same keys, different structures with different keys.\r\n### What do you get instead?\r\nyii\\base\\ErrorException: Trying to get property of non-object\r\n\r\n### Additional info\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.13.1\r\n| PHP version      | 7.0.15\r\n| Operating system |  FreeBSD 10.3-RELEASE amd64\r\n","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/15428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/15428/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/379186737","html_url":"https://github.com/yiisoft/yii2/issues/15117#issuecomment-379186737","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/15117","id":379186737,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTE4NjczNw==","user":{"login":"boboldehampsink","id":378974,"node_id":"MDQ6VXNlcjM3ODk3NA==","avatar_url":"https://avatars.githubusercontent.com/u/378974?v=4","gravatar_id":"","url":"https://api.github.com/users/boboldehampsink","html_url":"https://github.com/boboldehampsink","followers_url":"https://api.github.com/users/boboldehampsink/followers","following_url":"https://api.github.com/users/boboldehampsink/following{/other_user}","gists_url":"https://api.github.com/users/boboldehampsink/gists{/gist_id}","starred_url":"https://api.github.com/users/boboldehampsink/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boboldehampsink/subscriptions","organizations_url":"https://api.github.com/users/boboldehampsink/orgs","repos_url":"https://api.github.com/users/boboldehampsink/repos","events_url":"https://api.github.com/users/boboldehampsink/events{/privacy}","received_events_url":"https://api.github.com/users/boboldehampsink/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-06T08:35:40Z","updated_at":"2018-04-06T08:35:40Z","body":"This error is still present in the latest version. Running `migrate/up` once, then dropping/recreating db and running `migrate/up` again results in error because its still cached. The solution proposed in the original post fixes it and seems logical to me.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/379186737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"boboldehampsink","id":378974,"node_id":"MDQ6VXNlcjM3ODk3NA==","avatar_url":"https://avatars.githubusercontent.com/u/378974?v=4","gravatar_id":"","url":"https://api.github.com/users/boboldehampsink","html_url":"https://github.com/boboldehampsink","followers_url":"https://api.github.com/users/boboldehampsink/followers","following_url":"https://api.github.com/users/boboldehampsink/following{/other_user}","gists_url":"https://api.github.com/users/boboldehampsink/gists{/gist_id}","starred_url":"https://api.github.com/users/boboldehampsink/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boboldehampsink/subscriptions","organizations_url":"https://api.github.com/users/boboldehampsink/orgs","repos_url":"https://api.github.com/users/boboldehampsink/repos","events_url":"https://api.github.com/users/boboldehampsink/events{/privacy}","received_events_url":"https://api.github.com/users/boboldehampsink/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"boboldehampsink","id":378974,"node_id":"MDQ6VXNlcjM3ODk3NA==","avatar_url":"https://avatars.githubusercontent.com/u/378974?v=4","gravatar_id":"","url":"https://api.github.com/users/boboldehampsink","html_url":"https://github.com/boboldehampsink","followers_url":"https://api.github.com/users/boboldehampsink/followers","following_url":"https://api.github.com/users/boboldehampsink/following{/other_user}","gists_url":"https://api.github.com/users/boboldehampsink/gists{/gist_id}","starred_url":"https://api.github.com/users/boboldehampsink/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boboldehampsink/subscriptions","organizations_url":"https://api.github.com/users/boboldehampsink/orgs","repos_url":"https://api.github.com/users/boboldehampsink/repos","events_url":"https://api.github.com/users/boboldehampsink/events{/privacy}","received_events_url":"https://api.github.com/users/boboldehampsink/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-06T09:30:00Z","updated_at":"2018-04-06T09:30:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/16052","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/16052/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/16052/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/16052/events","html_url":"https://github.com/yiisoft/yii2/pull/16052","id":311908356,"node_id":"MDExOlB1bGxSZXF1ZXN0MTc5ODk3MzA1","number":16052,"title":"Fixes #15117 `yii\\db\\Schema::getTableMetadata` cache refreshing","user":{"login":"boboldehampsink","id":378974,"node_id":"MDQ6VXNlcjM3ODk3NA==","avatar_url":"https://avatars.githubusercontent.com/u/378974?v=4","gravatar_id":"","url":"https://api.github.com/users/boboldehampsink","html_url":"https://github.com/boboldehampsink","followers_url":"https://api.github.com/users/boboldehampsink/followers","following_url":"https://api.github.com/users/boboldehampsink/following{/other_user}","gists_url":"https://api.github.com/users/boboldehampsink/gists{/gist_id}","starred_url":"https://api.github.com/users/boboldehampsink/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boboldehampsink/subscriptions","organizations_url":"https://api.github.com/users/boboldehampsink/orgs","repos_url":"https://api.github.com/users/boboldehampsink/repos","events_url":"https://api.github.com/users/boboldehampsink/events{/privacy}","received_events_url":"https://api.github.com/users/boboldehampsink/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208443,"node_id":"MDU6TGFiZWwzMzIwODQ0Mw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:bug","name":"type:bug","color":"e102d8","default":false,"description":"Bug"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/25","html_url":"https://github.com/yiisoft/yii2/milestone/25","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/25/labels","id":2562828,"node_id":"MDk6TWlsZXN0b25lMjU2MjgyOA==","number":25,"title":"2.0.16","description":"","creator":{"login":"cebe","id":189796,"node_id":"MDQ6VXNlcjE4OTc5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/189796?v=4","gravatar_id":"","url":"https://api.github.com/users/cebe","html_url":"https://github.com/cebe","followers_url":"https://api.github.com/users/cebe/followers","following_url":"https://api.github.com/users/cebe/following{/other_user}","gists_url":"https://api.github.com/users/cebe/gists{/gist_id}","starred_url":"https://api.github.com/users/cebe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cebe/subscriptions","organizations_url":"https://api.github.com/users/cebe/orgs","repos_url":"https://api.github.com/users/cebe/repos","events_url":"https://api.github.com/users/cebe/events{/privacy}","received_events_url":"https://api.github.com/users/cebe/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":291,"state":"closed","created_at":"2017-06-05T18:03:36Z","updated_at":"2019-01-30T23:57:22Z","due_on":"2019-02-01T08:00:00Z","closed_at":"2019-01-30T23:57:22Z"},"comments":4,"created_at":"2018-04-06T09:30:00Z","updated_at":"2018-06-09T13:57:50Z","closed_at":"2018-04-06T13:49:18Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":3431193,"node_id":"MDEwOlJlcG9zaXRvcnkzNDMxMTkz","name":"yii2","full_name":"yiisoft/yii2","private":false,"owner":{"login":"yiisoft","id":993323,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MzMyMw==","avatar_url":"https://avatars.githubusercontent.com/u/993323?v=4","gravatar_id":"","url":"https://api.github.com/users/yiisoft","html_url":"https://github.com/yiisoft","followers_url":"https://api.github.com/users/yiisoft/followers","following_url":"https://api.github.com/users/yiisoft/following{/other_user}","gists_url":"https://api.github.com/users/yiisoft/gists{/gist_id}","starred_url":"https://api.github.com/users/yiisoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiisoft/subscriptions","organizations_url":"https://api.github.com/users/yiisoft/orgs","repos_url":"https://api.github.com/users/yiisoft/repos","events_url":"https://api.github.com/users/yiisoft/events{/privacy}","received_events_url":"https://api.github.com/users/yiisoft/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yiisoft/yii2","description":"Yii 2: The Fast, Secure and Professional PHP Framework","fork":false,"url":"https://api.github.com/repos/yiisoft/yii2","forks_url":"https://api.github.com/repos/yiisoft/yii2/forks","keys_url":"https://api.github.com/repos/yiisoft/yii2/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yiisoft/yii2/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yiisoft/yii2/teams","hooks_url":"https://api.github.com/repos/yiisoft/yii2/hooks","issue_events_url":"https://api.github.com/repos/yiisoft/yii2/issues/events{/number}","events_url":"https://api.github.com/repos/yiisoft/yii2/events","assignees_url":"https://api.github.com/repos/yiisoft/yii2/assignees{/user}","branches_url":"https://api.github.com/repos/yiisoft/yii2/branches{/branch}","tags_url":"https://api.github.com/repos/yiisoft/yii2/tags","blobs_url":"https://api.github.com/repos/yiisoft/yii2/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yiisoft/yii2/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yiisoft/yii2/git/refs{/sha}","trees_url":"https://api.github.com/repos/yiisoft/yii2/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yiisoft/yii2/statuses/{sha}","languages_url":"https://api.github.com/repos/yiisoft/yii2/languages","stargazers_url":"https://api.github.com/repos/yiisoft/yii2/stargazers","contributors_url":"https://api.github.com/repos/yiisoft/yii2/contributors","subscribers_url":"https://api.github.com/repos/yiisoft/yii2/subscribers","subscription_url":"https://api.github.com/repos/yiisoft/yii2/subscription","commits_url":"https://api.github.com/repos/yiisoft/yii2/commits{/sha}","git_commits_url":"https://api.github.com/repos/yiisoft/yii2/git/commits{/sha}","comments_url":"https://api.github.com/repos/yiisoft/yii2/comments{/number}","issue_comment_url":"https://api.github.com/repos/yiisoft/yii2/issues/comments{/number}","contents_url":"https://api.github.com/repos/yiisoft/yii2/contents/{+path}","compare_url":"https://api.github.com/repos/yiisoft/yii2/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yiisoft/yii2/merges","archive_url":"https://api.github.com/repos/yiisoft/yii2/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yiisoft/yii2/downloads","issues_url":"https://api.github.com/repos/yiisoft/yii2/issues{/number}","pulls_url":"https://api.github.com/repos/yiisoft/yii2/pulls{/number}","milestones_url":"https://api.github.com/repos/yiisoft/yii2/milestones{/number}","notifications_url":"https://api.github.com/repos/yiisoft/yii2/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yiisoft/yii2/labels{/name}","releases_url":"https://api.github.com/repos/yiisoft/yii2/releases{/id}","deployments_url":"https://api.github.com/repos/yiisoft/yii2/deployments","created_at":"2012-02-13T15:32:36Z","updated_at":"2025-11-10T03:14:21Z","pushed_at":"2025-11-04T07:28:12Z","git_url":"git://github.com/yiisoft/yii2.git","ssh_url":"git@github.com:yiisoft/yii2.git","clone_url":"https://github.com/yiisoft/yii2.git","svn_url":"https://github.com/yiisoft/yii2","homepage":"http://www.yiiframework.com","size":87767,"stargazers_count":14294,"watchers_count":14294,"language":"PHP","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6863,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":516,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","hacktoberfest","php","php-framework","yii","yii2"],"visibility":"public","forks":6863,"open_issues":516,"watchers":14294,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/yiisoft/yii2/pulls/16052","html_url":"https://github.com/yiisoft/yii2/pull/16052","diff_url":"https://github.com/yiisoft/yii2/pull/16052.diff","patch_url":"https://github.com/yiisoft/yii2/pull/16052.patch","merged_at":"2018-04-06T13:49:18Z"},"body":"| Q             | A\r\n| ------------- | ---\r\n| Is bugfix?    | yes\r\n| New feature?  | no\r\n| Breaks BC?    | no\r\n| Tests pass?   | yes\r\n| Fixed issues  | #15117\r\n\r\nBefore, setting `$refresh` still tried to pull from the cache. With this fix it doesn't and makes sure it loads from table again.\r\n","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/16052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/16052/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":1560948766,"node_id":"MDE3OkRlbWlsZXN0b25lZEV2ZW50MTU2MDk0ODc2Ng==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1560948766","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"demilestoned","commit_id":null,"commit_url":null,"created_at":"2018-04-06T13:49:37Z","milestone":{"title":"2.0.13.1"},"performed_via_github_app":null},{"id":1560948768,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE1NjA5NDg3Njg=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1560948768","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-04-06T13:49:37Z","milestone":{"title":"2.0.16"},"performed_via_github_app":null},{"id":1560949070,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE1NjA5NDkwNzA=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1560949070","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ab092f2e2178e2d7ac91f2edc21b3d05825ae9bc","commit_url":"https://api.github.com/repos/yiisoft/yii2/commits/ab092f2e2178e2d7ac91f2edc21b3d05825ae9bc","created_at":"2018-04-06T13:49:46Z","performed_via_github_app":null},{"actor":{"login":"tehmaestro","id":9526833,"node_id":"MDQ6VXNlcjk1MjY4MzM=","avatar_url":"https://avatars.githubusercontent.com/u/9526833?v=4","gravatar_id":"","url":"https://api.github.com/users/tehmaestro","html_url":"https://github.com/tehmaestro","followers_url":"https://api.github.com/users/tehmaestro/followers","following_url":"https://api.github.com/users/tehmaestro/following{/other_user}","gists_url":"https://api.github.com/users/tehmaestro/gists{/gist_id}","starred_url":"https://api.github.com/users/tehmaestro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tehmaestro/subscriptions","organizations_url":"https://api.github.com/users/tehmaestro/orgs","repos_url":"https://api.github.com/users/tehmaestro/repos","events_url":"https://api.github.com/users/tehmaestro/events{/privacy}","received_events_url":"https://api.github.com/users/tehmaestro/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-15T12:03:09Z","updated_at":"2018-08-15T12:03:09Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/16640","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/16640/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/16640/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/16640/events","html_url":"https://github.com/yiisoft/yii2/issues/16640","id":350784627,"node_id":"MDU6SXNzdWUzNTA3ODQ2Mjc=","number":16640,"title":"Table schema cache errors when upgrading from 2.0.12 to 2.0.15","user":{"login":"tehmaestro","id":9526833,"node_id":"MDQ6VXNlcjk1MjY4MzM=","avatar_url":"https://avatars.githubusercontent.com/u/9526833?v=4","gravatar_id":"","url":"https://api.github.com/users/tehmaestro","html_url":"https://github.com/tehmaestro","followers_url":"https://api.github.com/users/tehmaestro/followers","following_url":"https://api.github.com/users/tehmaestro/following{/other_user}","gists_url":"https://api.github.com/users/tehmaestro/gists{/gist_id}","starred_url":"https://api.github.com/users/tehmaestro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tehmaestro/subscriptions","organizations_url":"https://api.github.com/users/tehmaestro/orgs","repos_url":"https://api.github.com/users/tehmaestro/repos","events_url":"https://api.github.com/users/tehmaestro/events{/privacy}","received_events_url":"https://api.github.com/users/tehmaestro/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208865,"node_id":"MDU6TGFiZWwzMzIwODg2NQ==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:docs","name":"type:docs","color":"207de5","default":false,"description":"Documentation"},{"id":33330247,"node_id":"MDU6TGFiZWwzMzMzMDI0Nw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/status:ready%20for%20adoption","name":"status:ready for adoption","color":"02e10c","default":false,"description":"Feel free to implement this issue."},{"id":115010082,"node_id":"MDU6TGFiZWwxMTUwMTAwODI=","url":"https://api.github.com/repos/yiisoft/yii2/labels/feature:db","name":"feature:db","color":"bfd4f2","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-08-15T12:03:09Z","updated_at":"2019-02-04T08:39:05Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":3431193,"node_id":"MDEwOlJlcG9zaXRvcnkzNDMxMTkz","name":"yii2","full_name":"yiisoft/yii2","private":false,"owner":{"login":"yiisoft","id":993323,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MzMyMw==","avatar_url":"https://avatars.githubusercontent.com/u/993323?v=4","gravatar_id":"","url":"https://api.github.com/users/yiisoft","html_url":"https://github.com/yiisoft","followers_url":"https://api.github.com/users/yiisoft/followers","following_url":"https://api.github.com/users/yiisoft/following{/other_user}","gists_url":"https://api.github.com/users/yiisoft/gists{/gist_id}","starred_url":"https://api.github.com/users/yiisoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yiisoft/subscriptions","organizations_url":"https://api.github.com/users/yiisoft/orgs","repos_url":"https://api.github.com/users/yiisoft/repos","events_url":"https://api.github.com/users/yiisoft/events{/privacy}","received_events_url":"https://api.github.com/users/yiisoft/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/yiisoft/yii2","description":"Yii 2: The Fast, Secure and Professional PHP Framework","fork":false,"url":"https://api.github.com/repos/yiisoft/yii2","forks_url":"https://api.github.com/repos/yiisoft/yii2/forks","keys_url":"https://api.github.com/repos/yiisoft/yii2/keys{/key_id}","collaborators_url":"https://api.github.com/repos/yiisoft/yii2/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/yiisoft/yii2/teams","hooks_url":"https://api.github.com/repos/yiisoft/yii2/hooks","issue_events_url":"https://api.github.com/repos/yiisoft/yii2/issues/events{/number}","events_url":"https://api.github.com/repos/yiisoft/yii2/events","assignees_url":"https://api.github.com/repos/yiisoft/yii2/assignees{/user}","branches_url":"https://api.github.com/repos/yiisoft/yii2/branches{/branch}","tags_url":"https://api.github.com/repos/yiisoft/yii2/tags","blobs_url":"https://api.github.com/repos/yiisoft/yii2/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/yiisoft/yii2/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/yiisoft/yii2/git/refs{/sha}","trees_url":"https://api.github.com/repos/yiisoft/yii2/git/trees{/sha}","statuses_url":"https://api.github.com/repos/yiisoft/yii2/statuses/{sha}","languages_url":"https://api.github.com/repos/yiisoft/yii2/languages","stargazers_url":"https://api.github.com/repos/yiisoft/yii2/stargazers","contributors_url":"https://api.github.com/repos/yiisoft/yii2/contributors","subscribers_url":"https://api.github.com/repos/yiisoft/yii2/subscribers","subscription_url":"https://api.github.com/repos/yiisoft/yii2/subscription","commits_url":"https://api.github.com/repos/yiisoft/yii2/commits{/sha}","git_commits_url":"https://api.github.com/repos/yiisoft/yii2/git/commits{/sha}","comments_url":"https://api.github.com/repos/yiisoft/yii2/comments{/number}","issue_comment_url":"https://api.github.com/repos/yiisoft/yii2/issues/comments{/number}","contents_url":"https://api.github.com/repos/yiisoft/yii2/contents/{+path}","compare_url":"https://api.github.com/repos/yiisoft/yii2/compare/{base}...{head}","merges_url":"https://api.github.com/repos/yiisoft/yii2/merges","archive_url":"https://api.github.com/repos/yiisoft/yii2/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/yiisoft/yii2/downloads","issues_url":"https://api.github.com/repos/yiisoft/yii2/issues{/number}","pulls_url":"https://api.github.com/repos/yiisoft/yii2/pulls{/number}","milestones_url":"https://api.github.com/repos/yiisoft/yii2/milestones{/number}","notifications_url":"https://api.github.com/repos/yiisoft/yii2/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/yiisoft/yii2/labels{/name}","releases_url":"https://api.github.com/repos/yiisoft/yii2/releases{/id}","deployments_url":"https://api.github.com/repos/yiisoft/yii2/deployments","created_at":"2012-02-13T15:32:36Z","updated_at":"2025-11-10T03:14:21Z","pushed_at":"2025-11-04T07:28:12Z","git_url":"git://github.com/yiisoft/yii2.git","ssh_url":"git@github.com:yiisoft/yii2.git","clone_url":"https://github.com/yiisoft/yii2.git","svn_url":"https://github.com/yiisoft/yii2","homepage":"http://www.yiiframework.com","size":87767,"stargazers_count":14294,"watchers_count":14294,"language":"PHP","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":6863,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":516,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","hacktoberfest","php","php-framework","yii","yii2"],"visibility":"public","forks":6863,"open_issues":516,"watchers":14294,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### What steps will reproduce the problem?\r\nHi, I'm trying to upgrade our backend from version 2.0.12 to 2.0.15.\r\n\r\nWe have 4 backend machines, running Yii2 REST APIs and when I deploy the upgrade, from 2.0.12 to 2.0.15 , the machines are upgraded one by one.\r\nAlso, I use yii2-redis for caching and MySQL as a database.\r\n\r\nWhen running the deployment, the machines still running 2.0.12 throw a `Trying to get property of a non-object`. I believe this is because the caching structure for the table schemas has changed. In 2.0.15, there is a top-level `schema` key in the JSON that is being cached. \r\n\r\nVersion 2.0.15 is overwriting the cache with the new structure.\r\n\r\n### What is the expected result?\r\nThe backend machines should work normally, no errors.\r\n\r\n### What do you get instead?\r\nI get a `Trying to get property of a non-object in ActiveRecord:404`\r\n\r\nThrown on 2.0.12 instances.\r\n```\r\nname: \"PHP Notice\",\r\nmessage: \"Trying to get property of non-object\",\r\ncode: 8,\r\ntype: \"yii\\base\\ErrorException\",\r\nfile: \"project\\vendor\\yiisoft\\yii2\\db\\ActiveRecord.php\",\r\n```\r\n\r\n### Additional info\r\nMight be related to https://github.com/yiisoft/yii2/issues/15117 . Not sure if that last fix works, I only tried 2.0.15.1\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.12\r\n| PHP version      |7.0.15 \r\n| Operating system |Linux\r\n\r\n\r\n2.0.12\r\n```\r\n[\r\n    {\r\n        \"schemaName\": null,\r\n        \"name\": \"user_profile\",\r\n        \"fullName\": \"user_profile\",\r\n        \"primaryKey\": [\r\n            \"id\"\r\n        ],\r\n```\r\n\r\n2.0.15\r\n```\r\n[\r\n    {\r\n        \"schema\": {\r\n            \"schemaName\": null,\r\n            \"name\": \"user_profile\",\r\n            \"fullName\": \"user_profile\",\r\n            \"primaryKey\": [\r\n                \"id\"\r\n            ],\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/16640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/16640/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]