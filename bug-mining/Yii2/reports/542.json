{"url":"https://api.github.com/repos/yiisoft/yii2/issues/16974","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/16974/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/16974/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/16974/events","html_url":"https://github.com/yiisoft/yii2/issues/16974","id":391826943,"node_id":"MDU6SXNzdWUzOTE4MjY5NDM=","number":16974,"title":"Regular Expression Validator to include support for 'u' (UTF-8) modifier","user":{"login":"jklusis","id":35897850,"node_id":"MDQ6VXNlcjM1ODk3ODUw","avatar_url":"https://avatars.githubusercontent.com/u/35897850?v=4","gravatar_id":"","url":"https://api.github.com/users/jklusis","html_url":"https://github.com/jklusis","followers_url":"https://api.github.com/users/jklusis/followers","following_url":"https://api.github.com/users/jklusis/following{/other_user}","gists_url":"https://api.github.com/users/jklusis/gists{/gist_id}","starred_url":"https://api.github.com/users/jklusis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jklusis/subscriptions","organizations_url":"https://api.github.com/users/jklusis/orgs","repos_url":"https://api.github.com/users/jklusis/repos","events_url":"https://api.github.com/users/jklusis/events{/privacy}","received_events_url":"https://api.github.com/users/jklusis/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208443,"node_id":"MDU6TGFiZWwzMzIwODQ0Mw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:bug","name":"type:bug","color":"e102d8","default":false,"description":"Bug"},{"id":33330247,"node_id":"MDU6TGFiZWwzMzMzMDI0Nw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/status:ready%20for%20adoption","name":"status:ready for adoption","color":"02e10c","default":false,"description":"Feel free to implement this issue."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/25","html_url":"https://github.com/yiisoft/yii2/milestone/25","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/25/labels","id":2562828,"node_id":"MDk6TWlsZXN0b25lMjU2MjgyOA==","number":25,"title":"2.0.16","description":"","creator":{"login":"cebe","id":189796,"node_id":"MDQ6VXNlcjE4OTc5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/189796?v=4","gravatar_id":"","url":"https://api.github.com/users/cebe","html_url":"https://github.com/cebe","followers_url":"https://api.github.com/users/cebe/followers","following_url":"https://api.github.com/users/cebe/following{/other_user}","gists_url":"https://api.github.com/users/cebe/gists{/gist_id}","starred_url":"https://api.github.com/users/cebe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cebe/subscriptions","organizations_url":"https://api.github.com/users/cebe/orgs","repos_url":"https://api.github.com/users/cebe/repos","events_url":"https://api.github.com/users/cebe/events{/privacy}","received_events_url":"https://api.github.com/users/cebe/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":291,"state":"closed","created_at":"2017-06-05T18:03:36Z","updated_at":"2019-01-30T23:57:22Z","due_on":"2019-02-01T08:00:00Z","closed_at":"2019-01-30T23:57:22Z"},"comments":1,"created_at":"2018-12-17T18:00:05Z","updated_at":"2019-01-03T20:12:55Z","closed_at":"2019-01-03T20:12:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### What steps will reproduce the problem?\r\nAn example - I would like to create a rule in my model, that would check whether my password field contains both numeric and alphabetic characters (also non-english characters) both in front-end and back-end.\r\nSo, I create a rule for the 'password' field, where it would be required to match the following pattern - `/^(?=.*\\p{L})(?=.*[0-9]).+$/u` (notice the `u` at the end, which is the PCRE_UTF8 modifier (see here http://php.net/manual/en/reference.pcre.pattern.modifiers.php )\r\nIt looks ahead for utf-8 letters (the `(?=.*\\p{L})` part) and for numbers `(?=.*[0-9])`, passes if has at least one of both.\r\n\r\n### What is the expected result?\r\nIn this case I expect, that both in front-end and back-end the validation would pass if password had both letters and numbers and fail if it didn't.\r\n\r\n### What do you get instead?\r\nBack-end validation is successful, upon sending a correct form data is refreshed and the error is not shown. \r\nHowever in front-end it fails by showing that the entered password is incorrect, although the password has both numbers and letters.\r\n\r\n### Additional info\r\nThe reason why this happens is that the pattern goes through RegularExpressionValidator when it is being 'compiled' and the 'getClientOptions' method is being called. \r\nIn the first line of the method the pattern is being escaped by this function - \r\n`\\yii\\helpers\\BaseHtml::escapeJsRegularExpression`, where in the last lines of the function it is checked, whether there is or is not any flag provided. \r\nThe only valid flags are i, g and m, all the other ones are being escaped, therefore if I have a regular expression like previously mentioned, it ends up losing the `u` flag at the end.\r\n\r\nMaybe it would be possible to add the `u` to the excluded list, so it could be used if necessary? Or perhaps there are reasons why it is excluded in the first place? (I understand that upon releasing 2.0.6 version with the exclusions there could have been some reasons for excluding the u tag as the ES6 was already released one month prior and some broswers still may be incompatible, but this would be a very neat thing to have for patterns)\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.13\r\n| PHP version      | 7.2\r\n| Operating system | Ubuntu 16.04\r\n","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/16974/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/16974/timeline","performed_via_github_app":null,"state_reason":"completed"}