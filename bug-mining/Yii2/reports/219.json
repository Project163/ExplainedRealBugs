{"url":"https://api.github.com/repos/yiisoft/yii2/issues/13300","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/13300/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/13300/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/13300/events","html_url":"https://github.com/yiisoft/yii2/issues/13300","id":198135900,"node_id":"MDU6SXNzdWUxOTgxMzU5MDA=","number":13300,"title":"Allow pjax with \"data-pjax\" with no value in yii.js","user":{"login":"arogachev","id":8326201,"node_id":"MDQ6VXNlcjgzMjYyMDE=","avatar_url":"https://avatars.githubusercontent.com/u/8326201?v=4","gravatar_id":"","url":"https://api.github.com/users/arogachev","html_url":"https://github.com/arogachev","followers_url":"https://api.github.com/users/arogachev/followers","following_url":"https://api.github.com/users/arogachev/following{/other_user}","gists_url":"https://api.github.com/users/arogachev/gists{/gist_id}","starred_url":"https://api.github.com/users/arogachev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arogachev/subscriptions","organizations_url":"https://api.github.com/users/arogachev/orgs","repos_url":"https://api.github.com/users/arogachev/repos","events_url":"https://api.github.com/users/arogachev/events{/privacy}","received_events_url":"https://api.github.com/users/arogachev/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":225521613,"node_id":"MDU6TGFiZWwyMjU1MjE2MTM=","url":"https://api.github.com/repos/yiisoft/yii2/labels/feature:pjax","name":"feature:pjax","color":"c7def8","default":false,"description":null},{"id":496861903,"node_id":"MDU6TGFiZWw0OTY4NjE5MDM=","url":"https://api.github.com/repos/yiisoft/yii2/labels/JS","name":"JS","color":"006b75","default":false,"description":"JavaScript related"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/20","html_url":"https://github.com/yiisoft/yii2/milestone/20","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/20/labels","id":1736699,"node_id":"MDk6TWlsZXN0b25lMTczNjY5OQ==","number":20,"title":"2.0.11","description":"","creator":{"login":"cebe","id":189796,"node_id":"MDQ6VXNlcjE4OTc5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/189796?v=4","gravatar_id":"","url":"https://api.github.com/users/cebe","html_url":"https://github.com/cebe","followers_url":"https://api.github.com/users/cebe/followers","following_url":"https://api.github.com/users/cebe/following{/other_user}","gists_url":"https://api.github.com/users/cebe/gists{/gist_id}","starred_url":"https://api.github.com/users/cebe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cebe/subscriptions","organizations_url":"https://api.github.com/users/cebe/orgs","repos_url":"https://api.github.com/users/cebe/repos","events_url":"https://api.github.com/users/cebe/events{/privacy}","received_events_url":"https://api.github.com/users/cebe/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":276,"state":"closed","created_at":"2016-04-28T15:04:50Z","updated_at":"2017-11-11T22:55:39Z","due_on":"2016-12-18T08:00:00Z","closed_at":"2017-02-01T16:52:20Z"},"comments":2,"created_at":"2016-12-30T11:23:35Z","updated_at":"2018-01-23T11:50:33Z","closed_at":"2017-01-25T08:00:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I found this issue during writing tests for `yii.js`.\r\n\r\nAfter https://github.com/yiisoft/yii2/commit/9807b2e1a1ac1c671c860ab448eab8bf9154b2bf we lose the ability to have pjax links like \r\n\r\n```html\r\n<a data-pjax href=\"#\">\r\n```\r\n\r\nor \r\n\r\n```html\r\n<a data-pjax=\"\" href=\"#\">\r\n```\r\n\r\n(which is essentially the same).\r\n\r\nThis is because of:\r\n\r\n```js\r\npjax = $e.data('pjax') || 0,\r\n```\r\n\r\n`\"\" || 0` resolves to `0`.\r\n\r\nThis condtradicts with confuring pjax described in the docs for example [here](https://github.com/yiisoft/jquery-pjax#fnpjax):\r\n\r\n> Or try this selector that matches any `<a data-pjax href=>` links inside a `<div data-pjax>` container.\r\n\r\nI think that the older behavior - `pjax !== undefined && pjax !== 0 && $.support.pjax` is more correct, also note that @arisk sent the PR including this check in #12737 (https://github.com/yiisoft/yii2/pull/12737/commits/383aa471c684e011e48862943a52a8b7c22a08b0), then it was ignored.\r\n\r\nIt will be better if we disable pjax only if `data-pjax` attribute is set to `0` only:\r\n\r\n```js\r\nusePjax = pjax !== undefined && pjax !== 0 && $.support.pjax,\r\n```\r\n\r\nNote however that this check in [Yii2 pjax adaptation](https://github.com/yiisoft/jquery-pjax):\r\n\r\n```js\r\n// Ignore links with data-pjax=\"0\"\r\nif ($(link).data('pjax') == 0) {\r\n    return;\r\n}\r\n```\r\n\r\nneeds to be modified accordingly too, because `\"\" == 0` will evaluate to `true`.\r\n\r\nCan be:\r\n\r\n```js\r\n$(link).data('pjax') === 0)\r\n```\r\n\r\n(`data` returns `0` as `number`).\r\n\r\nOr in case of a `string` which is returend by `attr` for example:\r\n\r\n```js\r\n$(link).attr('data-pjax') === '0'\r\n```\r\n\r\nOr maybe even better:\r\n\r\n```js\r\nparseInt($(link).data('pjax')) === 0\r\n```\r\n\r\n> Note: I already fixed it in `yii.js` in PR containing tests for `yii.js`. PR will be sent soon.\r\n","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/13300/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/13300/timeline","performed_via_github_app":null,"state_reason":"completed"}