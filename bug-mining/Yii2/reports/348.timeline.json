[{"id":1238493251,"node_id":"MDEyOkxhYmVsZWRFdmVudDEyMzg0OTMyNTE=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1238493251","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-09-07T10:08:08Z","label":{"name":"status:need more info","color":"d4c5f9"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/327755835","html_url":"https://github.com/yiisoft/yii2/issues/14778#issuecomment-327755835","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/14778","id":327755835,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzc1NTgzNQ==","user":{"login":"yii-bot","id":13490354,"node_id":"MDQ6VXNlcjEzNDkwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/13490354?v=4","gravatar_id":"","url":"https://api.github.com/users/yii-bot","html_url":"https://github.com/yii-bot","followers_url":"https://api.github.com/users/yii-bot/followers","following_url":"https://api.github.com/users/yii-bot/following{/other_user}","gists_url":"https://api.github.com/users/yii-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/yii-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yii-bot/subscriptions","organizations_url":"https://api.github.com/users/yii-bot/orgs","repos_url":"https://api.github.com/users/yii-bot/repos","events_url":"https://api.github.com/users/yii-bot/events{/privacy}","received_events_url":"https://api.github.com/users/yii-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T10:08:11Z","updated_at":"2017-09-07T10:08:11Z","body":"Thanks for posting in our issue tracker.\nIn order to properly assist you, we need additional information:\n\n- When does the issue occur?\n- What do you see?\n- What was the expected result?\n- Can you supply us with a stacktrace? (optional)\n- Do you have exact code to reproduce it? Maybe a PHPUnit tests that fails? (optional)\n\nThanks!\n\n_This is an automated comment, triggered by adding the label `status:need more info`._","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/327755835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yii-bot","id":13490354,"node_id":"MDQ6VXNlcjEzNDkwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/13490354?v=4","gravatar_id":"","url":"https://api.github.com/users/yii-bot","html_url":"https://github.com/yii-bot","followers_url":"https://api.github.com/users/yii-bot/followers","following_url":"https://api.github.com/users/yii-bot/following{/other_user}","gists_url":"https://api.github.com/users/yii-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/yii-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yii-bot/subscriptions","organizations_url":"https://api.github.com/users/yii-bot/orgs","repos_url":"https://api.github.com/users/yii-bot/repos","events_url":"https://api.github.com/users/yii-bot/events{/privacy}","received_events_url":"https://api.github.com/users/yii-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/328084655","html_url":"https://github.com/yiisoft/yii2/issues/14778#issuecomment-328084655","issue_url":"https://api.github.com/repos/yiisoft/yii2/issues/14778","id":328084655,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODA4NDY1NQ==","user":{"login":"des1roer","id":10970793,"node_id":"MDQ6VXNlcjEwOTcwNzkz","avatar_url":"https://avatars.githubusercontent.com/u/10970793?v=4","gravatar_id":"","url":"https://api.github.com/users/des1roer","html_url":"https://github.com/des1roer","followers_url":"https://api.github.com/users/des1roer/followers","following_url":"https://api.github.com/users/des1roer/following{/other_user}","gists_url":"https://api.github.com/users/des1roer/gists{/gist_id}","starred_url":"https://api.github.com/users/des1roer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/des1roer/subscriptions","organizations_url":"https://api.github.com/users/des1roer/orgs","repos_url":"https://api.github.com/users/des1roer/repos","events_url":"https://api.github.com/users/des1roer/events{/privacy}","received_events_url":"https://api.github.com/users/des1roer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-08T12:00:19Z","updated_at":"2017-09-08T13:03:04Z","body":"model with validator\r\n\r\n    <?php\r\n\r\n    namespace common\\models;\r\n\r\n    use yii\\helpers\\FileHelper;\r\n    use yii\\db\\ActiveQuery;\r\n    use yii\\db\\ActiveRecord;\r\n    use yii\\web\\UploadedFile;\r\n\r\n    class ClaimItemPhoto extends ActiveRecord\r\n    {\r\n        protected $file_column = 'file_path';\r\n\r\n        protected $claimItemClass = ClaimItem::class;\r\n\r\n        public static function tableName()\r\n        {\r\n            return 'claim_item_photo';\r\n        }\r\n\r\n        public function scenarios()\r\n        {\r\n            return array_merge(\r\n                parent::scenarios(),\r\n                [\r\n                    'api-create' => ['claim_item_id', 'file_path'],\r\n                    'api-update' => ['claim_item_id', 'file_path'],\r\n                ]\r\n            );\r\n        }\r\n\r\n        public function rules()\r\n        {\r\n            return [\r\n                ['file_path', 'file', 'extensions' => 'png, jpg, jpeg', 'maxSize' => 1024 * 1024 * 2],\r\n                ['file_path', 'filter', 'filter' => [$this, 'filterUploadFile']],\r\n            ];\r\n        }\r\n\r\n        public function getPath()\r\n        {\r\n            if (isset($this->claimItem)) {\r\n                $path = $this->claimItem->claim->user->getFilesPath() . '/claims/' . $this->claimItem->claim_id;\r\n                if (!file_exists($path)) {\r\n                    FileHelper::createDirectory($path);\r\n                }\r\n\r\n                return $path;\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        public function getClaimItem() : ActiveQuery\r\n        {\r\n            return $this->hasOne(ClaimItem::className(), ['id' => 'claim_item_id']);\r\n        }\r\n\r\n        /**\r\n         * Загрузка файла.\r\n         *\r\n         * @param mixed $value\r\n         * @return null|string\r\n         */\r\n        public function filterUploadFile($value)\r\n        {\r\n            $name = null;\r\n            $file = UploadedFile::getInstanceByName($this->file_column);\r\n            if (!$file) {\r\n                $this->addError($this->file_column, 'Не передан файл');\r\n            } else {\r\n                if (!$this->isNewRecord) {\r\n                    $this->deleteFile();\r\n                }\r\n\r\n                $name = uniqid() . '.' . $file->extension;\r\n                $path = $this->getPath();\r\n\r\n                if (!$path || !$file->saveAs($path . '/' . $name)) {\r\n                    $this->addError($this->file_column, 'Не удалось загрузить файл');\r\n                }\r\n            }\r\n\r\n            return $name;\r\n        }\r\n    }\r\n\r\ntest\r\n\r\n        <?php\r\n        \r\n        namespace tests\\codeception\\frontend\\api;\r\n        \r\n        class ClaimItemPhotoTest extends \\Codeception\\TestCase\\Test\r\n        {\r\n            protected $tester;\r\n        \r\n            public function testCreateDelete()\r\n            {\r\n                $fileIn = codecept_data_dir() . 'bblogo-optim.svg';\r\n                $post = [\r\n                    'claim_item_id' => (string) $claim_item_id,\r\n                ];\r\n                $I->sendPOST('api/claim-item-photo/', $post, ['file_path' => $fileIn]);\r\n                $I->seeResponseCodeIs(422);\r\n            }\r\n        }\r\n\r\n![image](https://user-images.githubusercontent.com/10970793/30210799-6f229a4e-94b7-11e7-8527-cc0320876306.png)\r\n\r\n\r\ncorrect load svg file !!!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/comments/328084655/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"des1roer","id":10970793,"node_id":"MDQ6VXNlcjEwOTcwNzkz","avatar_url":"https://avatars.githubusercontent.com/u/10970793?v=4","gravatar_id":"","url":"https://api.github.com/users/des1roer","html_url":"https://github.com/des1roer","followers_url":"https://api.github.com/users/des1roer/followers","following_url":"https://api.github.com/users/des1roer/following{/other_user}","gists_url":"https://api.github.com/users/des1roer/gists{/gist_id}","starred_url":"https://api.github.com/users/des1roer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/des1roer/subscriptions","organizations_url":"https://api.github.com/users/des1roer/orgs","repos_url":"https://api.github.com/users/des1roer/repos","events_url":"https://api.github.com/users/des1roer/events{/privacy}","received_events_url":"https://api.github.com/users/des1roer/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1241257869,"node_id":"MDEyOkxhYmVsZWRFdmVudDEyNDEyNTc4Njk=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241257869","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-09-08T18:07:37Z","label":{"name":"status:to be verified","color":"fbca04"},"performed_via_github_app":null},{"id":1241257870,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MTI0MTI1Nzg3MA==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241257870","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2017-09-08T18:07:37Z","label":{"name":"status:need more info","color":"d4c5f9"},"performed_via_github_app":null},{"id":1241257994,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDEyNDEyNTc5OTQ=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241257994","actor":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2017-09-08T18:07:40Z","milestone":{"title":"2.0.15"},"performed_via_github_app":null},{"id":1241863818,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MTI0MTg2MzgxOA==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241863818","actor":{"login":"SilverFire","id":4499203,"node_id":"MDQ6VXNlcjQ0OTkyMDM=","avatar_url":"https://avatars.githubusercontent.com/u/4499203?v=4","gravatar_id":"","url":"https://api.github.com/users/SilverFire","html_url":"https://github.com/SilverFire","followers_url":"https://api.github.com/users/SilverFire/followers","following_url":"https://api.github.com/users/SilverFire/following{/other_user}","gists_url":"https://api.github.com/users/SilverFire/gists{/gist_id}","starred_url":"https://api.github.com/users/SilverFire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SilverFire/subscriptions","organizations_url":"https://api.github.com/users/SilverFire/orgs","repos_url":"https://api.github.com/users/SilverFire/repos","events_url":"https://api.github.com/users/SilverFire/events{/privacy}","received_events_url":"https://api.github.com/users/SilverFire/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2017-09-09T13:13:22Z","label":{"name":"status:to be verified","color":"fbca04"},"performed_via_github_app":null},{"id":1241863833,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDEyNDE4NjM4MzM=","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241863833","actor":{"login":"SilverFire","id":4499203,"node_id":"MDQ6VXNlcjQ0OTkyMDM=","avatar_url":"https://avatars.githubusercontent.com/u/4499203?v=4","gravatar_id":"","url":"https://api.github.com/users/SilverFire","html_url":"https://github.com/SilverFire","followers_url":"https://api.github.com/users/SilverFire/followers","following_url":"https://api.github.com/users/SilverFire/following{/other_user}","gists_url":"https://api.github.com/users/SilverFire/gists{/gist_id}","starred_url":"https://api.github.com/users/SilverFire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SilverFire/subscriptions","organizations_url":"https://api.github.com/users/SilverFire/orgs","repos_url":"https://api.github.com/users/SilverFire/repos","events_url":"https://api.github.com/users/SilverFire/events{/privacy}","received_events_url":"https://api.github.com/users/SilverFire/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2017-09-09T13:13:23Z","milestone":{"title":"2.0.13"},"performed_via_github_app":null},{"id":1241863834,"node_id":"MDE3OkRlbWlsZXN0b25lZEV2ZW50MTI0MTg2MzgzNA==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241863834","actor":{"login":"SilverFire","id":4499203,"node_id":"MDQ6VXNlcjQ0OTkyMDM=","avatar_url":"https://avatars.githubusercontent.com/u/4499203?v=4","gravatar_id":"","url":"https://api.github.com/users/SilverFire","html_url":"https://github.com/SilverFire","followers_url":"https://api.github.com/users/SilverFire/followers","following_url":"https://api.github.com/users/SilverFire/following{/other_user}","gists_url":"https://api.github.com/users/SilverFire/gists{/gist_id}","starred_url":"https://api.github.com/users/SilverFire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SilverFire/subscriptions","organizations_url":"https://api.github.com/users/SilverFire/orgs","repos_url":"https://api.github.com/users/SilverFire/repos","events_url":"https://api.github.com/users/SilverFire/events{/privacy}","received_events_url":"https://api.github.com/users/SilverFire/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"demilestoned","commit_id":null,"commit_url":null,"created_at":"2017-09-09T13:13:23Z","milestone":{"title":"2.0.15"},"performed_via_github_app":null},{"id":1241863850,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQxMjQxODYzODUw","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241863850","actor":{"login":"SilverFire","id":4499203,"node_id":"MDQ6VXNlcjQ0OTkyMDM=","avatar_url":"https://avatars.githubusercontent.com/u/4499203?v=4","gravatar_id":"","url":"https://api.github.com/users/SilverFire","html_url":"https://github.com/SilverFire","followers_url":"https://api.github.com/users/SilverFire/followers","following_url":"https://api.github.com/users/SilverFire/following{/other_user}","gists_url":"https://api.github.com/users/SilverFire/gists{/gist_id}","starred_url":"https://api.github.com/users/SilverFire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SilverFire/subscriptions","organizations_url":"https://api.github.com/users/SilverFire/orgs","repos_url":"https://api.github.com/users/SilverFire/repos","events_url":"https://api.github.com/users/SilverFire/events{/privacy}","received_events_url":"https://api.github.com/users/SilverFire/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2017-09-09T13:13:26Z","assignee":{"login":"SilverFire","id":4499203,"node_id":"MDQ6VXNlcjQ0OTkyMDM=","avatar_url":"https://avatars.githubusercontent.com/u/4499203?v=4","gravatar_id":"","url":"https://api.github.com/users/SilverFire","html_url":"https://github.com/SilverFire","followers_url":"https://api.github.com/users/SilverFire/followers","following_url":"https://api.github.com/users/SilverFire/following{/other_user}","gists_url":"https://api.github.com/users/SilverFire/gists{/gist_id}","starred_url":"https://api.github.com/users/SilverFire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SilverFire/subscriptions","organizations_url":"https://api.github.com/users/SilverFire/orgs","repos_url":"https://api.github.com/users/SilverFire/repos","events_url":"https://api.github.com/users/SilverFire/events{/privacy}","received_events_url":"https://api.github.com/users/SilverFire/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":1241863901,"node_id":"MDExOkNsb3NlZEV2ZW50MTI0MTg2MzkwMQ==","url":"https://api.github.com/repos/yiisoft/yii2/issues/events/1241863901","actor":{"login":"SilverFire","id":4499203,"node_id":"MDQ6VXNlcjQ0OTkyMDM=","avatar_url":"https://avatars.githubusercontent.com/u/4499203?v=4","gravatar_id":"","url":"https://api.github.com/users/SilverFire","html_url":"https://github.com/SilverFire","followers_url":"https://api.github.com/users/SilverFire/followers","following_url":"https://api.github.com/users/SilverFire/following{/other_user}","gists_url":"https://api.github.com/users/SilverFire/gists{/gist_id}","starred_url":"https://api.github.com/users/SilverFire/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SilverFire/subscriptions","organizations_url":"https://api.github.com/users/SilverFire/orgs","repos_url":"https://api.github.com/users/SilverFire/repos","events_url":"https://api.github.com/users/SilverFire/events{/privacy}","received_events_url":"https://api.github.com/users/SilverFire/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"f9b0090a7d7a18e31bea7ccfef99ce6716c7538b","commit_url":"https://api.github.com/repos/yiisoft/yii2/commits/f9b0090a7d7a18e31bea7ccfef99ce6716c7538b","created_at":"2017-09-09T13:13:41Z","state_reason":null,"performed_via_github_app":null}]