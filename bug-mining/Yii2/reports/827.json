{"url":"https://api.github.com/repos/yiisoft/yii2/issues/18821","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/18821/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/18821/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/18821/events","html_url":"https://github.com/yiisoft/yii2/issues/18821","id":964975742,"node_id":"MDU6SXNzdWU5NjQ5NzU3NDI=","number":18821,"title":"Illegal offset type using InCondition and DbExpresion","user":{"login":"MarcoPro","id":7687547,"node_id":"MDQ6VXNlcjc2ODc1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7687547?v=4","gravatar_id":"","url":"https://api.github.com/users/MarcoPro","html_url":"https://github.com/MarcoPro","followers_url":"https://api.github.com/users/MarcoPro/followers","following_url":"https://api.github.com/users/MarcoPro/following{/other_user}","gists_url":"https://api.github.com/users/MarcoPro/gists{/gist_id}","starred_url":"https://api.github.com/users/MarcoPro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarcoPro/subscriptions","organizations_url":"https://api.github.com/users/MarcoPro/orgs","repos_url":"https://api.github.com/users/MarcoPro/repos","events_url":"https://api.github.com/users/MarcoPro/events{/privacy}","received_events_url":"https://api.github.com/users/MarcoPro/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":38412944,"node_id":"MDU6TGFiZWwzODQxMjk0NA==","url":"https://api.github.com/repos/yiisoft/yii2/labels/status:to%20be%20verified","name":"status:to be verified","color":"fbca04","default":false,"description":"Needs to be reproduced and validated."},{"id":115010082,"node_id":"MDU6TGFiZWwxMTUwMTAwODI=","url":"https://api.github.com/repos/yiisoft/yii2/labels/feature:db","name":"feature:db","color":"bfd4f2","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/yiisoft/yii2/milestones/67","html_url":"https://github.com/yiisoft/yii2/milestone/67","labels_url":"https://api.github.com/repos/yiisoft/yii2/milestones/67/labels","id":7525554,"node_id":"MI_kwDOADRbGc4ActSy","number":67,"title":"2.0.45","description":"","creator":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":31,"state":"closed","created_at":"2021-12-29T10:16:41Z","updated_at":"2022-02-11T13:13:42Z","due_on":null,"closed_at":"2022-02-11T13:13:42Z"},"comments":5,"created_at":"2021-08-10T13:18:41Z","updated_at":"2022-02-08T13:51:57Z","closed_at":"2022-02-08T13:51:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\n### What steps will reproduce the problem?\r\n\r\nTrying to make use of IN condition and dbexpression to be able to use a json column\r\n\r\n```php\r\nModel::find()\r\n    ->where(new InCondition(new Expression(\"data->>$.name\"),'IN',[\"Mike\",\"Jonh\"]))\r\n    ->all();\r\n```\r\n\r\n### What is the expected result?\r\nYou would expect that using a DbExpression as the first operand would work correctly just as it does with other operators\r\n\r\n\r\n### What do you get instead?\r\n\r\n\r\n```php\r\n\r\nyii\\base\\ErrorException: Illegal offset type in yiisoft/yii2/db/Connection.php:970\r\nStack trace:\r\n#0 yiisoft/yii2/db/Connection.php(970): yii\\base\\ErrorHandler->handleError(2, 'Illegal offset ...', '/var/www/vhosts...', 970, Array)\r\n#1 yiisoft/yii2/db/conditions/InConditionBuilder.php(91): yii\\db\\Connection->quoteColumnName(Object(yii\\db\\Expression))\r\n#2 yiisoft/yii2/db/QueryBuilder.php(288): yii\\db\\conditions\\InConditionBuilder->build(Object(yii\\db\\conditions\\InCondition), Array)\r\n#3 yiisoft/yii2/db/QueryBuilder.php(1580): yii\\db\\QueryBuilder->buildExpression(Object(yii\\db\\conditions\\InCondition), Array)\r\n#4 yiisoft/yii2/db/QueryBuilder.php(1357): yii\\db\\QueryBuilder->buildCondition(Object(yii\\db\\conditions\\InCondition), Array)\r\n#5 yiisoft/yii2/db/QueryBuilder.php(235): yii\\db\\QueryBuilder->buildWhere(Object(yii\\db\\conditions\\InCondition), Array)\r\n#6 yiisoft/yii2/db/ActiveQuery.php(328): yii\\db\\QueryBuilder->build(Object(yii\\db\\Query))\r\n#7 yiisoft/yii2/db/Query.php(249): yii\\db\\ActiveQuery->createCommand(Object(yii\\db\\Connection))\r\n#8 yiisoft/yii2/db/ActiveQuery.php(133): yii\\db\\Query->all(NULL)\r\n#9 frontend/views/site/map.php(24): yii\\db\\ActiveQuery->all()\r\n#10 yiisoft/yii2/base/View.php(348): require('/var/www/vhosts...')\r\n#11 yiisoft/yii2/base/View.php(257): yii\\base\\View->renderPhpFile('/var/www/vhosts...', Array)\r\n#12 yiisoft/yii2/base/View.php(156): yii\\base\\View->renderFile('/var/www/vhosts...', Array, Object(frontend\\controllers\\SiteController))\r\n#13 yiisoft/yii2/base/Controller.php(410): yii\\base\\View->render('map', Array, Object(frontend\\controllers\\SiteController))\r\n#14 frontend/controllers/SiteController.php(80): yii\\base\\Controller->render('map')\r\n#15 [internal function]: frontend\\controllers\\SiteController->actionMap()\r\n#16 yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)\r\n#17 yiisoft/yii2/base/Controller.php(181): yii\\base\\InlineAction->runWithParams(Array)\r\n#18 yiisoft/yii2/base/Module.php(534): yii\\base\\Controller->runAction('map', Array)\r\n#19 yiisoft/yii2/web/Application.php(104): yii\\base\\Module->runAction('site/map', Array)\r\n#20 yiisoft/yii2/base/Application.php(392): yii\\web\\Application->handleRequest(Object(yii\\web\\Request))\r\n#21 frontend/web/index.php(17): yii\\base\\Application->run()\r\n#22 {main}\r\n```\r\n\r\n\r\n### Additional info\r\n\r\n| Q                | A\r\n| ---------------- | ---\r\n| Yii version      | 2.0.42.1\r\n| PHP version      | 7.4\r\n| Operating system | Ubunut  18.04\r\n\r\n","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/18821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/18821/timeline","performed_via_github_app":null,"state_reason":"completed"}