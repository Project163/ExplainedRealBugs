{"url":"https://api.github.com/repos/yiisoft/yii2/issues/20479","repository_url":"https://api.github.com/repos/yiisoft/yii2","labels_url":"https://api.github.com/repos/yiisoft/yii2/issues/20479/labels{/name}","comments_url":"https://api.github.com/repos/yiisoft/yii2/issues/20479/comments","events_url":"https://api.github.com/repos/yiisoft/yii2/issues/20479/events","html_url":"https://github.com/yiisoft/yii2/issues/20479","id":3318580637,"node_id":"I_kwDOADRbGc7FzYWd","number":20479,"title":"SQLSTATE[42000]: [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Incorrect syntax near the keyword 'nchar'","user":{"login":"craiglondon","id":3833140,"node_id":"MDQ6VXNlcjM4MzMxNDA=","avatar_url":"https://avatars.githubusercontent.com/u/3833140?v=4","gravatar_id":"","url":"https://api.github.com/users/craiglondon","html_url":"https://github.com/craiglondon","followers_url":"https://api.github.com/users/craiglondon/followers","following_url":"https://api.github.com/users/craiglondon/following{/other_user}","gists_url":"https://api.github.com/users/craiglondon/gists{/gist_id}","starred_url":"https://api.github.com/users/craiglondon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/craiglondon/subscriptions","organizations_url":"https://api.github.com/users/craiglondon/orgs","repos_url":"https://api.github.com/users/craiglondon/repos","events_url":"https://api.github.com/users/craiglondon/events{/privacy}","received_events_url":"https://api.github.com/users/craiglondon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":33208443,"node_id":"MDU6TGFiZWwzMzIwODQ0Mw==","url":"https://api.github.com/repos/yiisoft/yii2/labels/type:bug","name":"type:bug","color":"e102d8","default":false,"description":"Bug"},{"id":247756568,"node_id":"MDU6TGFiZWwyNDc3NTY1Njg=","url":"https://api.github.com/repos/yiisoft/yii2/labels/MSSQL","name":"MSSQL","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2025-08-13T13:54:03Z","updated_at":"2025-08-26T19:05:12Z","closed_at":"2025-08-26T19:05:12Z","author_association":"CONTRIBUTOR","type":{"id":155854,"node_id":"IT_kwDOAA8oK84AAmDO","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T09:16:31Z","updated_at":"2024-07-26T10:05:53Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I recently enabled useStrictMode for the session component and when I went to my website I got this error.\n\n```2025-08-13 07:57:43\n[xx.xx.xx.xx][-][4c6lbacej8f13b7mqrvv868fae][error][yii\\db\\Exception]\nPDOException: SQLSTATE[42000]: [Microsoft][ODBC Driver 18 for SQL\nServer][SQL Server]Incorrect syntax near the keyword 'nchar'. in\n/vendor/yiisoft/yii2/db/Command.php:1320\nStack trace:\n#0\n/vendor/yiisoft/yii2/db/Command.php(1320):\nPDOStatement->execute()\n#1\n/vendor/yiisoft/yii2/db/Command.php(1120):\nyii\\db\\Command->internalExecute()\n#2\n/vendor/yiisoft/yii2/web/DbSession.php(152):\nyii\\db\\Command->execute()\n#3\n/vendor/yiisoft/yii2/web/Session.php(155):\nyii\\web\\DbSession->regenerateID()\n#4\n/vendor/yiisoft/yii2/web/Session.php(690):\nyii\\web\\Session->open()\n#5\n/vendor/yiisoft/yii2/web/User.php(692):\nyii\\web\\Session->get()\n#6\n/vendor/yiisoft/yii2/web/User.php(199):\nyii\\web\\User->renewAuthStatus()\n#7\n/vendor/yiisoft/yii2/web/User.php(367):\nyii\\web\\User->getIdentity()\n#8\n/vendor/yiisoft/yii2/base/Component.php(139):\nyii\\web\\User->getIsGuest()\n#9\n/frontend/controllers/BaseController.php(62):\nyii\\base\\Component->__get()\n#10\n/vendor/yiisoft/yii2/base/Controller.php(176):\nfrontend\\controllers\\BaseController->beforeAction()\n#11\n/vendor/yiisoft/yii2/base/Module.php(552):\nyii\\base\\Controller->runAction()\n#12\n/vendor/yiisoft/yii2/web/Application.php(103):\nyii\\base\\Module->runAction()\n#13\n/vendor/yiisoft/yii2/base/Application.php(384):\nyii\\web\\Application->handleRequest()\n#14\n/frontend/web/index.php(30):\nyii\\base\\Application->run()\n#15 {main}\n```\n\nI suspect the issue is related to this\n`yii\\db\\mssql\\QueryBuilder->insert()`\n```\nif (in_array($dbType, ['char', 'varchar', 'nchar', 'nvarchar', 'binary', 'varbinary'])) {\n    $dbType .= '(MAX)';\n}\n```\n\nSQL Server does not support \"MAX\" for \"char\" or \"nchar\"\n\nhttps://learn.microsoft.com/en-us/sql/t-sql/data-types/char-and-varchar-transact-sql?view=sql-server-ver17\nhttps://learn.microsoft.com/en-us/sql/t-sql/data-types/nchar-and-nvarchar-transact-sql?view=sql-server-ver17","closed_by":{"login":"samdark","id":47294,"node_id":"MDQ6VXNlcjQ3Mjk0","avatar_url":"https://avatars.githubusercontent.com/u/47294?v=4","gravatar_id":"","url":"https://api.github.com/users/samdark","html_url":"https://github.com/samdark","followers_url":"https://api.github.com/users/samdark/followers","following_url":"https://api.github.com/users/samdark/following{/other_user}","gists_url":"https://api.github.com/users/samdark/gists{/gist_id}","starred_url":"https://api.github.com/users/samdark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samdark/subscriptions","organizations_url":"https://api.github.com/users/samdark/orgs","repos_url":"https://api.github.com/users/samdark/repos","events_url":"https://api.github.com/users/samdark/events{/privacy}","received_events_url":"https://api.github.com/users/samdark/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yiisoft/yii2/issues/20479/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yiisoft/yii2/issues/20479/timeline","performed_via_github_app":null,"state_reason":"completed"}