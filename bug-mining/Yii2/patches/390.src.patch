diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index e0534e579..9c0c94420 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -32,6 +32,8 @@ Yii Framework 2 Change Log
 - Enh #15332: Always check for availability of `openssl_pseudo_random_bytes`, even if LibreSSL is available (sammousa)
 - Enh #15335: Added `FileHelper::unlink()` that works well under all OSes (samdark)
 - Enh #15340: Test CHANGELOG.md for valid format (sammousa)
+- Bug #15317: Regenerate CSRF token if an empty value is given (sammousa)
+
 
 2.0.13.1 November 14, 2017
 --------------------------
diff --git a/framework/web/Request.php b/framework/web/Request.php
index 691184044..2b4349cae 100644
--- a/framework/web/Request.php
+++ b/framework/web/Request.php
@@ -1582,7 +1582,7 @@ class Request extends \yii\base\Request
     public function getCsrfToken($regenerate = false)
     {
         if ($this->_csrfToken === null || $regenerate) {
-            if ($regenerate || ($token = $this->loadCsrfToken()) === null) {
+            if ($regenerate || empty($token = $this->loadCsrfToken())) {
                 $token = $this->generateCsrfToken();
             }
             $this->_csrfToken = Yii::$app->security->maskToken($token);
diff --git a/tests/framework/web/RequestTest.php b/tests/framework/web/RequestTest.php
index d37227029..7b054aec5 100644
--- a/tests/framework/web/RequestTest.php
+++ b/tests/framework/web/RequestTest.php
@@ -137,6 +137,22 @@ class RequestTest extends TestCase
         }
     }
 
+    public function testIssue15317()
+    {
+        $this->mockWebApplication();
+        $_COOKIE[(new Request())->csrfParam] = '';
+        $request = new Request();
+        $request->enableCsrfCookie = true;
+        $request->enableCookieValidation = false;
+
+        $_SERVER['REQUEST_METHOD'] = 'POST';
+        \Yii::$app->security->unmaskToken('');
+        $this->assertFalse($request->validateCsrfToken(''));
+
+        // When an empty CSRF token is given it is regenerated.
+        $this->assertNotEmpty($request->getCsrfToken());
+
+    }
     /**
      * Test CSRF token validation by POST param.
      */
