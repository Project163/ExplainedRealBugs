diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index a22ad40db..b26f747c0 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -4,6 +4,7 @@ Yii Framework 2 Change Log
 2.0.33 under development
 ------------------------
 
+- Bug #16092: Fix duplicate joins in usage of `joinWith` (germanow)
 - Bug #17679: Fix Oracle exception "ORA-01461: can bind a LONG value only for insert into a LONG column" when inserting 4k+ string (vinpel, 243083df)
 - Bug #17859: Fix loading fixtures under Windows (samdark)
 - Bug #11945: Fix Schema Builder MySQL column definition order (simialbi)
diff --git a/framework/db/ActiveQuery.php b/framework/db/ActiveQuery.php
index b69b7ef57..300f9dda7 100644
--- a/framework/db/ActiveQuery.php
+++ b/framework/db/ActiveQuery.php
@@ -486,6 +486,16 @@ class ActiveQuery extends Query implements ActiveQueryInterface
         }
         $this->join = array_values($uniqueJoins);
 
+        // https://github.com/yiisoft/yii2/issues/16092
+        $uniqueJoinsByTableName = [];
+        foreach ($this->join as $config) {
+            $tableName = serialize($config[1]);
+            if (!array_key_exists($tableName, $uniqueJoinsByTableName)) {
+                $uniqueJoinsByTableName[$tableName] = $config;
+            }
+        }
+        $this->join = array_values($uniqueJoinsByTableName);
+
         if (!empty($join)) {
             // append explicit join to joinWith()
             // https://github.com/yiisoft/yii2/issues/2880
diff --git a/tests/framework/db/ActiveQueryTest.php b/tests/framework/db/ActiveQueryTest.php
index 5f85ebb19..2fd9fdea8 100644
--- a/tests/framework/db/ActiveQueryTest.php
+++ b/tests/framework/db/ActiveQueryTest.php
@@ -136,6 +136,26 @@ abstract class ActiveQueryTest extends DatabaseTestCase
         ], $result->joinWith);
     }
 
+    public function testBuildJoinWithRemoveDuplicateJoinByTableName()
+    {
+        $query = new ActiveQuery(Customer::className());
+        $query->innerJoinWith('orders')
+            ->joinWith('orders.orderItems');
+        $this->invokeMethod($query, 'buildJoinWith');
+        $this->assertEquals([
+            [
+                'INNER JOIN',
+                'order',
+                '{{customer}}.[[id]] = {{order}}.[[customer_id]]'
+            ],
+            [
+                'LEFT JOIN',
+                'order_item',
+                '{{order}}.[[id]] = {{order_item}}.[[order_id]]'
+            ],
+        ], $query->join);
+    }
+
     /**
      * @todo: tests for the regex inside getQueryTableName
      */
diff --git a/tests/framework/db/ActiveRecordTest.php b/tests/framework/db/ActiveRecordTest.php
index 142a63e95..7e5a2d7d1 100644
--- a/tests/framework/db/ActiveRecordTest.php
+++ b/tests/framework/db/ActiveRecordTest.php
@@ -561,6 +561,180 @@ abstract class ActiveRecordTest extends DatabaseTestCase
         $this->assertEquals(2, $orders[0]->items[0]->category->id);
     }
 
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateSimple()
+    {
+        // left join and eager loading
+        $orders = Order::find()
+            ->innerJoinWith('customer')
+            ->joinWith('customer')
+            ->orderBy('customer.id DESC, order.id')
+            ->all();
+        $this->assertCount(3, $orders);
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertEquals(3, $orders[1]->id);
+        $this->assertEquals(1, $orders[2]->id);
+        $this->assertTrue($orders[0]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[1]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[2]->isRelationPopulated('customer'));
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateCallbackFiltering()
+    {
+        // inner join filtering and eager loading
+        $orders = Order::find()
+            ->innerJoinWith('customer')
+            ->joinWith([
+                'customer' => function ($query) {
+                    $query->where('{{customer}}.[[id]]=2');
+                },
+            ])->orderBy('order.id')->all();
+        $this->assertCount(2, $orders);
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertEquals(3, $orders[1]->id);
+        $this->assertTrue($orders[0]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[1]->isRelationPopulated('customer'));
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateCallbackFilteringConditionsOnPrimary()
+    {
+        // inner join filtering, eager loading, conditions on both primary and relation
+        $orders = Order::find()
+            ->innerJoinWith('customer')
+            ->joinWith([
+                'customer' => function ($query) {
+                    $query->where(['{{customer}}.[[id]]' => 2]);
+                },
+            ])->where(['order.id' => [1, 2]])->orderBy('order.id')->all();
+        $this->assertCount(1, $orders);
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertTrue($orders[0]->isRelationPopulated('customer'));
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateWithSubRelation()
+    {
+        // join with sub-relation
+        $orders = Order::find()
+            ->innerJoinWith('items')
+            ->joinWith([
+                'items.category' => function ($q) {
+                    $q->where('{{category}}.[[id]] = 2');
+                },
+            ])->orderBy('order.id')->all();
+        $this->assertCount(1, $orders);
+        $this->assertTrue($orders[0]->isRelationPopulated('items'));
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertCount(3, $orders[0]->items);
+        $this->assertTrue($orders[0]->items[0]->isRelationPopulated('category'));
+        $this->assertEquals(2, $orders[0]->items[0]->category->id);
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateTableAlias1()
+    {
+        // join with table alias
+        $orders = Order::find()
+            ->innerJoinWith('customer')
+            ->joinWith([
+                'customer' => function ($q) {
+                    $q->from('customer c');
+                },
+            ])->orderBy('c.id DESC, order.id')->all();
+        $this->assertCount(3, $orders);
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertEquals(3, $orders[1]->id);
+        $this->assertEquals(1, $orders[2]->id);
+        $this->assertTrue($orders[0]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[1]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[2]->isRelationPopulated('customer'));
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateTableAlias2()
+    {
+        // join with table alias
+        $orders = Order::find()
+            ->innerJoinWith('customer')
+            ->joinWith('customer as c')
+            ->orderBy('c.id DESC, order.id')
+            ->all();
+        $this->assertCount(3, $orders);
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertEquals(3, $orders[1]->id);
+        $this->assertEquals(1, $orders[2]->id);
+        $this->assertTrue($orders[0]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[1]->isRelationPopulated('customer'));
+        $this->assertTrue($orders[2]->isRelationPopulated('customer'));
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateTableAliasSubRelation()
+    {
+        // join with table alias sub-relation
+        $orders = Order::find()
+            ->innerJoinWith([
+                'items as t' => function ($q) {
+                    $q->orderBy('t.id');
+                },
+            ])
+            ->joinWith([
+                'items.category as c' => function ($q) {
+                    $q->where('{{c}}.[[id]] = 2');
+                },
+            ])->orderBy('order.id')->all();
+        $this->assertCount(1, $orders);
+        $this->assertTrue($orders[0]->isRelationPopulated('items'));
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertCount(3, $orders[0]->items);
+        $this->assertTrue($orders[0]->items[0]->isRelationPopulated('category'));
+        $this->assertEquals(2, $orders[0]->items[0]->category->id);
+    }
+
+    /**
+     * @depends testJoinWith
+     */
+    public function testJoinWithDuplicateSubRelationCalledInsideClosure()
+    {
+        // join with sub-relation called inside Closure
+        $orders = Order::find()
+            ->innerJoinWith('items')
+            ->joinWith([
+                'items' => function ($q) {
+                    $q->orderBy('item.id');
+                    $q->joinWith([
+                        'category' => function ($q) {
+                            $q->where('{{category}}.[[id]] = 2');
+                        },
+                    ]);
+                },
+            ])
+            ->orderBy('order.id')
+            ->all();
+        $this->assertCount(1, $orders);
+        $this->assertTrue($orders[0]->isRelationPopulated('items'));
+        $this->assertEquals(2, $orders[0]->id);
+        $this->assertCount(3, $orders[0]->items);
+        $this->assertTrue($orders[0]->items[0]->isRelationPopulated('category'));
+        $this->assertEquals(2, $orders[0]->items[0]->category->id);
+    }
+
     /**
      * @depends testJoinWith
      */
