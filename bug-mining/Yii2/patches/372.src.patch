diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index d83c01af8..9bc891a47 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -98,7 +98,7 @@ Yii Framework 2 Change Log
 - Chg #14286: Used primary inputmask package name instead of an alias (samdark)
 - Chg #14321: `yii\widgets\MaskedInput` is now registering its JavaScript `clientOptions` initialization code in head section (DaveFerger)
 - Chg #14487: Changed i18n message error to warning (dmirogin)
-
+- Bug #13436: Fixed migration for MSSQL DbSession (silverfire)
 
 2.0.12 June 05, 2017
 --------------------
diff --git a/framework/web/DbSession.php b/framework/web/DbSession.php
index 16c3b8d77..218155a7a 100644
--- a/framework/web/DbSession.php
+++ b/framework/web/DbSession.php
@@ -172,6 +172,7 @@ class DbSession extends MultiFieldSession
                 ->createCommand($this->db)
                 ->queryScalar();
             $fields = $this->composeFields($id, $data);
+            $fields = $this->typecastFields($fields);
             if ($exists === false) {
                 $this->db->createCommand()
                     ->insert($this->sessionTable, $fields)
@@ -219,4 +220,22 @@ class DbSession extends MultiFieldSession
 
         return true;
     }
+
+    /**
+     * Method typecasts $fields before passing them to PDO.
+     * Default implementation casts field `data` to `\PDO::PARAM_LOB`.
+     * You can override this method in case you need special type casting.
+     *
+     * @param array $fields Fields, that will be passed to PDO. Key - name, Value - value
+     * @return array
+     * @since 2.0.13
+     */
+    protected function typecastFields($fields)
+    {
+        if (isset($fields['data']) && !is_array($fields['data'])) {
+            $fields['data'] = [$fields['data'], \PDO::PARAM_LOB];
+        }
+
+        return $fields;
+    }
 }
diff --git a/framework/web/migrations/m160313_153426_session_init.php b/framework/web/migrations/m160313_153426_session_init.php
index 9ebc95105..ec107d0f7 100644
--- a/framework/web/migrations/m160313_153426_session_init.php
+++ b/framework/web/migrations/m160313_153426_session_init.php
@@ -20,16 +20,25 @@ class m160313_153426_session_init extends Migration
      */
     public function up()
     {
+        $dataType = $this->binary();
         $tableOptions = null;
-        if ($this->db->driverName === 'mysql') {
-            // http://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci
-            $tableOptions = 'CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE=InnoDB';
+
+        switch ($this->db->driverName) {
+            case 'mysql':
+                // http://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci
+                $tableOptions = 'CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE=InnoDB';
+                break;
+            case 'sqlsrv':
+            case 'mssql':
+            case 'dblib':
+                $dataType = $this->text();
+                break;
         }
 
         $this->createTable('{{%session}}', [
             'id' => $this->string()->notNull(),
             'expire' => $this->integer(),
-            'data' => $this->binary(),
+            'data' => $dataType,
             'PRIMARY KEY ([[id]])',
         ], $tableOptions);
     }
diff --git a/framework/web/migrations/schema-mssql.sql b/framework/web/migrations/schema-mssql.sql
index 6e43657ac..072cc315d 100644
--- a/framework/web/migrations/schema-mssql.sql
+++ b/framework/web/migrations/schema-mssql.sql
@@ -16,6 +16,6 @@ create table [session]
 (
     [id]  varchar(256) not null,
     [expire] integer,
-    [data]   VARBINARY(MAX),
+    [data]   nvarchar(max),
     primary key ([id])
 );
diff --git a/tests/framework/rbac/DbManagerTestCase.php b/tests/framework/rbac/DbManagerTestCase.php
index 55e92e0c0..cbb8da43b 100644
--- a/tests/framework/rbac/DbManagerTestCase.php
+++ b/tests/framework/rbac/DbManagerTestCase.php
@@ -20,6 +20,7 @@ use yii\rbac\Permission;
 use yii\rbac\Role;
 use yiiunit\data\rbac\UserID;
 use yiiunit\framework\console\controllers\EchoMigrateController;
+use yiiunit\framework\db\oci\QueryBuilderTest;
 use yiiunit\framework\log\ArrayTarget;
 
 /**
@@ -80,8 +81,7 @@ abstract class DbManagerTestCase extends ManagerTestCase
 
     public static function tearDownAfterClass()
     {
-        static::runConsoleAction('migrate/down', ['migrationPath' => '@yii/rbac/migrations/', 'interactive' => false]);
-        Yii::$app = null;
+        static::runConsoleAction('migrate/down', ['all', 'migrationPath' => '@yii/rbac/migrations/', 'interactive' => false]);
         parent::tearDownAfterClass();
     }
 
diff --git a/tests/framework/web/DbSessionTest.php b/tests/framework/web/DbSessionTest.php
deleted file mode 100644
index 0702e0485..000000000
--- a/tests/framework/web/DbSessionTest.php
+++ /dev/null
@@ -1,146 +0,0 @@
-<?php
-/**
- * @link http://www.yiiframework.com/
- * @copyright Copyright (c) 2008 Yii Software LLC
- * @license http://www.yiiframework.com/license/
- */
-
-namespace yiiunit\framework\web;
-
-use Yii;
-use yii\db\Connection;
-use yii\db\Query;
-use yii\web\DbSession;
-use yiiunit\framework\console\controllers\EchoMigrateController;
-use yiiunit\TestCase;
-
-/**
- * @group db
- */
-class DbSessionTest extends TestCase
-{
-    protected function setUp()
-    {
-        parent::setUp();
-        /*
-         * @todo Optionally do fallback to some other database, however this might be overkill for tests only since
-         * sqlite is always available on travis.
-         */
-        if (!in_array('sqlite', \PDO::getAvailableDrivers())) {
-            $this->markTestIncomplete('DbSessionTest requires SQLite!');
-        }
-        $this->mockApplication();
-        Yii::$app->set('db', [
-            'class' => Connection::className(),
-            'dsn' => 'sqlite::memory:',
-        ]);
-    }
-
-    protected function createTableSession()
-    {
-        Yii::$app->db->createCommand()->createTable('session', [
-            'id' => 'string',
-            'expire' => 'integer',
-            'data' => 'text',
-            'user_id' => 'integer',
-        ])->execute();
-    }
-
-    // Tests :
-
-    public function testReadWrite()
-    {
-        $this->createTableSession();
-
-        $session = new DbSession();
-
-        $session->writeSession('test', 'session data');
-        $this->assertEquals('session data', $session->readSession('test'));
-        $session->destroySession('test');
-        $this->assertEquals('', $session->readSession('test'));
-    }
-
-    /**
-     * @depends testReadWrite
-     */
-    public function testGarbageCollection()
-    {
-        $this->createTableSession();
-
-        $session = new DbSession();
-
-        $session->writeSession('new', 'new data');
-        $session->writeSession('expire', 'expire data');
-
-        $session->db->createCommand()
-            ->update('session', ['expire' => time() - 100], 'id = :id', ['id' => 'expire'])
-            ->execute();
-        $session->gcSession(1);
-
-        $this->assertEquals('', $session->readSession('expire'));
-        $this->assertEquals('new data', $session->readSession('new'));
-    }
-
-    /**
-     * @depends testReadWrite
-     */
-    public function testWriteCustomField()
-    {
-        $this->createTableSession();
-
-        $session = new DbSession();
-        $session->writeCallback = function ($session) {
-            return [
-                'user_id' => 15,
-            ];
-        };
-
-        $session->writeSession('test', 'session data');
-
-        $query = new Query();
-        $sessionRow = $query->from('session')
-            ->where(['id' => 'test'])
-            ->one();
-
-        $this->assertEquals('session data', $sessionRow['data']);
-        $this->assertEquals(15, $sessionRow['user_id']);
-    }
-
-    protected function runMigrate($action, $params = [])
-    {
-        $migrate = new EchoMigrateController('migrate', Yii::$app, [
-            'migrationPath' => '@yii/web/migrations',
-            'interactive' => false,
-        ]);
-
-        ob_start();
-        ob_implicit_flush(false);
-        $migrate->run($action, $params);
-        ob_get_clean();
-
-        return array_map(function ($version) {
-            return substr($version, 15);
-        }, (new Query())->select(['version'])->from('migration')->column());
-    }
-
-    public function testMigration()
-    {
-        $this->mockWebApplication([
-            'components' => [
-                'db' => [
-                    'class' => Connection::className(),
-                    'dsn' => 'sqlite::memory:',
-                ],
-            ],
-        ]);
-
-        $history = $this->runMigrate('history');
-        $this->assertEquals(['base'], $history);
-
-        $history = $this->runMigrate('up');
-        $this->assertEquals(['base', 'session_init'], $history);
-
-        $history = $this->runMigrate('down');
-        $this->assertEquals(['base'], $history);
-    }
-}
diff --git a/tests/framework/web/session/AbstractDbSessionTest.php b/tests/framework/web/session/AbstractDbSessionTest.php
new file mode 100644
index 000000000..29970ea9a
--- /dev/null
+++ b/tests/framework/web/session/AbstractDbSessionTest.php
@@ -0,0 +1,195 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+
+namespace yiiunit\framework\web\session;
+
+use Yii;
+use yii\base\Security;
+use yii\db\Connection;
+use yii\db\Query;
+use yii\web\DbSession;
+use yiiunit\framework\console\controllers\EchoMigrateController;
+use yiiunit\TestCase;
+
+/**
+ * @group db
+ */
+abstract class AbstractDbSessionTest extends TestCase
+{
+    /**
+     * @return string[] the driver names that are suitable for the test (mysql, pgsql, etc)
+     */
+    abstract protected function getDriverNames();
+
+    protected function setUp()
+    {
+        parent::setUp();
+        $this->mockApplication();
+        Yii::$app->set('db', $this->getDbConfig());
+        $this->dropTableSession();
+        $this->createTableSession();
+    }
+
+    protected function tearDown()
+    {
+        $this->dropTableSession();
+        parent::tearDown();
+    }
+
+    protected function getDbConfig()
+    {
+        $driverNames = $this->getDriverNames();
+        foreach ($driverNames as $driverName) {
+            if (in_array($driverName, \PDO::getAvailableDrivers())) {
+                break;
+            }
+        }
+        if (!isset($driverName)) {
+            $this->markTestIncomplete(get_called_class() . ' requires ' . implode(' or ', $driverNames) . ' PDO driver!');
+            return [];
+        }
+
+        $databases = self::getParam('databases');
+        $config = $databases[$driverName];
+
+        $result = [
+            'class' => Connection::className(),
+            'dsn' => $config['dsn'],
+        ];
+
+        if (isset($config['username'])) {
+            $result['username'] = $config['username'];
+        }
+        if (isset($config['password'])) {
+            $result['password'] = $config['password'];
+        }
+
+        return $result;
+    }
+
+    protected function createTableSession()
+    {
+        $this->runMigrate('up');
+    }
+
+    protected function dropTableSession()
+    {
+        try {
+            $this->runMigrate('down', ['all']);
+        } catch (\Exception $e) {
+            // Table may not exist for different reasons, but since this method
+            // reverts DB changes to make next test pass, this exception is skipped.
+        }
+    }
+
+    // Tests :
+
+    public function testReadWrite()
+    {
+        $session = new DbSession();
+
+        $session->writeSession('test', 'session data');
+        $this->assertEquals('session data', $session->readSession('test'));
+        $session->destroySession('test');
+        $this->assertEquals('', $session->readSession('test'));
+    }
+
+    /**
+     * @depends testReadWrite
+     */
+    public function testGarbageCollection()
+    {
+        $session = new DbSession();
+
+        $session->writeSession('new', 'new data');
+        $session->writeSession('expire', 'expire data');
+
+        $session->db->createCommand()
+            ->update('session', ['expire' => time() - 100], 'id = :id', ['id' => 'expire'])
+            ->execute();
+        $session->gcSession(1);
+
+        $this->assertEquals('', $session->readSession('expire'));
+        $this->assertEquals('new data', $session->readSession('new'));
+    }
+
+    /**
+     * @depends testReadWrite
+     */
+    public function testWriteCustomField()
+    {
+        $session = new DbSession();
+
+        $session->writeCallback = function ($session) {
+            return ['data' => 'changed by callback data'];
+        };
+
+        $session->writeSession('test', 'session data');
+
+        $query = new Query();
+        $this->assertSame('changed by callback data', $session->readSession('test'));
+    }
+
+    protected function buildObjectForSerialization()
+    {
+        $object = new \stdClass();
+        $object->nullValue = null;
+        $object->floatValue = pi();
+        $object->textValue = str_repeat('QweåßƒТест', 200);
+        $object->array = [null, 'ab' => 'cd'];
+        $object->binary = base64_decode('5qS2UUcXWH7rjAmvhqGJTDNkYWFiOGMzNTFlMzNmMWIyMDhmOWIwYzAwYTVmOTFhM2E5MDg5YjViYzViN2RlOGZlNjllYWMxMDA0YmQxM2RQ3ZC0in5ahjNcehNB/oP/NtOWB0u3Skm67HWGwGt9MA==');
+        $object->with_null_byte = 'hey!' . "\0" . 'y"ûƒ^äjw¾bðúl5êù-Ö=W¿Š±¬GP¥Œy÷&ø';
+
+        return $object;
+    }
+
+    public function testSerializedObjectSaving()
+    {
+        $session = new DbSession();
+
+        $serializedObject = serialize($this->buildObjectForSerialization());
+        $session->writeSession('test', $serializedObject);
+        $this->assertSame($serializedObject, $session->readSession('test'));
+    }
+
+    protected function runMigrate($action, $params = [])
+    {
+        $migrate = new EchoMigrateController('migrate', Yii::$app, [
+            'migrationPath' => '@yii/web/migrations',
+            'interactive' => false,
+        ]);
+
+        ob_start();
+        ob_implicit_flush(false);
+        $migrate->run($action, $params);
+        ob_get_clean();
+
+        return array_map(function ($version) {
+            return substr($version, 15);
+        }, (new Query())->select(['version'])->from('migration')->column());
+    }
+
+    public function testMigration()
+    {
+        $this->dropTableSession();
+        $this->mockWebApplication([
+            'components' => [
+                'db' => $this->getDbConfig(),
+            ],
+        ]);
+
+        $history = $this->runMigrate('history');
+        $this->assertEquals(['base'], $history);
+
+        $history = $this->runMigrate('up');
+        $this->assertEquals(['base', 'session_init'], $history);
+
+        $history = $this->runMigrate('down');
+        $this->assertEquals(['base'], $history);
+        $this->createTableSession();
+    }
+}
diff --git a/tests/framework/web/SessionTest.php b/tests/framework/web/session/SessionTest.php
similarity index 94%
rename from tests/framework/web/SessionTest.php
rename to tests/framework/web/session/SessionTest.php
index b11900af3..96f7fed4b 100644
--- a/tests/framework/web/SessionTest.php
+++ b/tests/framework/web/session/SessionTest.php
@@ -5,7 +5,7 @@
  * @license http://www.yiiframework.com/license/
  */
 
-namespace yiiunit\framework\web;
+namespace yiiunit\framework\web\session;
 
 use yii\web\Session;
 use yiiunit\TestCase;
diff --git a/tests/framework/web/session/mssql/DbSessionTest.php b/tests/framework/web/session/mssql/DbSessionTest.php
new file mode 100644
index 000000000..c854fcea0
--- /dev/null
+++ b/tests/framework/web/session/mssql/DbSessionTest.php
@@ -0,0 +1,31 @@
+<?php
+
+namespace yiiunit\framework\web\session\mssql;
+
+/**
+ * Class DbSessionTest
+ *
+ * @author Dmytro Naumenko <d.naumenko.a@gmail.com>
+ *
+ * @group db
+ * @group mssql
+ */
+class DbSessionTest extends \yiiunit\framework\web\session\AbstractDbSessionTest
+{
+    protected function getDriverNames()
+    {
+        return ['mssql', 'sqlsrv', 'dblib'];
+    }
+
+    protected function buildObjectForSerialization()
+    {
+        $object = parent::buildObjectForSerialization();
+        unset($object->binary);
+        // Binary data produce error on insert:
+        // `An error occurred translating string for input param 1 to UCS-2`
+        // I failed to make it work either with `nvarchar(max)` or `varbinary(max)` column
+        // in Microsoft SQL server. © SilverFire TODO: fix it
+
+        return $object;
+    }
+}
diff --git a/tests/framework/web/session/mysql/DbSessionTest.php b/tests/framework/web/session/mysql/DbSessionTest.php
new file mode 100644
index 000000000..459f4cbf7
--- /dev/null
+++ b/tests/framework/web/session/mysql/DbSessionTest.php
@@ -0,0 +1,19 @@
+<?php
+
+namespace yiiunit\framework\web\session\mysql;
+
+/**
+ * Class DbSessionTest
+ *
+ * @author Dmytro Naumenko <d.naumenko.a@gmail.com>
+ *
+ * @group db
+ * @group mysql
+ */
+class DbSessionTest extends \yiiunit\framework\web\session\AbstractDbSessionTest
+{
+    protected function getDriverNames()
+    {
+        return ['mysql'];
+    }
+}
diff --git a/tests/framework/web/session/pgsql/DbSessionTest.php b/tests/framework/web/session/pgsql/DbSessionTest.php
new file mode 100644
index 000000000..58350fcd5
--- /dev/null
+++ b/tests/framework/web/session/pgsql/DbSessionTest.php
@@ -0,0 +1,19 @@
+<?php
+
+namespace yiiunit\framework\web\session\pgsql;
+
+/**
+ * Class DbSessionTest
+ *
+ * @author Dmytro Naumenko <d.naumenko.a@gmail.com>
+ *
+ * @group db
+ * @group pgsql
+ */
+class DbSessionTest extends \yiiunit\framework\web\session\AbstractDbSessionTest
+{
+    protected function getDriverNames()
+    {
+        return ['pgsql'];
+    }
+}
diff --git a/tests/framework/web/session/sqlite/DbSessionTest.php b/tests/framework/web/session/sqlite/DbSessionTest.php
new file mode 100644
index 000000000..bb90faa75
--- /dev/null
+++ b/tests/framework/web/session/sqlite/DbSessionTest.php
@@ -0,0 +1,19 @@
+<?php
+
+namespace yiiunit\framework\web\session\sqlite;
+
+/**
+ * Class DbSessionTest
+ *
+ * @author Dmytro Naumenko <d.naumenko.a@gmail.com>
+ *
+ * @group db
+ * @group sqlite
+ */
+class DbSessionTest extends \yiiunit\framework\web\session\AbstractDbSessionTest
+{
+    protected function getDriverNames()
+    {
+        return ['sqlite'];
+    }
+}
