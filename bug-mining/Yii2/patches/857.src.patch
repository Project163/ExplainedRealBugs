diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index 1d2a85a0b..e710d2058 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -17,6 +17,7 @@ Yii Framework 2 Change Log
 - Bug #19316: Fix MysqlMutex with same connection but difference database (kamarton)
 - Bug #19507: Fix eager loading of nested one-to-many relations (spo0okie)
 - Bug #19546: Reverted #19309 (bizley)
+- Bug #19520: Fix for TIMESTAMP & ROWVERSION columns in MSSQL insert query (darkdef)
 
 
 2.0.46 August 18, 2022
diff --git a/framework/db/mssql/QueryBuilder.php b/framework/db/mssql/QueryBuilder.php
index 8094f1dd3..cc3595519 100644
--- a/framework/db/mssql/QueryBuilder.php
+++ b/framework/db/mssql/QueryBuilder.php
@@ -485,7 +485,7 @@ class QueryBuilder extends \yii\db\QueryBuilder
 
         list($names, $placeholders, $values, $params) = $this->prepareInsertValues($table, $columns, $params);
         $cols = [];
-        $columns = [];
+        $outputColumns = [];
         if ($version2005orLater) {
             /* @var $schema TableSchema */
             $schema = $this->db->getTableSchema($table);
@@ -493,19 +493,26 @@ class QueryBuilder extends \yii\db\QueryBuilder
                 if ($column->isComputed) {
                     continue;
                 }
+
+                $dbType = $column->dbType;
+                if (in_array($dbType, ['char', 'varchar', 'nchar', 'nvarchar', 'binary', 'varbinary'])) {
+                    $dbType .= '(MAX)';
+                }
+                if ($column->dbType === Schema::TYPE_TIMESTAMP) {
+                    $dbType = $column->allowNull ? 'varbinary(8)' : 'binary(8)';
+                }
+
                 $quoteColumnName = $this->db->quoteColumnName($column->name);
-                $cols[] = $quoteColumnName . ' '
-                    . $column->dbType
-                    . (in_array($column->dbType, ['char', 'varchar', 'nchar', 'nvarchar', 'binary', 'varbinary']) ? "(MAX)" : "")
-                    . ' ' . ($column->allowNull ? "NULL" : "");
-                $columns[] = 'INSERTED.' . $quoteColumnName;
+                $cols[] = $quoteColumnName . ' ' . $dbType . ' ' . ($column->allowNull ? "NULL" : "");
+                $outputColumns[] = 'INSERTED.' . $quoteColumnName;
             }
         }
-        $countColumns = count($columns);
+
+        $countColumns = count($outputColumns);
 
         $sql = 'INSERT INTO ' . $this->db->quoteTableName($table)
             . (!empty($names) ? ' (' . implode(', ', $names) . ')' : '')
-            . (($version2005orLater && $countColumns) ? ' OUTPUT ' . implode(',', $columns) . ' INTO @temporary_inserted' : '')
+            . (($version2005orLater && $countColumns) ? ' OUTPUT ' . implode(',', $outputColumns) . ' INTO @temporary_inserted' : '')
             . (!empty($placeholders) ? ' VALUES (' . implode(', ', $placeholders) . ')' : $values);
 
         if ($version2005orLater && $countColumns) {
diff --git a/tests/framework/db/mssql/ActiveRecordTest.php b/tests/framework/db/mssql/ActiveRecordTest.php
index 4fab6394e..6b6841fa1 100644
--- a/tests/framework/db/mssql/ActiveRecordTest.php
+++ b/tests/framework/db/mssql/ActiveRecordTest.php
@@ -7,6 +7,8 @@
 
 namespace yiiunit\framework\db\mssql;
 
+use yii\db\Exception;
+use yii\db\Expression;
 use yiiunit\data\ar\TestTrigger;
 use yiiunit\data\ar\TestTriggerAlert;
 
@@ -24,7 +26,7 @@ class ActiveRecordTest extends \yiiunit\framework\db\ActiveRecordTest
     }
 
     /**
-     * @throws \yii\db\Exception
+     * @throws Exception
      */
     public function testSaveWithTrigger()
     {
@@ -58,7 +60,7 @@ END';
     }
 
     /**
-     * @throws \yii\db\Exception
+     * @throws Exception
      */
     public function testSaveWithComputedColumn()
     {
@@ -83,4 +85,39 @@ END';
         $this->assertTrue($record->save(false));
         $this->assertEquals(1, $record->id);
     }
+
+    /**
+     * @throws Exception
+     */
+    public function testSaveWithRowVersionColumn()
+    {
+        $db = $this->getConnection();
+
+        $sql = 'ALTER TABLE [dbo].[test_trigger] ADD [RV] rowversion';
+        $db->createCommand($sql)->execute();
+
+        $record = new TestTrigger();
+        $record->stringcol = 'test';
+        $this->assertTrue($record->save(false));
+        $this->assertEquals(1, $record->id);
+        $this->assertEquals('test', $record->stringcol);
+    }
+
+    /**
+     * @throws Exception
+     */
+    public function testSaveWithRowVersionNullColumn()
+    {
+        $db = $this->getConnection();
+
+        $sql = 'ALTER TABLE [dbo].[test_trigger] ADD [RV] rowversion NULL';
+        $db->createCommand($sql)->execute();
+
+        $record = new TestTrigger();
+        $record->stringcol = 'test';
+        $record->RV = new Expression('DEFAULT');
+        $this->assertTrue($record->save(false));
+        $this->assertEquals(1, $record->id);
+        $this->assertEquals('test', $record->stringcol);
+    }
 }
