diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index b32dcb9f4..99c9fb574 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -6,6 +6,7 @@ Yii Framework 2 Change Log
 
 - Bug #15081: Fixed "Undefined offset: 1" in log Target (ischenko)
 - Bug #15086: Fixed jQuery onLoad event handling (alexantr)
+- Bug #15108: Fixed `yii\db\Schema::getSchemaNames()` for MSSQL and added tests for all DBMSes (sergeymakinen)
 
 
 2.0.13 November 03, 2017
diff --git a/framework/db/mssql/Schema.php b/framework/db/mssql/Schema.php
index d89292e5a..7a185e3d5 100644
--- a/framework/db/mssql/Schema.php
+++ b/framework/db/mssql/Schema.php
@@ -118,15 +118,18 @@ class Schema extends \yii\db\Schema
 
     /**
      * @inheritDoc
+     * @see https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-database-principals-transact-sql
      */
     protected function findSchemaNames()
     {
-        $sql = <<<'SQL'
-SELECT ns.nspname AS schema_name
-FROM pg_namespace ns
-WHERE ns.nspname != 'information_schema' AND ns.nspname NOT LIKE 'pg_%'
-ORDER BY ns.nspname
+        static $sql = <<<'SQL'
+SELECT [s].[name]
+FROM [sys].[schemas] AS [s]
+INNER JOIN [sys].[database_principals] AS [p] ON [p].[principal_id] = [s].[principal_id]
+WHERE [p].[is_fixed_role] = 0 AND [p].[sid] IS NOT NULL
+ORDER BY [s].[name] ASC
 SQL;
+
         return $this->db->createCommand($sql)->queryColumn();
     }
 
diff --git a/framework/db/oci/Schema.php b/framework/db/oci/Schema.php
index f3387693b..2907545d9 100644
--- a/framework/db/oci/Schema.php
+++ b/framework/db/oci/Schema.php
@@ -73,17 +73,17 @@ class Schema extends \yii\db\Schema
 
     /**
      * @inheritDoc
+     * @see https://docs.oracle.com/cd/B28359_01/server.111/b28337/tdpsg_user_accounts.htm
      */
     protected function findSchemaNames()
     {
-        $sql = <<<'SQL'
-SELECT
-    USERNAME
-FROM DBA_USERS U
-WHERE
-    EXISTS (SELECT 1 FROM DBA_OBJECTS O WHERE O.OWNER = U.USERNAME)
-    AND DEFAULT_TABLESPACE NOT IN ('SYSTEM','SYSAUX')
+        static $sql = <<<'SQL'
+SELECT "u"."USERNAME"
+FROM "DBA_USERS" "u"
+WHERE "u"."DEFAULT_TABLESPACE" NOT IN ('SYSTEM', 'SYSAUX')
+ORDER BY "u"."USERNAME" ASC
 SQL;
+
         return $this->db->createCommand($sql)->queryColumn();
     }
 
diff --git a/framework/db/pgsql/Schema.php b/framework/db/pgsql/Schema.php
index 0670ae51f..bead45e36 100644
--- a/framework/db/pgsql/Schema.php
+++ b/framework/db/pgsql/Schema.php
@@ -142,12 +142,13 @@ class Schema extends \yii\db\Schema
      */
     protected function findSchemaNames()
     {
-        $sql = <<<'SQL'
-SELECT ns.nspname AS schema_name
-FROM pg_namespace ns
-WHERE ns.nspname != 'information_schema' AND ns.nspname NOT LIKE 'pg_%'
-ORDER BY ns.nspname
+        static $sql = <<<'SQL'
+SELECT "ns"."nspname"
+FROM "pg_namespace" AS "ns"
+WHERE "ns"."nspname" != 'information_schema' AND "ns"."nspname" NOT LIKE 'pg_%'
+ORDER BY "ns"."nspname" ASC
 SQL;
+
         return $this->db->createCommand($sql)->queryColumn();
     }
 
diff --git a/tests/framework/db/SchemaTest.php b/tests/framework/db/SchemaTest.php
index 69426ba3f..7ff3801c9 100644
--- a/tests/framework/db/SchemaTest.php
+++ b/tests/framework/db/SchemaTest.php
@@ -19,6 +19,11 @@ use yii\db\Schema;
 
 abstract class SchemaTest extends DatabaseTestCase
 {
+    /**
+     * @var string[]
+     */
+    protected $expectedSchemas;
+
     public function pdoAttributesProvider()
     {
         return [
@@ -27,6 +32,18 @@ abstract class SchemaTest extends DatabaseTestCase
         ];
     }
 
+    public function testGetSchemaNames()
+    {
+        /* @var $schema Schema */
+        $schema = $this->getConnection()->schema;
+
+        $schemas = $schema->getSchemaNames();
+        $this->assertNotEmpty($schemas);
+        foreach ($this->expectedSchemas as $schema) {
+            $this->assertContains($schema, $schemas);
+        }
+    }
+
     /**
      * @dataProvider pdoAttributesProvider
      * @param array $pdoAttributes
diff --git a/tests/framework/db/cubrid/SchemaTest.php b/tests/framework/db/cubrid/SchemaTest.php
index 8b53ed5b1..95b3fe2a8 100644
--- a/tests/framework/db/cubrid/SchemaTest.php
+++ b/tests/framework/db/cubrid/SchemaTest.php
@@ -18,6 +18,11 @@ class SchemaTest extends \yiiunit\framework\db\SchemaTest
 {
     public $driverName = 'cubrid';
 
+    public function testGetSchemaNames()
+    {
+        $this->markTestSkipped('Schemas are not supported in CUBRID.');
+    }
+
     public function testGetPDOType()
     {
         $values = [
diff --git a/tests/framework/db/mssql/SchemaTest.php b/tests/framework/db/mssql/SchemaTest.php
index c84d2b282..3bab8ea8c 100644
--- a/tests/framework/db/mssql/SchemaTest.php
+++ b/tests/framework/db/mssql/SchemaTest.php
@@ -18,6 +18,10 @@ class SchemaTest extends \yiiunit\framework\db\SchemaTest
 {
     public $driverName = 'sqlsrv';
 
+    protected $expectedSchemas = [
+        'dbo',
+    ];
+
     public function constraintsProvider()
     {
         $result = parent::constraintsProvider();
diff --git a/tests/framework/db/mysql/SchemaTest.php b/tests/framework/db/mysql/SchemaTest.php
index ee06c1fda..b181f5be9 100644
--- a/tests/framework/db/mysql/SchemaTest.php
+++ b/tests/framework/db/mysql/SchemaTest.php
@@ -17,6 +17,11 @@ class SchemaTest extends \yiiunit\framework\db\SchemaTest
 {
     public $driverName = 'mysql';
 
+    public function testGetSchemaNames()
+    {
+        $this->markTestSkipped('Schemas are not supported in MySQL.');
+    }
+
     public function constraintsProvider()
     {
         $result = parent::constraintsProvider();
diff --git a/tests/framework/db/oci/SchemaTest.php b/tests/framework/db/oci/SchemaTest.php
index 570312d88..4ea804352 100644
--- a/tests/framework/db/oci/SchemaTest.php
+++ b/tests/framework/db/oci/SchemaTest.php
@@ -18,6 +18,8 @@ class SchemaTest extends \yiiunit\framework\db\SchemaTest
 {
     public $driverName = 'oci';
 
+    protected $expectedSchemas = [];
+
     public function getExpectedColumns()
     {
         $columns = parent::getExpectedColumns();
diff --git a/tests/framework/db/pgsql/SchemaTest.php b/tests/framework/db/pgsql/SchemaTest.php
index 72080245d..b1cc9b108 100644
--- a/tests/framework/db/pgsql/SchemaTest.php
+++ b/tests/framework/db/pgsql/SchemaTest.php
@@ -19,6 +19,10 @@ class SchemaTest extends \yiiunit\framework\db\SchemaTest
 {
     public $driverName = 'pgsql';
 
+    protected $expectedSchemas = [
+        'public',
+    ];
+
     public function getExpectedColumns()
     {
         $columns = parent::getExpectedColumns();
diff --git a/tests/framework/db/sqlite/SchemaTest.php b/tests/framework/db/sqlite/SchemaTest.php
index a33e172e8..033c3dc9a 100644
--- a/tests/framework/db/sqlite/SchemaTest.php
+++ b/tests/framework/db/sqlite/SchemaTest.php
@@ -17,6 +17,11 @@ class SchemaTest extends \yiiunit\framework\db\SchemaTest
 {
     protected $driverName = 'sqlite';
 
+    public function testGetSchemaNames()
+    {
+        $this->markTestSkipped('Schemas are not supported in SQLite.');
+    }
+
     public function getExpectedColumns()
     {
         $columns = parent::getExpectedColumns();
