diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index 41afc27bc..26625e3be 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -37,6 +37,7 @@ Yii Framework 2 Change Log
 - Enh #14188: Add constants and function for sysexits(3) to `ConsoleHelper` (tom--, samdark, cebe)
 - Bug #14165: Set `_slave` of `Connection` to `false` instead of `null` in `close` method (rossoneri)
 - Bug #14423: Fixed `ArrayHelper::merge` behavior with null values for integer-keyed elements (dmirogin)
+- Bug #14406: Fixed caching rules in `yii\web\UrlManager` with different ruleConfig configuration (dmirogin)
 - Chg #7936: Deprecate `yii\base\Object` in favor of `yii\base\BaseObject` for compatibility with PHP 7.2 (rob006, cebe, klimov-paul)
 
 
diff --git a/framework/web/UrlManager.php b/framework/web/UrlManager.php
index ec2369034..1f7256d6c 100644
--- a/framework/web/UrlManager.php
+++ b/framework/web/UrlManager.php
@@ -183,7 +183,7 @@ class UrlManager extends Component
         }
         if ($this->cache instanceof CacheInterface) {
             $cacheKey = $this->cacheKey;
-            $hash = md5(json_encode($this->rules));
+            $hash = md5(json_encode([$this->ruleConfig, $this->rules]));
             if (($data = $this->cache->get($cacheKey)) !== false && isset($data[1]) && $data[1] === $hash) {
                 $this->rules = $data[0];
             } else {
diff --git a/tests/framework/web/UrlManagerCreateUrlTest.php b/tests/framework/web/UrlManagerCreateUrlTest.php
index 0c0cf0426..6db228393 100644
--- a/tests/framework/web/UrlManagerCreateUrlTest.php
+++ b/tests/framework/web/UrlManagerCreateUrlTest.php
@@ -8,6 +8,7 @@
 namespace yiiunit\framework\web;
 
 use Yii;
+use yii\caching\ArrayCache;
 use yii\web\UrlManager;
 use yii\web\UrlRule;
 use yiiunit\framework\web\stubs\CachedUrlRule;
@@ -54,13 +55,13 @@ class UrlManagerCreateUrlTest extends TestCase
     {
         // in this test class, all tests have enablePrettyUrl enabled.
         $config['enablePrettyUrl'] = true;
-        $config['cache'] = null;
 
         // set default values if they are not set
         $config = array_merge([
             'baseUrl' => '',
             'scriptUrl' => '/index.php',
             'hostInfo' => 'http://www.example.com',
+            'cache' => null,
             'showScriptName' => $showScriptName,
         ], $config);
 
@@ -758,4 +759,36 @@ class UrlManagerCreateUrlTest extends TestCase
         $this->assertEquals(2, $rules[0]->createCounter);
         $this->assertEquals(1, $rules[1]->createCounter);
     }
+
+    /**
+     * @see https://github.com/yiisoft/yii2/issues/14406
+     */
+    public function testCreatingRulesWithDifferentRuleConfigAndEnabledCache()
+    {
+        $this->mockWebApplication([
+            'components' => [
+                'cache' => ArrayCache::className()
+            ]
+        ]);
+        $urlManager = $this->getUrlManager([
+            'cache' => 'cache',
+            'rules' => [
+                '/' => 'site/index'
+            ]
+        ]);
+
+        $cachedUrlManager = $this->getUrlManager([
+            'cache' => 'cache',
+            'ruleConfig' => [
+                'class' => CachedUrlRule::className()
+            ],
+            'rules' => [
+                '/' => 'site/index'
+            ]
+        ]);
+
+        $this->assertNotEquals($urlManager->rules, $cachedUrlManager->rules);
+        $this->assertInstanceOf(UrlRule::className(), $urlManager->rules[0]);
+        $this->assertInstanceOf(CachedUrlRule::className(), $cachedUrlManager->rules[0]);
+    }
 }
