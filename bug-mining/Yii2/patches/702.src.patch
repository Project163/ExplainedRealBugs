diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index ac8825777..2453b1c18 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -4,6 +4,7 @@ Yii Framework 2 Change Log
 2.0.36 under development
 ------------------------
 
+- Bug #18047: Fix colorization markers output in Table.php (cheeseq)
 - Bug #18028: Fix division by zero exception in Table.php::calculateRowHeight (fourhundredfour)
 - Enh #18019: Allow jQuery 3.5.0 to be installed (wouter90)
 - Bug #18026: Fix `ArrayHelper::getValue()` did not work with `ArrayAccess` objects (mikk150)
diff --git a/framework/console/widgets/Table.php b/framework/console/widgets/Table.php
index 3141b9c31..b9938b1e7 100644
--- a/framework/console/widgets/Table.php
+++ b/framework/console/widgets/Table.php
@@ -241,36 +241,38 @@ class Table extends Widget
         $buffer = '';
         $arrayPointer = [];
         $finalChunk = [];
+        $alreadyPrintedCells = [];
         for ($i = 0, ($max = $this->calculateRowHeight($row)) ?: $max = 1; $i < $max; $i++) {
             $buffer .= $spanLeft . ' ';
             foreach ($size as $index => $cellSize) {
                 $cell = isset($row[$index]) ? $row[$index] : null;
                 $prefix = '';
+                $chunk = '';
                 if ($index !== 0) {
                     $buffer .= $spanMiddle . ' ';
                 }
                 if (is_array($cell)) {
                     if (empty($finalChunk[$index])) {
                         $finalChunk[$index] = '';
-                        $start = 0;
                         $prefix = $this->listPrefix;
                         if (!isset($arrayPointer[$index])) {
                             $arrayPointer[$index] = 0;
                         }
-                    } else {
-                        $start = mb_strwidth($finalChunk[$index], Yii::$app->charset);
                     }
-                    $chunk = mb_substr($cell[$arrayPointer[$index]], $start, $cellSize - 4, Yii::$app->charset);
+                    $chunk = $cell[$arrayPointer[$index]];
                     $finalChunk[$index] .= $chunk;
                     if (isset($cell[$arrayPointer[$index] + 1]) && $finalChunk[$index] === $cell[$arrayPointer[$index]]) {
                         $arrayPointer[$index]++;
                         $finalChunk[$index] = '';
                     }
                 } else {
-                    $chunk = mb_substr($cell, ($cellSize * $i) - ($i * 2), $cellSize - 2, Yii::$app->charset);
+                    if (!isset($alreadyPrintedCells[$index])) {
+                        $chunk = $cell;
+                    }
+                    $alreadyPrintedCells[$index] = true;
                 }
                 $chunk = $prefix . $chunk;
-                $repeat = $cellSize - mb_strwidth($chunk, Yii::$app->charset) - 1;
+                $repeat = $cellSize - Console::ansiStrwidth($chunk) - 1;
                 $buffer .= $chunk;
                 if ($repeat >= 0) {
                     $buffer .= str_repeat(' ', $repeat);
@@ -333,11 +335,9 @@ class Table extends Widget
         foreach ($columns as $column) {
             $columnWidth = max(array_map(function ($val) {
                 if (is_array($val)) {
-                    $encodings = array_fill(0, count($val), Yii::$app->charset);
-                    return max(array_map('mb_strwidth', $val, $encodings)) + mb_strwidth($this->listPrefix, Yii::$app->charset);
+                    return max(array_map('yii\helpers\Console::ansiStrwidth', $val)) + Console::ansiStrwidth($this->listPrefix);
                 }
-
-                return mb_strwidth($val, Yii::$app->charset);
+                return Console::ansiStrwidth($val);
             }, $column)) + 2;
             $this->columnWidths[] = $columnWidth;
             $totalWidth += $columnWidth;
@@ -376,10 +376,9 @@ class Table extends Widget
             return $size == 2 || $columnWidth == 0 ? 0 : ceil($columnWidth / ($size - 2));
         }, $this->columnWidths, array_map(function ($val) {
             if (is_array($val)) {
-                $encodings = array_fill(0, count($val), Yii::$app->charset);
-                return array_map('mb_strwidth', $val, $encodings);
+                return array_map('yii\helpers\Console::ansiStrwidth', $val);
             }
-            return mb_strwidth($val, Yii::$app->charset);
+            return Console::ansiStrwidth($val);
         }, $row));
         return max($rowsPerCell);
     }
diff --git a/framework/helpers/BaseConsole.php b/framework/helpers/BaseConsole.php
index 8c3b3fb18..e9e417edc 100644
--- a/framework/helpers/BaseConsole.php
+++ b/framework/helpers/BaseConsole.php
@@ -7,6 +7,7 @@
 
 namespace yii\helpers;
 
+use Yii;
 use yii\console\Markdown as ConsoleMarkdown;
 use yii\base\Model;
 
@@ -343,6 +344,17 @@ class BaseConsole
         return mb_strlen(static::stripAnsiFormat($string));
     }
 
+    /**
+     * Returns the width of the string without ANSI color codes.
+     * @param string $string the string to measure
+     * @return int the width of the string not counting ANSI format characters
+     * @since 2.0.36
+     */
+    public static function ansiStrwidth($string)
+    {
+        return mb_strwidth(static::stripAnsiFormat($string), Yii::$app->charset);
+    }
+
     /**
      * Converts an ANSI formatted string to HTML.
      *
diff --git a/tests/framework/console/widgets/TableTest.php b/tests/framework/console/widgets/TableTest.php
index 5fcacfd7d..76335d135 100644
--- a/tests/framework/console/widgets/TableTest.php
+++ b/tests/framework/console/widgets/TableTest.php
@@ -8,6 +8,7 @@
 namespace yiiunit\framework\console;
 
 use yii\console\widgets\Table;
+use yii\helpers\Console;
 use yiiunit\TestCase;
 
 /**
@@ -314,6 +315,56 @@ EXPECTED;
         );
     }
 
+    public function testColorizedInput()
+    {
+        $table = new Table();
+
+        $expected = <<<"EXPECTED"
+╔═══════╤═══════╤══════════╗
+║ test1 │ test2 │ test3    ║
+╟───────┼───────┼──────────╢
+║ col1  │ \e[33mcol2\e[0m  │ col3     ║
+╟───────┼───────┼──────────╢
+║ col1  │ col2  │ • col3-0 ║
+║       │       │ • \e[31mcol3-1\e[0m ║
+║       │       │ • col3-2 ║
+╚═══════╧═══════╧══════════╝
+
+EXPECTED;
+
+        $this->assertEqualsWithoutLE(
+            $expected,
+            $table
+                ->setHeaders(['test1', 'test2', 'test3'])
+                ->setRows([
+                    ['col1', Console::renderColoredString('%ycol2%n'), 'col3'],
+                    ['col1', 'col2', ['col3-0', Console::renderColoredString('%rcol3-1%n'), 'col3-2']],
+                ])
+                ->run()
+        );
+    }
+
+    public function testColorizedInputStripsANSIMarkersInternally()
+    {
+        $table = new Table();
+
+        $table
+            ->setHeaders(['t1', 't2', 't3'])
+            ->setRows([
+                ['col1', Console::renderColoredString('%ycol2%n'), 'col3'],
+                ['col1', 'col2', ['col3-0', Console::renderColoredString('%rcol3-1%n'), 'col3-2']],
+            ])
+            ->setScreenWidth(200)
+            ->run();
+
+        $columnWidths = \PHPUnit_Framework_Assert::readAttribute($table, "columnWidths");
+
+        $this->assertArrayHasKey(1, $columnWidths);
+        $this->assertEquals(4+2, $columnWidths[1]);
+        $this->assertArrayHasKey(2, $columnWidths);
+        $this->assertEquals(8+2, $columnWidths[2]);
+    }
+
     public function testCalculateRowHeightShouldNotThrowDivisionByZeroException()
     {
         $rows = [
