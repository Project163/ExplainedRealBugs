diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index a4d5858bf..e1cc1cd7a 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -10,6 +10,7 @@ Yii Framework 2 Change Log
 - Enh #18381: The `yii\web\AssetManager` `$basePath` readable and writeable check has been moved to the `checkBasePathPermission()`. This check will run once before `publishFile()` and `publishDirectory()` (nadar)
 - Bug #18199: Fix content body response on 304 HTTP status code, according to RFC 7232 (rad8329)
 - Enh #18394: Add support for setting `yii\web\Response::$stream` to a callable (brandonkelly)
+- Bug #18406: Fix PDO exception when committing or rolling back an autocommitted transaction in PHP 8 (brandonkelly)
 
 
 2.0.39.3 November 23, 2020
diff --git a/framework/db/Transaction.php b/framework/db/Transaction.php
index e6c1cbe93..7a119d117 100644
--- a/framework/db/Transaction.php
+++ b/framework/db/Transaction.php
@@ -140,7 +140,10 @@ class Transaction extends \yii\base\BaseObject
         $schema = $this->db->getSchema();
         if ($schema->supportsSavepoint()) {
             Yii::debug('Set savepoint ' . $this->_level, __METHOD__);
-            $schema->createSavepoint('LEVEL' . $this->_level);
+            // make sure the transaction wasn't autocommitted
+            if ($this->db->pdo->inTransaction()) {
+                $schema->createSavepoint('LEVEL' . $this->_level);
+            }
         } else {
             Yii::info('Transaction not started: nested transaction not supported', __METHOD__);
             throw new NotSupportedException('Transaction not started: nested transaction not supported.');
@@ -161,7 +164,10 @@ class Transaction extends \yii\base\BaseObject
         $this->_level--;
         if ($this->_level === 0) {
             Yii::debug('Commit transaction', __METHOD__);
-            $this->db->pdo->commit();
+            // make sure the transaction wasn't autocommitted
+            if ($this->db->pdo->inTransaction()) {
+                $this->db->pdo->commit();
+            }
             $this->db->trigger(Connection::EVENT_COMMIT_TRANSACTION);
             return;
         }
@@ -169,7 +175,10 @@ class Transaction extends \yii\base\BaseObject
         $schema = $this->db->getSchema();
         if ($schema->supportsSavepoint()) {
             Yii::debug('Release savepoint ' . $this->_level, __METHOD__);
-            $schema->releaseSavepoint('LEVEL' . $this->_level);
+            // make sure the transaction wasn't autocommitted
+            if ($this->db->pdo->inTransaction()) {
+                $schema->releaseSavepoint('LEVEL' . $this->_level);
+            }
         } else {
             Yii::info('Transaction not committed: nested transaction not supported', __METHOD__);
         }
@@ -189,7 +198,10 @@ class Transaction extends \yii\base\BaseObject
         $this->_level--;
         if ($this->_level === 0) {
             Yii::debug('Roll back transaction', __METHOD__);
-            $this->db->pdo->rollBack();
+            // make sure the transaction wasn't autocommitted
+            if ($this->db->pdo->inTransaction()) {
+                $this->db->pdo->rollBack();
+            }
             $this->db->trigger(Connection::EVENT_ROLLBACK_TRANSACTION);
             return;
         }
@@ -197,7 +209,10 @@ class Transaction extends \yii\base\BaseObject
         $schema = $this->db->getSchema();
         if ($schema->supportsSavepoint()) {
             Yii::debug('Roll back to savepoint ' . $this->_level, __METHOD__);
-            $schema->rollBackSavepoint('LEVEL' . $this->_level);
+            // make sure the transaction wasn't autocommitted
+            if ($this->db->pdo->inTransaction()) {
+                $schema->rollBackSavepoint('LEVEL' . $this->_level);
+            }
         } else {
             Yii::info('Transaction not rolled back: nested transaction not supported', __METHOD__);
         }
diff --git a/tests/framework/db/mysql/ConnectionTest.php b/tests/framework/db/mysql/ConnectionTest.php
index 7f9b15640..8a8f36e0d 100644
--- a/tests/framework/db/mysql/ConnectionTest.php
+++ b/tests/framework/db/mysql/ConnectionTest.php
@@ -7,6 +7,8 @@
 
 namespace yiiunit\framework\db\mysql;
 
+use yii\db\Connection;
+
 /**
  * @group db
  * @group mysql
@@ -14,4 +16,21 @@ namespace yiiunit\framework\db\mysql;
 class ConnectionTest extends \yiiunit\framework\db\ConnectionTest
 {
     protected $driverName = 'mysql';
+
+    /**
+     * @doesNotPerformAssertions
+     */
+    public function testTransactionAutocommit()
+    {
+        /** @var Connection $connection */
+        $connection = $this->getConnection(true);
+        $connection->transaction(function (Connection $db) {
+            // create table will cause the transaction to be implicitly committed
+            // (see https://dev.mysql.com/doc/refman/8.0/en/implicit-commit.html)
+            $name = 'test_implicit_transaction_table';
+            $db->createCommand()->createTable($name, ['id' => 'pk'])->execute();
+            $db->createCommand()->dropTable($name)->execute();
+        });
+        // If we made it this far without an error, then everything's working
+    }
 }
