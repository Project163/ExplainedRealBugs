diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index 4d2c20697..3bc97abdf 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -3,6 +3,8 @@ Yii Framework 2 Change Log
 
 2.0.48 under development
 ------------------------
+
+- Bug #15376: Added $userId for RBAC roles cache (manchenkoff)
 - Bug #18867: Fixed multiple issues with `yii\grid\CheckboxColumn`: "check all" checkbox not being checked on page load when all data row checkboxes are initially checked; clicking checkboxes triggered "change" event for other checkboxes that do not change their state; "check all" checkbox not being checked when disabled checkboxes are present and clicking last non-checked data row checkbox (PowerGamer1)
 - Bug #19635: PHP 8.2 compatibility fix for `yii\validators\DateValidator` (PowerGamer1)
 - Bug #17194: Fix unnecessary SQL updates in the database on attributes typecast via `yii\behaviors\AttributeTypecastBehavior` (aivchen)
diff --git a/framework/rbac/DbManager.php b/framework/rbac/DbManager.php
index e95489dab..d676cbf8c 100644
--- a/framework/rbac/DbManager.php
+++ b/framework/rbac/DbManager.php
@@ -477,7 +477,7 @@ class DbManager extends BaseManager
         }
 
         if ($this->cache !== null) {
-            $data = $this->cache->get($this->getUserRolesCacheKey());
+            $data = $this->cache->get($this->getUserRolesCacheKey($userId));
 
             if ($data !== false) {
                 return $data;
@@ -496,7 +496,7 @@ class DbManager extends BaseManager
         }
 
         if ($this->cache !== null) {
-            $this->cache->set($this->getUserRolesCacheKey(), $roles);
+            $this->cacheUserRolesData($userId, $roles);
         }
 
         return $roles;
@@ -1002,10 +1002,19 @@ class DbManager extends BaseManager
     {
         if ($this->cache !== null) {
             $this->cache->delete($this->cacheKey);
-            $this->cache->delete($this->getUserRolesCacheKey());
             $this->items = null;
             $this->rules = null;
             $this->parents = null;
+
+            $cachedUserIds = $this->cache->get($this->getUserRolesCachedSetKey());
+
+            if ($cachedUserIds !== false) {
+                foreach ($cachedUserIds as $userId) {
+                    $this->cache->delete($this->getUserRolesCacheKey($userId));
+                }
+
+                $this->cache->delete($this->getUserRolesCachedSetKey());
+            }
         }
         $this->checkAccessAssignments = [];
     }
@@ -1080,8 +1089,27 @@ class DbManager extends BaseManager
         return !isset($userId) || $userId === '';
     }
 
-    private function getUserRolesCacheKey()
+    private function getUserRolesCacheKey($userId)
+    {
+        return $this->cacheKey . $this->rolesCacheSuffix . $userId;
+    }
+
+    private function getUserRolesCachedSetKey()
     {
         return $this->cacheKey . $this->rolesCacheSuffix;
     }
+
+    private function cacheUserRolesData($userId, $roles)
+    {
+        $cachedUserIds = $this->cache->get($this->getUserRolesCachedSetKey());
+
+        if ($cachedUserIds === false) {
+            $cachedUserIds = [];
+        }
+
+        $cachedUserIds[] = $userId;
+
+        $this->cache->set($this->getUserRolesCacheKey($userId), $roles);
+        $this->cache->set($this->getUserRolesCachedSetKey(), $cachedUserIds);
+    }
 }
diff --git a/tests/framework/rbac/DbManagerTestCase.php b/tests/framework/rbac/DbManagerTestCase.php
index b2828871b..b6faad129 100644
--- a/tests/framework/rbac/DbManagerTestCase.php
+++ b/tests/framework/rbac/DbManagerTestCase.php
@@ -7,7 +7,6 @@
 
 namespace yiiunit\framework\rbac;
 
-use app\models\User;
 use Yii;
 use yii\caching\ArrayCache;
 use yii\console\Application;
@@ -214,6 +213,28 @@ abstract class DbManagerTestCase extends ManagerTestCase
         }
     }
 
+    public function testGetCachedRolesByUserId()
+    {
+        $this->auth->removeAll();
+        $this->auth->cache = new ArrayCache();
+
+        $admin = $this->auth->createRole('Admin');
+        $this->auth->add($admin);
+        $this->auth->assign($admin, 1);
+
+        $manager = $this->auth->createRole('Manager');
+        $this->auth->add($manager);
+        $this->auth->assign($manager, 2);
+
+        $adminUserRoles = $this->auth->getRolesByUser(1);
+        $this->assertArrayHasKey('Admin', $adminUserRoles);
+        $this->assertEquals($admin->name, $adminUserRoles['Admin']->name);
+
+        $managerUserRoles = $this->auth->getRolesByUser(2);
+        $this->assertArrayHasKey('Manager', $managerUserRoles);
+        $this->assertEquals($manager->name, $managerUserRoles['Manager']->name);
+    }
+
     /**
      * @dataProvider emptyValuesProvider
      * @param mixed $userId
