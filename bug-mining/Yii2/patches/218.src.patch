diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index dbe63bc3c..c42cdf72b 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -110,6 +110,7 @@ Yii Framework 2 Change Log
 - Bug #13401: Fixed lack of escaping of request dump at exception screens (samdark)
 - Enh #13417: Allow customizing `yii\data\ActiveDataProvider` in `yii\rest\IndexAction` (leandrogehlen)
 - Chg #13393: Removed redundant call to `yii\helpers\Url::to()` in `yii\web\Controller::redirect()` (greeflas)
+- Bug #12599: Fixed MSSQL fail to work with `nvarbinary`. Enhanced SQL scripts compatibility with older versions (samdark)
 
 2.0.10 October 20, 2016
 -----------------------
diff --git a/framework/caching/migrations/schema-mssql.sql b/framework/caching/migrations/schema-mssql.sql
index 62bb95ea7..fc6670fe6 100644
--- a/framework/caching/migrations/schema-mssql.sql
+++ b/framework/caching/migrations/schema-mssql.sql
@@ -8,6 +8,8 @@
  * @license http://www.yiiframework.com/license/
  * @since 2.0.7
  */
+if object_id('[cache]', 'U') is not null
+    drop table [cache];
 
 drop table if exists [cache];
 
diff --git a/framework/db/mssql/QueryBuilder.php b/framework/db/mssql/QueryBuilder.php
index 11e4fe45e..b86bba165 100644
--- a/framework/db/mssql/QueryBuilder.php
+++ b/framework/db/mssql/QueryBuilder.php
@@ -9,6 +9,7 @@ namespace yii\db\mssql;
 
 use yii\base\InvalidParamException;
 use yii\base\NotSupportedException;
+use yii\db\Expression;
 
 /**
  * QueryBuilder is the query builder for MS SQL Server databases (version 2008 and above).
@@ -312,4 +313,41 @@ class QueryBuilder extends \yii\db\QueryBuilder
     {
         return 'SELECT CASE WHEN EXISTS(' . $rawSql . ') THEN 1 ELSE 0 END';
     }
+
+    /**
+     * Normalizes data to be saved into the table, performing extra preparations and type converting, if necessary.
+     * @param string $table the table that data will be saved into.
+     * @param array $columns the column data (name => value) to be saved into the table.
+     * @return array normalized columns
+     */
+    private function normalizeTableRowData($table, $columns, &$params)
+    {
+        if (($tableSchema = $this->db->getSchema()->getTableSchema($table)) !== null) {
+            $columnSchemas = $tableSchema->columns;
+            foreach ($columns as $name => $value) {
+                // @see https://github.com/yiisoft/yii2/issues/12599
+                if (isset($columnSchemas[$name]) && $columnSchemas[$name]->type === Schema::TYPE_BINARY && $columnSchemas[$name]->dbType === 'varbinary' && is_string($value)) {
+                    $phName = self::PARAM_PREFIX . count($params);
+                    $columns[$name] = new Expression("CONVERT(VARBINARY, $phName)", [$phName => $value]);
+                }
+            }
+        }
+        return $columns;
+    }
+
+    /**
+     * @inheritdoc
+     */
+    public function insert($table, $columns, &$params)
+    {
+        return parent::insert($table, $this->normalizeTableRowData($table, $columns, $params), $params);
+    }
+
+    /**
+     * @inheritdoc
+     */
+    public function update($table, $columns, $condition, &$params)
+    {
+        return parent::update($table, $this->normalizeTableRowData($table, $columns, $params), $condition, $params);
+    }
 }
diff --git a/framework/i18n/migrations/schema-mssql.sql b/framework/i18n/migrations/schema-mssql.sql
index c5982b99e..479c0587f 100644
--- a/framework/i18n/migrations/schema-mssql.sql
+++ b/framework/i18n/migrations/schema-mssql.sql
@@ -8,8 +8,11 @@
  * @since 2.0.7
  */
 
-drop table if exists [source_message];
-drop table if exists [message];
+if object_id('[source_message]', 'U') is not null
+    drop table [source_message];
+
+if object_id('[message]', 'U') is not null
+    drop table [message];
 
 CREATE TABLE [source_message]
 (
diff --git a/framework/log/migrations/schema-mssql.sql b/framework/log/migrations/schema-mssql.sql
index 1a2456cc0..28358e321 100644
--- a/framework/log/migrations/schema-mssql.sql
+++ b/framework/log/migrations/schema-mssql.sql
@@ -12,7 +12,8 @@
  * @since 2.0.1
  */
 
-drop table if exists [log];
+if object_id('[log]', 'U') is not null
+    drop table [log];
 
 create table [log]
 (
diff --git a/framework/rbac/migrations/schema-mssql.sql b/framework/rbac/migrations/schema-mssql.sql
index 27dd1feab..e13fbae27 100644
--- a/framework/rbac/migrations/schema-mssql.sql
+++ b/framework/rbac/migrations/schema-mssql.sql
@@ -9,10 +9,17 @@
  * @since 2.0
  */
 
-drop table [auth_assignment];
-drop table [auth_item_child];
-drop table [auth_item];
-drop table [auth_rule];
+if object_id('[auth_assignment]', 'U') is not null
+    drop table [auth_assignment];
+
+if object_id('[auth_item_child]', 'U') is not null
+    drop table [auth_item_child];
+
+if object_id('[auth_item]', 'U') is not null
+    drop table [auth_item];
+
+if object_id('[auth_rule]', 'U') is not null
+    drop table [auth_rule];
 
 create table [auth_rule]
 (
diff --git a/framework/web/migrations/schema-mssql.sql b/framework/web/migrations/schema-mssql.sql
index e605778da..6e43657ac 100644
--- a/framework/web/migrations/schema-mssql.sql
+++ b/framework/web/migrations/schema-mssql.sql
@@ -9,7 +9,8 @@
  * @since 2.0.8
  */
 
-drop table if exists [session];
+if object_id('[session]', 'U') is not null
+    drop table [session];
 
 create table [session]
 (
