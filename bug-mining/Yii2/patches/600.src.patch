diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index 85722bf6c..9f8e7330a 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -4,6 +4,7 @@ Yii Framework 2 Change Log
 2.0.24 under development
 ------------------------
 
+- Bug #17219: Fixed quoting of table names with spaces in MSSQL (alexkart)
 - Bug #10020: Fixed quoting of column names with dots in MSSQL (alexkart)
 - Bug #17424: Subdomain support for `User::loginRequired` (alex-code)
 
diff --git a/framework/db/QueryBuilder.php b/framework/db/QueryBuilder.php
index 979da12f3..41c7e9532 100644
--- a/framework/db/QueryBuilder.php
+++ b/framework/db/QueryBuilder.php
@@ -270,11 +270,11 @@ class QueryBuilder extends \yii\base\BaseObject
      * @param array $params the parameters to be bound to the generated SQL statement. These parameters will
      * be included in the result with the additional parameters generated during the expression building process.
      * @return string the SQL statement that will not be neither quoted nor encoded before passing to DBMS
-     * @see ExpressionInterface
+     * @throws InvalidArgumentException when $expression building is not supported by this QueryBuilder.
      * @see ExpressionBuilderInterface
      * @see expressionBuilders
      * @since 2.0.14
-     * @throws InvalidArgumentException when $expression building is not supported by this QueryBuilder.
+     * @see ExpressionInterface
      */
     public function buildExpression(ExpressionInterface $expression, &$params = [])
     {
@@ -289,9 +289,9 @@ class QueryBuilder extends \yii\base\BaseObject
      *
      * @param ExpressionInterface $expression
      * @return ExpressionBuilderInterface
-     * @see expressionBuilders
-     * @since 2.0.14
      * @throws InvalidArgumentException when $expression building is not supported by this QueryBuilder.
+     * @since 2.0.14
+     * @see expressionBuilders
      */
     public function getExpressionBuilder(ExpressionInterface $expression)
     {
@@ -488,7 +488,7 @@ class QueryBuilder extends \yii\base\BaseObject
         }
 
         return 'INSERT INTO ' . $schema->quoteTableName($table)
-        . ' (' . implode(', ', $columns) . ') VALUES ' . implode(', ', $values);
+            . ' (' . implode(', ', $columns) . ') VALUES ' . implode(', ', $values);
     }
 
     /**
@@ -1136,7 +1136,7 @@ class QueryBuilder extends \yii\base\BaseObject
             list($rawQuery, $params) = $this->build($subQuery);
             array_walk(
                 $params,
-                function(&$param) {
+                function (&$param) {
                     $param = $this->db->quoteValue($param);
                 }
             );
@@ -1298,7 +1298,7 @@ class QueryBuilder extends \yii\base\BaseObject
             }
             // 0:join type, 1:join table, 2:on-condition (optional)
             list($joinType, $table) = $join;
-            $tables = $this->quoteTableNames((array) $table, $params);
+            $tables = $this->quoteTableNames((array)$table, $params);
             $table = reset($tables);
             $joins[$i] = "$joinType $table";
             if (isset($join[2])) {
@@ -1331,8 +1331,8 @@ class QueryBuilder extends \yii\base\BaseObject
                 }
                 $tables[$i] = "$table " . $this->db->quoteTableName($i);
             } elseif (strpos($table, '(') === false) {
-                if (preg_match('/^(.*?)(?i:\s+as|)\s+([^ ]+)$/', $table, $matches)) { // with alias
-                    $tables[$i] = $this->db->quoteTableName($matches[1]) . ' ' . $this->db->quoteTableName($matches[2]);
+                if ($tableWithAlias = $this->extractAlias($table)) { // with alias
+                    $tables[$i] = $this->db->quoteTableName($tableWithAlias[1]) . ' ' . $this->db->quoteTableName($tableWithAlias[2]);
                 } else {
                     $tables[$i] = $this->db->quoteTableName($table);
                 }
@@ -1454,7 +1454,7 @@ class QueryBuilder extends \yii\base\BaseObject
      */
     protected function hasLimit($limit)
     {
-        return ($limit instanceof ExpressionInterface) || ctype_digit((string) $limit);
+        return ($limit instanceof ExpressionInterface) || ctype_digit((string)$limit);
     }
 
     /**
@@ -1464,7 +1464,7 @@ class QueryBuilder extends \yii\base\BaseObject
      */
     protected function hasOffset($offset)
     {
-        return ($offset instanceof ExpressionInterface) || ctype_digit((string) $offset) && (string) $offset !== '0';
+        return ($offset instanceof ExpressionInterface) || ctype_digit((string)$offset) && (string)$offset !== '0';
     }
 
     /**
@@ -1543,7 +1543,7 @@ class QueryBuilder extends \yii\base\BaseObject
             return $this->buildExpression($condition, $params);
         }
 
-        return (string) $condition;
+        return (string)$condition;
     }
 
     /**
@@ -1552,8 +1552,8 @@ class QueryBuilder extends \yii\base\BaseObject
      * [[conditionClasses]] map.
      *
      * @param string|array $condition
-     * @see conditionClasses
      * @return ConditionInterface
+     * @see conditionClasses
      * @since 2.0.14
      */
     public function createConditionFromArray($condition)
@@ -1733,4 +1733,19 @@ class QueryBuilder extends \yii\base\BaseObject
 
         return $phName;
     }
+
+    /**
+     * Extracts table alias if there is one or returns false
+     * @param $table
+     * @return bool|array
+     * @since 2.0.24
+     */
+    protected function extractAlias($table)
+    {
+        if (preg_match('/^(.*?)(?i:\s+as|)\s+([^ ]+)$/', $table, $matches)) {
+            return $matches;
+        }
+
+        return false;
+    }
 }
diff --git a/framework/db/mssql/QueryBuilder.php b/framework/db/mssql/QueryBuilder.php
index f93f3303f..d82554066 100644
--- a/framework/db/mssql/QueryBuilder.php
+++ b/framework/db/mssql/QueryBuilder.php
@@ -429,4 +429,16 @@ class QueryBuilder extends \yii\db\QueryBuilder
 
         return $columnType;
     }
+
+    /**
+     * {@inheritdoc}
+     */
+    protected function extractAlias($table)
+    {
+        if (preg_match('/^\[.*\]$/', $table)) {
+            return false;
+        }
+
+        return parent::extractAlias($table);
+    }
 }
diff --git a/tests/framework/db/QueryBuilderTest.php b/tests/framework/db/QueryBuilderTest.php
index 6fe159b6e..38a67c8c2 100644
--- a/tests/framework/db/QueryBuilderTest.php
+++ b/tests/framework/db/QueryBuilderTest.php
@@ -1291,6 +1291,29 @@ abstract class QueryBuilderTest extends DatabaseTestCase
         return $conditions;
     }
 
+    /**
+     * @dataProvider buildFromDataProvider
+     * @param $table
+     * @param $expected
+     * @throws \Exception
+     */
+    public function testBuildFrom($table, $expected)
+    {
+        $params = [];
+        $sql = $this->getQueryBuilder()->buildFrom([$table], $params);
+        $this->assertEquals('FROM ' . $this->replaceQuotes($expected), $sql);
+    }
+
+    public function buildFromDataProvider()
+    {
+        return [
+            ['test t1', '[[test]] [[t1]]'],
+            ['test as t1', '[[test]] [[t1]]'],
+            ['test AS t1', '[[test]] [[t1]]'],
+            ['test', '[[test]]'],
+        ];
+    }
+
     /**
      * @dataProvider conditionProvider
      * @param array $condition
diff --git a/tests/framework/db/mssql/QueryBuilderTest.php b/tests/framework/db/mssql/QueryBuilderTest.php
index 397f5a932..459911c4c 100644
--- a/tests/framework/db/mssql/QueryBuilderTest.php
+++ b/tests/framework/db/mssql/QueryBuilderTest.php
@@ -196,4 +196,17 @@ class QueryBuilderTest extends \yiiunit\framework\db\QueryBuilderTest
 
         return $data;
     }
+
+    public function buildFromDataProvider()
+    {
+        $data = parent::buildFromDataProvider();
+        $data[] = ['[test]', '[[test]]'];
+        $data[] = ['[test] [t1]', '[[test]] [[t1]]'];
+        $data[] = ['[table.name]', '[[table.name]]'];
+        $data[] = ['[table.name.with.dots]', '[[table.name.with.dots]]'];
+        $data[] = ['[table name]', '[[table name]]'];
+        $data[] = ['[table name with spaces]', '[[table name with spaces]]'];
+
+        return $data;
+    }
 }
