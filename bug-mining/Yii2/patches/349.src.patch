diff --git a/framework/CHANGELOG.md b/framework/CHANGELOG.md
index c6e87a7eb..99982451b 100644
--- a/framework/CHANGELOG.md
+++ b/framework/CHANGELOG.md
@@ -38,7 +38,7 @@ Yii Framework 2 Change Log
 - Enh #13824: Support extracting concatenated strings in `yii message` (developeruz)
 - Enh #14089: Added tests for `yii\base\Theme` (vladis84)
 - Enh #13586: Added `$preserveNonEmptyValues` property to the `yii\behaviors\AttributeBehavior` (Kolyunya)
-- Enh #13780: Added support for trusted proxies in `yii\web\Request` (sammousa, cebe)
+- Enh #13780: Added support for trusted proxies in `yii\web\Request` (sammousa, cebe, silverfire)
 - Bug #14192: Fixed wrong default null value for TIMESTAMP when using PostgreSQL (Tigrov)
 - Enh #14081: Added `yii\caching\CacheInterface` to make custom cache extensions adoption easier (silverfire)
 - Enh #11415: Added `yii\console\widgets\Table` to draw tables in console apps (pana1990, rob006, samdark, tonykor)
diff --git a/framework/web/Request.php b/framework/web/Request.php
index 498633ef3..d5134964a 100644
--- a/framework/web/Request.php
+++ b/framework/web/Request.php
@@ -9,6 +9,7 @@ namespace yii\web;
 
 use Yii;
 use yii\base\InvalidConfigException;
+use yii\validators\IpValidator;
 
 /**
  * The web Request class represents an HTTP request.
@@ -168,42 +169,43 @@ class Request extends \yii\base\Request
     /**
      * @var array the configuration for trusted security related headers.
      *
-     * An array key is a regular expression for matching a client (ususally a proxy) by
-     * host name or ip address.
+     * An array key is an IPv4 or IPv6 IP address in CIDR notation for matching a client.
      *
      * An array value is a list of headers to trust. These will be matched against
      * [[secureHeaders]] to determine which headers are allowed to be sent by a specified host.
      * The case of the header names must be the same as specified in [[secureHeaders]].
      *
-     * To specify a host for which you trust all headers listed in [[secureHeaders]] you can just specify
-     * the regular expression as the array value.
-     *
-     * For example, to trust all headers listed in [[secureHeaders]]
-     * from domains ending in '.trusted.com' use the following:
+     * For example, to trust all headers listed in [[secureHeaders]] for IP addresses
+     * in range `192.168.0.0-192.168.0.254` write the following:
      *
      * ```php
      * [
-     *     '/\.trusted\.com$/',
+     *     '192.168.0.0/24',
      * ]
      * ```
      *
-     * To trust just the `x-forwarded-for` header from domains ending in `.partial.com` use:
+     * To trust just the `X-Forwarded-For` header from `10.0.0.1`, use:
      *
      * ```
      * [
-     *     '/\.partial\.com$/' => ['X-Forwarded-For']
+     *     '10.0.0.1' => ['X-Forwarded-For']
      * ]
      * ```
      *
      * Default is to trust all headers except those listed in [[secureHeaders]] from all hosts.
-     * Matches are tried in order and searching is stopped when a host or IP matches.
+     * Matches are tried in order and searching is stopped when IP matches.
+     * 
+     * > Info: Matching is performed using [[IpValidator]].
+     *   See [[IpValidator::::setRanges()|IpValidator::setRanges()]]
+     *   and [[IpValidator::networks]] for advanced matching.
+     * 
      * @see $secureHeaders
      * @since 2.0.13
      */
     public $trustedHosts = [];
     /**
      * @var array lists of headers that are, by default, subject to the trusted host configuration.
-     * These headers will be filtered unless explicitly allowed in [[$trustedHosts]].
+     * These headers will be filtered unless explicitly allowed in [[trustedHosts]].
      * The match of header names is case-insensitive.
      * @see https://en.wikipedia.org/wiki/List_of_HTTP_header_fields
      * @see $trustedHosts
@@ -284,14 +286,15 @@ class Request extends \yii\base\Request
 
         // check if the client is a trusted host
         if (!empty($this->trustedHosts)) {
-            $host = $this->getRemoteHost();
+            $validator = $this->getIpValidator();
             $ip = $this->getRemoteIP();
-            foreach ($this->trustedHosts as $hostRegex => $headers) {
+            foreach ($this->trustedHosts as $cidr => $headers) {
                 if (!is_array($headers)) {
-                    $hostRegex = $headers;
+                    $cidr = $headers;
                     $headers = $this->secureHeaders;
                 }
-                if (preg_match($hostRegex, $host) || preg_match($hostRegex, $ip)) {
+                $validator->setRanges($cidr);
+                if ($validator->validate($ip)) {
                     $trustedHeaders = $headers;
                     break;
                 }
@@ -306,6 +309,18 @@ class Request extends \yii\base\Request
         }
     }
 
+    /**
+     * Creates instance of [[IpValidator]].
+     * You can override this method to adjust validator or implement different matching strategy.
+     *
+     * @return IpValidator
+     * @since 2.0.13
+     */
+    protected function getIpValidator()
+    {
+        return new IpValidator();
+    }
+
     /**
      * Returns the header collection.
      * The header collection contains incoming HTTP headers.
diff --git a/tests/framework/web/RequestTest.php b/tests/framework/web/RequestTest.php
index 3e9e2930e..fdba5d027 100644
--- a/tests/framework/web/RequestTest.php
+++ b/tests/framework/web/RequestTest.php
@@ -320,7 +320,7 @@ class RequestTest extends TestCase
             [[
                 'HTTP_X_FORWARDED_PROTO' => 'https',
                 'REMOTE_HOST' => 'test.com',
-            ], true],
+            ], false],
             [[
                 'HTTP_X_FORWARDED_PROTO' => 'https',
                 'REMOTE_HOST' => 'othertest.com',
@@ -338,7 +338,7 @@ class RequestTest extends TestCase
             [[
                 'HTTP_FRONT_END_HTTPS' => 'on',
                 'REMOTE_HOST' => 'test.com',
-            ], true],
+            ], false],
             [[
                 'HTTP_FRONT_END_HTTPS' => 'on',
                 'REMOTE_HOST' => 'othertest.com',
@@ -364,8 +364,7 @@ class RequestTest extends TestCase
         $original = $_SERVER;
         $request = new Request([
             'trustedHosts' => [
-                '/^test.com$/',
-                '/^192\.168/',
+                '192.168.0.0/24',
             ],
         ]);
         $_SERVER = $server;
@@ -397,10 +396,10 @@ class RequestTest extends TestCase
                 [
                     'HTTP_X_FORWARDED_PROTO' => 'https',
                     'HTTP_X_FORWARDED_FOR' => '123.123.123.123',
-                    'REMOTE_HOST' => 'trusted.com',
+                    'REMOTE_HOST' => 'untrusted.com',
                     'REMOTE_ADDR' => '192.169.1.1',
                 ],
-                '123.123.123.123',
+                '192.169.1.1',
             ],
             [
                 [
@@ -425,8 +424,7 @@ class RequestTest extends TestCase
         $_SERVER = $server;
         $request = new Request([
             'trustedHosts' => [
-                '/^192\.168/',
-                '/^trusted.com$/',
+                '192.168.0.0/24',
             ],
         ]);
 
