diff --git a/pom.xml b/pom.xml
index 3c91d8b..7741b65 100644
--- a/pom.xml
+++ b/pom.xml
@@ -42,7 +42,7 @@
             <plugin>
                 <groupId>org.apache.maven.plugins</groupId>
                 <artifactId>maven-compiler-plugin</artifactId>
-                <version>3.3</version>
+                <version>3.10.1</version>
                 <configuration>
                     <source>1.6</source>
                     <target>1.6</target>
@@ -51,7 +51,7 @@
             <plugin>
                 <groupId>org.codehaus.mojo</groupId>
                 <artifactId>animal-sniffer-maven-plugin</artifactId>
-                <version>1.14</version>
+                <version>1.22</version>
                 <configuration>
                     <signature>
                         <groupId>org.codehaus.mojo.signature</groupId>
@@ -72,7 +72,7 @@
             <plugin>
                 <groupId>org.apache.maven.plugins</groupId>
                 <artifactId>maven-release-plugin</artifactId>
-                <version>2.5.3</version>
+                <version>3.0.0-M7</version>
                 <configuration>
                     <autoVersionSubmodules>true</autoVersionSubmodules>
                     <useReleaseProfile>false</useReleaseProfile>
@@ -87,7 +87,7 @@
         <dependency>
             <groupId>junit</groupId>
             <artifactId>junit</artifactId>
-            <version>4.13.1</version>
+            <version>4.13.2</version>
             <scope>test</scope>
         </dependency>
     </dependencies>
@@ -131,7 +131,7 @@
                     <plugin>
                         <groupId>org.sonatype.plugins</groupId>
                         <artifactId>nexus-staging-maven-plugin</artifactId>
-                        <version>1.6.6</version>
+                        <version>1.6.13</version>
                         <extensions>true</extensions>
                         <configuration>
                             <serverId>ossrh</serverId>
@@ -142,7 +142,7 @@
                     <plugin>
                         <groupId>org.apache.maven.plugins</groupId>
                         <artifactId>maven-source-plugin</artifactId>
-                        <version>2.4</version>
+                        <version>3.2.1</version>
                         <executions>
                             <execution>
                                 <id>attach-sources</id>
@@ -155,7 +155,7 @@
                     <plugin>
                         <groupId>org.apache.maven.plugins</groupId>
                         <artifactId>maven-javadoc-plugin</artifactId>
-                        <version>2.10.3</version>
+                        <version>3.4.1</version>
                         <executions>
                             <execution>
                                 <id>attach-javadocs</id>
@@ -168,7 +168,7 @@
                     <plugin>
                         <groupId>org.apache.maven.plugins</groupId>
                         <artifactId>maven-gpg-plugin</artifactId>
-                        <version>1.6</version>
+                        <version>3.0.1</version>
                         <executions>
                             <execution>
                                 <id>sign-artifacts</id>
diff --git a/src/main/java/net/e175/klaus/solarpositioning/SPA.java b/src/main/java/net/e175/klaus/solarpositioning/SPA.java
index 29c09fa..2a7a07b 100644
--- a/src/main/java/net/e175/klaus/solarpositioning/SPA.java
+++ b/src/main/java/net/e175/klaus/solarpositioning/SPA.java
@@ -212,7 +212,7 @@ public final class SPA {
         m[0] = (alphaDeltas[1].alpha - longitude - nuDegrees) / 360;
 
         // A.2.4. Calculate the local hour angle H0 corresponding to ...
-        final double acosArg = (SIN_HPRIME_0 - sin(phi * sin(toRadians(alphaDeltas[1].delta))))
+        final double acosArg = (SIN_HPRIME_0 - sin(phi) * sin(toRadians(alphaDeltas[1].delta)))
                 / (cos(phi) * cos(toRadians(alphaDeltas[1].delta)));
 
         final boolean noSunriseOrSet = (acosArg < -1.0) || (acosArg > 1.0);
diff --git a/src/test/java/net/e175/klaus/solarpositioning/SPATest.java b/src/test/java/net/e175/klaus/solarpositioning/SPATest.java
index 56a67b7..774c49f 100644
--- a/src/test/java/net/e175/klaus/solarpositioning/SPATest.java
+++ b/src/test/java/net/e175/klaus/solarpositioning/SPATest.java
@@ -99,8 +99,8 @@ public class SPATest {
 
         DateFormat df = getDateFormat(time);
 
-        assertEquals("2004-12-04T04:38:57+0000", df.format(res[0].getTime()));
-        assertEquals("2004-12-04T19:02:01+0000", df.format(res[2].getTime())); // SPA paper has 19:02:02.5
+        assertEquals("2004-12-04T04:38:56+0000", df.format(res[0].getTime()));
+        assertEquals("2004-12-04T19:02:02+0000", df.format(res[2].getTime())); // SPA paper has 19:02:02.5
     }
 
     @Test
@@ -126,8 +126,8 @@ public class SPATest {
 
         DateFormat df = getDateFormat(time);
 
-        assertEquals("2015-06-17T07:32:45+1200", df.format(res[0].getTime()));
-        assertEquals("2015-06-17T17:11:04+1200", df.format(res[2].getTime()));
+        assertEquals("2015-06-17T07:32:46+1200", df.format(res[0].getTime()));
+        assertEquals("2015-06-17T17:11:03+1200", df.format(res[2].getTime()));
     }
 
     @Test
@@ -153,9 +153,9 @@ public class SPATest {
 
         DateFormat df = getDateFormat(time);
 
-        assertEquals("2015-10-25T06:49:00+0100", df.format(res[0].getTime())); // NOAA: same (no seconds given)
+        assertEquals("2015-10-25T06:49:02+0100", df.format(res[0].getTime())); // NOAA: same (no seconds given)
         assertEquals("2015-10-25T11:50:55+0100", df.format(res[1].getTime())); // NOAA: 11:50:53
-        assertEquals("2015-10-25T16:52:02+0100", df.format(res[2].getTime())); // NOAA: 16:52 (no seconds given)
+        assertEquals("2015-10-25T16:51:59+0100", df.format(res[2].getTime())); // NOAA: 16:52 (no seconds given)
     }
 
     @Test
