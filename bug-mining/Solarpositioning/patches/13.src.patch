diff --git a/src/main/java/net/e175/klaus/solarpositioning/Grena3.java b/src/main/java/net/e175/klaus/solarpositioning/Grena3.java
index cd5c7e4..4ef9f8f 100644
--- a/src/main/java/net/e175/klaus/solarpositioning/Grena3.java
+++ b/src/main/java/net/e175/klaus/solarpositioning/Grena3.java
@@ -112,11 +112,11 @@ public final class Grena3 {
         final double gamma = atan2(sH, cH * sPhi - sDelta * cPhi / cDelta);
 
         // refraction correction (disabled for silly parameter values)
-        final double deltaRe = (pressure < 0.0 || pressure > 3000.0 || t < -273 || t > 273) ?
+        final double deltaRe =
+                (temperature < -273 || temperature > 273 || pressure < 0 || pressure > 3000) ? 0.0 : (
                 ((eP > 0.0) ?
                         (0.08422 * (pressure / 1000)) / ((273.0 + temperature) * tan(eP + 0.003138 / (eP + 0.08919)))
-                        : 0.0)
-                : 0.0;
+                        : 0.0));
 
         final double z = PI / 2 - eP - deltaRe;
 
diff --git a/src/test/java/net/e175/klaus/solarpositioning/Grena3Test.java b/src/test/java/net/e175/klaus/solarpositioning/Grena3Test.java
index e3c5e81..454ab3e 100644
--- a/src/test/java/net/e175/klaus/solarpositioning/Grena3Test.java
+++ b/src/test/java/net/e175/klaus/solarpositioning/Grena3Test.java
@@ -23,8 +23,8 @@ public class Grena3Test {
         AzimuthZenithAngle result = Grena3.calculateSolarPosition(time,
                 toDegrees(0.73117), toDegrees(0.21787), 65, 1000, 20);
 
-        assertEquals(toDegrees(1.1338), result.getZenithAngle(), TOLERANCE / 10);
-        assertEquals(toDegrees(-0.059186 + PI) % 360.0, result.getAzimuth(), TOLERANCE / 10);
+        assertEquals(toDegrees(1.13381), result.getZenithAngle(), TOLERANCE / 10);
+        assertEquals(toDegrees(-0.0591845 + PI) % 360.0, result.getAzimuth(), TOLERANCE / 10);
     }
 
     @Test
