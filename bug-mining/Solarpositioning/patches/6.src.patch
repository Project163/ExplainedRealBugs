diff --git a/src/main/java/net/e175/klaus/solarpositioning/SPA.java b/src/main/java/net/e175/klaus/solarpositioning/SPA.java
index 54a1ead..7c04134 100644
--- a/src/main/java/net/e175/klaus/solarpositioning/SPA.java
+++ b/src/main/java/net/e175/klaus/solarpositioning/SPA.java
@@ -3,7 +3,6 @@ package net.e175.klaus.solarpositioning;
 import static java.lang.Math.*;
 
 import java.util.Calendar;
-import java.util.Date;
 import java.util.GregorianCalendar;
 import java.util.TimeZone;
 
@@ -21,7 +20,8 @@ import java.util.TimeZone;
  */
 public final class SPA {
 
-	private static final double SIN_HPRIME_0 = sin(toRadians(-0.8333));
+	private static final double HPRIME_0 = -0.8333;
+	private static final double SIN_HPRIME_0 = sin(toRadians(HPRIME_0));
 
 	private SPA() {
 	}
@@ -71,7 +71,7 @@ public final class SPA {
 
 		// calculate Earth heliocentric latitude, B
 		final double[] bTerms = calculateLBRTerms(jme, TERMS_B);
-		final double bDegrees = toDegrees(calculateLBRPolynomial(jme, bTerms));
+		final double bDegrees = limitDegreesTo360(toDegrees(calculateLBRPolynomial(jme, bTerms)));
 
 		// calculate Earth radius vector, R
 		final double[] rTerms = calculateLBRTerms(jme, TERMS_R);
@@ -177,9 +177,9 @@ public final class SPA {
 	}
 
 	public static GregorianCalendar[] calculateSunriseTransitSet(final GregorianCalendar day,
-													  final double latitude,
-													  final double longitude,
-													  final double deltaT) {
+																 final double latitude,
+																 final double longitude,
+																 final double deltaT) {
 		final GregorianCalendar dayStart = startOfDayUT(day);
 		final JulianDate jd = new JulianDate(dayStart, 0);
 
@@ -198,7 +198,7 @@ public final class SPA {
 
 		// A.2.2. Calculate the geocentric right ascension and declination at 0 TT for day before, same day, next day
 		final AlphaDelta[] alphaDeltas = new AlphaDelta[3];
-		for (int i = 0; i < 3; i++) {
+		for (int i = 0; i < alphaDeltas.length; i++) {
 			JulianDate currentJd = new JulianDate(jd.getJulianDate() + i - 1, 0);
 			double currentJme = currentJd.getJulianEphemerisMillennium();
 			AlphaDelta ad = calculateAlphaDelta(currentJme, deltaPsi, epsilonDegrees);
@@ -281,17 +281,15 @@ public final class SPA {
 
 		// A.2.14. Calculate the sunrise, R (in fraction of day)
 		final double r = m[1] +
-				(h[1] - hPrime[0]) /
+				(h[1] - HPRIME_0) /
 						(360.0 * cos(toRadians(alphaDeltaPrimes[1].delta)) * cos(phi) * sin(toRadians(hPrime[1])));
 
 		// A.2.15. Calculate the sunset, S (in fraction of day)
 		final double s = m[2] +
-				(h[2] - hPrime[0]) /
+				(h[2] - HPRIME_0) /
 						(360.0 * cos(toRadians(alphaDeltaPrimes[2].delta)) * cos(phi) * sin(toRadians(hPrime[2])));
 
-
-		Date baseTime = dayStart.getTime();
-
+		final long baseTime = dayStart.getTimeInMillis();
 		return new GregorianCalendar[]{
 				addFractionOfDay(baseTime, r, day.getTimeZone()),
 				addFractionOfDay(baseTime, t, day.getTimeZone()),
@@ -299,11 +297,11 @@ public final class SPA {
 		};
 	}
 
-	private static GregorianCalendar addFractionOfDay(Date baseDate, double fraction, TimeZone tz) {
+	private static GregorianCalendar addFractionOfDay(final long baseDate, final double fraction, final TimeZone tz) {
 		long addMillis = (long) (fraction * (24 * 60 * 60 * 1000));
-		Date newDate = new Date(baseDate.getTime() + addMillis);
+		long newDate = baseDate + addMillis;
 		GregorianCalendar newCalendar = new GregorianCalendar(tz);
-		newCalendar.setTime(newDate);
+		newCalendar.setTimeInMillis(newDate);
 		return newCalendar;
 	}
 
@@ -323,7 +321,6 @@ public final class SPA {
 		}
 	}
 
-
 	/**
 	 * Limit to 0..1 if absolute value > 2. Refer to A.2.10 in NREL report.
 	 */
@@ -335,7 +332,7 @@ public final class SPA {
 	private static AlphaDelta calculateAlphaDelta(double jme, double deltaPsi, double epsilonDegrees) {
 		// calculate Earth heliocentric latitude, B
 		final double[] bTerms = calculateLBRTerms(jme, TERMS_B);
-		final double bDegrees = toDegrees(calculateLBRPolynomial(jme, bTerms));
+		final double bDegrees = limitDegreesTo360(toDegrees(calculateLBRPolynomial(jme, bTerms)));
 
 		// calculate Earth radius vector, R
 		final double[] rTerms = calculateLBRTerms(jme, TERMS_R);
diff --git a/src/test/java/net/e175/klaus/solarpositioning/JulianDateTest.java b/src/test/java/net/e175/klaus/solarpositioning/JulianDateTest.java
index 297065f..186dfc7 100644
--- a/src/test/java/net/e175/klaus/solarpositioning/JulianDateTest.java
+++ b/src/test/java/net/e175/klaus/solarpositioning/JulianDateTest.java
@@ -12,7 +12,7 @@ import org.junit.Test;
 
 public class JulianDateTest {
 
-	private static final double TOLERANCE = 0.00001;
+	private static final double TOLERANCE = 0.0000001;
 
 	@Test
 	public void testConstructor() {
@@ -82,4 +82,11 @@ public class JulianDateTest {
 		assertEquals(0.0, julDate.getJulianDate(), TOLERANCE);
 	}
 
+	@Test
+	public void testJulianDays() {
+		JulianDate jd = new JulianDate(2452929.500000, 0);
+		assertEquals(0.03790554, jd.getJulianCentury(), TOLERANCE);
+		assertEquals(0.00379056, jd.getJulianEphemerisMillennium(), TOLERANCE);
+	}
+
 }
diff --git a/src/test/java/net/e175/klaus/solarpositioning/SPATest.java b/src/test/java/net/e175/klaus/solarpositioning/SPATest.java
index 6d0e911..330457f 100644
--- a/src/test/java/net/e175/klaus/solarpositioning/SPATest.java
+++ b/src/test/java/net/e175/klaus/solarpositioning/SPATest.java
@@ -22,8 +22,8 @@ public class SPATest {
 
 		AzimuthZenithAngle result = SPA.calculateSolarPosition(time, 39.742476, -105.1786, 1830.14, 67, 820, 11);
 
-		assertEquals(194.34024, result.getAzimuth(), TOLERANCE);
-		assertEquals(50.11162, result.getZenithAngle(), TOLERANCE);
+		assertEquals(194.340241, result.getAzimuth(), TOLERANCE/10);
+		assertEquals(50.111622, result.getZenithAngle(), TOLERANCE/10);
 	}
 
 	@Test
@@ -44,12 +44,12 @@ public class SPATest {
 
 		AzimuthZenithAngle result = SPA.calculateSolarPosition(time, -41, 0, 100, 0, 1000, 20);
 
-		assertEquals(359.086, result.getAzimuth(), TOLERANCE);
+		assertEquals(359.08592, result.getAzimuth(), TOLERANCE);
 		assertEquals(17.5658, result.getZenithAngle(), TOLERANCE);
 
 		result = SPA.calculateSolarPosition(time, -3, 0, 100, 0, 1000, 20);
 
-		assertEquals(180.7903, result.getAzimuth(), TOLERANCE);
+		assertEquals(180.790356, result.getAzimuth(), TOLERANCE);
 		assertEquals(20.4285, result.getZenithAngle(), TOLERANCE);
 	}
 
@@ -77,11 +77,9 @@ public class SPATest {
 		DateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
 		df.setTimeZone(time.getTimeZone());
 
-		for (GregorianCalendar re : res) {
-			System.out.println(df.format(re.getTime()));
-		}
-
-
+		assertEquals("2003-10-17T06:12:43", df.format(res[0].getTime()));
+		assertEquals("2003-10-17T11:46:04", df.format(res[1].getTime()));
+		assertEquals("2003-10-17T17:20:19", df.format(res[2].getTime()));
 	}
 
 }
