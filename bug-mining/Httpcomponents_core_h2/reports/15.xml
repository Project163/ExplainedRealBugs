<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-750] H2ConnPool creates too many conns under high load at initialization time</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-750</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;We are using httpcore5 5.2.1 and we observed that at application startup time, httpclient5 could create more than 1 conn per endpoint and in some cases, too many connections caused OOM issue since httpclient5 creates a pair of input/output buffer per conn.&lt;/p&gt;

&lt;p&gt;The regression is introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;, which made this change:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-core/commit/14caf43eae407c544161c7f92329e8beb42a3534&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/commit/14caf43eae407c544161c7f92329e8beb42a3534&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolEntry.session != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; callback.completed(poolEntry.session);
&#160; &#160; &#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; poolEntry.requestQueue.add(callback);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolEntry.sessionFuture != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; poolEntry.sessionFuture.isDone()) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; poolEntry.sessionFuture = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When poolEntry.sessionFuture.isDone() is true, the connection is already ready, but the existing logic will abandon it and create a new one, and under high load, this logic could create a lot of conns per endpoint, which consumes a lot of memory.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The proposed fix:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolEntry.session != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                callback.completed(poolEntry.session);
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                poolEntry.requestQueue.add(callback);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolEntry.sessionFuture != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; poolEntry.sessionFuture.isDone()) {
                    &lt;span class=&quot;code-comment&quot;&gt;// Check whether we should recreate a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; conn or not
&lt;/span&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                        poolEntry.session = poolEntry.sessionFuture.get();
                        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) {
                            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FutureCallback&amp;lt;IOSession&amp;gt; pendingCallback = poolEntry.requestQueue.poll();
                            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pendingCallback != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                                pendingCallback.completed(poolEntry.session);
                            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                                &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                            }
                        }
                    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Exception e) {
                        poolEntry.sessionFuture = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
                    }
                } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I am planning to cut a PR for this.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>Linux / Ubuntu / openjdk version &amp;quot;1.8.0_292&amp;quot;</environment>
        <key id="13538470">HTTPCORE-750</key>
            <summary>H2ConnPool creates too many conns under high load at initialization time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Gaojie_Liu">Gaojie Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Jun 2023 23:22:31 +0000</created>
                <updated>Wed, 14 Jun 2023 09:53:30 +0000</updated>
                            <resolved>Sun, 4 Jun 2023 18:11:34 +0000</resolved>
                                    <version>5.2.1</version>
                                    <fixVersion>5.2.2</fixVersion>
                                    <component>HttpCore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="17728513" author="JIRAUSER290700" created="Thu, 1 Jun 2023 23:40:58 +0000"  >&lt;p&gt;PR is here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-core/pull/408&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/pull/408&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17728604" author="olegk" created="Fri, 2 Jun 2023 07:16:06 +0000"  >&lt;p&gt;&amp;gt; When poolEntry.sessionFuture.isDone() is true, the connection is already ready, but the existing logic will abandon it and create a new one&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gaojie_Liu&quot; class=&quot;user-hover&quot; rel=&quot;Gaojie_Liu&quot;&gt;Gaojie_Liu&lt;/a&gt; I do not think this is correct. In the snippet above the pool discards the connection &lt;em&gt;request&lt;/em&gt;, not the connection itself. These are not the same.&lt;/p&gt;

&lt;p&gt;Regarding the proposed change. one &lt;em&gt;MUST NOT&lt;/em&gt; use a blocking call on a future inside a callback! `poolEntry.sessionFuture.get()` is wrong. It can potentially block the entire I/O reactor thread and all non-blocking sessions assigned to it. All of them.&lt;/p&gt;

&lt;p&gt;Please try to create a reproducer for the issue and let&apos;s try to find a better solution.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17728608" author="olegk" created="Fri, 2 Jun 2023 07:30:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gaojie_Liu&quot; class=&quot;user-hover&quot; rel=&quot;Gaojie_Liu&quot;&gt;Gaojie_Liu&lt;/a&gt; There is a race condition between the connection request thread and the I/O reactor thread that creates the connection and assigns it to the pool entry. The request can be marked as done but its completion callback has not been fully executed yet. Presently the pool immediately creates another connection request if the previous request has been marked as done but there is no connection assigned to the pool entry, which potentially leads to multiple connections getting created instead of one. This needs to be fixed.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17728836" author="JIRAUSER290700" created="Fri, 2 Jun 2023 17:41:39 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for looking at the PR and this problem.&lt;/p&gt;

&lt;p&gt;It will take some time to reproduce this issue since it is a race condition and it is not easy to be triggered in a simple unit test and under high load, we did see this conn storm behavior.&lt;/p&gt;

&lt;p&gt;Regarding calling `future.get()` in class: `AbstractIOSessionPool`, I understand it is not good in general, but the code in PR did the `isDone` check before calling `future.get()`:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolEntry.sessionFuture != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; poolEntry.sessionFuture.isDone()) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Check whether we should recreate a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; conn or not
&lt;/span&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; poolEntry.session = poolEntry.sessionFuture.get();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FutureCallback&amp;lt;IOSession&amp;gt; pendingCallback = poolEntry.requestQueue.poll();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pendingCallback != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; pendingCallback.completed(poolEntry.session);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Exception e) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; poolEntry.sessionFuture = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So in practice, the `future.get()` won&apos;t block, and if you still have a concern, I can modify the code to use a timed get:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
poolEntry.session = poolEntry.sessionFuture.get(1, TimeUnit.MILLISECONDS); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Actually, this is not my original approach.&lt;/p&gt;

&lt;p&gt;Originally, I was thinking to check whether the `sessionFuture` is failed or cancelled or not before creating a new conn, but `Future` doesn&apos;t provide an API to check whether the Future is failed or not and it only has an API: `isCancelled`, which is not good enough. `Future.get()` will cover both scenarios:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/httpcomponents-core/blob/master/httpcore5/src/main/java/org/apache/hc/core5/concurrent/BasicFuture.java#L70&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/blob/master/httpcore5/src/main/java/org/apache/hc/core5/concurrent/BasicFuture.java#L70&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;With this in mind, another way can be:&lt;br/&gt;
1. Use `BasicFuture` instead of `Future` for `poolEntry.sessionFuture`.&lt;/p&gt;

&lt;p&gt;2. Add a new method: `isFailed` to `BasicFuture`.&lt;/p&gt;

&lt;p&gt;3. `AbstractIOSessionPool` will use the following logic:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolEntry.sessionFuture != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; (poolEntry.sessionFuture.isCancelled() || poolEntry.sessionFuture.isFailed())) {
    &lt;span class=&quot;code-comment&quot;&gt;// Check whether we should recreate a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; conn or not
&lt;/span&gt;    poolEntry.sessionFuture = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which approach do you prefer?&lt;/p&gt;</comment>
                            <comment id="17728852" author="arturobernalg" created="Fri, 2 Jun 2023 19:25:55 +0000"  >&lt;p&gt;Maybe Instead of modifying &lt;tt&gt;BasicFuture&lt;/tt&gt; or relying on &lt;tt&gt;Future.get()&lt;/tt&gt;, we can &#160;add an additional boolean flag, &lt;tt&gt;sessionInProgress&lt;/tt&gt;, to &lt;tt&gt;PoolEntry&lt;/tt&gt;. This flag would indicate whether a session creation process is currently in progress.&lt;/p&gt;

&lt;p&gt;You could adjust the logic so that a new session will only be created if &lt;tt&gt;poolEntry.sessionFuture&lt;/tt&gt; is null and &lt;tt&gt;poolEntry.sessionInProgress&lt;/tt&gt; is false. Upon completion, failure, or cancellation of the session creation, we would set &lt;tt&gt;sessionInProgress&lt;/tt&gt; back to false.&lt;/p&gt;</comment>
                            <comment id="17728876" author="JIRAUSER290700" created="Fri, 2 Jun 2023 22:09:02 +0000"  >&lt;p&gt;Emm..&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arturobernalg&quot; class=&quot;user-hover&quot; rel=&quot;arturobernalg&quot;&gt;arturobernalg&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Currently, `AbstractIOSessionPool` only passes a callback to function: `connectSession`, and it doesn&apos;t have a direct access to `BasicFuture`, and if we want to maintain such flag in `PoolEntry`, I suppose we will need to update this flag in the calback, which will be synchronized by `PoolEntry` as other callback logic such as `poolEntry.session`, and it won&apos;t work.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t get the exact reason why we can&apos;t invoke `Future.get()` here after checking `isDone` flag, can you elaborate? If there is a real concern, why `get(1, TimeUnit.MILLISECONDS)` won&apos;t suffice?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17728923" author="arturobernalg" created="Sat, 3 Jun 2023 06:22:52 +0000"  >&lt;p&gt;Calling &lt;tt&gt;get(1, TimeUnit.MILLISECONDS)&lt;/tt&gt; does not fundamentally change this. It just reduces the potential blocking time to a very small amount. While this might reduce the probability of experiencing the aforementioned issues, it does not eliminate it. Moreover, if the operation takes longer than 1 millisecond to complete, &lt;tt&gt;get(1, TimeUnit.MILLISECONDS)&lt;/tt&gt;will throw a &lt;tt&gt;TimeoutException&lt;/tt&gt;, which would need to be handled.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;As for the &lt;tt&gt;sessionInProgress&lt;/tt&gt; flag, you&apos;re correct that it would need to be updated within the callback in a thread-safe manner. This is not fundamentally different from other callback logic that updates shared state (such as &lt;tt&gt;poolEntry.session&lt;/tt&gt;), and it does not inherently prevent the solution from working. Of course this is &#160;just an idea&lt;/p&gt;</comment>
                            <comment id="17729038" author="JIRAUSER290700" created="Sun, 4 Jun 2023 04:55:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arturobernalg&quot; class=&quot;user-hover&quot; rel=&quot;arturobernalg&quot;&gt;arturobernalg&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;So the condition check: `isDone()` before `future.get()` is not good enough to guarantee non-blocking?&lt;/p&gt;

&lt;p&gt;If timeout does happen, the fix will create a new conn instead.&lt;/p&gt;</comment>
                            <comment id="17729054" author="olegk" created="Sun, 4 Jun 2023 08:35:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gaojie_Liu&quot; class=&quot;user-hover&quot; rel=&quot;Gaojie_Liu&quot;&gt;Gaojie_Liu&lt;/a&gt;&#160; Could you please try the following change-set and let me know if improves the situation?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ok2c/httpcomponents-core/commit/3969ff25778ba2137329e5e0cdef386f6736b073&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ok2c/httpcomponents-core/commit/3969ff25778ba2137329e5e0cdef386f6736b073&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17729088" author="JIRAUSER290700" created="Sun, 4 Jun 2023 18:02:24 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for the follow-up!&lt;/p&gt;

&lt;p&gt;I ran your patch in our env, and the fix worked as expected!&lt;/p&gt;



&lt;p&gt;Can you merge the fix into 5.2.1 and cut a new release on top of it?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Gaojie&lt;/p&gt;</comment>
                            <comment id="17729089" author="jira-bot" created="Sun, 4 Jun 2023 18:07:52 +0000"  >&lt;p&gt;Commit 9feb66cca6bb7d54b82337502acdccef760526ad in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=9feb66cca&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=9feb66cca&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17729093" author="olegk" created="Sun, 4 Jun 2023 18:11:34 +0000"  >&lt;p&gt;Fix committed to master.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17729094" author="jira-bot" created="Sun, 4 Jun 2023 18:19:08 +0000"  >&lt;p&gt;Commit ca7e62854322ae5e38f9d090aab1a6750f9eb406 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=ca7e62854&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=ca7e62854&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17729102" author="jira-bot" created="Sun, 4 Jun 2023 18:46:19 +0000"  >&lt;p&gt;Commit 71886ab1fd4c1ed924d7df5a9777e1412478778b in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=71886ab1f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=71886ab1f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17729112" author="JIRAUSER290700" created="Sun, 4 Jun 2023 21:14:15 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for merging the fix.&lt;/p&gt;

&lt;p&gt;Will&#160; the `5.2.2` release be cut any time soon?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Gaojie&lt;/p&gt;</comment>
                            <comment id="17729115" author="michael-o" created="Sun, 4 Jun 2023 21:20:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gaojie_Liu&quot; class=&quot;user-hover&quot; rel=&quot;Gaojie_Liu&quot;&gt;Gaojie_Liu&lt;/a&gt;, you can sponsor it...&lt;/p&gt;</comment>
                            <comment id="17729124" author="JIRAUSER290700" created="Mon, 5 Jun 2023 00:18:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael-o&quot; class=&quot;user-hover&quot; rel=&quot;michael-o&quot;&gt;michael-o&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;What are ways to sponsor it?&lt;/p&gt;

&lt;p&gt;I can check with my company to explore these opportunities.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Gaojie&lt;/p&gt;</comment>
                            <comment id="17729128" author="garydgregory" created="Mon, 5 Jun 2023 01:08:24 +0000"  >&lt;p&gt;If Oleg is not available to cut a release candidate, I can probably do it within a week or two.&lt;/p&gt;</comment>
                            <comment id="17729377" author="olegk" created="Mon, 5 Jun 2023 16:33:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gaojie_Liu&quot; class=&quot;user-hover&quot; rel=&quot;Gaojie_Liu&quot;&gt;Gaojie_Liu&lt;/a&gt; I will try to find time to cut a release from 5.2.x branch in the coming weeks but HttpClient 5.3.x is presently more important as far as I am concerned, so do not take it as a promise.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17729387" author="JIRAUSER290700" created="Mon, 5 Jun 2023 17:35:25 +0000"  >&lt;p&gt;Got it, thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; !&lt;/p&gt;</comment>
                            <comment id="17729404" author="michael-o" created="Mon, 5 Jun 2023 18:29:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gaojie_Liu&quot; class=&quot;user-hover&quot; rel=&quot;Gaojie_Liu&quot;&gt;Gaojie_Liu&lt;/a&gt;, maybe you can incentivize &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; with some amount to do the release ASAP.&lt;/p&gt;</comment>
                            <comment id="17731609" author="jira-bot" created="Mon, 12 Jun 2023 13:14:36 +0000"  >&lt;p&gt;Commit d869b87749ef46f28d8d09985f9ef3048f7204e4 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=d869b8774&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=d869b8774&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17731944" author="jira-bot" created="Tue, 13 Jun 2023 07:59:31 +0000"  >&lt;p&gt;Commit d869b87749ef46f28d8d09985f9ef3048f7204e4 in httpcomponents-core&apos;s branch refs/heads/dependabot/maven/io.reactivex.rxjava3-rxjava-3.1.6 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=d869b8774&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=d869b8774&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17732098" author="jira-bot" created="Tue, 13 Jun 2023 13:46:45 +0000"  >&lt;p&gt;Commit 24a84a0e2f708bfe58e12402f9517a820f6163e2 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=24a84a0e2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=24a84a0e2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17732101" author="jira-bot" created="Tue, 13 Jun 2023 13:55:01 +0000"  >&lt;p&gt;Commit 24a84a0e2f708bfe58e12402f9517a820f6163e2 in httpcomponents-core&apos;s branch refs/heads/dependabot/maven/io.reactivex.rxjava3-rxjava-3.1.6 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=24a84a0e2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=24a84a0e2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17732114" author="jira-bot" created="Tue, 13 Jun 2023 14:23:22 +0000"  >&lt;p&gt;Commit 7624ed571214b9d4bc87d18e1f2f4f6f3cf30260 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=7624ed571&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=7624ed571&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17732118" author="jira-bot" created="Tue, 13 Jun 2023 14:25:27 +0000"  >&lt;p&gt;Commit 7624ed571214b9d4bc87d18e1f2f4f6f3cf30260 in httpcomponents-core&apos;s branch refs/heads/dependabot/maven/io.reactivex.rxjava3-rxjava-3.1.6 from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=7624ed571&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=7624ed571&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                            <comment id="17732476" author="jira-bot" created="Wed, 14 Jun 2023 09:53:30 +0000"  >&lt;p&gt;Commit a091322f7fb5292d63609855596403cc00376eff in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=a091322f7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=a091322f7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-750&quot; title=&quot;H2ConnPool creates too many conns under high load at initialization time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-750&quot;&gt;&lt;del&gt;HTTPCORE-750&lt;/del&gt;&lt;/a&gt;: Fixed a defect causing AbstractIOSessionPool to create multiple connections under high load at initialization time due to a race condition&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="13395054">HTTPCORE-683</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ia40:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>