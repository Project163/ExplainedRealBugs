<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-577] Random connection resets under load</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-577</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;It appears that under load a hc5 server will send an unexpected connection reset to the client, here&apos;s a sample code that triggers the issue:&#160;&lt;a href=&quot;https://github.com/rferreira/hc5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rferreira/hc5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>openjdk 11.0.2 2019-01-15&lt;br/&gt;
OpenJDK Runtime Environment AdoptOpenJDK (build 11.0.2+9)&lt;br/&gt;
OpenJDK 64-Bit Server VM AdoptOpenJDK (build 11.0.2+9, mixed mode, sharing)&lt;br/&gt;
&lt;br/&gt;
macOS&lt;br/&gt;
</environment>
        <key id="13233960">HTTPCORE-577</key>
            <summary>Random connection resets under load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10008">Information Provided</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cleverfoo">Rafael Ferreira</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 May 2019 13:34:56 +0000</created>
                <updated>Mon, 20 May 2019 13:52:34 +0000</updated>
                            <resolved>Sun, 19 May 2019 10:54:14 +0000</resolved>
                                    <version>5.0-beta7</version>
                                                    <component>HttpCore NIO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16842255" author="cleverfoo" created="Fri, 17 May 2019 15:32:17 +0000"  >&lt;p&gt;Updated title and comment since the header size was a red herring, I&apos;ll keep digging into this and try to see if I can identify the cause.&#160;&lt;/p&gt;</comment>
                            <comment id="16843380" author="jira-bot" created="Sun, 19 May 2019 10:14:04 +0000"  >&lt;p&gt;Commit 6bd4bdb8eeabe1458e0029fe9cb0ab61fddc86c5 in httpcomponents-core&apos;s branch refs/heads/bug-fixes from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=6bd4bdb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=6bd4bdb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-577&quot; title=&quot;Random connection resets under load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-577&quot;&gt;&lt;del&gt;HTTPCORE-577&lt;/del&gt;&lt;/a&gt;: server side HTTP protocol negotiator to propagate exceptions to the i/o event handler associated with the i/o session&lt;/p&gt;</comment>
                            <comment id="16843391" author="olegk" created="Sun, 19 May 2019 10:53:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cleverfoo&quot; class=&quot;user-hover&quot; rel=&quot;cleverfoo&quot;&gt;cleverfoo&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;1. The culprit is this line in your message exchange handler that causes a NPE.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
requestMessage.getBody().close();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;GET messages issued by the benchmark enclose no request entity&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;GET / HTTP/1.0
Connection: Keep-Alive
Host: localhost:8080
User-Agent: ApacheBench/2.3
Accept: */*

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Therefore &lt;tt&gt;requestMessage#getBody&lt;/tt&gt; return null and the code above causes an NPE.&lt;/p&gt;

&lt;p&gt;2. The response producer supplied by the exchange handler does not actually do much in case of an exception, so exceptions get easily overlooked.  At the very least the response handler should log or print the exception.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
responseTrigger.submitResponse(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BasicResponseProducer(resp) {

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void failed(Exception cause) {
        cause.printStackTrace();
    }

}, context);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3. On top of everything there was a bug in the server side HTTP protocol negotiator causing the handler failure to propagate exceptions to the i/o event handler associated with the i/o session. I&apos;ll commit the fix to the master shortly.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/httpcomponents-core/commit/6bd4bdb8eeabe1458e0029fe9cb0ab61fddc86c5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/commit/6bd4bdb8eeabe1458e0029fe9cb0ab61fddc86c5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="16843980" author="jira-bot" created="Mon, 20 May 2019 13:52:34 +0000"  >&lt;p&gt;Commit ca4dce3bdb65b53681b94c1ddfa8e607a05bf425 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=ca4dce3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=ca4dce3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-577&quot; title=&quot;Random connection resets under load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-577&quot;&gt;&lt;del&gt;HTTPCORE-577&lt;/del&gt;&lt;/a&gt;: server side HTTP protocol negotiator to propagate exceptions to the i/o event handler associated with the i/o session&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02sps:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>