<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:35:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-334] DefaultSerializer does not load classes from the ContextClassLoader, causing RememberMe to not work</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-334</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;RememberMe functionality does not work because Shiro is in a different class loader than the RememberMe serializable class,&lt;/p&gt;

&lt;p&gt;The only thing that needs to change is the resolveClass() function,&lt;br/&gt;
and it should use Thread.currentThread().getContextClassLoader().loadClass() to load the class,&lt;br/&gt;
as that works in all cases and all class loader configurations.&lt;/p&gt;

&lt;p&gt;I fixed this in my code by overriding DefaultSerializer, but this should be the default behavior:&lt;/p&gt;

&lt;p&gt;    private static class Serialize&amp;lt;T&amp;gt; extends DefaultSerializer&amp;lt;T&amp;gt; &lt;br/&gt;
    {&lt;br/&gt;
        @Override&lt;br/&gt;
        public T deserialize(byte[] serialized) throws SerializationException&lt;br/&gt;
        {&lt;br/&gt;
            if (serialized == null)&lt;/p&gt;
            {
                String msg = &quot;argument cannot be null.&quot;;
                throw new IllegalArgumentException(msg);
            }
&lt;p&gt;            ByteArrayInputStream bais = new ByteArrayInputStream(serialized);&lt;br/&gt;
            BufferedInputStream bis = new BufferedInputStream(bais);&lt;br/&gt;
            try&lt;br/&gt;
            {&lt;br/&gt;
                ObjectInputStream ois = new ObjectInputStream(bis)&lt;br/&gt;
                {&lt;br/&gt;
                    @Override&lt;br/&gt;
                    public Class resolveClass(ObjectStreamClass desc) throws ClassNotFoundException&lt;/p&gt;
                    {
                        // ************ THIS IS THE LINE THAT WAS CHANGED ********************
                        return Thread.currentThread().getContextClassLoader().loadClass(desc.getName());
                    }
&lt;p&gt;                };&lt;br/&gt;
                @SuppressWarnings(&lt;/p&gt;
{&quot;unchecked&quot;}
&lt;p&gt;)&lt;br/&gt;
                T deserialized = (T) ois.readObject();&lt;br/&gt;
                ois.close();&lt;br/&gt;
                return deserialized;&lt;br/&gt;
            } catch (Exception e)&lt;/p&gt;
            {
                String msg = &quot;Unable to deserialze argument byte array.&quot;;
                throw new SerializationException(msg, e);
            }
&lt;p&gt;        }&lt;br/&gt;
    }    &lt;/p&gt;</description>
                <environment>JEE Server (Glassfish) where Shiro JAR files are not in the same ClassLoader as the Application JARs</environment>
        <key id="12535181">SHIRO-334</key>
            <summary>DefaultSerializer does not load classes from the ContextClassLoader, causing RememberMe to not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lhazlewood">Les Hazlewood</assignee>
                                    <reporter username="lprimak">Lenny Primak</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Dec 2011 17:31:45 +0000</created>
                <updated>Tue, 24 Jan 2012 01:11:43 +0000</updated>
                            <resolved>Thu, 15 Dec 2011 00:01:34 +0000</resolved>
                                    <version>1.1.0</version>
                    <version>1.2.0</version>
                    <version>1.3.0</version>
                    <version>2.0.0-alpha</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>Authentication (log-in)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13169831" author="lhazlewood" created="Thu, 15 Dec 2011 00:01:34 +0000"  >&lt;p&gt;Resolved in trunk, rev. 1214564.  &lt;/p&gt;

&lt;p&gt;Created a new ClassResolvingObjectInputStream: &lt;a href=&quot;http://svn.apache.org/repos/asf/shiro/trunk/core/src/main/java/org/apache/shiro/io/ClassResolvingObjectInputStream.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/repos/asf/shiro/trunk/core/src/main/java/org/apache/shiro/io/ClassResolvingObjectInputStream.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And changed the DefaultSerializer implementation (line 75) to use it instead of ObjectInputStream.&lt;/p&gt;

&lt;p&gt;Please re-open if there are any issues with the committed solution.&lt;/p&gt;</comment>
                            <comment id="13191757" author="lhazlewood" created="Tue, 24 Jan 2012 01:11:43 +0000"  >&lt;p&gt;Closing with the 1.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>220865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i102nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>208565</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>