<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:35:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-586] Can&apos;t Search For Groups In Active Directory Without A System User</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-586</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;From &lt;a href=&quot;http://stackoverflow.com/questions/39518150/how-do-i-search-for-ad-groups-in-shiro-without-a-system-user&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/39518150/how-do-i-search-for-ad-groups-in-shiro-without-a-system-user&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I can authenticate with the ActiveDirectoryRealm but I can&apos;t search for groups without having a systemUser.&lt;/p&gt;

&lt;p&gt;Most often, clients of my application don&apos;t have the system user/password and the admins don&apos;t like giving it out so they can&apos;t configure it properly.&lt;/p&gt;

&lt;p&gt;Spring Security and GUI clients let you use the username and password that was used to log in with to search for the groups.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13005802">SHIRO-586</key>
            <summary>Can&apos;t Search For Groups In Active Directory Without A System User</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="opticyclic">opticyclic</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Sep 2016 00:32:16 +0000</created>
                <updated>Fri, 21 Oct 2016 14:53:55 +0000</updated>
                            <resolved>Fri, 21 Oct 2016 14:53:55 +0000</resolved>
                                                    <fixVersion>1.4.0-RC2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15518449" author="opticyclic" created="Sat, 24 Sep 2016 05:25:23 +0000"  >&lt;p&gt;In order to do this with custom code you need to do something like the following pseudo-code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomActiveDirectoryRealm &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ActiveDirectoryRealm {

  /**
   * Done during the log in process
   */
  @Override
  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; AuthenticationInfo queryForAuthenticationInfo(AuthenticationToken token, LdapContextFactory ldapContextFactory) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; NamingException {
    SimpleAuthenticationInfo authenticationInfo = (SimpleAuthenticationInfo)&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.queryForAuthenticationInfo(token, ldapContextFactory);
    getRoleNames;
    createCustomPrincipal;
    addRoleNamesToCustomPrincipal;
    addPrincipalToAuthInfo;

    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; authenticationInfo;
  }

  /**
   * Done during checks &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; hasRole
   */
  @Override
  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; AuthorizationInfo queryForAuthorizationInfo(PrincipalCollection principals, LdapContextFactory ldapContextFactory) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; NamingException {
    getAvailablePrincipal(principals);
    getRoleNamesFromCustomPrincipal;

    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; buildAuthorizationInfo(roleNames);
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, the key method to get the role names from active directory is private:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.shiro.realm.activedirectory.ActiveDirectoryRealm
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getRoleNamesForUser(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; username, LdapContext ldapContext) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; NamingException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Right now, the only option seems to be to copy the code into the subclass &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If this method was protected it would make sub-classing easier.&lt;/p&gt;

&lt;p&gt;Obviously, it would be a better if this didn&apos;t have to be custom code at all and the main ActiveDirectoryRealm could bind without a system user; but for now, changing from private to protected is a very small change to make this workable.&lt;/p&gt;</comment>
                            <comment id="15518511" author="githubbot" created="Sat, 24 Sep 2016 06:16:14 +0000"  >&lt;p&gt;GitHub user opticyclic opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/shiro/pull/38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/shiro/pull/38&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SHIRO-586&quot; title=&quot;Can&amp;#39;t Search For Groups In Active Directory Without A System User&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SHIRO-586&quot;&gt;&lt;del&gt;SHIRO-586&lt;/del&gt;&lt;/a&gt; - Can&apos;t Search For Groups In Active Directory Without A System User&lt;/p&gt;

&lt;p&gt;    Change getRoleNamesForUser from private to protected so that it can be used in sub-classes.&lt;br/&gt;
    This will enable implementing a custom Realm (that sub-classes ActiveDirectoryRealm) able to access groups/roles without needing a system user.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/opticyclic/shiro&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/opticyclic/shiro&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SHIRO-586&quot; title=&quot;Can&amp;#39;t Search For Groups In Active Directory Without A System User&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SHIRO-586&quot;&gt;&lt;del&gt;SHIRO-586&lt;/del&gt;&lt;/a&gt;_NoSystemUser&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/shiro/pull/38.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/shiro/pull/38.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #38&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 71c73847c14e39a1d671fbef83652008a8ef2508&lt;br/&gt;
Author: andrewmorgan &amp;lt;andrew.morgan@formicary.net&amp;gt;&lt;br/&gt;
Date:   2016-09-24T06:11:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SHIRO-586&quot; title=&quot;Can&amp;#39;t Search For Groups In Active Directory Without A System User&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SHIRO-586&quot;&gt;&lt;del&gt;SHIRO-586&lt;/del&gt;&lt;/a&gt; - Change getRoleNamesForUser from private to protected so that it can be used in sub-classes&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15541462" author="githubbot" created="Mon, 3 Oct 2016 03:52:52 +0000"  >&lt;p&gt;Github user opticyclic closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/shiro/pull/38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/shiro/pull/38&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33ryn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>