<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:35:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-394] PropertiesRealm reloading not working when loading from file</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-394</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;I use a PropertiesRealm with a file url. This works fine when initially loading the properties file. Yet I was puzzled to find out that reloading does not work.&lt;/p&gt;

&lt;p&gt;I debugged and found the problem:&lt;br/&gt;
First of all the method isFileModified() checks for the lastModified date. Yet this returns 0 if the file does not exist. This is always the case when using the prefix &quot;file:&quot;. Therefore the file was never reloaded because the reload file was checking the last modfied date of a file that was never there.&lt;/p&gt;

&lt;p&gt;I have several problems with that:&lt;br/&gt;
1. Frankly speaking has anyone ever tested that stuff? To me it does not look like that and I think Shiro can do better.&lt;br/&gt;
2. The isModified method should react if the file is not existing (any more). Because maybe someone deleted in by accident which causes problems for the next startup.&lt;br/&gt;
3. The initial file loading and the reloading should use the same code. So at least then its clear that if the initial load succeeds so does the reloading.&lt;/p&gt;

&lt;p&gt;The quick fix is pretty straightforward - just remove the prefix &quot;file:&quot; from the resource path::&lt;br/&gt;
    private boolean isFileModified() {&lt;br/&gt;
        File propertyFile = new File(ResourceUtils.stripPrefix(this.resourcePath));&lt;br/&gt;
        long currentLastModified = propertyFile.lastModified();&lt;br/&gt;
        if (currentLastModified &amp;gt; this.fileLastModified) &lt;/p&gt;
{
            this.fileLastModified = currentLastModified;
            return true;
        }
&lt;p&gt; else &lt;/p&gt;
{
            return false;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;I will hopefully be able to supply a patch soon.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Jan&lt;/p&gt;</description>
                <environment>All</environment>
        <key id="12614573">SHIRO-394</key>
            <summary>PropertiesRealm reloading not working when loading from file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="remast">Jan Stamer</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Nov 2012 20:23:11 +0000</created>
                <updated>Fri, 15 Jul 2016 14:56:14 +0000</updated>
                            <resolved>Sat, 4 May 2013 22:59:18 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.2.2</fixVersion>
                                    <component>Realms </component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13494178" author="lhazlewood" created="Fri, 9 Nov 2012 18:18:37 +0000"  >&lt;p&gt;Hi Jan,&lt;/p&gt;

&lt;p&gt;Your continued help with these issues is greatly appreciated.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254062</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0eicn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>82735</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>