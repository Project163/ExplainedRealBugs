<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:34:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-115] ActiveDirectoryRealm might by vulnerable to LDAP search code injection</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-115</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;When searching for a userName within getRoleNamesForUser, the search filter is built by inserting the literal value from userName. Two potential problems might arise: userName might contain (deliberately crafted) LDAP syntax elements that could be used to affect the search. Permissible user principal names within AD (e.g. &quot;A(1&quot;) might be rejected due to syntax problems (even some Microsoft software packages appear to be quick-and-dirty here - see note at bottom of &lt;a href=&quot;http://technet.microsoft.com/en-us/library/cc730634(WS.10).aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://technet.microsoft.com/en-us/library/cc730634(WS.10).aspx&lt;/a&gt;) .&lt;/p&gt;

&lt;p&gt;This potential vulnerability can easily be fixed by using search parameters instead of literals  (which should be considered good style anyway). The actual chance for an exploit appears to be very remote, but hackers are so creative &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;// vulnerable to injection String searchFilter = &quot;(&amp;amp;(objectClass=*)(userPrincipalName=&quot; + userPrincipalName + &quot;))&quot;;&lt;br/&gt;
// vulnerable to injection NamingEnumeration answer = ldapContext.search(searchBase, searchFilter, searchCtls);&lt;/p&gt;

&lt;p&gt;        String searchFilter = &quot;(&amp;amp;(objectClass=*)(userPrincipalName=&lt;/p&gt;
{0}
&lt;p&gt;))&quot;;&lt;br/&gt;
        Object[] searchArguments = new Object[] &lt;/p&gt;
{userPrincipalName}
&lt;p&gt;;&lt;br/&gt;
        NamingEnumeration answer = ldapContext.search(searchBase, searchFilter, searchArguments, searchCtls);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12441814">SHIRO-115</key>
            <summary>ActiveDirectoryRealm might by vulnerable to LDAP search code injection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lhazlewood">Les Hazlewood</assignee>
                                    <reporter username="rsaddey">Reiner Saddey</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Nov 2009 09:56:28 +0000</created>
                <updated>Fri, 11 Jun 2010 22:00:41 +0000</updated>
                            <resolved>Mon, 7 Dec 2009 16:29:50 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Authentication (log-in)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12786977" author="lhazlewood" created="Mon, 7 Dec 2009 16:29:50 +0000"  >&lt;p&gt;Committed to rev. 887987.  Please test further and re-open if you see any problems.&lt;/p&gt;</comment>
                            <comment id="12878060" author="lhazlewood" created="Fri, 11 Jun 2010 22:00:41 +0000"  >&lt;p&gt;Closing all resolved issues due to a successful 1.0.0-incubating release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>174850</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 24 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i10abb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>209805</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>