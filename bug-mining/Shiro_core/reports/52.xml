<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:35:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-305] Connect to a SSL secured LDAP</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-305</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;Configuration for connecting the Shiro framework with a SSL secured LDAP (LDAPv2 &amp;amp; LDAPv3 on SSLv3 port) fails.&lt;/p&gt;

&lt;p&gt;Parameters for LDAP in the shiro.ini file:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;&lt;br/&gt;
...&lt;br/&gt;
ldapRealm.contextFactory.environment&lt;span class=&quot;error&quot;&gt;&amp;#91;java.naming.security.protocol&amp;#93;&lt;/span&gt; = ssl&lt;br/&gt;
ldapRealm.contextFactory.environment&lt;span class=&quot;error&quot;&gt;&amp;#91;com.sun.jndi.ldap.connect.pool.protocol&amp;#93;&lt;/span&gt; = plain ssl&lt;br/&gt;
ldapRealm.contextFactory.environment&lt;span class=&quot;error&quot;&gt;&amp;#91;com.sun.jndi.ldap.connect.pool&amp;#93;&lt;/span&gt; = true&lt;/p&gt;

&lt;p&gt;These entries lead to following error message:&lt;/p&gt;

&lt;p&gt;org.apache.shiro.config.ConfigurationException: Map property value &lt;span class=&quot;error&quot;&gt;&amp;#91;ssl&amp;#93;&lt;/span&gt; contained key-value pair token &lt;span class=&quot;error&quot;&gt;&amp;#91;ssl&amp;#93;&lt;/span&gt; that does not properly split to a single key and pair.  This must be the case for all map entries. &lt;/p&gt;</description>
                <environment>Windows 7, Tomcat 6.x</environment>
        <key id="12510407">SHIRO-305</key>
            <summary>Connect to a SSL secured LDAP</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lhazlewood">Les Hazlewood</assignee>
                                    <reporter username="pdiefent">Peter Diefenth&#228;ler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Jun 2011 07:25:42 +0000</created>
                <updated>Tue, 24 Jan 2012 01:11:46 +0000</updated>
                            <resolved>Sat, 7 Jan 2012 03:41:15 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>Realms </component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13049810" author="lhazlewood" created="Wed, 15 Jun 2011 15:23:22 +0000"  >&lt;p&gt;I wonder if BeanUtils is interpreting the text inside the brackets as an OGNL expression thinking it should navigate an object graph (like the other properties).  We&apos;ll have to investigate how to ensure they are interpreted as Strings.  Thanks for the issue Peter.&lt;/p&gt;</comment>
                            <comment id="13071038" author="aatos" created="Tue, 26 Jul 2011 11:07:08 +0000"  >&lt;p&gt;There&apos;s a workaround if you can use spring integration. Configure your securitymanager, realm etc beans in and set the environment variables as a map property on the contextfactory bean.&lt;/p&gt;</comment>
                            <comment id="13163440" author="jcmuller" created="Tue, 6 Dec 2011 08:35:54 +0000"  >&lt;p&gt;I&apos;m new to shiro so I might have missed something, but it looks like the problem is larger than just the key/value tokenization.&lt;/p&gt;

&lt;p&gt;My use case is Vaadin +  Shiro + LDAP + SSL.&lt;/p&gt;

&lt;p&gt;The following configuration will work:&lt;br/&gt;
-----------------------------------------------------&lt;br/&gt;
#Config A&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;&lt;br/&gt;
 ldapRealm = org.apache.shiro.realm.ldap.JndiLdapRealm&lt;br/&gt;
 ldapRealm.userDnTemplate = &lt;/p&gt;
{user-dn-string}&lt;br/&gt;
&lt;br/&gt;
#this line has to be the first in the contextFactory configuration&lt;br/&gt;
# because it wipes out the enironment in ldapRealm.contextFactory&lt;br/&gt;
 ldapRealm.contextFactory.environment = &quot;java.naming.security.protocol&quot;:&quot;ssl&quot;,&quot;java.naming.referral&quot;:&quot;follow&quot;&lt;br/&gt;
&lt;br/&gt;
 ldapRealm.contextFactory.url = ldaps://{ldap-host}:{ldap-port}&lt;br/&gt;
 ldapRealm.contextFactory.authenticationMechanism = none&lt;br/&gt;
&lt;br/&gt;
The following will not work:&lt;br/&gt;
---------------------------------------&lt;br/&gt;
#Config B&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;&lt;br/&gt;
 ldapRealm = org.apache.shiro.realm.ldap.JndiLdapRealm&lt;br/&gt;
 ldapRealm.userDnTemplate = {user-dn-string}

&lt;p&gt;#this line has to be the first in the contextFactory configuration&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;because it wipes out the enironment in ldapRealm.contextFactory&lt;br/&gt;
 ldapRealm.contextFactory.environment = &quot;java.naming.security.protocol&quot;:&quot;ssl&quot;&lt;br/&gt;
 ldapRealm.contextFactory.environment = &quot;java.naming.referral&quot;:&quot;follow&quot;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt; ldapRealm.contextFactory.url = ldaps://&lt;/p&gt;
{ldap-host}:{ldap-port}&lt;br/&gt;
 ldapRealm.contextFactory.authenticationMechanism = none&lt;br/&gt;
&lt;br/&gt;
Neither will this:&lt;br/&gt;
-----------------------&lt;br/&gt;
#Config C&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;&lt;br/&gt;
 ldapRealm = org.apache.shiro.realm.ldap.JndiLdapRealm&lt;br/&gt;
 ldapRealm.userDnTemplate = {user-dn-string}&lt;br/&gt;
&lt;br/&gt;
 ldapRealm.contextFactory.url = ldaps://{ldap-host}
&lt;p&gt;:&lt;/p&gt;
{ldap-port}
&lt;p&gt; ldapRealm.contextFactory.authenticationMechanism = none&lt;/p&gt;

&lt;p&gt;#this line has to be the first in the contextFactory configuration&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;because it wipes out the enironment in ldapRealm.contextFactory&lt;br/&gt;
 ldapRealm.contextFactory.environment = &quot;java.naming.security.protocol&quot;:&quot;ssl&quot;,&quot;java.naming.referral&quot;:&quot;follow&quot;&lt;/li&gt;
&lt;/ol&gt;



&lt;p&gt;There are two problems:&lt;br/&gt;
1. The string tokenizer for maps doesn&apos;t deal with the documented beanProperty&lt;span class=&quot;error&quot;&gt;&amp;#91;key&amp;#93;&lt;/span&gt;=value syntax properly.  It does work properly with the beanProperty = key:value I use above.&lt;br/&gt;
2. ldapRealm.contextFactory.environment call JndiLdapContextFactory.setEnvironment(...) which wipes out any environment variables stored there currently.  This is why Config A and Config C doesn&apos;t.&lt;/p&gt;

&lt;p&gt;Issue 1 seems best fixed with a change in the documentation.&lt;br/&gt;
Issue 2 should either be much better documented (removing erroneous documentation) or there should be a mergeEnvironment that gets used in place of setEnvironment.&lt;/p&gt;

&lt;p&gt;I&apos;d be happy to provide a documentation patch for both.  I don&apos;t have time to do the mergeEnvironment patch of sufficient quality.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Jeff&lt;/p&gt;</comment>
                            <comment id="13181799" author="lhazlewood" created="Sat, 7 Jan 2012 03:41:15 +0000"  >&lt;p&gt;Documentation doesn&apos;t need to be changed - it now works as expected, i.e.&lt;/p&gt;

&lt;p&gt;ldapRealm.contextFactory.environment&lt;span class=&quot;error&quot;&gt;&amp;#91;key&amp;#93;&lt;/span&gt; = value&lt;/p&gt;

&lt;p&gt;will now work.&lt;/p&gt;</comment>
                            <comment id="13181800" author="lhazlewood" created="Sat, 7 Jan 2012 03:41:35 +0000"  >&lt;p&gt;also note that this solution allows you to append to the environment map without overwriting it.&lt;/p&gt;</comment>
                            <comment id="13191769" author="lhazlewood" created="Tue, 24 Jan 2012 01:11:46 +0000"  >&lt;p&gt;Closing with the 1.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66941</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1022f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>208469</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>