<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:34:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-182] SimpleSession cannot be deserialized</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-182</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;org.apache.shiro.session.mgt.SimpleSession fails deserialization with the following error:&lt;/p&gt;

&lt;p&gt;	at java.io.ObjectInputStream$BlockDataInputStream.readByte(ObjectInputStream.java:2666)&lt;br/&gt;
	at java.io.ObjectInputStream$BlockDataInputStream.readUTFChar(ObjectInputStream.java:3058)&lt;br/&gt;
	at java.io.ObjectInputStream$BlockDataInputStream.readUTFBody(ObjectInputStream.java:2955)&lt;br/&gt;
	at java.io.ObjectInputStream$BlockDataInputStream.readUTF(ObjectInputStream.java:2764)&lt;br/&gt;
	at java.io.ObjectInputStream.readUTF(ObjectInputStream.java:1032)&lt;br/&gt;
	at org.apache.shiro.session.mgt.SimpleSession.readObject(SimpleSession.java:481)&lt;/p&gt;

&lt;p&gt;There is a problem with the way the &apos;expired&apos; flag is managed. In writeObject the &apos;expired&apos; flag is written if it&apos;s set:&lt;/p&gt;

&lt;p&gt;if (expired) {&lt;br/&gt;
    out.writeBoolean(expired);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;But, in getAlteredFieldsBitMask, the bit in the bit mask is only set when the &apos;exprired&apos; flag is not set:&lt;/p&gt;

&lt;p&gt;bitMask = !expired ? bitMask | EXPIRED_BIT_MASK : bitMask;&lt;/p&gt;

&lt;p&gt;A short test:&lt;/p&gt;

&lt;p&gt;SimpleSession session = new SimpleSession(&quot;localhost&quot;);&lt;br/&gt;
//  This doesn&apos;t work either&lt;br/&gt;
// session.setExpired(true);&lt;br/&gt;
ByteArrayOutputStream serialized = new ByteArrayOutputStream();&lt;br/&gt;
ObjectOutputStream serializer = new ObjectOutputStream(serialized);&lt;br/&gt;
serializer.writeObject(session);&lt;br/&gt;
serializer.close();&lt;br/&gt;
new ObjectInputStream(new ByteArrayInputStream(serialized.toByteArray())).readObject();&lt;/p&gt;</description>
                <environment>Linux 2.6.34 x86_64&lt;br/&gt;
java version &amp;quot;1.5.0_12&amp;quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_12-b04)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 1.5.0_12-b04, mixed mode)</environment>
        <key id="12468566">SHIRO-182</key>
            <summary>SimpleSession cannot be deserialized</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kaosko">Kalle Korhonen</assignee>
                                    <reporter username="fdemarco">Favio D. DeMarco</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Jul 2010 14:29:27 +0000</created>
                <updated>Sun, 26 Jun 2011 21:51:58 +0000</updated>
                            <resolved>Wed, 7 Jul 2010 04:19:22 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Caching </component>
                    <component>Session Management</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12885249" author="fdemarco" created="Mon, 5 Jul 2010 14:38:16 +0000"  >&lt;p&gt;Actual version is 1.1.0-incubating-SNAPSHOT, shiro-core-1.1.0-incubating-20100701.070234-9.jar, from MANIFEST.MF:&lt;/p&gt;

&lt;p&gt;Hudson-Build-Number: 218&lt;br/&gt;
Hudson-Project: Shiro&lt;br/&gt;
Hudson-Version: 1.353&lt;/p&gt;</comment>
                            <comment id="12885250" author="kaosko" created="Mon, 5 Jul 2010 14:50:31 +0000"  >&lt;p&gt;Would be an easy merge for 1.0.1 as well.&lt;/p&gt;</comment>
                            <comment id="12885365" author="lhazlewood" created="Mon, 5 Jul 2010 23:15:50 +0000"  >&lt;p&gt;It will be easy to write a unit test for this - thanks for the example Favio.&lt;/p&gt;</comment>
                            <comment id="12885367" author="lhazlewood" created="Mon, 5 Jul 2010 23:17:17 +0000"  >&lt;p&gt;Updating fix version to 1.0.1 (bug fix without API adjustments)&lt;/p&gt;</comment>
                            <comment id="12885818" author="kaosko" created="Wed, 7 Jul 2010 04:19:22 +0000"  >&lt;p&gt;Leave a comment if you need it fixed for 1.0.1&lt;/p&gt;</comment>
                            <comment id="13055206" author="lhazlewood" created="Sun, 26 Jun 2011 21:51:58 +0000"  >&lt;p&gt;Closing as this was released in 1.1.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69959</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i108of:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>209540</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>