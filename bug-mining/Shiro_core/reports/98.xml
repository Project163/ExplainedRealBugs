<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:35:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SHIRO-902] Separator conflict between PermissionUtils.resolveDelimitedPermissions() and WildcardPermission.SUBPART_DIVIDER_TOKEN</title>
                <link>https://issues.apache.org/jira/browse/SHIRO-902</link>
                <project id="12310950" key="SHIRO">Shiro</project>
                    <description>&lt;p&gt;PermissionUtils.resolveDelimitedPermissions() accepts multiple permissions, separated by comma. But comma is already reserved by WildcardPermission.SUBPART_DIVIDER_TOKEN.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Example: &quot;user:read,write:*&quot;&lt;/p&gt;

&lt;p&gt;Expected:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;parts: [&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;user&amp;quot;&amp;#93;&lt;/span&gt;,&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;read&amp;quot;, &amp;quot;write&amp;quot;&amp;#93;&lt;/span&gt;,&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;*&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;tt&gt;]&lt;/tt&gt;&lt;tt&gt;Actual:&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;WildcardPermission.parts: [&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;user&amp;quot;&amp;#93;&lt;/span&gt;,&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;read&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;tt&gt;],&lt;/tt&gt;&lt;tt&gt;WildcardPermission.parts: [&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;write&amp;quot;&amp;#93;&lt;/span&gt;,&lt;/tt&gt;&lt;tt&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;*&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;tt&gt;]&lt;/tt&gt;{&lt;tt&gt;}&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;JUnit test to trigger the bug:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;import static org.assertj.core.api.Assertions.assertThat;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;import org.apache.shiro.authz.permission.WildcardPermission;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;import org.apache.shiro.authz.permission.WildcardPermissionResolver;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;import org.apache.shiro.util.PermissionUtils;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;import org.junit.jupiter.api.Test;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;public class PermissionUtilsTest {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; @Test&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; void verifyResolveDelimitedPermissionsRespectsSubPartDividerToken() {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; var permissionResolver = new WildcardPermissionResolver(true);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; var result = PermissionUtils.resolveDelimitedPermissions(&quot;user:read,write:*&quot;, permissionResolver);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; assertThat(result)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; &#160; .containsExactlyInAnyOrder(&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; new WildcardPermission(&quot;user:read,write:*&quot;)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; &#160; );&lt;/tt&gt;&lt;br/&gt;
{{&#160; &#160; }}}&lt;br/&gt;
&lt;tt&gt;}&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I understand, that PermissionUtils actually cannot know about WildcardPermission.SUBPART_DIVIDER_TOKEN, because it is hidden behind the PermissionResolver abstraction. But WildcardPermissionResolver is the only resolver you provide. PermissionUtils should support using it.&lt;/p&gt;

&lt;p&gt;I also understand that the fix will be a breaking change, which should usually be avoided in public APIs. But also consider, that every new user using PermissionUtils will waste time debugging this bug, and then will avoid using resolveDelimitedPermissions(). What&apos;s the purpose of a stable but unused API?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13517771">SHIRO-902</key>
            <summary>Separator conflict between PermissionUtils.resolveDelimitedPermissions() and WildcardPermission.SUBPART_DIVIDER_TOKEN</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="bmarwell">Benjamin Marwell</assignee>
                                    <reporter username="ewirch">Eduard Wirch</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jan 2023 08:22:30 +0000</created>
                <updated>Fri, 27 Jan 2023 18:23:39 +0000</updated>
                            <resolved>Fri, 27 Jan 2023 18:23:39 +0000</resolved>
                                    <version>1.10.1</version>
                                    <fixVersion>2.0.0-alpha</fixVersion>
                                    <component>Authorization (access control) </component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17676763" author="mampf86" created="Fri, 13 Jan 2023 20:38:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewirch&quot; class=&quot;user-hover&quot; rel=&quot;ewirch&quot;&gt;ewirch&lt;/a&gt; as a workaround, you could just pass a List of one element into &lt;tt&gt;resolvePermission().&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;I see your point (and I agree), but I am not sure if we want to solve it THAT way. Maybe just not providing the methohd &lt;tt&gt;resolveDelimitedPermissions&lt;/tt&gt; does not make any sense.&lt;/p&gt;</comment>
                            <comment id="17680331" author="mampf86" created="Tue, 24 Jan 2023 19:30:30 +0000"  >&lt;p&gt;Hah, we can&apos;t just get rid of the method as I thought.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://shiro.apache.org/configuration.html#Configuration-INIConfiguration-Sections-roles&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://shiro.apache.org/configuration.html#Configuration-INIConfiguration-Sections-roles&lt;/a&gt; where we say:&lt;/p&gt;
&lt;h5&gt;&lt;a name=&quot;LineFormat&quot;&gt;&lt;/a&gt;Line Format&lt;/h5&gt;

&lt;p&gt;Each line in the &lt;span class=&quot;error&quot;&gt;&amp;#91;roles&amp;#93;&lt;/span&gt; section must must define a role-to-permission(s) key/value mapping with in the following format:&lt;br/&gt;
&lt;tt&gt;rolename&lt;/tt&gt;&#160;=&#160;&lt;em&gt;permissionDefinition1&lt;/em&gt;,&#160;&lt;em&gt;permissionDefinition2&lt;/em&gt;, &#8230;,&#160;&lt;em&gt;permissionDefinitionN&lt;/em&gt;&lt;br/&gt;
where&#160;&lt;em&gt;permissionDefinition&lt;/em&gt;&#160;is an arbitrary String, but most people will want to use strings that conform to the&#160;&lt;a href=&quot;https://shiro.apache.org/static/current/apidocs/org/apache/shiro/authz/permission/WildcardPermission.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;org.apache.shiro.authz.permission.WildcardPermission&lt;/tt&gt;&lt;/a&gt;&#160;format for ease of use and flexibility. See the&#160;&lt;a href=&quot;https://shiro.apache.org/permissions.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Permissions&lt;/a&gt;&#160;documentation for more information on Permissions and how you can benefit from them.&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Internal commas&lt;br/&gt;
Note that if an individual&#160;&lt;b&gt;permissionDefinition&lt;/b&gt;&#160;needs to be internally comma-delimited (e.g.&#160;&lt;tt&gt;printer:5thFloor:print,info&lt;/tt&gt;), you will need to surround that definition with double quotes (&quot;) to avoid parsing errors:`&quot;printer:5thFloor:print,info&quot;`&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;That said,, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewirch&quot; class=&quot;user-hover&quot; rel=&quot;ewirch&quot;&gt;ewirch&lt;/a&gt;, can you try to qoute the permissions?&lt;br/&gt;
Like so? &lt;tt&gt;PermissionUtils.resolveDelimitedPermissions(&quot;\&quot;user:read,write:*\&quot;&quot;, permissionResolver);&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17681435" author="mampf86" created="Fri, 27 Jan 2023 18:23:39 +0000"  >&lt;p&gt;As shown in the new testcase in commit &lt;a href=&quot;https://github.com/apache/shiro/commit/1973173049442bb5388cd11a44d9c77edd45422f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/shiro/commit/1973173049442bb5388cd11a44d9c77edd45422f&lt;/a&gt;, this is not a bug. The manual clearly states that quoting is needed in such cases.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>English</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1eqyg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>