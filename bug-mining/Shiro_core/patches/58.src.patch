diff --git a/core/src/main/java/org/apache/shiro/authc/credential/PasswordMatcher.java b/core/src/main/java/org/apache/shiro/authc/credential/PasswordMatcher.java
index 478732f1d..e687dcc1a 100644
--- a/core/src/main/java/org/apache/shiro/authc/credential/PasswordMatcher.java
+++ b/core/src/main/java/org/apache/shiro/authc/credential/PasswordMatcher.java
@@ -92,7 +92,12 @@ public class PasswordMatcher implements CredentialsMatcher {
     }
 
     protected Object getStoredPassword(AuthenticationInfo storedAccountInfo) {
-        return storedAccountInfo != null ? storedAccountInfo.getCredentials() : null;
+        Object stored = storedAccountInfo != null ? storedAccountInfo.getCredentials() : null;
+        //fix for https://issues.apache.org/jira/browse/SHIRO-363
+        if (stored instanceof char[]) {
+            stored = new String((char[])stored);
+        }
+        return stored;
     }
 
     public PasswordService getPasswordService() {
diff --git a/core/src/test/groovy/org/apache/shiro/authc/credential/PasswordMatcherTest.groovy b/core/src/test/groovy/org/apache/shiro/authc/credential/PasswordMatcherTest.groovy
index 350623f35..cb34f88ba 100644
--- a/core/src/test/groovy/org/apache/shiro/authc/credential/PasswordMatcherTest.groovy
+++ b/core/src/test/groovy/org/apache/shiro/authc/credential/PasswordMatcherTest.groovy
@@ -21,6 +21,7 @@ package org.apache.shiro.authc.credential
 import org.apache.shiro.authc.AuthenticationInfo
 import org.apache.shiro.authc.AuthenticationToken
 import org.apache.shiro.crypto.hash.Sha256Hash
+
 import static org.easymock.EasyMock.*
 
 /**
@@ -114,6 +115,34 @@ class PasswordMatcherTest extends GroovyTestCase {
         verify token, info, service
     }
 
+    /**
+     * Asserts fix for https://issues.apache.org/jira/browse/SHIRO-363
+     */
+    void testCharArrayComparison() {
+        def service = createMock(PasswordService)
+        def token = createMock(AuthenticationToken)
+        def info = createMock(AuthenticationInfo)
+        //generate a stored password just for this test:
+        def submittedPassword = "foo"
+        def savedPasswordAsString = "foo";
+        def savedPassword = savedPasswordAsString.toCharArray()
+
+        expect(token.credentials).andReturn submittedPassword
+        expect(info.credentials).andReturn savedPassword
+
+        expect(service.passwordsMatch(eq(submittedPassword), eq(savedPasswordAsString))).andReturn true
+
+        replay token, info, service
+
+        def matcher = new PasswordMatcher()
+        matcher.passwordService = service
+        assertSame service, matcher.passwordService
+
+        assertTrue matcher.doCredentialsMatch(token, info)
+
+        verify token, info, service
+    }
+
     void testUnexpectedSavedCredentialsType() {
         def service = createMock(HashingPasswordService)
         def token = createMock(AuthenticationToken)
