diff --git a/core/src/main/java/org/apache/shiro/authz/ModularRealmAuthorizer.java b/core/src/main/java/org/apache/shiro/authz/ModularRealmAuthorizer.java
index 3c8fc13f5..fbef09471 100644
--- a/core/src/main/java/org/apache/shiro/authz/ModularRealmAuthorizer.java
+++ b/core/src/main/java/org/apache/shiro/authz/ModularRealmAuthorizer.java
@@ -89,6 +89,7 @@ public class ModularRealmAuthorizer implements Authorizer, PermissionResolverAwa
     public void setRealms(Collection<Realm> realms) {
         this.realms = realms;
         applyPermissionResolverToRealms();
+        applyRolePermissionResolverToRealms();
     }
 
     /**
diff --git a/core/src/main/java/org/apache/shiro/util/ThreadContext.java b/core/src/main/java/org/apache/shiro/util/ThreadContext.java
index 8d800adae..86af204f3 100644
--- a/core/src/main/java/org/apache/shiro/util/ThreadContext.java
+++ b/core/src/main/java/org/apache/shiro/util/ThreadContext.java
@@ -40,6 +40,7 @@ import java.util.Map;
  * execution, respectively (i.e. individually explicitly or all via the <tt>clear</tt> method).</p>
  *
  * @author Les Hazlewood
+ * @author Kalle Korhonen
  * @see #remove()
  * @since 0.1
  */
diff --git a/core/src/test/java/org/apache/shiro/authz/ModularRealmAuthorizerTest.java b/core/src/test/java/org/apache/shiro/authz/ModularRealmAuthorizerTest.java
index 2fcc9799b..edd046b4e 100644
--- a/core/src/test/java/org/apache/shiro/authz/ModularRealmAuthorizerTest.java
+++ b/core/src/test/java/org/apache/shiro/authz/ModularRealmAuthorizerTest.java
@@ -18,6 +18,8 @@
  */
 package org.apache.shiro.authz;
 
+import static org.junit.Assert.assertTrue;
+
 import java.util.ArrayList;
 import java.util.Collection;
 
@@ -75,13 +77,22 @@ public class ModularRealmAuthorizerTest
             Assert.assertTrue( ((AuthorizingRealm)realm).getRolePermissionResolver() == rolePermissionResolver );
         }
         
+        // add a new realm and make sure the RolePermissionResolver is set
+        MockAuthorizingRealm mockRealm = new MockAuthorizingRealm();
+        realms.add( mockRealm );
+        modRealmAuthz.setRealms( realms );
+        assertTrue( ((AuthorizingRealm) mockRealm).getRolePermissionResolver() == rolePermissionResolver );
+        
+        
         // TODO: no way to unset them, not sure if that is a valid use case, but this is conistent with the PermissionResolver logic
 //        // now just to be sure, unset them
 //        modRealmAuthz.setRolePermissionResolver( null );
 //        for ( Realm realm : realms )
 //        {
 //            Assert.assertNull( ((AuthorizingRealm)realm).getRolePermissionResolver() );
-//        }    
+//        }
+        
+        
     }
     
     class MockAuthorizingRealm extends AuthorizingRealm
