diff --git a/core/src/test/java/org/apache/shiro/mgt/VMSingletonDefaultSecurityManagerTest.java b/core/src/test/java/org/apache/shiro/mgt/VMSingletonDefaultSecurityManagerTest.java
index fc860c7a2..81c9878c1 100644
--- a/core/src/test/java/org/apache/shiro/mgt/VMSingletonDefaultSecurityManagerTest.java
+++ b/core/src/test/java/org/apache/shiro/mgt/VMSingletonDefaultSecurityManagerTest.java
@@ -56,18 +56,21 @@ public class VMSingletonDefaultSecurityManagerTest {
         sm.setRealm(new IniRealm(ini));
         SecurityUtils.setSecurityManager(sm);
 
-        Subject subject = SecurityUtils.getSubject();
+        try {
+            Subject subject = SecurityUtils.getSubject();
 
-        AuthenticationToken token = new UsernamePasswordToken("guest", "guest");
-        subject.login(token);
-        subject.getSession().setAttribute("key", "value");
-        assertTrue(subject.getSession().getAttribute("key").equals("value"));
+            AuthenticationToken token = new UsernamePasswordToken("guest", "guest");
+            subject.login(token);
+            subject.getSession().setAttribute("key", "value");
+            assertTrue(subject.getSession().getAttribute("key").equals("value"));
 
-        subject = SecurityUtils.getSubject();
+            subject = SecurityUtils.getSubject();
 
-        assertTrue(subject.isAuthenticated());
-        assertTrue(subject.getSession().getAttribute("key").equals("value"));
-
-        sm.destroy();
+            assertTrue(subject.isAuthenticated());
+            assertTrue(subject.getSession().getAttribute("key").equals("value"));
+        } finally {
+            sm.destroy();
+            SecurityUtils.setSecurityManager(null);
+        }
     }
 }
