diff --git a/core/src/test/java/org/apache/shiro/crypto/JcaCipherServiceTest.java b/core/src/test/java/org/apache/shiro/crypto/JcaCipherServiceTest.java
new file mode 100644
index 000000000..03d733ac2
--- /dev/null
+++ b/core/src/test/java/org/apache/shiro/crypto/JcaCipherServiceTest.java
@@ -0,0 +1,23 @@
+package org.apache.shiro.crypto;
+
+import static org.junit.Assert.*;
+
+import org.junit.Test;
+
+public class JcaCipherServiceTest {
+
+    @Test
+    public void testDecrypt() {
+	JcaCipherService cipherService = new JcaCipherService("AES") {};
+	String ciphertext = "iv_helloword";
+	String key = "somekey";
+	try {
+	    // This should cause ArrayIndexOutOfBoundsException, at least currently that's what we want
+	    cipherService.decrypt(ciphertext.getBytes(), key.getBytes());
+	} catch (CryptoException e) {
+	    return;
+	}
+        fail("CryptoException was expected to be thrown");
+    }
+
+}
