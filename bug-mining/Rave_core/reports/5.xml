<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:25:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[RAVE-331] Error when trying to upload a duplicate gadget url to widget store</title>
                <link>https://issues.apache.org/jira/browse/RAVE-331</link>
                <project id="12311290" key="RAVE">Rave</project>
                    <description>&lt;p&gt;How to Reproduce&lt;br/&gt;
--------------------------&lt;br/&gt;
1) Login to Rave as any user&lt;br/&gt;
2) Upload a gadget to the widget store - verify it was added successfully&lt;br/&gt;
3) Go back and try to add the same gadget url again&lt;br/&gt;
4) You will see the standard &quot;rave has suffered a brief meltdown&quot; page&lt;/p&gt;

&lt;p&gt;The issue is that the DefaultWidgetService.registerNewWidget function returns a null Widget object if it finds the URL already in the system.  The RavePermissionEvaluator.hasPermission functions are not properly dealing with potential null objects and thus a NPE is thrown.&lt;/p&gt;

&lt;p&gt;How to Fix&lt;br/&gt;
----------------&lt;br/&gt;
1) Improve the RavePermissionEvaluator.hasPermission methods to check for and safely handle possible null objects.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12529673">RAVE-331</key>
            <summary>Error when trying to upload a duplicate gadget url to widget store</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="carlucci">Tony Carlucci</assignee>
                                    <reporter username="carlucci">Tony Carlucci</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Nov 2011 14:57:09 +0000</created>
                <updated>Fri, 13 Jan 2012 15:40:23 +0000</updated>
                            <resolved>Fri, 4 Nov 2011 11:19:18 +0000</resolved>
                                    <version>0.5-INCUBATING</version>
                                    <fixVersion>0.6-INCUBATING</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13142448" author="carlucci" created="Wed, 2 Nov 2011 19:40:54 +0000"  >&lt;p&gt;Jasha - I&apos;ve applied the fix to the RavePermissionEvaluator class to check for null domain objects.  You should be able to apply your DuplicateItemException changes to the WidgetService#registerNewWidget now (&lt;a href=&quot;https://issues.apache.org/jira/browse/RAVE-332&quot; title=&quot;Change logic of adding a  duplicate widget&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAVE-332&quot;&gt;&lt;del&gt;RAVE-332&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13142979" author="jashajoachimsthal" created="Thu, 3 Nov 2011 09:13:50 +0000"  >&lt;p&gt;The permission check is too strict. Neither as admin nor as user I&apos;m allowed to check if a widget exists for a given URL.&lt;br/&gt;
This should be possible for both a new URL and a URL that belongs to a widget that already exists but hasn&apos;t been published yet.&lt;br/&gt;
All my unit tests pass, but the real form submission fails with a 403 access denied.&lt;/p&gt;</comment>
                            <comment id="13143237" author="carlucci" created="Thu, 3 Nov 2011 15:29:12 +0000"  >&lt;p&gt;Right - the READ permission in DefaultWidgetPermissionEvaluator is coded such that read permission is granted if the user is the owner of the widget or if the widget has a &apos;published&apos; status (so that regular users can&apos;t access non published widgets).  Sounds like we should add a new WidgetService method:&lt;/p&gt;

&lt;p&gt;boolean isRegistered(String widgetUrl) &lt;/p&gt;

&lt;p&gt;that we leave unsecured.  So any user can check to see if a particular url has already been registered, but they don&apos;t necesarily get access to the object if it does exist.  Thoughts?&lt;/p&gt;</comment>
                            <comment id="13143243" author="jashajoachimsthal" created="Thu, 3 Nov 2011 15:38:11 +0000"  >&lt;p&gt;An admin should have read permission even if he is not the owner.&lt;/p&gt;

&lt;p&gt;In this use case the isRegistered is good enough for everyone. &lt;/p&gt;</comment>
                            <comment id="13143306" author="carlucci" created="Thu, 3 Nov 2011 16:53:12 +0000"  >&lt;p&gt;Yes, an admin gets all permissions in the Default&lt;span class=&quot;error&quot;&gt;&amp;#91;Model&amp;#93;&lt;/span&gt;PermissionEvaluators the way they are coded right now.  The parent AbstractModelPermissionEvaluator#hasPermission function checks to see if the user is an admin, which superseeds all other permission checks.&lt;/p&gt;

&lt;p&gt;Just to clarify - are you going to create the isRegistered function or did you want me to do it (fine either way)&lt;/p&gt;</comment>
                            <comment id="13143318" author="jashajoachimsthal" created="Thu, 3 Nov 2011 17:02:45 +0000"  >&lt;p&gt;As an admin (canonical) I also got the 403 when trying to add the widget that already existed in preview.&lt;/p&gt;

&lt;p&gt;I&apos;ll create the isRegistered myself, probably tomorrow.&lt;/p&gt;</comment>
                            <comment id="13143412" author="carlucci" created="Thu, 3 Nov 2011 18:24:40 +0000"  >&lt;p&gt;If you haven&apos;t modified the registerNewWidget function yet to throw the DuplicateItemException, then yes that is expected, because it returns null if it found a Widget already in the database.  The permission evaluator then denies permission on a null Widget.&lt;/p&gt;</comment>
                            <comment id="13143923" author="jashajoachimsthal" created="Fri, 4 Nov 2011 11:19:18 +0000"  >&lt;p&gt;Added isRegistered, admin can indeed call getWidgetByUrl&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12529677">RAVE-332</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12501778" name="stacktrace.log" size="8799" author="carlucci" created="Tue, 1 Nov 2011 14:57:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215532</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 3 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1e25r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>290279</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>